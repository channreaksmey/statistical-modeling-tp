<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>TP4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="TP4_files/libs/clipboard/clipboard.min.js"></script>
<script src="TP4_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="TP4_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="TP4_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="TP4_files/libs/quarto-html/popper.min.js"></script>
<script src="TP4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="TP4_files/libs/quarto-html/anchor.min.js"></script>
<link href="TP4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="TP4_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="TP4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="TP4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="TP4_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TP4</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="tp4---generalized-linear-models" class="level1">
<h1>TP4 - Generalized Linear Models</h1>
<section id="problem-1" class="level2">
<h2 class="anchored" data-anchor-id="problem-1">Problem 1</h2>
<p><strong>Mroz’s Data on Women’s Labour-Force Participation</strong>: The data in the data frame <code>Mroz</code> in the car package, originally employed by Mroz (1987), were used by Long (1997) to illustrate the method of logistic regression. The variables in the dataset are described in the following table, adapted from Long (and using Long’s variable names). Most of the variables are self-explanatory. The variable <code>lwg</code> is the log of the wife’s actual wage if she is working outside the home. For women not working outside the home, Mroz proceeded as follows: He regressed the log-wages of the working women on the other variables, and used the resulting regression equation to predict the wages of those not working outside the home.</p>
<p>• <code>lfp</code>: 1 if the wife is in the paid labour force, 0 otherwise</p>
<p>• <code>k5</code>: number of children ages 5 and younger</p>
<p>• <code>k618</code>: number of children ages 6 to 18</p>
<p>• <code>age</code>: wife’s age in years</p>
<p>• <code>wc</code>: 1 if wife attended college, 0 otherwise</p>
<p>• <code>hc</code>: 1 if husband attended college, 0 otherwise</p>
<p>• <code>lwg</code>: log of wife’s estimated wage rate</p>
<p>• <code>inc</code>: family income excluding wife’s wages, $1000s</p>
<p>Following Long, perform a logistic regression of <code>lfp</code> on the other variables. Briefly (i.e., in a paragraph) summarize the results of this regression. Offer two concrete interpretations of the coefficient of <code>inc</code> in the logistic regression.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(car)) <span class="fu">install.packages</span>(<span class="st">"car"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: car</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Mroz)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Mroz)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   753 obs. of  8 variables:
 $ lfp : Factor w/ 2 levels "no","yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ k5  : int  1 0 1 0 1 0 0 0 0 0 ...
 $ k618: int  0 2 3 3 2 0 2 0 2 2 ...
 $ age : int  32 30 35 34 31 54 37 54 48 39 ...
 $ wc  : Factor w/ 2 levels "no","yes": 1 1 1 1 2 1 2 1 1 1 ...
 $ hc  : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ lwg : num  1.2102 0.3285 1.5141 0.0921 1.5243 ...
 $ inc : num  10.9 19.5 12 6.8 20.1 ...</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Mroz)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  lfp            k5              k618            age          wc        hc     
 no :325   Min.   :0.0000   Min.   :0.000   Min.   :30.00   no :541   no :458  
 yes:428   1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:36.00   yes:212   yes:295  
           Median :0.0000   Median :1.000   Median :43.00                      
           Mean   :0.2377   Mean   :1.353   Mean   :42.54                      
           3rd Qu.:0.0000   3rd Qu.:2.000   3rd Qu.:49.00                      
           Max.   :3.0000   Max.   :8.000   Max.   :60.00                      
      lwg               inc        
 Min.   :-2.0541   Min.   :-0.029  
 1st Qu.: 0.8181   1st Qu.:13.025  
 Median : 1.0684   Median :17.700  
 Mean   : 1.0971   Mean   :20.129  
 3rd Qu.: 1.3997   3rd Qu.:24.466  
 Max.   : 3.2189   Max.   :96.000  </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform logistic regression of lfp on all other variables</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(lfp <span class="sc">~</span> k5 <span class="sc">+</span> k618 <span class="sc">+</span> age <span class="sc">+</span> wc <span class="sc">+</span> hc <span class="sc">+</span> lwg <span class="sc">+</span> inc, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> Mroz, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary of the logistic regression</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = lfp ~ k5 + k618 + age + wc + hc + lwg + inc, family = binomial(link = "logit"), 
    data = Mroz)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  3.182140   0.644375   4.938 7.88e-07 ***
k5          -1.462913   0.197001  -7.426 1.12e-13 ***
k618        -0.064571   0.068001  -0.950 0.342337    
age         -0.062871   0.012783  -4.918 8.73e-07 ***
wcyes        0.807274   0.229980   3.510 0.000448 ***
hcyes        0.111734   0.206040   0.542 0.587618    
lwg          0.604693   0.150818   4.009 6.09e-05 ***
inc         -0.034446   0.008208  -4.196 2.71e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1029.75  on 752  degrees of freedom
Residual deviance:  905.27  on 745  degrees of freedom
AIC: 921.27

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>The logistic regression analysis reveals several significant predictors of women’s labour force participation. The number of young children (k5) has a strong negative effect (p &lt; 0.001), indicating that each additional child under age 5 substantially reduces the likelihood of labour force participation. Similarly, the wife’s age shows a negative association, suggesting that older women in the sample are less likely to work outside the home. In contrast, the log of the wife’s estimated wage rate (lwg) has a strong positive effect (p &lt; 0.001), indicating that women with higher earning potential are more likely to participate in the labour force. Notably, family income excluding the wife’s wages (inc) has a significant negative coefficient, suggesting that higher family income reduces the wife’s likelihood of working outside the home, possibly due to reduced financial necessity. Educational attainment, measured by college attendance for both wife (wc) and husband (hc), shows positive but varying levels of significance. The number of older children (k618) appears to have a weaker effect on labour force participation compared to younger children.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate odds ratios and confidence intervals</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_model))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>conf_intervals <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(logit_model))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine results</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Coefficient =</span> <span class="fu">coef</span>(logit_model),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">OddsRatio =</span> odds_ratios,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                 conf_intervals)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Coefficient  OddsRatio     2.5 %     97.5 %
(Intercept)  3.18214046 24.0982799 6.9377228 87.0347916
k5          -1.46291304  0.2315607 0.1555331  0.3370675
k618        -0.06457068  0.9374698 0.8200446  1.0710837
age         -0.06287055  0.9390650 0.9154832  0.9625829
wcyes        0.80727378  2.2417880 1.4347543  3.5387571
hcyes        0.11173357  1.1182149 0.7467654  1.6766380
lwg          0.60469312  1.8306903 1.3689201  2.4768235
inc         -0.03444643  0.9661401 0.9502809  0.9814042</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specific interpretations for 'inc' coefficient</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>inc_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(logit_model)[<span class="st">"inc"</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>inc_odds_ratio <span class="ot">&lt;-</span> <span class="fu">exp</span>(inc_coef)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Interpretations of 'inc' coefficient ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Interpretations of 'inc' coefficient ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Coefficient:"</span>, inc_coef, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficient: -0.03444643 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odds Ratio:"</span>, inc_odds_ratio, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odds Ratio: 0.9661401 </code></pre>
</div>
</div>
<ul>
<li><p>The 95% confidence interval [0.9503, 0.9814] <strong>does not include 1. 0</strong></p></li>
<li><p>This confirms the effect is <strong>statistically significant</strong> (p &lt; 0.001)</p></li>
<li><p>We can be confident that higher family income genuinely reduces wives’ labour force participation</p></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretation 1: Change in log-odds</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation 1 (Log-odds):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation 1 (Log-odds):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"For each $1,000 increase in family income (excluding wife's wages),</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>For each $1,000 increase in family income (excluding wife's wages),</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"the log-odds of the wife participating in the labour force changes by"</span>, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(inc_coef, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>the log-odds of the wife participating in the labour force changes by -0.0344 </code></pre>
</div>
</div>
<p><strong>Interpretation 1: Log-Odds Scale (Additive Effect)</strong></p>
<p>For each <strong>$1,000 increase</strong> in family income excluding the wife’s wages, the <strong>log-odds</strong> of the wife participating in the labour force <strong>decrease by 0.0344 units</strong>, holding all other variables constant.</p>
<p><strong>More concretely:</strong> Consider two otherwise identical women (same age, education, number of children, etc.). If Woman A’s family has an income of $20,000 (excluding her potential wages) and Woman B’s family has an income of $30,000, then Woman B’s log-odds of working are <strong>0.344 units lower</strong> than Woman A’s (0.0344 × 10 = 0.344).</p>
<p>This negative relationship suggests that as household income from other sources (primarily husband’s earnings) increases, wives become less likely to seek paid employment, consistent with the economic theory of the “income effect” - when the family has sufficient financial resources, there’s less economic necessity for the wife to work outside the home.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretation 2: Percentage change in odds</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>percent_change <span class="ot">&lt;-</span> (inc_odds_ratio <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation 2 (Odds):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation 2 (Odds):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"For each $1,000 increase in family income (excluding wife's wages),</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>For each $1,000 increase in family income (excluding wife's wages),</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"the odds of the wife participating in the labour force are multiplied by"</span>, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(inc_odds_ratio, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>the odds of the wife participating in the labour force are multiplied by 0.9661 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"This represents approximately a"</span>, <span class="fu">round</span>(percent_change, <span class="dv">2</span>), </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% change in the odds.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>This represents approximately a -3.39 % change in the odds.</code></pre>
</div>
</div>
<p><strong>Interpretation 2: Odds Ratio Scale (Multiplicative Effect)</strong></p>
<p>For each <strong>$1,000 increase</strong> in family income excluding the wife’s wages, the <strong>odds</strong> of the wife participating in the labour force are <strong>multiplied by 0.966</strong> (or reduced by approximately 3.4%), holding all other variables constant.</p>
<p><strong>More concretely:</strong> Consider the same two women from above. Woman B (with family income $10,000 higher) has odds of labour force participation that are <strong>0.966¹⁰ = 0.708</strong> (or about <strong>71%</strong>) of Woman A’s odds. In other words, the higher family income results in approximately a <strong>29% reduction</strong> in the odds of working.</p>
<p><strong>Practical example with probabilities:</strong> Suppose Woman A (lower income) has a 0.60 probability of working, which corresponds to odds of 0.60/(1-0.60) = 1.5. Woman B (income $10,000 higher) would have odds of 1.5 × 0.708 = 1.062, corresponding to a probability of 1.062/(1+1.062) = 0.515 or about <strong>51.5%</strong>. Thus, the $10,000 income difference translates to about an <strong>8.5 percentage point reduction</strong> in the probability of labour force participation.</p>
</section>
<section id="problem-2" class="level2">
<h2 class="anchored" data-anchor-id="problem-2">Problem 2</h2>
<p><strong>Powers and Xie’s Data on High-School Graduation</strong>: Employing a sample of 1643 men between the ages of 20 and 24 from the U. S. National Longitudinal Survey of Youth, Powers and Xie (2000) investigate the relationship between high-school graduation and parents’ education, race, family income, number of siblings, family structure, and a test of academic ability. The data set, in the file <code>Powers.txt</code> on the course web site, contains the following variables (using Powers and Xie’s variable names):</p>
<p>• <code>hsgrad</code>: whether the respondent was graduated from high school by 1985 (<code>Yes</code> or <code>No</code>)</p>
<p>• <code>nonwhite</code>: whether the respondent is black or Hispanic (<code>Yes</code> or <code>No</code>)</p>
<p>• <code>mhs</code>: whether the respondent’s mother is a high-school graduate (<code>Yes</code> or <code>No</code>)</p>
<p>• <code>fhs</code>: whether the respondent’s father is a high-school graduate (<code>Yes</code> or <code>No</code>)</p>
<p>• <code>income</code>: Family income in 1979 (in $1000s) adjusted for family size</p>
<p>• <code>asvab</code>: standardized score on the Armed Services Vocational Aptitude Battery test</p>
<p>• <code>nsibs</code>: number of siblings</p>
<p>• <code>intact</code>: whether the respondent lived with both biological parents at age 14 (<code>Yes</code> or <code>No</code>)</p>
<p>The data file also contains respondent ID numbers, which are not contiguous.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>powers <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"~/Documents/I4-AMS-B/Statistical-Modeling/statistical-modeling-tp/TP4/Powers.txt"</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>powers <span class="ot">&lt;-</span> powers[<span class="fu">complete.cases</span>(powers), ]</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>yn_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hsgrad"</span>, <span class="st">"nonwhite"</span>, <span class="st">"mhs"</span>, <span class="st">"fhs"</span>, <span class="st">"intact"</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>powers[yn_vars] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  powers[yn_vars],</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>powers</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      hsgrad nonwhite mhs fhs income  asvab nsibs intact
7          1        0   1   1  4.909 -0.110     1      0
9          1        0   1   0  6.940  0.452     4      0
15         1        0   1   1 11.000  0.967     1      1
26         1        0   0   0 15.000  1.667     2      0
31         1        1   0   0  2.544  0.000     2      0
36         1        0   0   1  9.391  0.000     3      0
41         1        0   0   1  3.175  0.460     3      0
42         1        0   0   1 10.500 -0.620     1      1
64         1        0   0   1 15.105  1.257     3      1
69         1        0   0   0 20.000  1.110     1      1
73         1        0   0   0 12.500  0.850     2      0
106        1        0   1   0  6.351  1.573     1      1
107        1        0   0   0 11.180  0.725     2      1
120        1        0   0   1 26.833  1.662     2      1
122        1        0   0   0  6.000  0.588     1      1
139        1        0   0   0 15.119  0.749     4      1
145        1        0   1   1  4.899  0.437     3      1
146        1        0   1   1  4.899  1.151     3      1
148        1        0   1   1  9.839  0.749     2      0
155        0        0   1   1  7.348 -0.027     3      1
162        1        0   0   0 12.000  1.569     2      1
163        1        0   0   0 12.000  0.964     2      1
166        1        0   0   1  8.944  0.682     3      1
185        1        0   1   1 10.286  0.186     3      1
187        1        0   1   1 13.416  0.170     2      1
191        1        0   0   0 13.000  1.090     2      1
194        1        0   1   1 14.000  0.504     1      1
196        1        0   0   0 35.000  1.585     1      1
198        1        0   0   0 15.000  0.803     1      1
207        0        0   0   0  5.814 -0.771     2      0
230        1        0   1   0  9.500 -0.191     2      1
232        1        0   0   0 12.969  0.502     3      1
233        1        0   0   0 12.969 -0.574     3      1
234        1        0   0   0  2.887 -0.100     7      1
235        1        0   1   1  6.532  0.727     3      1
241        1        0   0   0  3.536 -0.842     6      1
246        1        0   1   1  6.708  1.122     3      1
248        0        0   0   0  2.858 -0.974     4      0
253        0        0   0   1  7.000 -0.692     2      0
260        1        0   1   0 13.500  1.432     3      1
261        1        0   1   0 13.500  0.988     3      1
263        1        0   1   1  9.391  0.074     4      1
279        1        0   1   0 12.500  0.265     1      1
281        1        0   0   0 10.206  1.286     3      1
295        0        0   1   1  8.083 -0.572     1      0
299        0        1   0   1  2.179 -1.019     4      0
300        0        1   0   0  2.309 -1.680     2      1
313        0        0   0   0  6.940 -0.317     3      1
318        1        0   1   1 22.500 -0.900     2      1
324        0        0   1   1 12.247 -1.171     3      1
325        1        0   1   1 12.247  0.810     3      1
342        1        0   1   0  7.603  1.548     3      1
346        1        0   1   0  6.842  0.267     2      1
350        1        0   1   1 18.520  0.285     4      1
355        1        0   1   1  8.971  0.177     4      0
356        0        0   1   1 11.180  0.214     3      1
358        1        0   1   0 16.330 -0.101     3      1
372        1        0   1   0 14.758  1.310     2      1
378        0        1   0   1  2.415 -0.313     5      0
384        1        1   0   1  2.884 -0.180     5      0
387        1        1   0   0  8.126 -1.754     4      1
393        1        0   0   1 14.500  1.018     3      1
394        0        1   0   0  3.780 -1.425    11      0
408        1        0   1   1 17.500  1.181     5      1
411        1        0   0   1  8.944 -0.865     2      1
412        1        0   0   1  8.944  0.506     2      1
434        1        0   0   0  7.500  0.419     4      1
440        1        0   1   1 17.321  0.567     0      1
441        1        0   1   0 10.392 -1.404     1      1
443        1        0   0   0  5.000  1.496     1      1
445        1        0   0   0 20.000  1.057     1      1
448        1        0   1   1  5.774 -1.528     3      0
450        1        0   1   1 13.416 -0.263     4      1
451        1        0   1   1 13.416 -0.742     4      1
461        1        0   1   0 23.094  1.447     2      1
470        0        0   0   0  2.910 -1.114     4      0
479        1        0   1   1 12.000  0.610     1      1
484        1        0   1   0 19.654 -0.742     4      1
486        1        0   1   0 10.733  0.026     2      1
489        1        0   1   0 17.321  0.883     3      1
493        1        0   1   1 20.572  0.802     3      1
508        1        0   0   0 13.000 -0.428     3      1
509        1        0   1   1 14.311  1.276     2      1
511        1        0   1   1 13.685  1.218     2      1
513        1        1   0   0  3.101  0.369     4      0
517        0        1   0   0  2.475 -1.287     7      0
523        1        1   0   0 11.068 -0.765     7      1
535        0        0   0   0  4.899 -0.393     4      1
537        0        0   0   0  4.899 -1.680     9      1
540        0        0   0   0  4.919 -0.577     3      0
553        1        0   1   0 11.068  1.711     7      1
554        1        0   1   0 11.068  1.201     7      0
562        1        0   1   0 25.981  0.722     1      1
594        1        1   0   1  2.432  0.187     3      0
596        1        1   0   1  5.774  0.424     2      0
600        1        0   0   0  9.798  0.899     3      1
605        1        0   0   1 12.374  0.283     5      1
606        1        0   0   0 12.374  0.453     5      1
610        1        0   0   0 10.000 -0.510     7      1
613        1        0   0   1  7.778 -0.284     1      0
616        1        0   0   0 11.023 -1.474     3      1
628        1        1   0   0  3.748 -1.608     8      0
637        1        0   1   1 13.500  0.175     2      1
638        1        0   1   0 12.500  0.660     1      1
639        1        0   1   0 12.500  0.408     1      1
641        0        0   0   0 16.166 -1.000     2      1
645        1        0   1   0 37.501  1.432     2      1
651        1        0   1   1  6.928  0.869     1      0
663        1        0   1   0 10.000  0.801     1      1
667        1        0   1   0 15.652  0.904     2      1
671        1        1   0   0  9.238  1.161     1      0
672        1        1   0   0  9.238  0.409     1      0
674        0        1   0   0  8.333 -1.475     6      1
675        0        1   0   1  8.333 -1.713     6      1
676        1        1   0   1  8.333 -1.364     6      1
678        1        1   1   0  8.660 -0.825     4      1
681        1        0   0   0  2.041 -1.440    11      0
685        1        0   1   1 13.416  0.148     2      1
686        1        0   1   1 13.416  1.011     2      1
702        1        0   1   1  5.774 -0.351     2      1
707        1        0   0   0 10.392 -0.336     0      1
711        1        0   0   0 14.434  0.130     4      0
714        0        0   1   0  6.283 -0.701     2      1
725        1        0   0   0 23.094  1.667     1      1
728        1        0   0   0  5.307 -1.092     3      0
741        1        0   1   0  2.236  0.033     6      0
747        1        0   0   1 13.100  0.761     1      1
751        1        0   0   0  0.000 -0.532     3      1
754        1        1   0   0  3.130 -0.509     6      0
763        1        1   0   1  9.016 -0.042     6      1
765        1        1   0   1  9.016  0.146     5      1
767        0        0   1   1  7.757 -0.967     3      1
776        1        0   1   0 10.286  1.642     2      1
777        1        0   1   0 10.286  1.164     2      1
778        1        0   1   0 10.286  0.897     2      1
784        1        0   0   1  7.603 -0.068     2      1
791        1        0   1   0 10.733  0.750     2      1
795        1        0   1   0 25.981  0.146     0      1
797        1        0   0   1 20.000  0.763     2      1
799        1        0   1   1  9.827 -0.137     4      1
802        1        0   0   0  7.559 -0.550     5      1
806        1        0   1   1 12.247 -0.778     3      1
807        1        0   1   1 12.247  1.094     3      1
817        1        0   1   0 17.321  0.824     0      1
832        0        1   1   1  5.060 -0.278     8      1
838        1        1   0   0 16.000 -1.189     1      1
844        1        0   0   0  6.940 -0.473     3      1
850        1        0   1   0  5.367  1.274     4      1
860        1        0   0   1 14.434  0.873     4      0
864        1        0   1   0 26.833  0.136     3      1
870        1        0   0   1  5.303 -1.298     5      1
871        0        0   1   0  5.303  0.566     5      1
873        1        0   0   0 11.339  1.020     4      1
874        1        0   0   0 11.339  1.405     4      1
877        1        0   0   0 19.000  0.000     6      1
882        1        0   0   0 16.994  0.670     6      1
885        1        0   0   0 14.849  1.323     2      0
902        1        0   0   0 12.500  1.105     1      1
903        1        0   1   1 33.541  0.000     4      1
908        1        0   1   1  8.944  0.975     4      1
913        1        0   1   0  9.500  1.284     2      1
920        1        0   1   1  6.940  1.426     3      1
921        1        0   1   1  6.940 -1.297     3      1
924        1        0   1   0 12.969  1.169     2      1
929        1        0   1   1  8.944  0.615     2      1
937        1        0   1   1  8.839  1.129     6      1
938        1        0   1   1  8.839 -0.462     6      1
946        1        0   1   1 10.000  1.073     1      1
948        1        0   0   1 10.000 -0.503     9      1
951        1        0   1   1  7.348  0.109     3      1
956        1        0   1   1 11.180  0.251     2      1
957        1        0   1   1  9.391 -0.582     6      1
960        1        0   0   0 30.619  1.319     3      1
961        1        0   0   0 30.619  1.299     3      1
973        1        0   1   1 10.500  0.763     2      1
994        1        0   1   0  7.598  0.379     4      0
997        1        0   1   1 12.450  0.507     1      1
1000       1        1   0   1  2.933  0.747     4      0
1003       1        0   1   0  8.660  0.477     3      1
1010       1        0   0   1  9.000  1.136     2      1
1011       1        0   1   1 13.279 -0.149     0      1
1012       1        0   0   0 10.206 -1.378     3      1
1013       1        0   0   0 10.206  1.245     3      1
1042       1        0   0   0  2.449 -0.094     6      1
1043       1        0   1   0  2.797 -1.650     6      0
1044       1        0   1   0  8.944 -1.410     2      1
1046       1        0   0   1 15.000  0.578     1      1
1051       1        0   0   1 14.434  1.449     2      1
1052       1        0   1   1 12.247  1.498     3      1
1053       1        0   1   1 12.247  0.782     3      1
1054       1        0   1   1  9.500  0.000     1      1
1058       1        0   0   0  5.500 -0.232     2      0
1081       1        0   0   0 22.808  0.873     3      1
1089       0        0   0   0  5.814 -1.423     2      1
1092       1        0   0   0  7.603  0.387     8      1
1109       1        0   1   0 25.000  1.173     2      1
1125       1        0   1   1  4.000  0.000     3      0
1134       0        0   0   1 10.206  0.546     3      1
1145       1        0   1   0 23.094  1.423     2      1
1146       1        0   1   0  5.657 -0.890     3      0
1153       0        1   1   0  8.165 -1.419     3      1
1176       1        0   1   0 14.758  0.390     2      1
1186       1        0   0   0 13.416  0.435     2      1
1188       1        0   1   1  8.944  1.073     2      1
1222       1        1   0   0  1.812 -1.258     4      1
1247       1        0   0   0  7.603 -1.079     6      0
1248       1        0   1   1  8.497 -0.030     1      1
1256       1        0   0   1  5.228 -0.850     2      0
1257       0        0   1   1  9.000 -0.502     1      1
1273       1        0   1   0 11.000  0.633     2      1
1287       1        1   1   1  9.000 -1.125     2      1
1289       1        1   1   1  2.147 -0.640     1      0
1291       1        1   1   0  5.116 -1.229     1      0
1294       1        1   1   1  8.165  0.146     4      1
1315       1        0   0   0 20.000  0.412     1      1
1319       1        0   0   0  7.000 -1.428     1      1
1349       1        0   0   1  6.708  0.000     2      1
1350       1        0   0   1  6.708  0.000     2      1
1351       1        0   0   1  6.708 -0.209     2      1
1353       1        0   1   1 11.500  0.127     1      1
1368       1        0   1   0 26.517  1.513     7      1
1373       1        0   0   0 15.652  0.129     2      1
1379       1        1   1   0  1.938 -0.319     3      0
1383       0        1   1   0  8.315 -1.582     9      0
1384       1        1   1   0  8.315 -0.870     9      1
1387       0        1   0   0  0.917 -1.419    11      0
1396       1        0   1   0 13.856 -0.046     1      1
1417       0        0   0   1  6.005 -0.665     4      1
1418       1        1   0   1 10.733  0.013     2      0
1425       1        0   1   0  8.944  0.861     2      1
1433       1        1   0   1  4.472 -0.089     2      1
1434       0        0   0   0  3.580 -1.719     5      0
1447       1        0   1   0 31.820  0.000     0      1
1456       0        0   1   0 11.180 -0.300     2      0
1479       1        0   0   0 30.000  1.541     2      1
1501       1        0   0   0 18.371  1.450     3      1
1503       1        0   0   0  4.619  1.218     1      0
1508       1        0   0   0  8.165  1.569     3      1
1513       1        0   0   0 13.640 -0.532     2      1
1515       1        0   1   0 20.412  0.171     2      1
1535       0        0   1   0 10.614 -0.490     9      1
1536       0        1   1   0 11.628 -0.719     9      1
1555       1        0   1   0 14.950  1.058     4      1
1556       1        0   1   0 14.950  0.882     4      1
1557       1        0   1   0 11.180 -0.530     3      1
1560       1        0   1   0 11.000 -0.450     1      1
1561       1        0   0   0 28.284  0.346     0      0
1565       1        0   0   0 20.000  1.061     2      1
1569       1        0   1   1 11.180  0.704     4      0
1574       1        0   1   0 20.000  1.372     3      1
1580       0        0   1   1 16.000 -0.761     3      1
1585       1        0   0   0 15.000  0.324     1      1
1588       1        0   0   0  8.660  0.000     1      0
1590       1        0   0   0  5.715 -0.404     3      1
1591       1        0   0   0  5.715 -0.251     3      1
1597       1        0   0   1  7.500  0.788     1      1
1601       1        0   1   1  7.500  0.362     2      1
1602       1        0   1   1  7.500  0.331     2      1
1611       1        0   1   1 10.000  1.005     2      0
1612       1        0   1   1  4.572  0.620     3      1
1613       1        0   1   1  4.572  0.285     3      1
1618       1        0   1   1  7.181  0.784     5      1
1626       1        0   0   0  9.390  1.654     3      1
1627       0        0   0   0  9.390 -0.351     3      1
1630       1        0   1   1  8.400  0.939     3      1
1631       1        0   1   0  9.390  1.664     3      1
1632       1        0   1   0  9.390  1.691     3      1
1635       1        0   1   1  7.921  0.292     6      1
1636       1        0   1   1  7.921  0.306     6      1
1637       1        0   0   0 15.000  0.474     1      1
1644       1        0   0   0  6.000  0.035     1      1
1651       1        1   0   0  9.798  1.019     3      1
1659       1        0   1   1 22.678  0.487     6      1
1667       0        0   1   1  3.578  0.161     3      0
1669       1        0   1   0 12.000  1.037     2      1
1670       1        0   0   0 22.500  1.539     1      1
1672       1        0   1   0 13.880  0.528     3      1
1679       1        0   0   1 18.371  0.737     3      1
1682       1        0   1   1 10.392 -0.062     1      1
1715       1        1   0   0 11.000  0.516     1      1
1731       1        0   1   1  6.708  0.746     4      1
1741       0        0   1   1  7.000 -0.770     3      1
1743       1        0   1   1  4.800  0.085     3      1
1748       1        0   0   0 20.207  1.252     1      1
1763       1        1   0   0 10.159  0.853     1      0
1767       1        0   0   0 24.495  1.142     2      1
1772       0        0   1   0  1.680 -0.864     2      0
1780       1        0   0   0  9.238  1.149     3      1
1784       1        0   1   0  3.536  0.897     1      0
1788       1        0   1   1 10.392  0.701     2      1
1790       1        0   0   0  5.081  0.635     1      1
1791       1        0   1   1 13.500  0.676     1      1
1792       1        0   1   1 10.733  1.144     2      1
1796       1        0   1   0 12.702  0.381     3      0
1802       1        0   1   0 20.000  0.905     5      1
1810       1        0   1   1 33.541  0.241     2      1
1811       0        1   1   0  2.800 -0.344     9      0
1812       0        0   1   0  2.425 -1.153     9      0
1813       0        0   0   0  6.221 -0.693     4      0
1819       1        1   0   0  9.839  1.191     1      1
1822       0        1   0   0  4.472 -1.442     2      0
1830       0        1   0   0  0.265 -0.868     5      0
1836       1        1   0   0  2.041  0.366     6      1
1867       1        0   0   1  9.500  1.315     1      1
1869       1        0   1   1 10.206 -0.482     4      1
1873       1        0   0   0 11.748 -0.963     3      1
1881       1        0   1   1 12.075  0.053     2      1
1889       1        0   0   0  3.536  0.114     3      0
1890       1        0   0   0  3.536 -1.110     3      0
1894       1        0   1   0 15.700  0.179     3      1
1916       1        0   0   0 15.062  0.636     2      1
1917       1        0   1   1  5.196 -0.612     1      1
1919       1        0   1   1  9.839  0.221     2      1
1920       1        0   0   0 18.783  0.361     2      1
1924       1        0   0   0  6.532  0.056     3      0
1925       1        0   1   1 10.104  1.024     2      0
1930       1        0   1   1 10.000  1.487     1      1
1931       1        0   0   0 13.229 -0.285     4      0
1945       1        0   1   0  1.350  0.000     1      1
1950       1        0   1   0  5.774  0.747     1      1
1952       1        0   1   0 10.286 -0.041     2      1
1955       1        0   1   0  9.815  1.192     1      1
1963       1        0   1   1 14.434  0.989     2      1
1966       1        0   0   0  7.500  1.235     3      1
1971       1        0   1   0 11.000  0.108     1      1
1975       1        0   1   1 12.702  0.818     4      1
1977       1        0   1   1 12.000 -0.365     2      1
1978       1        0   1   1 12.000 -0.646     2      1
1984       0        0   0   0  3.464 -1.267     1      0
1991       0        0   1   0  4.830 -1.124     4      0
1992       1        0   1   0  4.830 -0.671     4      0
2005       1        0   1   0 22.361  1.196     2      1
2007       1        0   1   1 15.011  1.261     0      1
2015       0        0   0   0  0.939 -1.597     5      0
2020       1        0   1   0 11.431 -0.683     3      1
2026       0        0   0   0 11.258  0.000     0      1
2031       0        0   1   0  5.292 -1.721     2      0
2032       1        0   1   0  5.292 -0.742     2      0
2033       1        0   1   1 13.000  0.735     1      1
2038       1        0   0   0 11.547  1.546     1      1
2040       1        0   1   1 14.500  0.911     5      1
2041       1        0   1   1 12.969  0.481     5      1
2045       1        0   0   0  2.256 -0.125     4      0
2051       0        0   1   0  2.449 -1.225     3      1
2060       1        0   1   0  3.500  0.130     2      0
2067       1        0   1   1  7.750  0.244    11      0
2069       1        0   0   0 10.206  1.481     3      1
2078       1        0   0   0  3.578 -2.010     2      1
2085       1        0   1   1 11.000  0.350     1      1
2089       1        0   1   1  8.485 -0.593     6      1
2090       0        0   1   1  8.485 -0.814     6      1
2091       0        0   0   0  3.266 -1.590    10      1
2092       0        0   0   0  3.266 -1.281    10      1
2107       1        0   1   1 12.500  1.305     1      1
2109       1        0   1   0 17.500  0.496     2      1
2110       1        0   0   0  7.333  1.439     6      1
2111       1        0   1   0  7.333  1.082     6      1
2113       1        0   0   1 16.547  1.686     2      1
2118       1        0   1   1 13.416 -0.271     3      1
2135       0        0   0   0  9.899 -0.987     0      0
2138       1        0   1   0  3.536  0.684     5      1
2147       1        0   1   0 11.000  1.368     1      1
2151       1        0   1   1 14.000  1.021     2      1
2169       1        1   1   1 17.889  0.774     2      1
2172       1        0   0   0 12.124 -0.012     1      1
2178       1        0   1   0 18.475  0.711     3      1
2180       1        0   0   0  4.740  0.155     3      1
2182       1        0   0   0  5.931  0.892     4      0
2187       1        0   1   0  9.000 -0.005     1      1
2188       1        0   1   0  9.000 -0.705     1      1
2202       1        0   1   1 11.500  1.154     1      1
2207       1        0   0   1  5.657  0.805     0      0
2208       1        1   1   1  4.919 -0.550     3      0
2209       1        1   1   1  4.919 -0.845     3      0
2218       1        0   0   0 17.889  0.496     2      1
2219       1        0   1   0  8.160  0.230     1      1
2223       1        0   0   0  4.619  0.015     2      1
2238       1        0   1   0 15.652  1.351     2      1
2255       0        0   0   0  6.708 -0.982     2      1
2256       1        0   1   1  6.000  0.054     1      1
2261       0        0   0   0  3.250 -1.464     5      1
2266       0        1   1   0 13.333 -1.513     5      1
2291       1        0   0   0 20.000  1.640     1      1
2302       1        0   0   0  8.573  1.398     5      1
2306       0        0   0   0  5.367 -1.071     5      1
2307       0        0   0   0  5.367 -1.594     5      1
2309       1        0   0   0  1.485 -0.446    10      0
2316       0        0   0   0  6.000 -0.792     6      1
2323       1        0   1   1  8.944 -0.200     2      1
2326       1        0   0   1  8.497 -0.357     2      1
2327       1        0   0   1  8.497  0.359     2      1
2330       1        0   1   1  8.660  0.368     1      1
2341       1        0   1   1  8.944  1.260     3      1
2344       1        0   1   1 21.000 -1.020     1      1
2352       0        1   1   0  2.683 -1.482     3      0
2361       0        0   1   0  8.165 -1.543     6      1
2365       1        0   1   1 11.533 -0.234     3      0
2376       1        0   1   0 10.500  0.749     1      1
2380       1        0   1   1  5.367  0.916     3      0
2382       1        1   0   0  4.536 -0.034     5      1
2386       1        1   1   0  7.603  0.949     2      0
2397       0        1   0   0  4.693 -1.145    10      1
2415       1        0   1   0  8.032  1.423     2      0
2438       1        0   1   0 12.667  1.343     6      1
2439       1        0   1   0 12.667  0.767     6      1
2443       1        0   0   0  8.497  0.201     2      1
2456       0        0   1   1  7.500 -0.412     2      1
2465       1        0   0   1 11.180  1.626     4      1
2466       0        0   1   1  4.914 -0.678     5      1
2467       1        0   1   1  4.914  0.489     4      1
2470       1        0   0   0  7.000  0.711     1      0
2475       1        0   0   1 10.206  0.917     5      1
2476       0        0   0   1 10.206 -1.235     5      1
2477       1        0   0   0  5.303  0.679     1      0
2479       1        0   0   0  9.391  0.682     2      1
2497       1        0   1   1 12.800  0.932     3      0
2526       1        0   1   0  5.680  0.419     2      0
2527       1        0   1   1  7.647 -1.141     2      0
2540       1        0   1   1 19.963 -0.206     3      1
2541       1        0   1   0  6.750  1.519     2      1
2545       1        0   0   0 13.856  1.014     0      1
2546       1        0   0   0  7.778 -0.641     4      0
2547       1        1   1   0  5.000 -0.273     3      1
2553       1        0   1   0  5.124  0.951     5      1
2557       1        0   1   1 11.180  1.490     2      1
2562       1        0   0   1  6.546  1.183     5      1
2563       1        0   1   1  8.944  0.963     2      1
2571       1        0   1   1 10.619  1.244     1      1
2572       1        0   1   1 13.000  0.822     3      1
2574       1        0   0   0  2.598 -0.063     3      1
2578       1        0   1   1  3.464 -1.012    10      1
2579       1        0   1   1  4.135  1.435     1      1
2582       1        0   0   0  6.172 -0.892    12      1
2583       1        0   0   0  6.172  0.003    12      1
2584       1        0   0   0  6.172 -1.253    12      1
2589       1        0   0   0  4.000  1.547     1      1
2594       0        0   0   0  6.500  0.068     3      1
2602       0        0   0   0  5.367  0.633     4      1
2604       1        0   1   1  7.155  0.537     2      1
2610       1        0   1   0  8.944  1.219     2      1
2611       1        0   1   0 13.500  0.856     1      1
2612       1        0   1   0 13.500 -0.432     1      1
2617       0        0   1   1  7.217 -1.447     3      0
2630       1        0   1   1  6.081  0.785     2      0
2633       1        0   1   0  5.367  1.765     2      0
2642       1        0   0   0 10.500  1.343     1      1
2644       1        1   0   0  3.578 -0.066     4      1
2650       1        1   0   0  2.177  0.710     8      1
2658       0        1   0   0  2.834 -1.467     3      1
2666       0        0   0   0  1.500 -1.526     2      1
2682       0        1   0   0  0.077 -1.545    12      1
2696       1        1   0   1  2.268  0.076     4      1
2697       1        1   0   0  2.828  0.158     6      1
2707       1        1   0   0  3.266 -1.180     9      1
2714       1        0   1   0 17.321  1.506     1      1
2724       1        0   1   0 11.000  1.211     1      1
2725       1        0   1   0 15.011  1.291     0      1
2732       1        0   0   0  6.000  0.152     2      1
2755       0        0   1   0 10.733  0.600     3      1
2760       1        0   1   1  3.187 -0.040     5      0
2765       1        0   1   1 10.286  0.171     2      1
2766       1        0   0   0  3.130  0.926     2      1
2767       1        0   0   0  3.130 -1.147     2      1
2772       1        1   1   0  5.376 -0.867    10      1
2773       1        1   0   0  9.815 -0.112     0      1
2776       1        0   0   0  8.132  1.015     5      1
2780       1        0   0   0  0.805 -1.620     2      1
2783       1        0   1   0  1.097  0.129     2      1
2787       1        0   0   0  6.954  0.971     2      1
2800       1        0   1   1 19.706  1.526     1      1
2803       1        1   1   1  5.814 -0.608     2      1
2805       1        1   1   0  9.899 -0.886     5      0
2811       1        0   0   1  8.981 -0.597     3      1
2815       1        0   1   1  6.803  0.219     4      1
2830       1        0   0   1  4.572  0.523     3      1
2832       1        0   0   0  8.250  0.138     0      0
2837       0        0   1   0 12.750 -0.358     1      1
2838       1        0   1   0  6.708  1.530     2      1
2845       1        0   0   0  5.367  1.766     3      1
2851       1        0   0   0 20.125  1.519     2      1
2857       1        0   1   1 17.889 -0.065     6      1
2858       1        0   1   0 17.889  1.125     6      1
2860       1        0   1   0 11.339  1.048     2      1
2861       1        0   0   0 10.000  1.756     1      1
2866       1        0   0   1  4.899  0.381     5      1
2870       1        0   0   0 12.247  1.184     5      1
2871       1        0   0   0 12.247  0.441     5      1
2895       1        0   0   0 20.412  0.357     3      1
2896       1        0   0   0 20.412  1.391     3      1
2903       1        0   0   0 43.301  1.517     2      1
2905       1        0   0   0 23.702  1.275     2      1
2906       1        0   0   0 23.702  1.396     2      1
2912       1        0   0   1  2.000 -0.175     3      0
2937       1        0   0   1 10.062  0.685     2      1
2941       1        0   0   0 33.541  1.481     2      1
2944       1        0   0   0 10.000  0.377     3      1
2945       1        0   1   0 13.472  0.515     3      1
2950       1        0   0   0 13.676  0.912     5      1
2953       0        0   0   1  3.688 -0.106     1      0
2954       1        0   1   0  5.669 -1.750     4      1
2956       1        0   0   0 14.289  0.737     3      1
2957       1        0   0   0 14.289  1.169     3      1
2962       1        0   1   0 11.339  0.746     5      1
2963       1        0   0   0 12.500  0.814     1      1
2966       0        0   0   0  3.189 -1.765     4      0
2967       1        0   0   0  3.511 -0.869     4      0
2971       0        1   0   0  4.750 -1.775     6      1
2973       1        0   0   1 14.500 -0.161     2      1
2974       0        0   1   1  6.736 -0.612     4      1
2975       1        0   1   1  4.472  1.311     2      1
2976       1        0   1   0  8.655  0.573     3      1
2977       1        0   1   1  8.000 -0.205     6      1
2981       1        0   1   1 13.064  0.321     3      1
2982       1        0   0   0 24.495  1.343     3      0
2984       1        0   0   0 24.495  1.731     3      1
2985       1        0   0   0 24.495  1.386     3      0
2998       1        0   0   0 17.324  0.778     4      1
3005       1        1   1   0 13.856  0.239     1      1
3016       1        0   1   1  7.155  1.428     2      1
3019       1        0   1   1 14.000  0.538     5      1
3024       1        0   0   0 14.000 -0.549     1      1
3026       1        0   0   0 15.119  0.400     4      1
3044       0        0   0   0  2.259  0.000     2      0
3055       1        0   1   0 12.500 -0.875     2      0
3056       1        0   0   0 12.413  1.384     2      1
3072       1        1   0   0  0.816 -0.921     6      0
3082       1        0   0   0  4.327 -0.076     6      1
3086       1        0   1   0 15.652  1.305     2      1
3127       1        0   1   1  7.757 -0.794     5      1
3128       1        0   1   1 15.000  0.407     2      1
3141       1        0   1   0 14.434  1.488     2      1
3142       1        0   0   0 15.000  1.546     1      1
3149       1        0   1   1 10.392 -0.048     0      1
3160       1        0   0   0  7.250  0.000     2      0
3161       1        0   0   0  7.250  0.075     2      0
3171       1        0   0   0 33.541  1.573     2      1
3194       0        0   1   0 12.702 -0.222     0      0
3210       1        0   1   0 12.522  0.505     2      1
3219       1        0   1   0  8.839  0.720     5      1
3220       1        0   1   0  8.839  1.187     5      1
3230       0        0   0   1 11.547 -1.179     2      1
3239       1        1   1   1 14.758  0.501     2      1
3240       1        0   1   1 11.023  1.477     3      0
3247       1        0   1   0  6.532  0.231     4      0
3255       1        0   1   0 12.500  1.552     2      1
3257       1        0   0   0  8.944  1.539     2      1
3265       1        0   0   0  3.800 -0.375     3      1
3267       1        1   1   1 11.180  1.104     3      1
3270       0        1   0   0  2.851 -1.596     4      0
3272       0        0   0   0  3.080 -1.016     6      0
3274       0        0   0   1  2.249  0.000     3      0
3281       1        0   0   0 16.000  0.526     2      1
3283       1        0   0   0  6.485 -0.837     2      0
3296       0        0   0   0  4.596  0.866     0      0
3310       1        1   1   1  4.080 -0.605     0      0
3311       0        1   1   0  5.292 -0.741     4      1
3314       0        0   0   0  6.500  0.140     2      0
3318       0        1   0   1  5.550 -1.533     5      1
3323       1        1   0   1  0.900 -0.281     3      0
3326       1        1   1   1  4.243 -1.596     4      0
3329       1        0   0   1 10.733  0.922     2      1
3330       1        0   0   1  9.839 -0.792     2      1
3334       0        1   0   1 10.000 -0.464     2      0
3346       1        0   1   1  9.391 -0.895     2      1
3353       1        0   0   0 10.614 -0.791     3      1
3354       1        0   0   0 10.614  0.008     3      1
3356       1        0   1   1  0.919  0.076     4      0
3357       1        0   1   0 13.416  0.284     5      0
3361       1        0   1   0 10.206  0.751     2      1
3374       1        0   1   0  8.839  0.191     5      1
3379       1        0   1   1 12.500  1.270     2      1
3381       1        0   1   1 22.361  1.247     2      1
3382       1        0   1   1 14.434  0.918     1      0
3385       1        0   1   1 12.060  0.988     9      1
3388       1        0   0   0 14.000  1.421     3      0
3395       1        0   1   0  7.071  0.695     0      0
3404       1        0   1   1  7.757  1.474     3      1
3405       1        0   1   1  7.757  1.402     3      1
3425       1        0   0   1  1.633  0.997     4      1
3431       1        0   0   0 16.667  1.576     6      1
3440       0        0   0   0  4.000 -0.753     4      0
3443       1        0   0   1  8.944  1.509     2      1
3453       1        0   1   0 13.750 -0.592     1      0
3460       1        0   1   1  8.944 -0.682     2      1
3461       1        0   0   0  8.485  1.315     5      1
3462       1        0   0   0  8.485  0.205     5      1
3463       1        0   0   0  8.485  0.321     5      1
3464       1        0   1   0  8.165  1.402     3      1
3466       1        0   1   0  8.165  0.934     3      1
3471       1        0   1   1  6.940 -0.539     3      1
3479       1        0   1   1 17.000 -0.272     2      1
3489       1        0   1   1  8.000  0.243     0      1
3492       1        0   1   0  6.868  0.438     6      0
3497       1        0   0   0 10.614  1.161     4      1
3507       1        0   0   1 13.880  0.913     3      1
3509       1        0   0   1 17.321  0.000     2      1
3513       1        0   0   1 11.500 -0.360     2      1
3516       1        0   1   1  8.165 -0.329     3      1
3517       1        0   1   1  8.165 -0.051     3      1
3520       1        0   1   1 11.263 -0.269     6      1
3521       1        0   1   1 11.263 -0.020     6      1
3528       1        0   1   0 14.741  0.236     6      1
3529       1        0   1   0 14.741  0.215     6      1
3530       1        0   0   0 19.630  1.518     2      1
3540       0        1   0   0  5.000 -0.126     3      0
3553       1        0   0   0  5.367  1.158     8      1
3561       1        0   1   0  8.083 -1.650     4      0
3569       1        0   1   1  7.666 -0.704     4      1
3570       0        0   0   0  9.208 -1.189     4      0
3582       1        0   1   0 18.000  1.255     1      1
3583       1        0   1   0 18.000  1.744     1      1
3585       1        0   1   1  9.500  1.693     2      1
3588       1        0   1   0  7.137  0.703     2      0
3592       1        0   1   1  8.573  0.711     6      1
3599       1        0   1   1 18.000  0.465     1      1
3612       1        0   1   1 10.510 -0.149     4      1
3615       1        0   0   1 15.011  0.991     4      1
3616       1        0   1   0  8.689  1.373     3      1
3620       1        0   1   0 10.392  0.253     2      1
3623       1        0   1   0 10.104  1.641     0      1
3639       0        0   0   0  6.205 -1.614     3      1
3640       1        0   0   0  6.205 -1.657     3      1
3642       1        0   0   1  4.919  0.093     2      1
3656       1        0   1   0  7.603  0.025     2      1
3660       1        0   0   0  2.570 -1.511     8      1
3666       1        0   1   1 10.253  1.345     0      0
3690       1        0   0   0  0.000  1.509     1      1
3693       0        0   0   0 14.000 -0.289     2      0
3695       0        1   0   0  8.573  0.254     3      0
3723       1        0   0   0  5.814  0.157     2      1
3732       1        0   1   0 13.864  1.661     2      1
3742       0        0   1   0  8.533 -0.373     1      1
3743       1        0   1   0 14.500  1.568     1      1
3747       1        0   0   1 16.971 -0.182     0      1
3750       1        0   1   1  3.130  0.673     3      0
3751       0        0   1   1  3.130  0.171     3      0
3757       1        0   1   0 21.939  1.643     1      1
3760       1        0   1   1 11.180  0.194     2      1
3776       0        0   1   0 17.000  1.285     2      1
3780       1        0   1   0 10.500  0.407     1      0
3788       1        0   1   0 13.081  0.956     2      1
3795       1        0   0   0 13.500  0.917     1      1
3805       1        0   0   0 17.889  0.966     2      1
3815       1        0   1   0 20.412  1.231     3      1
3827       1        1   1   0  3.536 -1.311     3      0
3830       1        0   0   1  8.573 -0.186     3      0
3833       1        0   1   1 13.416  0.307     2      1
3838       0        0   1   1  6.261  0.186     3      0
3852       1        0   1   1  5.367 -0.056     2      1
3854       1        0   0   0  8.083  1.060     1      0
3860       1        0   1   0 13.416  1.693     2      1
3861       1        0   1   0 14.311  1.505     2      1
3863       1        0   0   0 31.754  1.469     4      1
3865       1        0   1   0  6.293  1.415     2      0
3868       1        0   1   0 11.180  1.337     2      1
3874       1        0   0   0 18.783  1.504     2      1
3875       1        0   0   0 18.783  1.358     2      1
3880       1        0   1   0 17.500  1.311     2      1
3884       1        0   0   1 10.286  0.713     2      1
3885       1        0   1   0 11.717  1.828     4      1
3886       1        0   1   0 11.717  1.580     4      1
3887       1        0   0   0 12.522  1.828     2      1
3888       1        0   0   0 17.500  0.600     1      1
3890       1        0   0   0 21.500  1.273     1      1
3892       1        0   1   0 16.330  1.520     4      1
3894       1        0   1   1 23.094  1.428     0      1
3898       1        0   0   0 17.963  1.002     3      1
3904       1        0   0   0 12.500  0.825     1      1
3910       1        0   0   0 10.681  0.470     1      1
3932       1        1   0   0  7.155 -0.405     3      1
3933       1        1   0   0  7.155 -1.410     3      1
3955       0        1   1   0  3.667 -1.469     6      1
3956       1        1   1   1 10.000  0.568     4      1
3963       1        0   0   0  9.000 -0.200     3      0
3965       1        0   1   0 12.350  0.650     2      1
3968       1        0   1   0  4.041  1.385     0      1
3989       1        0   1   0 11.547 -0.231     0      1
3994       1        0   1   0  4.082  0.188     3      1
3999       0        0   0   1  4.899 -0.398     4      1
4009       1        0   0   0  5.879  0.561     3      0
4010       1        0   0   1  5.969  1.075     3      1
4013       1        0   0   1  9.839 -0.961     2      0
4014       1        0   0   1  9.839 -0.582     2      0
4020       1        1   0   0  3.578 -0.597     2      1
4022       1        0   0   0 15.000 -0.726     1      1
4070       0        1   0   0  1.581 -1.384     9      0
4072       0        1   0   0  3.828 -0.930     4      0
4073       1        1   0   1  9.500 -0.770     2      1
4087       1        0   1   1  6.928  0.705     2      1
4090       1        0   1   0  6.000 -0.099     1      1
4098       0        0   1   1 12.522 -1.178     2      1
4106       1        0   0   0 21.362  1.335     1      0
4113       1        0   1   0  3.130 -1.066     4      0
4114       1        0   0   0 11.547  0.543     0      1
4127       1        0   1   1  4.619  0.799     3      0
4129       1        0   0   0  6.047  0.585     4      1
4130       1        0   0   0  6.047 -2.067     4      1
4138       0        0   0   1  5.144 -1.581     3      0
4141       0        0   0   0  7.500  0.059     1      1
4155       0        0   1   0 10.200 -1.359     1      0
4156       0        0   0   0  8.410 -1.273     3      0
4158       0        0   0   1 15.000 -0.536     1      0
4161       1        0   1   1  8.660  0.162     0      1
4164       1        0   0   0 37.501  0.550     1      0
4171       1        0   1   0 12.075  1.374     5      1
4172       1        0   0   0 12.500  1.458     1      1
4181       0        1   1   1  0.566 -0.149     7      0
4191       1        0   0   0 15.652  1.454     2      1
4205       1        1   1   0  4.082 -1.699     4      1
4209       0        1   1   0  1.878 -1.656     2      1
4216       1        0   1   1 10.286  0.273     2      1
4230       1        0   0   0  8.485  1.164     4      0
4233       1        0   1   0 12.021  0.243     0      1
4234       1        0   0   0  9.000 -0.321     1      1
4242       1        0   1   1  8.050  0.024     5      1
4243       1        0   1   0  3.578 -1.476     2      0
4244       1        0   0   0 16.100  1.456     2      1
4245       1        0   0   0 16.100  0.505     2      1
4247       1        0   0   0  1.039 -0.279     6      1
4248       1        0   0   0  7.826  0.845     2      0
4263       0        0   0   0  3.578 -0.726     6      0
4285       1        0   0   1  7.615  0.061     3      0
4289       1        0   1   0 10.000  1.596     3      1
4298       1        0   1   1  6.261  1.409     5      0
4299       1        0   1   1  6.261  0.947     3      0
4302       1        0   1   0  4.472  1.287     2      1
4303       1        0   1   0  4.472  0.238     2      1
4307       1        0   1   0 15.000  1.401     1      1
4309       1        0   0   0 15.000  0.674     1      1
4312       1        1   0   0  3.182 -1.511     6      1
4313       1        1   0   0  3.182 -1.118     6      0
4314       0        1   0   0  3.182 -1.079     6      1
4318       1        1   1   1  5.669  0.890     4      1
4324       1        1   0   0  7.217 -0.972     5      0
4327       1        0   1   1  6.261  1.001     4      0
4330       1        0   1   0 13.856 -1.257     1      1
4333       0        0   1   0  6.406  0.086     6      0
4338       1        0   0   0  5.367  0.374     2      1
4342       1        0   0   0  9.000  0.109     2      1
4343       1        0   0   0  9.000 -0.082     2      1
4348       0        0   0   1 10.607  0.265     1      0
4365       1        0   0   0  5.715  1.204     3      0
4382       1        0   1   1 21.362  1.667     2      1
4385       0        0   0   0  6.708  0.000     8      1
4390       1        0   1   0 10.286 -0.574     2      1
4394       1        0   0   0 25.000  0.468     3      1
4401       0        0   0   1 10.000  0.222     3      1
4407       1        0   0   0 14.289  1.277     3      1
4410       1        0   1   0 12.247  0.549     3      1
4412       1        1   1   0  4.950 -0.912     5      1
4418       1        0   1   1  0.000  0.364     3      1
4427       1        0   0   0  4.619  0.197     1      1
4429       1        0   0   0  5.000  1.535     3      0
4430       1        1   0   0  5.367  0.941     4      0
4436       0        0   0   0  4.919 -1.094     4      0
4448       1        0   1   0 13.279  1.201     1      0
4461       0        0   0   0 11.180 -1.057     2      1
4466       1        0   1   1  5.774  0.041     1      0
4470       1        0   1   0 15.652  0.513     2      1
4471       1        0   1   1  8.700  1.214     1      0
4480       1        1   1   0 23.000  1.538     1      1
4486       1        1   1   0  6.000  0.480     2      0
4498       1        1   0   0  3.354  0.499     4      0
4504       0        0   1   0  3.062 -1.791     4      1
4518       1        0   1   1  6.708 -0.423     2      1
4519       1        0   1   1  3.462  0.213     4      0
4524       1        1   1   0 15.652  0.470     2      0
4529       1        0   0   0 18.500  0.000     1      0
4531       1        0   0   0 16.166  1.137     1      1
4540       1        0   1   1  5.196 -0.396     1      0
4542       1        0   0   0  2.012 -1.485     3      0
4548       1        0   1   0 17.321  1.267     2      1
4549       1        0   1   0 11.339  0.160     4      1
4563       1        0   0   1 13.279  0.006     0      1
4566       1        0   1   1 11.547  1.105     3      0
4577       1        0   0   0 13.000  0.030     1      1
4579       1        0   1   1 12.500  0.985     3      1
4583       1        0   0   0  5.824  0.680    10      1
4586       1        0   0   0  2.254  1.194     2      1
4595       1        0   0   1 15.000  0.110     2      1
4597       0        0   0   0 11.547 -0.586     6      0
4610       1        0   1   1 10.000  1.187     2      0
4619       0        0   0   0  2.268 -1.104     5      0
4620       0        0   0   0  2.268 -1.865     5      0
4621       1        0   0   0  6.500  0.829     3      0
4623       1        0   1   0 10.000 -0.967     1      1
4629       1        0   0   0 20.000  0.708     1      1
4630       1        0   0   0 20.000  0.211     1      1
4635       1        0   1   0 20.412  1.417     3      1
4640       1        0   1   0  6.351 -0.565     1      0
4642       1        0   1   0 11.180  0.362     2      1
4643       0        0   1   0  2.828 -0.499     2      1
4647       1        0   0   0 12.355  1.460     6      0
4661       1        0   0   0 13.229  0.824     4      1
4667       1        0   0   0 22.361  0.862     2      1
4669       1        0   1   0 12.522 -0.538     2      1
4676       1        0   1   1  0.894  1.388     2      1
4677       1        0   0   0  4.965  0.167     6      1
4687       1        0   1   0 20.000  1.040     1      1
4698       1        0   0   1 12.500  0.891     1      1
4699       1        0   0   0 11.180  0.850     3      1
4702       1        0   0   0 13.416  1.296     2      1
4707       1        0   1   0 11.180  0.470     2      1
4709       1        0   0   0 35.000  0.458     1      1
4712       0        1   0   0  6.957 -1.423     7      1
4722       1        0   1   1 12.500  0.005     1      1
4732       1        0   1   0  3.831 -0.718     5      1
4736       0        0   0   1  1.490 -1.072     1      0
4740       1        0   1   1 13.856 -0.218     0      1
4747       1        0   0   0  8.050 -1.051     5      1
4752       1        0   0   0  6.928  0.437     6      0
4755       1        0   1   1 14.289  0.363     3      1
4756       1        0   0   0 16.000  1.828     1      1
4760       1        0   0   0 11.500  1.429     1      1
4765       1        0   1   1 13.500  0.592     3      1
4770       1        0   1   0  9.238  0.393     3      1
4773       0        0   0   0  4.023 -1.250     8      0
4776       1        0   0   0  3.024 -0.810     4      1
4779       1        0   0   0 10.500 -1.314     1      1
4789       1        0   1   1 12.522  0.836     4      1
4793       1        0   1   1  6.124  1.295     3      1
4794       1        0   1   1  6.124  0.582     3      1
4799       0        0   1   0 12.075  1.329     2      1
4805       1        0   1   0 19.000  0.913     1      1
4813       1        0   0   0  7.500  0.265     1      1
4816       1        0   0   0  5.000  1.407     6      0
4828       1        0   0   0  9.827  1.213     4      1
4829       1        0   0   0  9.827  1.264     4      1
4830       1        0   0   0  9.827  1.396     4      1
4831       1        0   0   0  9.827  1.319     4      1
4832       1        0   0   1  3.780  1.392     2      1
4834       1        0   1   1  8.165  0.147     5      0
4835       1        0   0   1  8.165  1.079     3      1
4840       1        0   1   0  5.374  1.292     2      0
4843       1        0   0   1  5.000  0.083     3      1
4850       1        0   1   0  5.715 -1.103     3      1
4854       1        0   1   0  6.940  0.640     3      0
4855       1        0   1   0  6.940  0.635     3      0
4856       1        0   1   1 13.741  1.013     1      1
4860       1        0   1   1  7.115 -0.602     3      0
4862       1        0   1   1  7.115  1.268     8      0
4894       1        0   1   1  4.840  1.020     3      1
4895       1        0   1   0 10.733  0.945     2      1
4898       1        0   1   0  8.165  0.746     5      1
4908       1        0   1   0 10.330 -0.367     1      1
4911       1        0   0   1  4.400  0.899     2      1
4912       1        0   1   1  6.124  1.133     3      1
4913       1        0   1   1  6.124  0.196     3      1
4918       0        0   0   0  5.544 -1.392     7      0
4923       0        0   0   0  4.041 -0.907     7      1
4937       0        0   0   0  3.176 -1.518     6      1
4942       1        0   0   0  2.907 -0.978     4      1
4979       1        1   1   1  2.885  0.535     2      0
4983       0        0   0   0  4.157 -0.747     9      1
4985       0        0   1   0  8.497 -1.331     2      1
4998       1        0   0   0 37.501  1.073     2      1
5005       1        0   0   0 43.302  0.414     2      1
5012       1        0   0   0 22.500  1.215     1      1
5013       1        1   1   1  8.944  0.461     2      1
5029       1        0   0   0 43.302  1.828     1      1
5058       0        0   0   0  7.000 -0.401     2      0
5082       1        0   0   0  2.776 -1.476     5      1
5092       1        0   1   1 11.180  0.401     2      1
5095       1        0   0   0 11.500  1.006     1      1
5097       1        0   1   1 11.500  0.240     1      1
5102       1        0   0   0 11.547  0.378     1      0
5106       1        0   1   0  5.883 -0.609     6      1
5109       1        0   1   1  9.391 -0.515     2      1
5130       1        0   1   0  7.071 -0.875     8      1
5137       0        0   0   0  4.738  0.000     1      0
5149       1        0   1   1  1.768  0.755     1      1
5156       1        0   0   0 11.500  0.267     3      1
5161       1        0   1   0 17.100  0.375     2      0
5166       1        0   0   0 12.374  1.541     0      0
5168       1        0   0   1  8.050  1.120     2      1
5178       1        0   1   0  8.497  0.917     2      1
5184       1        0   1   1  5.367 -0.393     5      0
5185       1        0   1   1  5.670  1.164     1      0
5192       1        0   1   1  7.917 -0.632     4      1
5194       1        0   1   1  7.917  0.592     4      1
5197       1        0   1   0  1.782  0.665     1      0
5211       1        0   1   0  5.081 -1.098     3      1
5222       1        1   0   0  4.920  0.179     4      1
5229       1        0   1   1 10.286 -0.304     6      1
5230       1        0   0   1 11.180 -0.916     2      1
5235       1        0   0   1  6.124 -1.170     3      1
5237       1        0   0   0  8.944  0.687     2      1
5238       0        0   0   0 10.960 -0.920     5      0
5245       1        1   0   0  4.000  0.740     6      1
5249       1        0   0   0  6.708  0.581     2      1
5250       1        0   0   0  6.708  1.118     2      1
5252       1        0   0   0 15.000  0.039     3      1
5254       1        0   1   0 12.000 -0.042     4      0
5260       1        0   1   1 12.000 -0.634     4      0
5266       1        0   1   1  9.238  0.284     2      0
5269       0        0   0   0  4.619 -1.057     5      1
5278       1        0   0   0  2.773 -0.588     6      1
5284       1        0   0   0  3.266  0.113     4      1
5291       1        0   1   0  3.001 -0.963     3      1
5300       1        0   0   0  0.000  0.069     2      1
5312       1        0   0   0 11.547 -0.755     6      0
5316       1        0   0   0  7.181  1.223     4      0
5318       1        0   1   1  5.500  1.166     4      0
5319       1        0   0   0  5.920  1.643     2      1
5320       0        0   0   0  4.750 -1.247     3      1
5329       1        0   1   1  6.798 -0.536     4      1
5342       1        0   1   1 12.247  0.782     3      1
5356       1        0   0   0  5.367  0.566     2      1
5357       1        0   0   0  5.367 -0.618     2      1
5358       1        0   1   1  5.100  0.856     1      1
5361       0        0   0   0  4.233  0.044     0      1
5363       0        0   0   1  8.165 -0.250     3      1
5364       1        0   0   1  8.165 -0.600     3      1
5365       1        0   0   1  8.165 -0.828     3      1
5366       1        0   0   0  8.165  1.307     3      1
5382       1        0   0   0 12.728  0.472     3      1
5383       1        0   0   1 12.522  0.420     8      1
5392       1        0   1   0  9.365  0.896     3      1
5394       1        0   1   1  6.708  0.750     2      1
5395       1        0   1   1  6.708  0.568     2      1
5398       1        0   0   0  3.578  0.963     3      1
5405       1        0   0   0  1.695  0.608     1      1
5407       0        0   1   0  5.000 -0.762     1      1
5410       1        0   0   0  8.660  1.105     0      1
5417       1        0   0   0  2.828  1.172     5      1
5418       1        0   0   0  2.828  0.546     5      1
5419       1        0   1   1  5.715  1.494     3      1
5420       1        0   1   1  5.715  1.498     3      1
5423       0        0   0   0  2.531 -1.730     4      1
5435       1        0   1   1  5.590  0.850     2      1
5439       1        0   0   0  6.425  1.571     4      1
5440       1        0   0   0  6.425  1.360     4      1
5441       1        0   0   0  8.944 -0.270     2      1
5443       1        0   0   1  2.000 -1.625     4      1
5447       0        0   0   0  3.578 -1.285     3      1
5451       1        0   0   0  8.497 -0.137     3      1
5461       0        0   0   0  5.335 -1.781     7      1
5463       1        0   0   0  3.024 -0.560     4      1
5468       0        0   0   0  1.191 -1.505     5      1
5470       1        0   0   0  1.991  0.319    10      1
5484       1        1   1   0  1.461 -0.551     5      0
5490       1        0   1   1 17.250 -0.552     1      1
5491       1        0   1   1 17.250  0.360     1      1
5494       1        0   1   0 10.451  0.230     2      1
5500       1        0   1   0  9.000  0.128     1      1
5504       1        0   1   0  2.907  1.006     2      1
5512       1        0   1   0  7.500  0.506     1      1
5514       1        0   0   0  3.969  0.084     4      1
5519       0        0   0   0  4.419 -1.584     5      0
5535       0        0   0   0  6.333 -1.608     9      1
5538       1        1   0   0  1.508 -1.069    11      1
5539       1        1   0   0  1.508  0.702    11      1
5540       1        0   1   1 12.611 -0.192     1      1
5543       1        0   1   0  6.928  1.241     2      1
5554       0        0   1   0  8.573 -0.094     3      0
5556       0        0   0   0  4.246 -1.291     3      1
5558       1        0   0   0  2.356 -1.923     3      1
5567       1        0   1   1  4.503  1.320     4      1
5579       1        0   0   1  8.315  0.502     3      1
5580       0        0   0   1  8.315 -0.303     3      1
5585       1        0   1   0  3.464 -0.664     0      1
5586       1        0   1   0 18.000 -0.113     1      1
5603       0        0   0   0  1.500 -1.015     2      1
5607       1        1   0   0  6.973 -0.434     4      1
5608       1        0   0   0  5.196 -1.737     1      1
5611       1        1   0   0  4.919 -1.062     2      1
5613       1        1   1   1  3.618 -1.786     8      1
5618       1        1   1   1  9.449  0.373     4      1
5621       1        0   1   0  8.944  0.183     2      1
5622       1        0   1   0  8.944 -0.219     2      1
5625       1        0   0   1 10.607  0.529     3      1
5637       1        1   0   1  5.099 -1.179     3      1
5653       1        0   1   1  5.196  0.436     2      0
5655       1        0   0   1 14.434  1.312     4      1
5671       1        0   0   0 22.500  1.065     2      1
5672       1        0   1   1 21.637  0.777     3      1
5677       1        0   1   0  5.500  0.063     1      1
5693       1        0   1   0  6.505  0.957     3      0
5694       1        0   0   0  8.165  0.319     6      0
5711       1        0   1   1  2.557  0.028     3      0
5726       1        1   0   0  4.249 -0.329     2      1
5727       1        1   1   0  4.900 -0.694     5      0
5733       1        1   1   1  6.000 -0.238     1      1
5738       0        1   0   0  3.406 -1.366     7      0
5759       1        1   1   0  6.803  1.432     5      1
5764       1        1   0   1 15.285  1.043     4      1
5772       0        1   0   0  5.052 -1.402     4      1
5778       1        1   0   1  4.899 -1.351     2      1
5779       0        1   0   0 13.607 -1.503     7      1
5785       1        1   0   1  8.165  1.031     2      1
5786       1        1   0   0  8.165 -0.365     4      1
5791       0        1   0   0  1.273 -1.357     5      0
5824       1        1   1   0  9.961 -0.347     3      1
5842       1        1   0   1  6.532 -0.139     6      1
5847       1        0   1   1  5.580 -1.575     5      1
5850       1        1   0   0 10.614  1.108     3      1
5863       1        1   0   0  6.364 -0.333     5      1
5890       1        0   1   1  3.500  0.715     1      0
5893       1        1   1   0 12.500 -0.031     3      1
5894       1        1   0   1  3.593 -0.579     7      0
5898       1        1   1   1  8.000 -0.478     4      1
5901       0        1   0   0  2.944 -1.122     3      0
5903       0        1   0   0  1.159 -1.741     3      0
5912       1        1   1   1  4.243 -0.394     0      0
5917       1        1   1   1  5.814 -0.694     2      1
5918       0        1   0   1  3.000 -1.433     5      0
5920       0        1   1   1  2.828 -1.793     1      0
5928       1        1   0   1  5.303 -0.338     2      0
5929       0        1   0   0  5.500 -0.834     4      0
5931       1        1   0   0  3.801 -1.132     1      1
5940       1        1   0   0  2.096 -0.041     5      0
5959       1        1   1   1  7.865 -1.240     1      1
5960       1        1   0   1  2.055 -1.636     8      0
5961       0        1   0   1  2.055 -1.303     8      0
5979       0        1   1   1 10.607 -1.363     5      0
5982       1        1   1   0  4.000  0.000     1      0
5987       1        1   1   1  4.899 -0.056     4      0
5993       0        1   0   0  3.017 -1.081    12      1
6000       0        1   0   0  2.330 -1.568     1      0
6012       1        0   1   1  1.245 -1.662     4      0
6013       1        1   1   0  7.348 -0.187     7      1
6014       1        1   1   0  7.348 -1.112     7      1
6034       0        1   0   0  0.787 -0.877     4      0
6035       0        1   0   0  0.787 -1.888     4      1
6038       1        1   1   1  5.367 -0.147     4      1
6041       1        1   0   1 11.717  0.555     4      1
6052       1        1   0   1  5.594 -0.934     4      0
6054       1        1   0   1  4.472  0.001     3      1
6057       1        1   0   1  4.792 -0.101     2      0
6065       1        1   0   0 10.607 -0.516     3      0
6077       1        1   0   1  4.800 -1.797     2      1
6085       1        1   0   0 10.733 -1.684     2      1
6090       0        1   0   0  1.134 -1.630     5      0
6092       1        1   1   0  1.342 -0.649     2      1
6093       1        1   1   0  1.342  0.251     2      1
6095       1        1   0   0  1.732 -1.139     3      1
6106       1        1   0   0  5.715 -1.633     9      1
6112       1        1   0   0  3.674 -1.739     6      1
6113       1        1   1   1  3.674 -1.992     6      1
6135       1        1   1   0  5.276 -1.000     8      1
6136       0        1   1   0  5.276 -0.683     8      1
6137       0        1   1   0  5.276 -1.085     8      1
6140       1        1   1   1  7.603 -0.946     2      0
6145       0        1   0   0  3.042 -1.800     2      0
6167       1        1   1   1  4.039 -1.098     6      0
6173       1        1   1   0  6.425  0.006     5      0
6176       1        1   0   0  6.010  0.541     0      0
6207       1        1   0   0  2.694 -0.885     7      0
6213       1        1   1   0  0.707 -0.756     6      1
6216       1        1   0   0  3.479 -0.790    13      1
6218       1        1   0   1  1.633 -0.465     4      0
6224       1        0   0   0  3.674 -1.387     3      1
6247       1        1   1   0  4.000 -0.945     1      1
6248       1        1   0   0  7.621  0.233     6      1
6249       1        1   0   1  2.721 -1.050     3      1
6253       1        1   0   1  1.897 -0.153     6      0
6271       1        1   0   0  3.175 -1.302     4      0
6279       0        1   0   0  5.443 -1.168     4      1
6298       1        1   0   0  4.251 -1.301    17      1
6301       1        1   0   0  1.259  0.491     7      0
6314       1        1   0   0  3.415 -0.610     8      0
6323       1        1   0   0  3.002 -0.148     7      0
6340       1        1   0   1  1.939 -1.068     3      0
6341       1        1   0   1  2.574 -1.802     3      0
6359       0        1   0   0  2.449 -1.237     5      0
6391       1        1   0   0  5.500 -0.590     4      1
6398       0        1   1   1  3.266 -1.426     2      0
6401       1        1   0   0  0.996 -0.136     4      0
6402       1        1   1   1  2.236  0.651     3      1
6406       1        1   1   0  5.774 -0.724    12      1
6411       1        1   0   0  0.265  1.227    11      0
6453       1        1   0   0  2.453 -0.934     5      1
6454       1        1   0   1  2.453 -1.199     6      0
6471       1        1   0   1  2.242  0.000    -3      0
6484       1        0   0   0  3.005 -0.931     5      1
6496       1        1   0   0  5.814 -1.278     6      1
6511       1        1   0   0 10.840 -0.118     9      0
6514       1        1   0   0  2.297 -0.978     9      1
6517       1        1   1   1  7.647 -0.323     4      1
6576       1        1   0   0  3.708 -0.102     3      1
6593       1        1   0   0  2.539 -0.796     5      0
6594       1        1   0   1  2.735 -0.745     4      0
6597       1        1   0   0  3.394  1.311     0      0
6603       1        1   1   0  2.268 -0.519     5      0
6617       1        0   0   0  2.508  0.613     1      0
6661       1        1   0   0  3.266 -0.516     4      0
6677       1        1   0   0  2.035 -1.130     5      0
6679       1        1   0   0  2.366 -0.891     8      0
6680       0        1   0   0  2.366 -0.746     7      0
6698       1        1   0   0  2.683  0.127     5      0
6719       0        1   0   0  3.000 -1.322     2      0
6721       1        1   1   1  2.404 -1.438     8      1
6729       0        1   1   1  2.498 -0.114     4      0
6743       1        1   0   0  3.920 -0.509    14      0
6746       1        1   1   1  4.688  0.000     4      0
6760       1        1   0   1  2.957 -1.308     1      0
6762       0        1   0   0  3.220 -1.762    11      0
6768       1        1   0   0 12.374  0.882     2      0
6776       1        1   0   0  2.546  1.184     7      0
6778       1        0   0   0  3.249 -1.280     8      0
6784       1        1   1   0  7.603 -0.189     2      1
6790       0        1   0   1  3.264 -1.084     5      1
6791       1        1   0   0  3.264 -1.182     4      0
6792       1        1   0   0  1.920 -0.953     3      0
6794       1        0   1   0  2.375  0.000     4      0
6799       1        1   0   1  2.030 -0.604     5      0
6801       1        1   1   0  5.196 -0.181     4      0
6802       1        1   0   1  8.700  0.069     2      0
6805       1        0   1   1  7.155 -0.045     2      1
6808       1        1   0   0  1.282  0.947     1      0
6811       1        1   0   0  2.458  0.764     4      1
6819       1        1   1   0  0.831 -0.874     2      0
6838       1        1   1   1 10.041  0.039     7      0
6844       1        1   1   1 18.475  0.822     1      1
6849       1        1   0   1  2.114  0.243     1      0
6850       1        1   1   1  2.114  1.055     1      0
6851       1        1   0   1  2.123  0.000     2      0
6861       1        1   0   1 10.614  0.011     5      1
6868       0        1   1   1 14.500 -0.700     3      0
6897       1        1   0   1  3.000 -0.507     2      0
6898       1        1   0   0  3.000 -1.147     2      0
6902       1        1   0   0  8.500 -0.631     4      0
6906       0        0   1   1  6.325 -1.672     7      1
6908       1        1   1   0  9.615  0.463     5      0
6909       1        1   0   0  4.596 -0.605     0      0
6910       1        1   0   0  5.411  0.337     2      1
6911       1        0   0   0  5.411 -0.663     2      1
6914       1        1   0   0  9.394 -1.154     3      0
6938       1        1   1   0  5.774  0.037     3      1
6942       1        1   0   0 15.000  0.165     6      1
6946       1        1   1   0  8.165 -0.661     3      1
6947       1        1   1   0  8.165 -1.253     3      1
6960       1        1   1   0  3.130  0.016     2      1
6969       1        1   0   1  1.564 -0.438     8      0
6998       1        1   0   1  7.634  0.048     3      1
7003       1        1   0   1  3.704 -0.119     5      0
7004       1        1   0   0  3.704 -0.612     5      0
7010       1        1   1   0  8.693 -0.338     6      1
7069       1        1   0   0  2.268 -0.734     7      1
7070       1        1   0   0  2.268 -1.460     6      1
7083       1        1   0   1  7.757 -1.769     3      1
7100       1        1   0   0 19.000  0.266     3      1
7104       1        1   0   0  2.000 -0.173     2      1
7113       0        1   0   1  2.687 -1.105    16      0
7114       1        1   1   1  3.753  1.017     1      0
7119       1        1   0   0 25.000  1.562     2      1
7129       1        1   1   0 12.075 -0.513     8      0
7133       1        1   1   1  7.506 -0.539     3      1
7141       1        1   0   0  8.083 -1.535     4      0
7142       0        1   0   0  8.083 -1.120     4      0
7143       1        1   1   1  9.815  1.124     0      1
7145       1        0   0   1  7.559  0.422     4      0
7149       0        0   0   0  1.250 -0.708     4      0
7173       0        1   0   0  3.479 -0.984     6      1
7185       1        1   1   1  8.165  1.167     3      1
7187       1        1   1   1  6.047 -0.698     5      0
7188       0        1   1   1  6.532 -1.114     5      0
7190       1        1   0   1  3.500  1.010     2      0
7191       1        1   0   1  3.500 -0.919     2      0
7195       0        1   0   0  4.536  0.000    10      1
7223       1        1   0   0  1.667 -1.326     6      0
7227       0        1   0   0  3.130 -0.125     6      0
7240       1        1   0   0  8.944  0.713     2      1
7251       1        1   1   1  2.858  0.092     4      1
7254       0        1   0   0  4.082 -1.556     4      0
7257       0        1   1   0  2.121 -1.071     8      1
7261       1        1   0   1  3.536 -1.194     6      1
7262       1        1   0   1  3.536 -1.029     9      1
7265       1        1   0   0  4.025 -0.265     4      0
7266       1        1   0   0  2.970 -0.637     1      0
7268       1        1   1   0  2.041 -0.992     4      1
7272       0        1   0   1  5.367 -1.616     3      0
7277       0        1   0   1  6.803 -0.570     9      0
7281       1        1   0   0  5.692 -0.547     8      1
7318       1        1   1   0  7.500  0.268     1      1
7319       1        1   0   0  7.500 -0.217     6      1
7320       1        1   0   0  7.500 -1.414     7      1
7326       0        1   1   0  4.061 -1.595     3      0
7369       1        1   0   0  3.421  1.024     5      1
7370       1        1   0   0  3.421  1.524     5      1
7372       1        1   0   0  8.000 -0.179     2      0
7373       0        1   1   0  9.324 -1.573     0      1
7379       1        1   0   0  3.674 -1.279     8      1
7380       1        1   0   0  3.735 -1.591     7      1
7381       1        1   0   1  3.470 -1.195     3      1
7384       1        1   1   1  0.894 -0.948     2      1
7386       1        1   0   0 16.100  0.490     2      1
7399       1        1   0   0 12.500  1.094     5      1
7401       1        1   1   1  8.944  0.304     2      1
7417       1        0   0   0  4.000  0.436     2      0
7424       1        0   1   0 14.434  1.114     3      1
7427       1        0   1   0 12.522  1.687     2      1
7434       0        1   0   0  2.342 -0.851     4      1
7456       0        1   0   0  2.939 -1.896     7      1
7461       0        1   0   0  6.957 -1.435    11      1
7469       1        1   0   1  0.000 -1.475     3      1
7484       1        1   1   1  5.814 -0.372     2      1
7491       1        1   1   1 20.496 -0.057     0      1
7495       1        1   0   0  5.715 -0.273     4      1
7502       1        1   0   1  4.695  0.000     7      1
7505       1        1   1   0  2.631 -1.091     7      1
7516       1        1   1   1  6.235 -0.357     2      1
7526       1        1   0   0  5.774 -1.182     1      0
7534       0        0   0   0  4.500 -1.309     2      0
7547       1        1   0   0  5.774 -1.704     4      0
7549       0        1   0   0  1.274 -1.837    11      0
7552       1        1   1   1  6.200  1.667     1      1
7554       1        0   0   1 10.500  1.303     1      1
7555       1        0   0   1 10.500  1.096     1      1
7557       1        0   0   0  9.798 -0.680     2      1
7559       0        0   1   1  6.500 -0.927     3      0
7561       1        0   0   0 26.386  1.537     2      1
7570       1        0   0   0  3.503 -0.276     3      1
7576       1        0   0   0  8.500  0.549     1      1
7589       0        0   0   0  4.000  0.545     3      0
7590       1        0   0   0  4.000  0.725     3      0
7594       1        1   0   0  3.500  0.000     2      0
7599       1        0   1   1 14.311 -0.605     2      1
7627       1        1   0   0 12.522 -1.501     2      1
7629       1        1   0   1  5.000  0.618     5      0
7635       1        1   0   0  2.041 -0.342     5      1
7641       1        1   1   1  0.751 -1.294     3      0
7643       1        1   1   1  0.751 -1.816     3      0
7650       1        1   0   0  3.182  0.422    12      0
7661       1        1   0   0  5.485 -0.139     5      1
7664       1        1   1   1  7.500 -0.425     2      1
7667       1        1   0   0  0.000 -1.480     3      0
7668       1        1   0   1  9.000 -0.802     1      1
7674       1        1   1   0  8.944 -0.925     2      1
7675       1        1   1   1  9.526 -0.975     2      0
7690       1        1   0   0  8.497 -0.145     2      1
7697       1        1   1   0  5.389 -0.035     3      1
7698       1        1   1   0  5.389 -0.172     3      1
7711       1        1   0   0  5.667 -1.010     5      1
7712       1        1   0   0  1.667  0.111     6      0
7714       0        1   0   0  1.768 -0.868     6      1
7715       1        1   0   0  1.768 -1.333     6      1
7719       1        0   0   0 15.000  1.158    13      1
7720       1        0   0   0 15.000  1.226    12      1
7787       1        1   0   1  8.000  0.982     1      1
7790       1        1   0   0  9.839 -1.333     2      1
7799       1        1   0   0  2.737 -0.807     2      1
7800       1        1   0   0 12.000 -0.299     1      1
7803       0        1   0   0  3.674 -1.781     5      1
7808       1        1   0   0  6.762 -0.887     4      1
7812       1        1   0   0  3.436 -1.439     4      1
7839       0        1   0   0  2.500 -1.989     2      0
7848       0        1   0   1  0.900 -1.398     8      0
7852       1        1   1   0  6.930  1.242     0      0
7857       1        1   1   1  7.000 -0.290     2      0
7860       1        1   0   1  7.071 -1.321     6      1
7866       0        1   0   0  9.815 -1.390     0      1
7872       1        1   0   0 11.180 -0.037     4      1
7925       1        0   1   0 15.910  0.057     3      1
7929       1        1   0   0  4.500 -1.119     9      1
7932       1        1   0   0  5.000 -1.475     7      1
7935       0        1   0   0  4.859  0.171     4      0
7937       0        1   0   1  0.976 -1.547     2      0
7939       1        1   0   0  3.408  0.072     2      0
7944       1        0   1   1  7.000 -0.122     2      0
7947       1        1   0   0  1.556  0.198     4      0
7948       0        1   0   0  1.556 -1.118     4      0
7953       0        1   0   0  2.683  0.000     9      0
7956       1        1   0   0  4.455  0.555     8      1
7964       1        1   0   0  5.168  0.458     4      1
7965       1        1   1   1 13.416  0.818     2      1
7966       1        1   1   1 13.416 -0.383     2      1
7977       0        1   0   0  3.266 -0.242     3      1
7978       0        1   0   0  3.266 -0.607     3      1
7986       0        1   0   0  1.512 -0.627     7      1
8004       1        1   0   1 13.500 -0.906     6      0
8026       1        1   1   0 10.206 -0.280     3      1
8038       1        1   1   0  1.225  1.109     4      1
8040       1        1   0   1 11.000 -0.338     1      0
8069       1        1   1   0  4.500 -0.230     1      1
8070       0        1   0   0  6.667 -1.208     9      1
8077       1        1   0   0 13.500 -0.398     1      1
8097       1        1   0   0  1.837 -0.064     3      1
8098       0        1   0   0  1.837 -0.946     3      1
8108       1        1   0   1 13.856 -0.847     0      1
8115       0        1   0   0  2.400 -1.438     6      1
8116       0        1   1   0  6.000 -1.498     4      1
8136       1        0   1   0  6.708  0.458     2      1
8138       1        1   0   0  8.670  0.151     3      1
8145       0        0   1   1  4.082  0.230     3      0
8147       1        1   0   0  2.646 -0.079     5      0
8156       1        1   0   0  9.827 -0.222     5      1
8163       1        1   0   0  1.500  0.824     1      1
8165       0        1   0   0  7.348  0.177     5      1
8168       1        1   1   0 12.500 -0.800     3      1
8185       0        1   0   0  4.914 -1.708     3      0
8216       1        1   0   0  2.948 -1.667     5      1
8219       1        0   1   0 14.087  0.351     2      1
8228       1        1   0   1 10.206  1.064     3      1
8229       0        0   0   0 10.206 -0.257     3      1
8233       1        0   0   0  4.025 -0.952     2      1
8239       1        1   1   0  4.919  0.184     2      1
8240       1        1   1   0  4.000 -0.771     3      1
8244       1        1   1   1  5.657 -0.802     0      1
8255       0        1   0   1  2.656 -1.582     7      0
8256       1        1   1   1  2.530 -0.979     6      0
8263       1        1   0   0  5.501  0.817     2      1
8291       0        1   0   0  1.225 -0.413     4      1
8301       1        1   0   0 12.522 -0.820     2      1
8302       1        1   0   0  3.182  0.950    10      1
8307       0        1   0   0  2.840  0.000     6      1
8314       1        1   0   0  4.472 -0.507     4      1
8316       1        1   0   0  1.155  0.519     7      0
8320       1        1   0   0  9.942  0.118     7      1
8323       1        1   1   0 37.501  0.027     2      1
8328       1        1   0   0  1.206 -0.414     7      1
8331       0        1   0   0  1.206 -1.417     7      1
8333       0        1   0   0  3.552 -0.243     4      1
8339       1        1   0   1  8.050  0.401     2      1
8356       1        1   0   0  5.303  0.000     8      1
8360       1        1   0   0  3.780 -0.210     4      0
8378       0        1   0   0  5.456 -0.887     4      1
8379       1        1   0   0  4.743  0.236     7      1
8380       1        1   0   0  4.743 -0.785     7      1
8381       1        0   0   0 17.500  0.225     1      1
8384       1        1   1   1  5.500 -1.632     2      0
8390       1        1   0   0  5.586 -0.352     5      1
8394       0        1   0   0  6.325 -1.124     7      1
8420       1        1   0   0  3.780 -0.570     4      0
8421       1        0   0   0  3.780 -0.315     4      1
8433       1        1   1   1  3.674 -1.294     2      1
8469       1        0   0   0  8.497  0.295     2      1
8478       1        1   0   0  1.000 -0.860     6      1
8481       1        1   0   0  2.828 -1.295     9      0
8497       1        1   0   0  4.596 -0.064    13      1
8498       1        1   1   0  2.949 -0.240     5      0
8499       1        1   0   1  5.669 -0.843     4      1
8504       1        1   0   0  1.809 -1.497     7      1
8509       1        1   0   1  0.794 -0.435     4      0
8536       1        1   1   1  1.225 -0.299     3      1
8582       0        1   0   0  4.009 -0.968     7      1
8588       1        1   1   0  5.292  0.037     4      1
8604       1        1   0   1  5.367 -0.617     4      0
8617       1        1   1   1  3.402 -1.025     4      1
8625       1        1   1   1 20.000  0.010     4      1
8630       1        1   0   0  4.158 -1.456     4      1
8632       1        1   1   0  4.919 -0.453     5      1
8633       1        1   1   0  4.919 -0.579     5      1
8653       1        1   1   1  3.536 -1.011    13      1
8654       1        1   1   1  3.536 -1.365    13      1
8661       0        1   0   0  2.449 -0.723     4      0
8681       1        1   0   0  1.225 -1.030     8      1
8698       1        1   0   0  4.937 -0.367     7      1
8709       0        1   0   0  2.449  0.000    15      1
8726       1        1   0   0  4.243 -1.297     6      1
8727       1        1   0   0  4.243 -0.993     6      1
8740       1        0   0   0  5.926  0.909     2      1
8741       1        0   0   0  5.926 -0.108     2      1
8813       1        1   0   0  1.897 -0.828    16      1
8814       0        1   0   0  1.897 -1.480    16      1
8856       1        1   0   0  2.910 -0.211     5      0
8859       1        1   0   0  3.000  0.177     4      0
8871       1        1   0   0  1.175 -0.560     6      0
Yes        1        0   0   0 -1.143  5.000    No      0
8973       0        1   0   0  2.244 -0.766     2      0
8975       1        1   1   0 12.522 -1.016     2      0
8979       1        1   1   1  3.578  0.108     2      1
8984       1        1   0   0  9.145 -0.388     2      1
9010       1        1   1   0  7.603 -1.014     7      0
9016       1        1   1   0 15.061 -0.077     5      0
9017       0        1   1   0 15.061 -0.935     5      0
9034       1        1   1   1  1.414  0.685     2      1
9051       1        1   0   0  3.144 -1.815     4      1
9056       1        1   0   0  1.821  0.541     7      0
9058       1        1   0   0  1.190 -0.808     2      0
9059       1        1   0   0  1.190  0.712     2      0
9061       1        1   0   0  1.308 -1.188    11      1
9066       1        1   0   0  4.514 -0.974    10      1
9071       0        1   0   0  4.899 -1.495     3      1
9076       0        1   0   0  3.098 -1.436    13      1
9099       1        1   0   0  3.704  0.626     4      0
9110       1        1   0   0  3.024 -0.985     6      1
9112       1        1   0   0  5.216 -0.645     2      1
9114       1        1   0   0  1.399  0.147     0      1
9116       1        1   0   0  2.813 -0.531     9      1
9155       1        1   0   0  1.809  0.849     5      0
9181       1        1   0   0  2.167 -1.730    11      1
9186       0        1   0   0  1.704 -1.537     1      0
9215       1        0   0   1  3.118 -0.051     5      0
9216       0        0   0   0  1.682 -0.049     9      0
9230       1        1   1   1  2.442  1.213     3      0
9237       1        1   0   0  5.307  0.547     3      1
9253       0        1   0   0  5.814 -0.716     2      1
9265       1        1   0   0  3.166  0.833     2      0
9283       0        1   0   0  2.250 -1.843     4      1
9288       1        1   0   0  2.250 -0.795     9      1
9295       1        1   1   0  8.500 -0.172     3      0
9300       0        1   0   0  2.236 -0.577     5      0
9303       1        1   1   1  4.899 -0.478     2      1
9304       1        0   1   1  2.500  0.895     2      0
9307       1        1   0   0  4.667 -1.605    11      1
9309       1        1   1   1  1.484 -1.163     8      1
9324       1        1   1   1  8.165  0.150     2      1
9326       1        0   0   0  5.376 -0.214     7      1
9327       1        1   1   0  2.808 -0.923     2      0
9329       1        1   1   1  4.025 -1.811     2      1
9358       1        1   0   0  5.367 -1.375     6      1
9367       1        1   0   0  5.889  0.261     3      0
9368       1        1   0   1  3.743  1.280     4      0
9369       0        1   0   0  4.619 -1.363     2      0
9375       1        1   0   0  3.130  0.964     3      0
9376       1        1   0   0  3.130 -0.886     3      0
9386       1        0   0   0  2.449 -0.746     3      0
9387       1        0   0   0  2.449 -0.685     3      0
9389       1        0   0   0  8.500  1.586     1      1
9425       1        0   1   0  8.165  0.043     3      1
9437       1        1   0   0  3.667 -0.994     8      1
9443       1        1   0   0  2.776 -0.166    11      0
9486       1        1   0   0 10.205 -1.049     7      0
9513       1        1   1   1  2.250  0.168     2      0
9538       0        1   1   1  2.475 -1.805     6      0
9548       0        1   0   0  7.201 -0.791     3      1
9569       1        1   0   0  5.715 -1.014     4      1
9572       1        1   1   0  6.928  0.406     2      1
9580       1        1   1   1 12.247  0.119     3      1
9605       1        1   1   1  1.633 -1.022     5      0
9606       1        1   1   1  1.633 -0.246     5      0
9636       1        1   0   0 12.250  0.854     4      1
9639       1        1   0   0  6.940 -1.056     3      1
9646       1        0   1   0 12.701  0.316     2      1
9651       1        0   1   0 11.547  0.449     0      1
9669       1        0   1   1  5.500  0.229     1      1
9670       1        1   1   0  3.000  0.553     7      0
9674       1        1   1   0  3.266  0.000     6      0
9677       1        1   1   0  6.928  0.215     0      1
9679       1        1   1   1  3.500 -0.131     2      0
9685       1        1   0   0  6.718 -1.593     7      1
9687       1        1   1   0  6.708 -1.338     6      0
9688       0        1   1   1  6.928 -0.992     0      1
9761       1        1   0   0  4.491  0.406     3      0
9762       1        1   0   0  7.155 -1.078     2      1
9771       1        1   0   0  8.315 -0.214     5      1
9773       1        1   0   0  4.899 -0.936     3      1
9775       1        1   0   0 10.500 -1.046     4      1
9779       0        1   0   0  9.250 -0.609     4      1
9788       1        0   1   0 13.416  1.292     2      1
9814       0        1   0   0  5.303 -1.174     6      0
9821       0        1   1   0  5.339 -0.288     5      1
9822       1        1   1   0  5.339 -0.111     5      1
9825       1        1   1   1  3.584 -0.858     5      0
9827       0        1   1   1  3.584 -1.535     5      0
9836       1        1   0   0  3.542 -1.047     6      0
9841       1        1   0   0  4.313 -1.111     9      1
9848       1        1   0   0 13.000 -0.134     2      1
9868       1        1   0   0  3.266  0.827     2      0
9873       1        1   1   0  8.660  0.452     4      1
9875       0        1   0   0 12.500 -1.365     2      1
9878       1        1   0   1  7.757  0.522     6      1
9879       1        1   1   0  7.348 -0.019     7      0
9880       1        1   0   0  7.348 -0.679     3      1
9886       0        1   1   1  4.067 -1.283     6      1
9905       1        1   0   0  7.233  0.640     6      1
9914       0        1   0   0  4.899 -0.677     5      1
9918       1        1   0   0  4.899 -2.107     5      1
9919       1        1   0   0  4.899 -1.805     3      1
9929       1        1   0   0  7.500  0.078     2      0
9950       1        1   0   0  6.047 -0.930     4      1
9952       1        1   0   0  7.559 -1.246     4      1
9957       0        1   0   0  5.657 -1.632     7      1
9961       1        1   0   0  6.500  0.288     4      1
9962       0        1   0   0  6.500 -0.119     4      1
9968       0        1   0   0  5.657 -1.092     5      1
9969       1        1   0   0  3.479  0.562     4      0
9977       0        1   0   0  1.470 -1.805     8      1
9983       1        1   1   0  8.944 -0.087     3      1
9985       1        1   1   1 11.180 -0.948     3      0
9990       0        1   0   1  3.000 -0.743     2      0
9998       0        1   0   0  1.500 -1.645     3      1
10001      1        1   1   1  7.506  0.452     1      0
10003      1        1   0   0  1.968 -0.656     2      0
10004      1        1   1   1  2.200  0.174     2      0
10025      0        1   0   0  2.791 -1.796     4      0
10031      1        0   0   0  1.773 -1.740     7      1
10050      1        1   0   0  8.333 -1.326     6      1
10051      1        1   0   0  8.333 -1.072     6      1
10053      1        1   0   0  5.000  0.110     7      1
10075      0        1   0   0  4.914 -1.626     8      1
10078      1        1   0   0  2.899 -0.480     5      1
10084      1        1   1   0  3.253 -0.639     8      1
10085      1        1   1   0  3.253 -1.298     8      1
10115      1        1   0   1  2.051 -1.003     9      0
10123      1        1   0   0 10.206  1.447     3      1
10128      1        1   0   0  4.082 -1.347     4      1
10133      1        1   1   0  2.980 -1.432     3      1
10139      1        1   1   1  5.500 -0.346     2      0
10154      1        1   0   0  4.500 -1.002     6      0
10158      1        1   0   0  2.236 -0.849     6      0
10169      1        1   0   1  4.899 -0.286     8      1
10197      1        1   0   0  2.828 -1.489     5      1
10235      1        1   0   0  9.839  1.154     2      0
10307      1        1   0   0  3.811 -0.369     1      0
10311      1        0   1   0  7.000 -0.458     1      1
10327      0        1   0   0  1.508 -1.334     9      0
10330      0        1   0   0  1.768 -1.767     5      0
10337      1        1   0   0  3.402 -1.206     4      1
10363      1        1   0   0 15.652  0.501     2      1
10382      1        1   1   1 17.500  0.892     1      1
10385      1        0   0   1  4.000 -0.057     2      0
10386      0        0   0   1  4.000 -1.057     2      0
10391      0        1   0   0  5.836 -1.436     9      0
10392      0        1   0   0  8.660 -0.869     7      1
10407      1        0   0   0 10.205  1.483     4      1
10412      0        1   0   0  3.578 -1.199     7      0
10426      1        1   0   0 16.706  0.420     3      1
10430      1        1   0   0  2.255 -1.786    10      1
10431      1        1   0   0  2.255 -1.623    10      1
10434      0        1   0   0  0.980 -1.601     5      1
10438      1        1   0   0  6.667  0.271     6      0
10439      1        1   0   0  6.667 -0.711     6      0
10453      1        1   1   1  7.071 -1.349     2      0
10454      1        1   0   0  8.500  0.239     3      1
10455      1        1   0   0  8.500 -1.500     3      1
10471      1        1   0   0  2.880  0.003     8      0
10479      1        0   0   0  4.919 -1.201    14      1
10482      0        0   0   0  4.491 -1.205     6      0
10487      1        1   0   1  3.402 -1.003     7      0
10488      1        1   0   0  3.402 -0.370     6      0
10489      1        1   0   0  3.402 -1.027     6      0
10490      1        1   0   0  3.394 -0.407     2      0
10492      1        1   0   1  2.187 -0.204     8      0
10517      1        1   0   1  5.500 -0.666     3      0
10527      0        1   0   0  1.890 -0.983     5      1
10540      0        1   0   0  2.606  0.301     4      0
10541      0        1   0   0  2.606  0.329     4      0
10545      0        1   0   0  4.123 -1.122     5      1
10574      0        1   0   0  2.729 -2.508     6      1
11750      1        0   1   1 33.541  0.271     3      1
11755      0        0   0   0  6.722 -1.545     2      1
11758      1        0   1   1 12.000  0.840     1      1
11759      1        0   0   1  8.165 -0.234     3      1
11760      0        1   0   0  5.000 -2.679     2      1
11763      1        1   0   0  6.351  0.217     7      0
11780      1        0   0   0 24.495  1.041     5      1
11790      1        0   1   0  9.000  0.037     2      1
11791      1        0   1   0  9.000  0.607     2      1
11793      1        0   0   0  3.750 -1.111     4      1
11796      1        1   0   0  2.713  1.346     3      0
11799      1        1   0   1  4.472 -0.612     3      0
11801      0        1   1   1  6.500 -1.145     2      0
11806      1        0   1   1  8.550 -0.172     1      1
11809      1        0   1   1 10.000  0.919     1      1
11820      1        0   0   0 13.416  0.608     3      1
11833      1        0   0   0  8.497 -1.259     4      0
11841      1        1   0   0  3.500 -0.162     2      0
11844      1        0   0   0  5.657 -0.652     2      0
11846      1        1   0   0  4.472 -1.098     3      1
11849      1        1   1   1  3.780 -1.116     4      1
11852      1        0   1   0 12.500  1.090     2      1
11863      1        0   1   0 11.000  1.126     3      1
11864      1        1   0   0  6.532 -0.929     7      1
11872      1        0   1   0 23.094  1.456     7      1
11875      1        0   1   1  8.050  0.642     2      1
11880      1        0   1   0  6.708 -0.161     2      1
11897      1        0   0   0  8.000  1.405     2      0
11920      1        0   0   0 13.002  0.917     0      1
11925      1        0   1   1  8.333  1.041     6      1
11926      1        0   1   1  8.333  1.297     6      1
11934      1        1   0   0  6.124 -0.952     3      1
11937      1        1   1   1 11.628 -0.807     2      1
11941      1        0   1   0  4.899 -0.506     3      1
11942      1        0   0   0  4.041  0.127     5      1
11945      1        1   0   0  0.302 -1.174     8      1
11946      0        1   0   0  0.535  0.000    13      1
11947      1        1   0   0  0.535 -0.906    12      1
11952      0        1   0   0  3.266 -1.483     3      1
11956      1        0   0   0 14.289  0.348     3      1
11972      1        0   1   0  6.261  0.177     2      1
11976      1        1   0   0  2.009 -1.101     6      0
11994      1        0   1   1  6.532  0.249     3      1
12009      0        0   0   1 10.607  0.277     1      1
12010      1        1   1   1  9.815  1.109     1      0
12013      1        0   1   0  1.000  0.428     1      1
12014      1        0   1   0 10.000  0.794     1      1
12019      1        0   1   0 13.461  0.695     2      1
12023      1        0   0   0 10.500  0.958     1      0
12031      1        0   0   0  6.708  0.711     3      1
12039      1        0   0   0  2.500  0.710     1      1
12040      1        0   0   1  2.500 -0.472     1      1
12043      0        0   0   0  2.858 -1.680     4      0
12044      1        0   1   1 11.258 -0.067     1      1
12053      1        1   0   1 14.434  0.608     1      1
12065      0        0   1   1  7.155  0.071     2      1
12068      1        0   0   0  7.500  1.142     2      0
12074      1        0   1   1 10.000  0.356     1      1
12089      1        0   0   0  8.500  0.516     3      1
12090      1        0   1   0  3.879  0.270     5      1
12093      1        0   1   1 13.238  0.244     2      1
12102      1        0   0   0 11.180  0.808     2      1
12106      1        0   0   0  6.124  0.760     3      1
12110      1        0   1   1  6.899  0.115     3      1
12112      0        0   1   1  7.603 -0.733     2      1
12114      1        0   1   1 17.500  0.462     4      1
12116      1        0   0   0 13.000  1.001     1      1
12125      1        1   0   0 11.180 -0.766     2      1
12131      1        1   0   1  7.348 -0.341     4      1
12139      0        0   0   0  5.307 -0.568     5      1
12143      0        0   0   0  1.541 -0.985     3      0
12144      0        0   0   0  1.541 -0.907     3      0
12156      1        1   0   1  3.843 -0.093     4      0
12157      1        1   0   1  3.843 -0.093     4      1
12158      1        1   0   1  3.843 -1.727     4      1
12183      1        1   1   0  7.603  0.582     2      1
12184      1        1   0   0  7.603 -1.358     2      1
12197      1        1   1   1 10.451  0.088     7      0
12199      1        1   1   0  0.495 -0.625     3      0
12206      1        0   0   0 17.678  1.555     2      1
12218      1        1   0   0  6.000 -1.203     6      1
12260      1        0   1   1  3.578  1.501     3      1
12283      1        1   0   0  4.025 -0.299     6      0</code></pre>
</div>
</div>
<p>a. Following Powers and Xie perform a logistic regression of <code>hsgrad</code> on the other variables in the data set. Compute a likelihood-ratio test of the omnibus null hypothesis that none of the explanatory variables influences high-school graduation. Then construct 95-percent confidence intervals for the coefficients of the seven explanatory variables. What conclusions can you draw from these results? Finally, offer two brief, but concrete, interpretations of each of the estimated coefficients of income and intact.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the full model</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(hsgrad <span class="sc">~</span> nonwhite <span class="sc">+</span> mhs <span class="sc">+</span> fhs <span class="sc">+</span> income <span class="sc">+</span> asvab <span class="sc">+</span> nsibs <span class="sc">+</span> intact, </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> powers, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit null model</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>null_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(hsgrad <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> powers, </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display summary</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(full_model))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = hsgrad ~ nonwhite + mhs + fhs + income + asvab + 
    nsibs + intact, family = binomial(link = "logit"), data = powers)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   13.32763  882.74341   0.015   0.9880    
nonwhite       0.81554    0.17825   4.575 4.76e-06 ***
mhs            0.34726    0.17897   1.940   0.0523 .  
fhs            0.31391    0.18262   1.719   0.0856 .  
income         0.04861    0.02289   2.123   0.0337 *  
asvab          1.51769    0.11708  12.963  &lt; 2e-16 ***
nsibs0       -13.19374  882.74351  -0.015   0.9881    
nsibs1       -12.13503  882.74345  -0.014   0.9890    
nsibs10      -12.50545  882.74367  -0.014   0.9887    
nsibs11      -12.18234  882.74364  -0.014   0.9890    
nsibs12      -12.27861  882.74383  -0.014   0.9889    
nsibs13      -13.24800  882.74387  -0.015   0.9880    
nsibs14        1.64927 1072.74692   0.002   0.9988    
nsibs15      -29.54854 1248.38767  -0.024   0.9811    
nsibs16      -13.82733  882.74428  -0.016   0.9875    
nsibs17        1.47051 1248.38768   0.001   0.9991    
nsibs2       -12.28031  882.74342  -0.014   0.9889    
nsibs3       -12.54327  882.74342  -0.014   0.9887    
nsibs4       -12.47637  882.74342  -0.014   0.9887    
nsibs5       -12.93708  882.74343  -0.015   0.9883    
nsibs6       -12.18484  882.74344  -0.014   0.9890    
nsibs7       -12.84239  882.74346  -0.015   0.9884    
nsibs8       -12.33474  882.74349  -0.014   0.9889    
nsibs9       -13.45353  882.74350  -0.015   0.9878    
nsibsNo       -6.29445 1248.38781  -0.005   0.9960    
intact         0.72026    0.16470   4.373 1.22e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1504.8  on 1613  degrees of freedom
Residual deviance: 1081.4  on 1588  degrees of freedom
AIC: 1133.4

Number of Fisher Scoring iterations: 13</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate LR test</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>G_squared <span class="ot">&lt;-</span> null_model<span class="sc">$</span>deviance <span class="sc">-</span> full_model<span class="sc">$</span>deviance</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>df_test <span class="ot">&lt;-</span> null_model<span class="sc">$</span>df.residual <span class="sc">-</span> full_model<span class="sc">$</span>df.residual</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(G_squared, df_test, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"H0: β₁ = β₂ = β₃ = β₄ = β₅ = β₆ = β₇ = 0</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>H0: β₁ = β₂ = β₃ = β₄ = β₅ = β₆ = β₇ = 0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"(None of the explanatory variables influence graduation)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(None of the explanatory variables influence graduation)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test Statistics:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  G² statistic:        "</span>, <span class="fu">round</span>(G_squared, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  G² statistic:         423.434 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Degrees of freedom:  "</span>, df_test, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Degrees of freedom:   25 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  P-value:             "</span>, <span class="fu">format.pval</span>(p_value, <span class="at">eps =</span> <span class="fl">0.001</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  P-value:              &lt; 0.001 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Conclusion: STRONGLY REJECT H0 (p &lt; 0.001) ***</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"At least one explanatory variable significantly influences</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"high-school graduation probability.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Conclusion: REJECT H0 (p &lt; 0.05)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Conclusion: FAIL TO REJECT H0 (p ≥ 0.05)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conclusion: STRONGLY REJECT H0 (p &lt; 0.001) ***
At least one explanatory variable significantly influences
high-school graduation probability.</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute confidence intervals</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>ci_95 <span class="ot">&lt;-</span> <span class="fu">confint</span>(full_model, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comprehensive table</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>coef_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(<span class="fu">coef</span>(full_model)),</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">coef</span>(full_model),</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Std.Error =</span> <span class="fu">summary</span>(full_model)<span class="sc">$</span>coefficients[, <span class="st">"Std. Error"</span>],</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Lower =</span> ci_95[, <span class="dv">1</span>],</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Upper =</span> ci_95[, <span class="dv">2</span>],</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">z_value =</span> <span class="fu">summary</span>(full_model)<span class="sc">$</span>coefficients[, <span class="st">"z value"</span>],</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> <span class="fu">summary</span>(full_model)<span class="sc">$</span>coefficients[, <span class="st">"Pr(&gt;|z|)"</span>]</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(coef_table) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add significance stars</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>coef_table<span class="sc">$</span>Sig <span class="ot">&lt;-</span> <span class="fu">cut</span>(coef_table<span class="sc">$</span>p_value, </span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="cn">Inf</span>),</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"***"</span>, <span class="st">"**"</span>, <span class="st">"*"</span>, <span class="st">""</span>))</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coef_table)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Variable     Estimate    Std.Error      CI_Lower     CI_Upper
1  (Intercept)  13.32762544 8.827434e+02 -1.665369e+02           NA
2     nonwhite   0.81554344 1.782546e-01  4.695057e-01   1.16883066
3          mhs   0.34726098 1.789670e-01 -1.671804e-03   0.62477275
4          fhs   0.31391151 1.826200e-01 -4.106082e-02   0.67574502
5       income   0.04861168 2.289446e-02  5.043034e-03   0.09472099
6        asvab   1.51769121 1.170829e-01  1.293789e+00   1.75316340
7       nsibs0 -13.19374146 8.827435e+02            NA 166.54707776
8       nsibs1 -12.13502579 8.827435e+02            NA 167.67932428
9      nsibs10 -12.50545191 8.827437e+02            NA 167.01448468
10     nsibs11 -12.18233850 8.827436e+02            NA 167.39315346
11     nsibs12 -12.27861340 8.827438e+02            NA 166.89748211
12     nsibs13 -13.24799956 8.827439e+02            NA 165.88939882
13     nsibs14   1.64927444 1.072747e+03 -5.903709e+00   9.20930696
14     nsibs15 -29.54854428 1.248388e+03            NA 166.43191445
15     nsibs16 -13.82733275 8.827443e+02            NA 165.06701963
16     nsibs17   1.47050929 1.248388e+03 -7.312976e+00  10.25808427
17      nsibs2 -12.28030923 8.827434e+02            NA 167.57413146
18      nsibs3 -12.54326897 8.827434e+02            NA 167.31344186
19      nsibs4 -12.47637089 8.827434e+02            NA 167.37562017
20      nsibs5 -12.93708352 8.827434e+02            NA 166.90937787
21      nsibs6 -12.18483960 8.827434e+02            NA 167.64680632
22      nsibs7 -12.84239462 8.827435e+02            NA 166.96469555
23      nsibs8 -12.33474075 8.827435e+02            NA 167.42514745
24      nsibs9 -13.45352992 8.827435e+02            NA 166.30879371
25     nsibsNo  -6.29445056 1.248388e+03 -1.418049e+01   1.45613475
26      intact   0.72025761 1.646971e-01  3.978662e-01   1.04400275
        z_value      p_value Sig
1   0.015097961 9.879540e-01    
2   4.575159710 4.758568e-06 ***
3   1.940363276 5.233556e-02    
4   1.718933163 8.562654e-02    
5   2.123294239 3.372920e-02   *
6  12.962530697 1.995536e-38 ***
7  -0.014946291 9.880750e-01    
8  -0.013746945 9.890319e-01    
9  -0.014166572 9.886971e-01    
10 -0.013800540 9.889891e-01    
11 -0.013909600 9.889021e-01    
12 -0.015007750 9.880260e-01    
13  0.001537431 9.987733e-01    
14 -0.023669366 9.811163e-01    
15 -0.015664030 9.875024e-01    
16  0.001177927 9.990602e-01    
17 -0.013911527 9.889006e-01    
18 -0.014209417 9.886629e-01    
19 -0.014133632 9.887234e-01    
20 -0.014655542 9.883070e-01    
21 -0.013803376 9.889868e-01    
22 -0.014548275 9.883926e-01    
23 -0.013973188 9.888514e-01    
24 -0.015240588 9.878402e-01    
25 -0.005042063 9.959770e-01    
26  4.373226269 1.224237e-05 ***</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Significance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"A. OVERALL MODEL:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>A. OVERALL MODEL:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   The omnibus LR test shows that the model as a whole is</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   The omnibus LR test shows that the model as a whole is</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   highly significant, indicating that the set of predictors</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   highly significant, indicating that the set of predictors</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   significantly improves prediction of graduation over the</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   significantly improves prediction of graduation over the</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   null model.</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   null model.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"B. INDIVIDUAL PREDICTORS (at α = 0.05):</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>B. INDIVIDUAL PREDICTORS (at α = 0.05):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(coef_table)) {  <span class="co"># Skip intercept</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  var <span class="ot">&lt;-</span> coef_table<span class="sc">$</span>Variable[i]</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  est <span class="ot">&lt;-</span> coef_table<span class="sc">$</span>Estimate[i]</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  ci_low <span class="ot">&lt;-</span> coef_table<span class="sc">$</span>CI_Lower[i]</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  ci_high <span class="ot">&lt;-</span> coef_table<span class="sc">$</span>CI_Upper[i]</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> coef_table<span class="sc">$</span>p_value[i]</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  sig <span class="ot">&lt;-</span> coef_table<span class="sc">$</span>Sig[i]</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   "</span>, var, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(p <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>    direction <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(est <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"POSITIVE"</span>, <span class="st">"NEGATIVE"</span>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"      "</span>, direction, <span class="st">"effect (significant"</span>, sig, <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"       CI: ["</span>, <span class="fu">round</span>(ci_low, <span class="dv">4</span>), <span class="st">","</span>, <span class="fu">round</span>(ci_high, <span class="dv">4</span>), <span class="st">"] excludes 0</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"       NOT significant (CI includes 0)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"       CI: ["</span>, <span class="fu">round</span>(ci_low, <span class="dv">4</span>), <span class="st">","</span>, <span class="fu">round</span>(ci_high, <span class="dv">4</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    nonwhite :
       POSITIVE effect (significant 1 )
       CI: [ 0.4695 , 1.1688 ] excludes 0

    mhs :
       NOT significant (CI includes 0)
       CI: [ -0.0017 , 0.6248 ]

    fhs :
       NOT significant (CI includes 0)
       CI: [ -0.0411 , 0.6757 ]

    income :
       POSITIVE effect (significant 3 )
       CI: [ 0.005 , 0.0947 ] excludes 0

    asvab :
       POSITIVE effect (significant 1 )
       CI: [ 1.2938 , 1.7532 ] excludes 0

    nsibs0 :
       NOT significant (CI includes 0)
       CI: [ NA , 166.5471 ]

    nsibs1 :
       NOT significant (CI includes 0)
       CI: [ NA , 167.6793 ]

    nsibs10 :
       NOT significant (CI includes 0)
       CI: [ NA , 167.0145 ]

    nsibs11 :
       NOT significant (CI includes 0)
       CI: [ NA , 167.3932 ]

    nsibs12 :
       NOT significant (CI includes 0)
       CI: [ NA , 166.8975 ]

    nsibs13 :
       NOT significant (CI includes 0)
       CI: [ NA , 165.8894 ]

    nsibs14 :
       NOT significant (CI includes 0)
       CI: [ -5.9037 , 9.2093 ]

    nsibs15 :
       NOT significant (CI includes 0)
       CI: [ NA , 166.4319 ]

    nsibs16 :
       NOT significant (CI includes 0)
       CI: [ NA , 165.067 ]

    nsibs17 :
       NOT significant (CI includes 0)
       CI: [ -7.313 , 10.2581 ]

    nsibs2 :
       NOT significant (CI includes 0)
       CI: [ NA , 167.5741 ]

    nsibs3 :
       NOT significant (CI includes 0)
       CI: [ NA , 167.3134 ]

    nsibs4 :
       NOT significant (CI includes 0)
       CI: [ NA , 167.3756 ]

    nsibs5 :
       NOT significant (CI includes 0)
       CI: [ NA , 166.9094 ]

    nsibs6 :
       NOT significant (CI includes 0)
       CI: [ NA , 167.6468 ]

    nsibs7 :
       NOT significant (CI includes 0)
       CI: [ NA , 166.9647 ]

    nsibs8 :
       NOT significant (CI includes 0)
       CI: [ NA , 167.4251 ]

    nsibs9 :
       NOT significant (CI includes 0)
       CI: [ NA , 166.3088 ]

    nsibsNo :
       NOT significant (CI includes 0)
       CI: [ -14.1805 , 1.4561 ]

    intact :
       POSITIVE effect (significant 1 )
       CI: [ 0.3979 , 1.044 ] excludes 0</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>beta_income <span class="ot">&lt;-</span> <span class="fu">coef</span>(full_model)[<span class="st">"income"</span>]</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>beta_intact <span class="ot">&lt;-</span> <span class="fu">coef</span>(full_model)[<span class="st">"intactYes"</span>]</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate odds ratios</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>or_income <span class="ot">&lt;-</span> <span class="fu">exp</span>(beta_income)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>or_intact <span class="ot">&lt;-</span> <span class="fu">exp</span>(beta_intact)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co"># For a $10,000 increase in income</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>or_income_10k <span class="ot">&lt;-</span> <span class="fu">exp</span>(beta_income <span class="sc">*</span> <span class="dv">10</span>)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"INCOME VARIABLE</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>INCOME VARIABLE</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"-"</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------------</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Coefficient:  β ="</span>, <span class="fu">round</span>(beta_income, <span class="dv">5</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficient:  β = 0.04861 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation 1 (Log-Odds Scale):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretation 1 (Log-Odds Scale):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  For each additional $1,000 in adjusted family income, the</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  For each additional $1,000 in adjusted family income, the</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  log-odds of graduating from high school increase by</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  log-odds of graduating from high school increase by</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  "</span>, <span class="fu">round</span>(beta_income, <span class="dv">5</span>), <span class="st">", holding all other variables constant.</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   0.04861 , holding all other variables constant.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation 2 (Odds Ratio - Concrete):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretation 2 (Odds Ratio - Concrete):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  For each additional $1,000 in adjusted family income, the</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  For each additional $1,000 in adjusted family income, the</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  odds of graduating are multiplied by"</span>, <span class="fu">round</span>(or_income, <span class="dv">5</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  odds of graduating are multiplied by 1.04981 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  (or a"</span>, <span class="fu">round</span>((or_income <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">3</span>), <span class="st">"% increase in odds),</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (or a 4.981 % increase in odds),</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  holding all other variables constant.</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  holding all other variables constant.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  CONCRETE EXAMPLE:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  CONCRETE EXAMPLE:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Consider two students identical in all respects except that</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Consider two students identical in all respects except that</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Student A's family has income $20,000 and Student B's family</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student A's family has income $20,000 and Student B's family</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  has income $30,000 (a $10,000 difference).</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  has income $30,000 (a $10,000 difference).</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Student B has odds of graduation that are"</span>, <span class="fu">round</span>(or_income_10k, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student B has odds of graduation that are 1.626 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  times the odds for Student A ("</span>, <span class="fu">round</span>((or_income_10k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"% higher).</span><span class="sc">\n\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  times the odds for Student A ( 62.6 % higher).</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"INTACT VARIABLE</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>INTACT VARIABLE</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">rep</span>(<span class="st">"-"</span>, <span class="dv">70</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------------</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Coefficient: β ="</span>, <span class="fu">round</span>(beta_intact, <span class="dv">5</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficient: β = NA </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation 1 (Log-Odds Scale):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretation 1 (Log-Odds Scale):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Students who lived with both biological parents at age 14</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Students who lived with both biological parents at age 14</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  have log-odds of graduating that are"</span>, <span class="fu">round</span>(beta_intact, <span class="dv">5</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  have log-odds of graduating that are NA </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  units higher than students who did not live with both parents,</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  units higher than students who did not live with both parents,</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  holding all other variables constant.</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  holding all other variables constant.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation 2 (Odds Ratio - Concrete):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretation 2 (Odds Ratio - Concrete):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Students from intact families have odds of graduating that</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Students from intact families have odds of graduating that</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  are"</span>, <span class="fu">round</span>(or_intact, <span class="dv">4</span>), <span class="st">"times the odds for students from</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  are NA times the odds for students from</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  non-intact families ("</span>, <span class="fu">round</span>((or_intact <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"% higher odds),</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  non-intact families ( NA % higher odds),</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  holding all other variables constant.</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  holding all other variables constant.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  CONCRETE EXAMPLE:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  CONCRETE EXAMPLE:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Consider two students who are identical in race, parents'</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Consider two students who are identical in race, parents'</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  education, family income, ASVAB score, and number of siblings.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  education, family income, ASVAB score, and number of siblings.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  If Student A is from an intact family and Student B is not,</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  If Student A is from an intact family and Student B is not,</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  then Student A has"</span>, <span class="fu">round</span>(or_intact, <span class="dv">2</span>), <span class="st">"times the odds of</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  then Student A has NA times the odds of</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  graduating compared to Student B.</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  graduating compared to Student B.</code></pre>
</div>
</div>
<p>b. The logistic regression in the previous problem assumes that the partial relationship between the log-odds of high-school graduation and number of siblings is linear. Test for nonlinearity by fitting a model that treats <code>nsibs</code> as a factor, performing an appropriate likelihood-ratio test. In the course of working this problem, you should discover two errors in the data. Deal with the errors in a reasonable manner. Does the result of the test change?</p>
</section>
<section id="problem-3" class="level2">
<h2 class="anchored" data-anchor-id="problem-3">Problem 3</h2>
<p><strong>North Atlantic Hurricanes:</strong> the goal of the following exercise is to build a model that predicts the group membership of a hurricanes, either tropical or non-tropical, based on the latitude of formation.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>hurricanes <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"https://userpage.fu-berlin.de/soga/data/raw-data/hurricanes.xlsx"</span>)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hurricanes)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   337 obs. of  12 variables:
 $ RowNames: chr  "1" "2" "3" "4" ...
 $ Number  : num  430 432 433 436 437 438 440 441 445 449 ...
 $ Name    : chr  "NOTNAMED" "NOTNAMED" "NOTNAMED" "NOTNAMED" ...
 $ Year    : num  1944 1944 1944 1944 1944 ...
 $ Type    : num  1 0 0 0 0 1 0 1 0 0 ...
 $ FirstLat: num  30.2 25.6 14.2 20.8 20 29.2 16.1 27.6 21.6 19 ...
 $ FirstLon: num  -76.1 -74.9 -65.2 -58 -84.2 -55.8 -80.8 -85.6 -95.2 -56.6 ...
 $ MaxLat  : num  32.1 31 16.6 26.3 20.6 38 21.9 27.6 28.6 24.9 ...
 $ MaxLon  : num  -74.8 -78.1 -72.2 -72.3 -84.9 -53.2 -82.9 -85.6 -96.1 -79.6 ...
 $ LastLat : num  35.1 32.6 20.6 42.1 19.1 50 28.4 31.7 29.5 28.9 ...
 $ LastLon : num  -69.2 -78.2 -88.5 -71.5 -93.9 -46.5 -82.1 -79.1 -96 -81.8 ...
 $ MaxInt  : num  80 80 105 120 70 85 105 100 120 120 ...</code></pre>
</div>
</div>
<p>There are 337 observations and 12 variables in the dataset. We are primarily interested in the variable <code>type</code>, which is our response variable, and the variable <code>FirstLat</code>, which corresponds to the latitude of formation, and thus is our predictor variable.</p>
<p>a. Produce the following plot and give the interpretation. You may consider using the function ggplot in ’ggplot2“ package.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create descriptive labels</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>hurricanes<span class="sc">$</span>Type_label <span class="ot">&lt;-</span> <span class="fu">factor</span>(hurricanes<span class="sc">$</span>Type,</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"tropical-only"</span>, </span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"baroclinic influences"</span>,</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"baroclinic initiation"</span>))</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the stacked bar chart</span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(hurricanes, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">fill =</span> Type_label)) <span class="sc">+</span></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"tropical-only"</span> <span class="ot">=</span> <span class="st">"#F8766D"</span>,</span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"baroclinic influences"</span> <span class="ot">=</span> <span class="st">"#00BA38"</span>, </span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"baroclinic initiation"</span> <span class="ot">=</span> <span class="st">"#619CFF"</span>)) <span class="sc">+</span></span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Hurricane Types by Year"</span>,</span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"count"</span>,</span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Type of Hurricane"</span>) <span class="sc">+</span></span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP4_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"hurricane_types_by_year.pdf"</span>, <span class="at">plot =</span> p1, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This stacked bar chart shows the frequency of different hurricane types in the North Atlantic from approximately 1950 to 2010.</p>
<p>Key observations:</p>
<ol type="1">
<li>DOMINANCE OF TROPICAL HURRICANES (red/salmon bars): - Tropical-only hurricanes are the most common type across all years - They form the largest proportion of the total count in most years</li>
</ol>
<!-- -->
<ol start="2" type="1">
<li>TEMPORAL VARIATION:
<ul>
<li>Hurricane frequency varies considerably from year to year</li>
<li>Some years have notably high activity (e.g., around 1950, 1970, 1995)</li>
<li>Other years show much lower hurricane counts</li>
</ul></li>
<li>NON-TROPICAL HURRICANES (green and blue):
<ul>
<li>Baroclinic influences (green) and baroclinic initiation (blue) appear more frequently in certain periods</li>
<li>These types seem more common in the 1960s-1970s period</li>
<li>They represent a smaller but consistent proportion of total hurricanes</li>
</ul></li>
<li>POSSIBLE TRENDS:
<ul>
<li>There may be decadal variability in hurricane frequency</li>
<li>The relative proportions of types appear relatively stable</li>
<li>More recent decades (1990s-2000s) show continued activity</li>
</ul></li>
</ol>
<p>b. In class 0, tropical hurricanes, there are 187 observations, in class 1, baroclinic influences, there are 77 observations and in class 3, baroclinic initiation, there are 73 observations. Since we can only deal with dichotomous (binary) data in logistic regression, please re-code the classes and assign class 1 and 3, both are being influenced by the outer tropics, the label 1 and name the new variable <code>Type_new</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(hurricanes<span class="sc">$</span>Type)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1   3 
187  77  73 </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create binary variable</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Type 0 (tropical) = 0 (tropical hurricane)</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Type 1 and 3 (baroclinic) = 1 (non-tropical hurricane)</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>hurricanes<span class="sc">$</span>Type_new <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(hurricanes<span class="sc">$</span>Type <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create labeled version</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>hurricanes<span class="sc">$</span>Type_new_label <span class="ot">&lt;-</span> <span class="fu">factor</span>(hurricanes<span class="sc">$</span>Type_new,</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Tropical"</span>, <span class="st">"Non-Tropical"</span>))</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the recoding</span></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">New Type_new distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
New Type_new distribution:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(hurricanes<span class="sc">$</span>Type_new))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
187 150 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Cross-tabulation to verify recoding:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cross-tabulation to verify recoding:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(<span class="at">Original =</span> hurricanes<span class="sc">$</span>Type, <span class="at">New =</span> hurricanes<span class="sc">$</span>Type_new))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        New
Original   0   1
       0 187   0
       1   0  77
       3   0  73</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Labeled version:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Labeled version:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(hurricanes<span class="sc">$</span>Type_new_label))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Tropical Non-Tropical 
         187          150 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Summary:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Tropical hurricanes (Type 0): "</span>, <span class="fu">sum</span>(hurricanes<span class="sc">$</span>Type_new <span class="sc">==</span> <span class="dv">0</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Tropical hurricanes (Type 0):  187 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Non-tropical hurricanes (Type 1 &amp; 3): "</span>, <span class="fu">sum</span>(hurricanes<span class="sc">$</span>Type_new <span class="sc">==</span> <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Non-tropical hurricanes (Type 1 &amp; 3):  150 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Total:  "</span>, <span class="fu">nrow</span>(hurricanes), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Total:   337 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Proportion tropical: "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(hurricanes<span class="sc">$</span>Type_new <span class="sc">==</span> <span class="dv">0</span>), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Proportion tropical:  0.555 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Proportion non-tropical: "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(hurricanes<span class="sc">$</span>Type_new <span class="sc">==</span> <span class="dv">1</span>), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Proportion non-tropical:  0.445 </code></pre>
</div>
</div>
<p>c. Fit a logistic model with Type_new as a response variable and Firstlat has predictor. Interpret the estimated coefficient of Firstlat. Obtain the 95% confident interval of the log-dd and the odd.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check FirstLat variable</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Summary of FirstLat:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Summary of FirstLat:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(hurricanes<span class="sc">$</span>FirstLat))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  10.30   16.60   23.30   23.44   28.70   46.00 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Missing values:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Missing values:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Type_new:"</span>, <span class="fu">sum</span>(<span class="fu">is.na</span>(hurricanes<span class="sc">$</span>Type_new)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Type_new: 0 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"FirstLat:"</span>, <span class="fu">sum</span>(<span class="fu">is.na</span>(hurricanes<span class="sc">$</span>FirstLat)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>FirstLat: 0 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the logistic regression model</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>model_simple <span class="ot">&lt;-</span> <span class="fu">glm</span>(Type_new <span class="sc">~</span> FirstLat,</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> hurricanes,</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display summary</span></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Model Summary ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Model Summary ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_simple)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Type_new ~ FirstLat, family = binomial(link = "logit"), 
    data = hurricanes)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -9.08263    0.96148  -9.446   &lt;2e-16 ***
FirstLat     0.37283    0.03947   9.447   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 463.11  on 336  degrees of freedom
Residual deviance: 232.03  on 335  degrees of freedom
AIC: 236.03

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficient</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>firstlat_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_simple)[<span class="st">"FirstLat"</span>]</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>firstlat_se <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_simple)<span class="sc">$</span>coefficients[<span class="st">"FirstLat"</span>, <span class="st">"Std. Error"</span>]</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>firstlat_pval <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_simple)<span class="sc">$</span>coefficients[<span class="st">"FirstLat"</span>, <span class="st">"Pr(&gt;|z|)"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"INTERPRETATION:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>INTERPRETATION:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. LOG-ODDS INTERPRETATION:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>1. LOG-ODDS INTERPRETATION:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   For each 1-degree increase in latitude of formation (FirstLat),</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   For each 1-degree increase in latitude of formation (FirstLat),</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   the log-odds of a hurricane being non-tropical (vs tropical)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   the log-odds of a hurricane being non-tropical (vs tropical)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   "</span>, <span class="fu">ifelse</span>(firstlat_coef <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"increase"</span>, <span class="st">"decrease"</span>), <span class="st">" by"</span>, </span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abs</span>(<span class="fu">round</span>(firstlat_coef, <span class="dv">4</span>)), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    increase  by 0.3728 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate odds ratio</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>or_firstlat <span class="ot">&lt;-</span> <span class="fu">exp</span>(firstlat_coef)</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2. ODDS RATIO INTERPRETATION:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>2. ODDS RATIO INTERPRETATION:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   Odds Ratio:"</span>, <span class="fu">round</span>(or_firstlat, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Odds Ratio: 1.4518 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   For each 1-degree increase in latitude,</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   For each 1-degree increase in latitude,</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   the odds of a hurricane being non-tropical are multiplied by"</span>, </span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(or_firstlat, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   the odds of a hurricane being non-tropical are multiplied by 1.4518 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>percent_change <span class="ot">&lt;-</span> (or_firstlat <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   This represents a"</span>, <span class="fu">round</span>(<span class="fu">abs</span>(percent_change), <span class="dv">2</span>), </span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% "</span>, <span class="fu">ifelse</span>(percent_change <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"increase"</span>, <span class="st">"decrease"</span>), </span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">" in odds per degree latitude.</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   This represents a 45.18 %  increase  in odds per degree latitude.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"3. PRACTICAL INTERPRETATION:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>3. PRACTICAL INTERPRETATION:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (firstlat_coef <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   Hurricanes that form at HIGHER latitudes are MORE LIKELY</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   to be non-tropical (baroclinic influences or initiation).</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   This makes meteorological sense:  tropical systems form in warm,</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   low-latitude regions, while baroclinic systems are associated</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   with mid-latitude weather patterns.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   Hurricanes that form at LOWER latitudes are MORE LIKELY</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   to be tropical.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Hurricanes that form at HIGHER latitudes are MORE LIKELY
   to be non-tropical (baroclinic influences or initiation).
   This makes meteorological sense:  tropical systems form in warm,
   low-latitude regions, while baroclinic systems are associated
   with mid-latitude weather patterns.</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% Confidence Intervals</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="co"># CI for log-odds (coefficients)</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>ci_logodds <span class="ot">&lt;-</span> <span class="fu">confint</span>(model_simple)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">1.  Confidence Interval for LOG-ODDS (coefficients):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1.  Confidence Interval for LOG-ODDS (coefficients):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(ci_logodds, <span class="dv">4</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>               2.5 %  97.5 %
(Intercept) -11.1234 -7.3381
FirstLat      0.3011  0.4565</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CI for odds ratios</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>ci_odds <span class="ot">&lt;-</span> <span class="fu">exp</span>(ci_logodds)</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">2. Confidence Interval for ODDS RATIOS:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
2. Confidence Interval for ODDS RATIOS:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(ci_odds, <span class="dv">4</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>             2.5 % 97.5 %
(Intercept) 0.0000 0.0007
FirstLat    1.3514 1.5785</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detailed interpretation for FirstLat</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Detailed CI Interpretation for FirstLat:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Detailed CI Interpretation for FirstLat:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Log-odds CI: ["</span>, <span class="fu">round</span>(ci_logodds[<span class="st">"FirstLat"</span>, <span class="dv">1</span>], <span class="dv">4</span>), <span class="st">","</span>, </span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ci_logodds[<span class="st">"FirstLat"</span>, <span class="dv">2</span>], <span class="dv">4</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Log-odds CI: [ 0.3011 , 0.4565 ]</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odds Ratio CI: ["</span>, <span class="fu">round</span>(ci_odds[<span class="st">"FirstLat"</span>, <span class="dv">1</span>], <span class="dv">4</span>), <span class="st">","</span>, </span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ci_odds[<span class="st">"FirstLat"</span>, <span class="dv">2</span>], <span class="dv">4</span>), <span class="st">"]</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odds Ratio CI: [ 1.3514 , 1.5785 ]</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"We are 95% confident that for each 1-degree increase in latitude,</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>We are 95% confident that for each 1-degree increase in latitude,</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"the odds of being non-tropical are multiplied by a factor between</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>the odds of being non-tropical are multiplied by a factor between</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">round</span>(ci_odds[<span class="st">"FirstLat"</span>, <span class="dv">1</span>], <span class="dv">4</span>), <span class="st">"and"</span>, <span class="fu">round</span>(ci_odds[<span class="st">"FirstLat"</span>, <span class="dv">2</span>], <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.3514 and 1.5785 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if CI includes 1</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (ci_odds[<span class="st">"FirstLat"</span>, <span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">||</span> ci_odds[<span class="st">"FirstLat"</span>, <span class="dv">2</span>] <span class="sc">&lt;</span> <span class="dv">1</span>) {</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Since the CI does NOT include 1.0, the effect is statistically significant.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Since the CI includes 1.0, the effect is NOT statistically significant.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Since the CI does NOT include 1.0, the effect is statistically significant.</code></pre>
</div>
</div>
<p>d. Predict if a hurricane is a tropical hurricane or non-tropical hurricane with the first latitudes are 10<sup>o</sup> , 23.5◦ and 30◦. You may use the <code>predict()</code> function. Please note, that if we add the argument <code>type = "response"</code> to the function call, the <code>predict()</code> function returns the probability and not the log-odds.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for predictions</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>pred_latitudes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">FirstLat =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="fl">23.5</span>, <span class="dv">30</span>))</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict log-odds</span></span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>pred_logodds <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_simple, <span class="at">newdata =</span> pred_latitudes, <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities</span></span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>pred_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_simple, <span class="at">newdata =</span> pred_latitudes, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard errors for confidence intervals</span></span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>pred_se <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_simple, <span class="at">newdata =</span> pred_latitudes, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% CI for log-odds</span></span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a>ci_lower_logodds <span class="ot">&lt;-</span> pred_se<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_se<span class="sc">$</span>se.fit</span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a>ci_upper_logodds <span class="ot">&lt;-</span> pred_se<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> pred_se<span class="sc">$</span>se.fit</span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to probability scale</span></span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a>ci_lower_prob <span class="ot">&lt;-</span> <span class="fu">exp</span>(ci_lower_logodds) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(ci_lower_logodds))</span>
<span id="cb262-19"><a href="#cb262-19" aria-hidden="true" tabindex="-1"></a>ci_upper_prob <span class="ot">&lt;-</span> <span class="fu">exp</span>(ci_upper_logodds) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(ci_upper_logodds))</span>
<span id="cb262-20"><a href="#cb262-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-21"><a href="#cb262-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create results table</span></span>
<span id="cb262-22"><a href="#cb262-22" aria-hidden="true" tabindex="-1"></a>pred_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb262-23"><a href="#cb262-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Latitude =</span> pred_latitudes<span class="sc">$</span>FirstLat,</span>
<span id="cb262-24"><a href="#cb262-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Log_Odds =</span> <span class="fu">round</span>(pred_logodds, <span class="dv">4</span>),</span>
<span id="cb262-25"><a href="#cb262-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Probability_NonTropical =</span> <span class="fu">round</span>(pred_probs, <span class="dv">4</span>),</span>
<span id="cb262-26"><a href="#cb262-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">Prob_CI_Lower =</span> <span class="fu">round</span>(ci_lower_prob, <span class="dv">4</span>),</span>
<span id="cb262-27"><a href="#cb262-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Prob_CI_Upper =</span> <span class="fu">round</span>(ci_upper_prob, <span class="dv">4</span>),</span>
<span id="cb262-28"><a href="#cb262-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted_Type =</span> <span class="fu">ifelse</span>(pred_probs <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">"Non-Tropical"</span>, <span class="st">"Tropical"</span>)</span>
<span id="cb262-29"><a href="#cb262-29" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Prediction Results ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Prediction Results ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred_results)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Latitude Log_Odds Probability_NonTropical Prob_CI_Lower Prob_CI_Upper
1     10.0  -5.3543                  0.0047        0.0015        0.0144
2     23.5  -0.3211                  0.4204        0.3434        0.5015
3     30.0   2.1023                  0.8911        0.8228        0.9352
  Predicted_Type
1       Tropical
2       Tropical
3   Non-Tropical</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detailed interpretation</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== DETAILED INTERPRETATIONS ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== DETAILED INTERPRETATIONS ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pred_results)) {</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"LATITUDE:"</span>, pred_results<span class="sc">$</span>Latitude[i], <span class="st">"degrees</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"  - Log-odds:"</span>, pred_results<span class="sc">$</span>Log_Odds[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"  - Probability of being NON-TROPICAL:"</span>, </span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(pred_results<span class="sc">$</span>Probability_NonTropical[i] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"  - Probability of being TROPICAL:"</span>, </span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>((<span class="dv">1</span> <span class="sc">-</span> pred_results<span class="sc">$</span>Probability_NonTropical[i]) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"  - 95% CI for probability:  ["</span>, </span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(pred_results<span class="sc">$</span>Prob_CI_Lower[i] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"% - "</span>,</span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(pred_results<span class="sc">$</span>Prob_CI_Upper[i] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%]</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"  - PREDICTION:"</span>, pred_results<span class="sc">$</span>Predicted_Type[i], </span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"(using 0.5 threshold)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb269-14"><a href="#cb269-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (pred_results<span class="sc">$</span>Latitude[i] <span class="sc">==</span> <span class="dv">10</span>) {</span>
<span id="cb269-15"><a href="#cb269-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"  - INTERPRETATION: At 10°N (low latitude, near equator),</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-16"><a href="#cb269-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"    hurricanes are VERY LIKELY to be tropical.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-17"><a href="#cb269-17" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (pred_results<span class="sc">$</span>Latitude[i] <span class="sc">==</span> <span class="fl">23.5</span>) {</span>
<span id="cb269-18"><a href="#cb269-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"  - INTERPRETATION: At 23.5°N (Tropic of Cancer),</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-19"><a href="#cb269-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"    this is a transitional latitude.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-20"><a href="#cb269-20" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (pred_results<span class="sc">$</span>Latitude[i] <span class="sc">==</span> <span class="dv">30</span>) {</span>
<span id="cb269-21"><a href="#cb269-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"  - INTERPRETATION:  At 30°N (subtropical/mid-latitude),</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-22"><a href="#cb269-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"    hurricanes are MORE LIKELY to have baroclinic influences.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-23"><a href="#cb269-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb269-24"><a href="#cb269-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb269-25"><a href="#cb269-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>LATITUDE: 10 degrees
  - Log-odds: -5.3543 
  - Probability of being NON-TROPICAL: 0.47 %
  - Probability of being TROPICAL: 99.53 %
  - 95% CI for probability:  [ 0.15 % -  1.44 %]
  - PREDICTION: Tropical (using 0.5 threshold)
  - INTERPRETATION: At 10°N (low latitude, near equator),
    hurricanes are VERY LIKELY to be tropical.

LATITUDE: 23.5 degrees
  - Log-odds: -0.3211 
  - Probability of being NON-TROPICAL: 42.04 %
  - Probability of being TROPICAL: 57.96 %
  - 95% CI for probability:  [ 34.34 % -  50.15 %]
  - PREDICTION: Tropical (using 0.5 threshold)
  - INTERPRETATION: At 23.5°N (Tropic of Cancer),
    this is a transitional latitude.

LATITUDE: 30 degrees
  - Log-odds: 2.1023 
  - Probability of being NON-TROPICAL: 89.11 %
  - Probability of being TROPICAL: 10.89 %
  - 95% CI for probability:  [ 82.28 % -  93.52 %]
  - PREDICTION: Non-Tropical (using 0.5 threshold)
  - INTERPRETATION:  At 30°N (subtropical/mid-latitude),
    hurricanes are MORE LIKELY to have baroclinic influences.</code></pre>
</div>
</div>
<p>e. Now consider all the variables in the data. Choose the best model (with only main effects).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check all available variables</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Available variables:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Available variables:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(hurricanes))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "RowNames"       "Number"         "Name"           "Year"          
 [5] "Type"           "FirstLat"       "FirstLon"       "MaxLat"        
 [9] "MaxLon"         "LastLat"        "LastLon"        "MaxInt"        
[13] "Type_label"     "Type_new"       "Type_new_label"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for complete cases</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>complete_data <span class="ot">&lt;-</span> hurricanes[<span class="fu">complete.cases</span>(hurricanes), ]</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Original observations:"</span>, <span class="fu">nrow</span>(hurricanes), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Original observations: 337 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Complete observations:"</span>, <span class="fu">nrow</span>(complete_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Complete observations: 337 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Observations with missing data:"</span>, <span class="fu">nrow</span>(hurricanes) <span class="sc">-</span> <span class="fu">nrow</span>(complete_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Observations with missing data: 0 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify numeric vs categorical variables</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variable types:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Variable types:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hurricanes)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   337 obs. of  15 variables:
 $ RowNames      : chr  "1" "2" "3" "4" ...
 $ Number        : num  430 432 433 436 437 438 440 441 445 449 ...
 $ Name          : chr  "NOTNAMED" "NOTNAMED" "NOTNAMED" "NOTNAMED" ...
 $ Year          : num  1944 1944 1944 1944 1944 ...
 $ Type          : num  1 0 0 0 0 1 0 1 0 0 ...
 $ FirstLat      : num  30.2 25.6 14.2 20.8 20 29.2 16.1 27.6 21.6 19 ...
 $ FirstLon      : num  -76.1 -74.9 -65.2 -58 -84.2 -55.8 -80.8 -85.6 -95.2 -56.6 ...
 $ MaxLat        : num  32.1 31 16.6 26.3 20.6 38 21.9 27.6 28.6 24.9 ...
 $ MaxLon        : num  -74.8 -78.1 -72.2 -72.3 -84.9 -53.2 -82.9 -85.6 -96.1 -79.6 ...
 $ LastLat       : num  35.1 32.6 20.6 42.1 19.1 50 28.4 31.7 29.5 28.9 ...
 $ LastLon       : num  -69.2 -78.2 -88.5 -71.5 -93.9 -46.5 -82.1 -79.1 -96 -81.8 ...
 $ MaxInt        : num  80 80 105 120 70 85 105 100 120 120 ...
 $ Type_label    : Factor w/ 3 levels "tropical-only",..: 2 1 1 1 1 2 1 2 1 1 ...
 $ Type_new      : num  1 0 0 0 0 1 0 1 0 0 ...
 $ Type_new_label: Factor w/ 2 levels "Tropical","Non-Tropical": 2 1 1 1 1 2 1 2 1 1 ...</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit full model with all relevant predictors</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude:  Type (original), Type_label, Type_new_label (derived variables)</span></span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude: ID variables if any</span></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Fitting Full Model with All Predictors ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Fitting Full Model with All Predictors ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model (adjust based on actual variable names in your data)</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">glm</span>(Type_new <span class="sc">~</span> Year <span class="sc">+</span> FirstLat <span class="sc">+</span> FirstLon <span class="sc">+</span> MaxLat <span class="sc">+</span> </span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>                    MaxLon <span class="sc">+</span> LastLat <span class="sc">+</span> LastLon <span class="sc">+</span> MaxInt, </span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> hurricanes, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Type_new ~ Year + FirstLat + FirstLon + MaxLat + 
    MaxLon + LastLat + LastLon + MaxInt, family = binomial(link = "logit"), 
    data = hurricanes)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -68.867885  21.600778  -3.188  0.00143 ** 
Year          0.032430   0.010829   2.995  0.00275 ** 
FirstLat      0.504068   0.084320   5.978 2.26e-09 ***
FirstLon     -0.069127   0.038204  -1.809  0.07038 .  
MaxLat       -0.036082   0.075211  -0.480  0.63141    
MaxLon        0.049806   0.044782   1.112  0.26605    
LastLat      -0.140099   0.047633  -2.941  0.00327 ** 
LastLon       0.049084   0.023491   2.090  0.03666 *  
MaxInt        0.004503   0.010491   0.429  0.66778    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 463.11  on 336  degrees of freedom
Residual deviance: 193.96  on 328  degrees of freedom
AIC: 211.96

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Model Selection using Stepwise AIC ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Model Selection using Stepwise AIC ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Backward selection using AIC</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>model_backward <span class="ot">&lt;-</span> <span class="fu">step</span>(model_full, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">trace =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=211.96
Type_new ~ Year + FirstLat + FirstLon + MaxLat + MaxLon + LastLat + 
    LastLon + MaxInt

           Df Deviance    AIC
- MaxInt    1   194.14 210.14
- MaxLat    1   194.19 210.19
- MaxLon    1   195.23 211.23
&lt;none&gt;          193.96 211.96
- FirstLon  1   197.58 213.58
- LastLon   1   198.58 214.58
- Year      1   203.35 219.35
- LastLat   1   204.18 220.18
- FirstLat  1   248.21 264.21

Step:  AIC=210.14
Type_new ~ Year + FirstLat + FirstLon + MaxLat + MaxLon + LastLat + 
    LastLon

           Df Deviance    AIC
- MaxLat    1   194.31 208.31
- MaxLon    1   195.32 209.32
&lt;none&gt;          194.14 210.14
- FirstLon  1   197.62 211.62
- LastLon   1   198.61 212.61
- Year      1   203.54 217.54
- LastLat   1   204.27 218.27
- FirstLat  1   257.82 271.82

Step:  AIC=208.31
Type_new ~ Year + FirstLat + FirstLon + MaxLon + LastLat + LastLon

           Df Deviance    AIC
- MaxLon    1   195.35 207.35
&lt;none&gt;          194.31 208.31
- FirstLon  1   197.63 209.63
- LastLon   1   199.10 211.10
- Year      1   203.68 215.68
- LastLat   1   212.94 224.94
- FirstLat  1   326.91 338.91

Step:  AIC=207.35
Type_new ~ Year + FirstLat + FirstLon + LastLat + LastLon

           Df Deviance    AIC
&lt;none&gt;          195.35 207.35
- FirstLon  1   198.12 208.12
- Year      1   205.31 215.31
- LastLon   1   206.91 216.91
- LastLat   1   218.92 228.92
- FirstLat  1   389.77 399.77</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Best Model (Backward Selection) ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Best Model (Backward Selection) ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_backward)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Type_new ~ Year + FirstLat + FirstLon + LastLat + 
    LastLon, family = binomial(link = "logit"), data = hurricanes)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -70.40240   21.51235  -3.273  0.00107 ** 
Year          0.03327    0.01080   3.081  0.00206 ** 
FirstLat      0.48766    0.06026   8.093 5.83e-16 ***
FirstLon     -0.03484    0.02115  -1.647  0.09952 .  
LastLat      -0.15749    0.03536  -4.453 8.45e-06 ***
LastLon       0.06222    0.01952   3.187  0.00144 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 463.11  on 336  degrees of freedom
Residual deviance: 195.35  on 331  degrees of freedom
AIC: 207.35

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward selection starting from simple model</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>model_forward <span class="ot">&lt;-</span> <span class="fu">step</span>(model_simple, </span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> model_simple, <span class="at">upper =</span> model_full),</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">trace =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=236.03
Type_new ~ FirstLat

           Df Deviance    AIC
+ LastLat   1   219.10 225.10
+ Year      1   220.99 226.99
+ MaxLat    1   223.79 229.79
+ MaxInt    1   227.11 233.11
&lt;none&gt;          232.03 236.03
+ FirstLon  1   231.37 237.37
+ LastLon   1   231.98 237.98
+ MaxLon    1   231.99 237.99

Step:  AIC=225.1
Type_new ~ FirstLat + LastLat

           Df Deviance    AIC
+ LastLon   1   207.55 215.55
+ Year      1   208.86 216.86
+ MaxLon    1   211.67 219.67
+ FirstLon  1   216.33 224.33
&lt;none&gt;          219.10 225.10
+ MaxInt    1   217.95 225.95
+ MaxLat    1   218.77 226.77

Step:  AIC=215.55
Type_new ~ FirstLat + LastLat + LastLon

           Df Deviance    AIC
+ Year      1   198.12 208.12
+ FirstLon  1   205.31 215.31
&lt;none&gt;          207.55 215.55
+ MaxLon    1   207.41 217.41
+ MaxInt    1   207.54 217.54
+ MaxLat    1   207.55 217.55

Step:  AIC=208.12
Type_new ~ FirstLat + LastLat + LastLon + Year

           Df Deviance    AIC
+ FirstLon  1   195.35 207.35
&lt;none&gt;          198.12 208.12
+ MaxLon    1   197.63 209.63
+ MaxInt    1   198.07 210.07
+ MaxLat    1   198.09 210.09

Step:  AIC=207.35
Type_new ~ FirstLat + LastLat + LastLon + Year + FirstLon

         Df Deviance    AIC
&lt;none&gt;        195.35 207.35
+ MaxLon  1   194.31 208.31
+ MaxInt  1   195.27 209.27
+ MaxLat  1   195.32 209.32</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Best Model (Forward Selection) ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Best Model (Forward Selection) ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_forward)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Type_new ~ FirstLat + LastLat + LastLon + Year + 
    FirstLon, family = binomial(link = "logit"), data = hurricanes)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -70.40240   21.51235  -3.273  0.00107 ** 
FirstLat      0.48766    0.06026   8.093 5.83e-16 ***
LastLat      -0.15749    0.03536  -4.453 8.45e-06 ***
LastLon       0.06222    0.01952   3.187  0.00144 ** 
Year          0.03327    0.01080   3.081  0.00206 ** 
FirstLon     -0.03484    0.02115  -1.647  0.09952 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 463.11  on 336  degrees of freedom
Residual deviance: 195.35  on 331  degrees of freedom
AIC: 207.35

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Both directions</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>model_both <span class="ot">&lt;-</span> <span class="fu">step</span>(model_simple,</span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> model_simple, <span class="at">upper =</span> model_full),</span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=236.03
Type_new ~ FirstLat

           Df Deviance    AIC
+ LastLat   1   219.10 225.10
+ Year      1   220.99 226.99
+ MaxLat    1   223.79 229.79
+ MaxInt    1   227.11 233.11
&lt;none&gt;          232.03 236.03
+ FirstLon  1   231.37 237.37
+ LastLon   1   231.98 237.98
+ MaxLon    1   231.99 237.99

Step:  AIC=225.1
Type_new ~ FirstLat + LastLat

           Df Deviance    AIC
+ LastLon   1   207.55 215.55
+ Year      1   208.86 216.86
+ MaxLon    1   211.67 219.67
+ FirstLon  1   216.33 224.33
&lt;none&gt;          219.10 225.10
+ MaxInt    1   217.95 225.95
+ MaxLat    1   218.77 226.77
- LastLat   1   232.03 236.03

Step:  AIC=215.55
Type_new ~ FirstLat + LastLat + LastLon

           Df Deviance    AIC
+ Year      1   198.12 208.12
+ FirstLon  1   205.31 215.31
&lt;none&gt;          207.55 215.55
+ MaxLon    1   207.41 217.41
+ MaxInt    1   207.54 217.54
+ MaxLat    1   207.55 217.55
- LastLon   1   219.10 225.10
- LastLat   1   231.98 237.98

Step:  AIC=208.12
Type_new ~ FirstLat + LastLat + LastLon + Year

           Df Deviance    AIC
+ FirstLon  1   195.35 207.35
&lt;none&gt;          198.12 208.12
+ MaxLon    1   197.63 209.63
+ MaxInt    1   198.07 210.07
+ MaxLat    1   198.09 210.09
- Year      1   207.55 215.55
- LastLon   1   208.86 216.86
- LastLat   1   220.93 228.93

Step:  AIC=207.35
Type_new ~ FirstLat + LastLat + LastLon + Year + FirstLon

           Df Deviance    AIC
&lt;none&gt;          195.35 207.35
- FirstLon  1   198.12 208.12
+ MaxLon    1   194.31 208.31
+ MaxInt    1   195.27 209.27
+ MaxLat    1   195.32 209.32
- Year      1   205.31 215.31
- LastLon   1   206.91 216.91
- LastLat   1   218.92 228.92</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Best Model (Stepwise Both Directions) ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Best Model (Stepwise Both Directions) ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_both)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Type_new ~ FirstLat + LastLat + LastLon + Year + 
    FirstLon, family = binomial(link = "logit"), data = hurricanes)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -70.40240   21.51235  -3.273  0.00107 ** 
FirstLat      0.48766    0.06026   8.093 5.83e-16 ***
LastLat      -0.15749    0.03536  -4.453 8.45e-06 ***
LastLon       0.06222    0.01952   3.187  0.00144 ** 
Year          0.03327    0.01080   3.081  0.00206 ** 
FirstLon     -0.03484    0.02115  -1.647  0.09952 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 463.11  on 336  degrees of freedom
Residual deviance: 195.35  on 331  degrees of freedom
AIC: 207.35

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Model Comparison ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Model Comparison ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Simple model AIC:"</span>, <span class="fu">AIC</span>(model_simple), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple model AIC: 236.0302 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Full model AIC:"</span>, <span class="fu">AIC</span>(model_full), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Full model AIC: 211.9574 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Backward selection AIC:"</span>, <span class="fu">AIC</span>(model_backward), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Backward selection AIC: 207.3478 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Forward selection AIC:"</span>, <span class="fu">AIC</span>(model_forward), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Forward selection AIC: 207.3478 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Stepwise both AIC:"</span>, <span class="fu">AIC</span>(model_both), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stepwise both AIC: 207.3478 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose best model</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> model_backward  <span class="co"># or whichever has lowest AIC</span></span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Final Best Model Summary ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Final Best Model Summary ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(best_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Type_new ~ Year + FirstLat + FirstLon + LastLat + 
    LastLon, family = binomial(link = "logit"), data = hurricanes)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -70.40240   21.51235  -3.273  0.00107 ** 
Year          0.03327    0.01080   3.081  0.00206 ** 
FirstLat      0.48766    0.06026   8.093 5.83e-16 ***
FirstLon     -0.03484    0.02115  -1.647  0.09952 .  
LastLat      -0.15749    0.03536  -4.453 8.45e-06 ***
LastLon       0.06222    0.01952   3.187  0.00144 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 463.11  on 336  degrees of freedom
Residual deviance: 195.35  on 331  degrees of freedom
AIC: 207.35

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>f. Check if there is overdispersion in the model. Take it into account if there is.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">What is overdispersion?</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
What is overdispersion?</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- In logistic regression, the variance should equal μ(1-μ)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- In logistic regression, the variance should equal μ(1-μ)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Overdispersion occurs when actual variance &gt; expected variance</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Overdispersion occurs when actual variance &gt; expected variance</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- This can happen due to:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- This can happen due to:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  * Missing important predictors</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  * Missing important predictors</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  * Clustering in data</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  * Clustering in data</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  * Outliers or extreme values</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  * Outliers or extreme values</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Overdispersion leads to underestimated standard errors</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Overdispersion leads to underestimated standard errors</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  and inflated significance tests</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  and inflated significance tests</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate dispersion parameter</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>residual_deviance_best <span class="ot">&lt;-</span> best_model<span class="sc">$</span>deviance</span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>df_residual_best <span class="ot">&lt;-</span> best_model<span class="sc">$</span>df.residual</span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>dispersion_param <span class="ot">&lt;-</span> residual_deviance_best <span class="sc">/</span> df_residual_best</span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-6"><a href="#cb343-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Dispersion Check ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Dispersion Check ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Residual Deviance:"</span>, <span class="fu">round</span>(residual_deviance_best, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Residual Deviance: 195.3478 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Residual df:"</span>, df_residual_best, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Residual df: 331 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Dispersion Parameter (φ):"</span>, <span class="fu">round</span>(dispersion_param, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dispersion Parameter (φ): 0.5902 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"INTERPRETATION:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>INTERPRETATION:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- If φ ≈ 1:  No overdispersion (good! )</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- If φ ≈ 1:  No overdispersion (good! )</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- If φ &gt; 1: Overdispersion present</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- If φ &gt; 1: Overdispersion present</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- If φ &gt;&gt; 1 (e.g., &gt; 2-3): Serious overdispersion</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- If φ &gt;&gt; 1 (e.g., &gt; 2-3): Serious overdispersion</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (dispersion_param <span class="sc">&gt;</span> <span class="fl">1.5</span>) {</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"RESULT: Overdispersion detected (φ ="</span>, <span class="fu">round</span>(dispersion_param, <span class="dv">4</span>), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"ACTION REQUIRED: Adjust for overdispersion</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Formal test for overdispersion</span></span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=== Formal Test for Overdispersion ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Chi-square test</span></span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a>  p_value_overdisp <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(residual_deviance_best, df_residual_best, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"H0: No overdispersion (deviance follows chi-square distribution)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Test statistic (deviance):"</span>, <span class="fu">round</span>(residual_deviance_best, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-12"><a href="#cb359-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"df:"</span>, df_residual_best, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-13"><a href="#cb359-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">format.pval</span>(p_value_overdisp), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-14"><a href="#cb359-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-15"><a href="#cb359-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p_value_overdisp <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb359-16"><a href="#cb359-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Conclusion:  SIGNIFICANT overdispersion (p &lt; 0.05)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb359-17"><a href="#cb359-17" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb359-18"><a href="#cb359-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Conclusion: No significant evidence of overdispersion</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb359-19"><a href="#cb359-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb359-20"><a href="#cb359-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-21"><a href="#cb359-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjust for overdispersion using quasi-binomial</span></span>
<span id="cb359-22"><a href="#cb359-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=== Fitting Quasi-Binomial Model ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-23"><a href="#cb359-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"This accounts for overdispersion by estimating φ from the data</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb359-24"><a href="#cb359-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-25"><a href="#cb359-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Refit best model with quasi-binomial family</span></span>
<span id="cb359-26"><a href="#cb359-26" aria-hidden="true" tabindex="-1"></a>  formula_best <span class="ot">&lt;-</span> <span class="fu">formula</span>(best_model)</span>
<span id="cb359-27"><a href="#cb359-27" aria-hidden="true" tabindex="-1"></a>  model_quasi <span class="ot">&lt;-</span> <span class="fu">glm</span>(formula_best,</span>
<span id="cb359-28"><a href="#cb359-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> hurricanes,</span>
<span id="cb359-29"><a href="#cb359-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">quasibinomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb359-30"><a href="#cb359-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-31"><a href="#cb359-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(model_quasi)</span>
<span id="cb359-32"><a href="#cb359-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-33"><a href="#cb359-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Comparison:  Binomial vs Quasi-Binomial ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb359-34"><a href="#cb359-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-35"><a href="#cb359-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compare coefficients (should be the same)</span></span>
<span id="cb359-36"><a href="#cb359-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Coefficients (should be identical):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-37"><a href="#cb359-37" aria-hidden="true" tabindex="-1"></a>  comp_coef <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb359-38"><a href="#cb359-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">Binomial =</span> <span class="fu">coef</span>(best_model),</span>
<span id="cb359-39"><a href="#cb359-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">QuasiBinomial =</span> <span class="fu">coef</span>(model_quasi)</span>
<span id="cb359-40"><a href="#cb359-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb359-41"><a href="#cb359-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(comp_coef, <span class="dv">4</span>))</span>
<span id="cb359-42"><a href="#cb359-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-43"><a href="#cb359-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compare standard errors (quasi should be larger)</span></span>
<span id="cb359-44"><a href="#cb359-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standard Errors (quasi should be larger):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-45"><a href="#cb359-45" aria-hidden="true" tabindex="-1"></a>  se_binomial <span class="ot">&lt;-</span> <span class="fu">summary</span>(best_model)<span class="sc">$</span>coefficients[, <span class="st">"Std. Error"</span>]</span>
<span id="cb359-46"><a href="#cb359-46" aria-hidden="true" tabindex="-1"></a>  se_quasi <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_quasi)<span class="sc">$</span>coefficients[, <span class="st">"Std. Error"</span>]</span>
<span id="cb359-47"><a href="#cb359-47" aria-hidden="true" tabindex="-1"></a>  comp_se <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb359-48"><a href="#cb359-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">Binomial =</span> se_binomial,</span>
<span id="cb359-49"><a href="#cb359-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">QuasiBinomial =</span> se_quasi,</span>
<span id="cb359-50"><a href="#cb359-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ratio =</span> se_quasi <span class="sc">/</span> se_binomial</span>
<span id="cb359-51"><a href="#cb359-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb359-52"><a href="#cb359-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(comp_se, <span class="dv">4</span>))</span>
<span id="cb359-53"><a href="#cb359-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-54"><a href="#cb359-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">The ratio shows how much the SE increased to account for overdispersion.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-55"><a href="#cb359-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Standard errors inflated by factor of:"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(dispersion_param), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb359-56"><a href="#cb359-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-57"><a href="#cb359-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compare p-values</span></span>
<span id="cb359-58"><a href="#cb359-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"P-values comparison:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-59"><a href="#cb359-59" aria-hidden="true" tabindex="-1"></a>  p_binomial <span class="ot">&lt;-</span> <span class="fu">summary</span>(best_model)<span class="sc">$</span>coefficients[, <span class="st">"Pr(&gt;|z|)"</span>]</span>
<span id="cb359-60"><a href="#cb359-60" aria-hidden="true" tabindex="-1"></a>  p_quasi <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_quasi)<span class="sc">$</span>coefficients[, <span class="st">"Pr(&gt;|t|)"</span>]</span>
<span id="cb359-61"><a href="#cb359-61" aria-hidden="true" tabindex="-1"></a>  comp_p <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb359-62"><a href="#cb359-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Binomial =</span> p_binomial,</span>
<span id="cb359-63"><a href="#cb359-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">QuasiBinomial =</span> p_quasi,</span>
<span id="cb359-64"><a href="#cb359-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">Significant_Binomial =</span> p_binomial <span class="sc">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb359-65"><a href="#cb359-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">Significant_Quasi =</span> p_quasi <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb359-66"><a href="#cb359-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb359-67"><a href="#cb359-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(comp_p)</span>
<span id="cb359-68"><a href="#cb359-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-69"><a href="#cb359-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== RECOMMENDATION ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-70"><a href="#cb359-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Since overdispersion is present, USE THE QUASI-BINOMIAL MODEL</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-71"><a href="#cb359-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"for inference (hypothesis tests, confidence intervals).</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-72"><a href="#cb359-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"The quasi-binomial model provides more conservative (and more accurate)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-73"><a href="#cb359-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"standard errors and p-values.</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb359-74"><a href="#cb359-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-75"><a href="#cb359-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save the final model</span></span>
<span id="cb359-76"><a href="#cb359-76" aria-hidden="true" tabindex="-1"></a>  final_model <span class="ot">&lt;-</span> model_quasi</span>
<span id="cb359-77"><a href="#cb359-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Final model:  Quasi-binomial with dispersion parameter"</span>, </span>
<span id="cb359-78"><a href="#cb359-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">summary</span>(model_quasi)<span class="sc">$</span>dispersion, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-79"><a href="#cb359-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-80"><a href="#cb359-80" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb359-81"><a href="#cb359-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"RESULT: No substantial overdispersion (φ ="</span>, <span class="fu">round</span>(dispersion_param, <span class="dv">4</span>), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-82"><a href="#cb359-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"The standard binomial logistic regression is appropriate.</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb359-83"><a href="#cb359-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-84"><a href="#cb359-84" aria-hidden="true" tabindex="-1"></a>  final_model <span class="ot">&lt;-</span> best_model</span>
<span id="cb359-85"><a href="#cb359-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Final model: Standard binomial logistic regression</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb359-86"><a href="#cb359-86" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>RESULT: No substantial overdispersion (φ = 0.5902 )
The standard binomial logistic regression is appropriate.

Final model: Standard binomial logistic regression</code></pre>
</div>
</div>
</section>
<section id="problem-4" class="level2">
<h2 class="anchored" data-anchor-id="problem-4">Problem 4</h2>
<p>Given the dataset <code>Default</code> with 4 variables. The goal is to build a logistic regression model to predict <code>default</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.1     ✔ stringr   1.5.2
✔ lubridate 1.9.4     ✔ tibble    3.3.0
✔ purrr     1.1.0     ✔ tidyr     1.3.1
✔ readr     2.1.6     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
✖ dplyr::recode() masks car::recode()
✖ MASS::select()  masks dplyr::select()
✖ purrr::some()   masks car::some()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Default)</span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Default)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  default student   balance    income
1      No      No  729.5265 44361.625
2      No     Yes  817.1804 12106.135
3      No      No 1073.5492 31767.139
4      No      No  529.2506 35704.494
5      No      No  785.6559 38463.496
6      No     Yes  919.5885  7491.559</code></pre>
</div>
</div>
<section id="a.-explore-the-relationship-between-default-and-other-variables-income-balance-student.-you-may-create-some-scatterplots-and-boxplots." class="level4">
<h4 class="anchored" data-anchor-id="a.-explore-the-relationship-between-default-and-other-variables-income-balance-student.-you-may-create-some-scatterplots-and-boxplots.">a. Explore the relationship between <code>default</code> and other variables (<code>income</code>, <code>balance</code>, <code>student</code>). You may create some scatterplots, and boxplots.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Distribution of Response Variable</span></span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Default, <span class="fu">aes</span>(<span class="at">x =</span> default, <span class="at">fill =</span> default)) <span class="sc">+</span></span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">'count'</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(count)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#00BA38"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#F8766D"</span>)) <span class="sc">+</span></span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Credit Default"</span>,</span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Default Status"</span>,</span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb369-11"><a href="#cb369-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-12"><a href="#cb369-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP4_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>The green bar completely dominates the chart</p></li>
<li><p>The red bar is barely visible in comparison</p></li>
<li><p>The scale difference is dramatic (~9,667 vs 333)</p></li>
</ul>
<p>This chart reveals a <strong>severely imbalanced dataset</strong> where defaults are rare (only 3.33%). While most customers are responsible, identifying the risky minority is critical for bank profitability. The extreme imbalance means standard accuracy metrics are misleading, and we must focus on sensitivity and use appropriate threshold selection to balance the business costs of false positives versus false negatives. With only 333 default cases, our model will have limited power to detect complex interactions, but should still effectively identify high-risk customers based on balance and other key predictors</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Default Rate by Student Status</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>student_default <span class="ot">&lt;-</span> Default <span class="sc">%&gt;%</span></span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(student, default) <span class="sc">%&gt;%</span></span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(student) <span class="sc">%&gt;%</span></span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count))</span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(student_default)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
# Groups:   student [2]
  student default count proportion
  &lt;fct&gt;   &lt;fct&gt;   &lt;int&gt;      &lt;dbl&gt;
1 No      No       6850     0.971 
2 No      Yes       206     0.0292
3 Yes     No       2817     0.957 
4 Yes     Yes       127     0.0431</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Default, <span class="fu">aes</span>(<span class="at">x =</span> student, <span class="at">fill =</span> default)) <span class="sc">+</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#00BA38"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#F8766D"</span>)) <span class="sc">+</span></span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Default Rate by Student Status"</span>,</span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Student"</span>,</span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Default"</span>) <span class="sc">+</span></span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP4_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>The <strong>red portion (defaults)</strong> is visibly <strong>larger</strong> for students (right bar)</p></li>
<li><p>The <strong>green portion (non-defaults)</strong> is slightly smaller for students</p></li>
<li><p>Both bars reach 100% (proportion = 1.0), making it easy to compare rates</p></li>
</ul>
<p>The crude comparison shows students have a 48% higher default rate (4.31% vs 2.92%, p &lt; 0.001). However, this crude association is likely confounded by students’ higher average credit card balances and lower incomes. In the multivariable logistic regression, after controlling for balance and income, we expect the student coefficient to reverse direction, showing that students actually have LOWER odds of default at the same debt and income levels. This is a classic example of Simpson’s Paradox, where a confounding variable (balance) masks the true relationship. The implication is that student status itself is not a risk factor; rather, it’s a marker for different financial circumstances that can be directly addressed through credit limit management.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Boxplots:  Balance by Default Status</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Balance Distribution by Default ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Balance Distribution by Default ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Default, <span class="fu">aes</span>(<span class="at">x =</span> default, <span class="at">y =</span> balance, <span class="at">fill =</span> default)) <span class="sc">+</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#00BA38"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#F8766D"</span>)) <span class="sc">+</span></span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Credit Card Balance by Default Status"</span>,</span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Default Status"</span>,</span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Balance ($)"</span>) <span class="sc">+</span></span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP4_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical test</span></span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"t-test for balance by default:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>t-test for balance by default:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">t.test</span>(balance <span class="sc">~</span> default, <span class="at">data =</span> Default))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  balance by default
t = -48.984, df = 374.14, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group No and group Yes is not equal to 0
95 percent confidence interval:
 -981.7670 -905.9889
sample estimates:
 mean in group No mean in group Yes 
         803.9438         1747.8217 </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Boxplots: Income by Default Status</span></span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Income Distribution by Default ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Income Distribution by Default ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Default, <span class="fu">aes</span>(<span class="at">x =</span> default, <span class="at">y =</span> income, <span class="at">fill =</span> default)) <span class="sc">+</span></span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#00BA38"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#F8766D"</span>)) <span class="sc">+</span></span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Annual Income by Default Status"</span>,</span>
<span id="cb382-5"><a href="#cb382-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Default Status"</span>,</span>
<span id="cb382-6"><a href="#cb382-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Income ($)"</span>) <span class="sc">+</span></span>
<span id="cb382-7"><a href="#cb382-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb382-8"><a href="#cb382-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb382-9"><a href="#cb382-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-10"><a href="#cb382-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p4)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP4_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical test</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"t-test for income by default:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>t-test for income by default:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">t.test</span>(income <span class="sc">~</span> default, <span class="at">data =</span> Default))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  income by default
t = 1.922, df = 353.62, p-value = 0.05541
alternative hypothesis: true difference in means between group No and group Yes is not equal to 0
95 percent confidence interval:
  -34.38335 2988.42235
sample estimates:
 mean in group No mean in group Yes 
         33566.17          32089.15 </code></pre>
</div>
</div>
<p><strong>Non-Defaulters (Green Box - Left):</strong></p>
<ul>
<li><p><strong>Median</strong>: ~$750 (dark horizontal line)</p></li>
<li><p><strong>IQR (box)</strong>: ~$400 to ~$1,100</p></li>
<li><p><strong>Whiskers</strong>: Extend to ~$0 and ~$2,200</p></li>
<li><p><strong>Outliers</strong>: A few black dots above $2,200 (high balance but didn’t default)</p></li>
<li><p><strong>Distribution</strong>: Lower, more compressed</p></li>
</ul>
<p><strong>Defaulters (Red/Pink Box - Right):</strong></p>
<ul>
<li><p><strong>Median</strong>: ~$1,800 (dark horizontal line)</p></li>
<li><p><strong>IQR (box)</strong>: ~$1,450 to ~$2,000</p></li>
<li><p><strong>Whiskers</strong>: Extend to ~$1,000 and ~$2,200</p></li>
<li><p><strong>Outliers</strong>: A few black dots below $750 (low balance but still defaulted - rare!)</p></li>
<li><p><strong>Distribution</strong>: Higher, more compressed at top</p></li>
</ul>
<p>Credit card balance is by far the strongest predictor of default in this dataset. Defaulters have mean balance of $1,748 compared to $804 for non-defaulters - a difference of $944 (117% higher). This difference is extraordinarily statistically significant (t = -48.98, p &lt; 2.2e-16). The boxplots show almost complete separation between groups, with defaulters’ balances clustering around $1,500-$2,000 while non-defaulters center around $700-$800. There appears to be a critical threshold around $1,000-$1,500, above which default risk increases dramatically. In the logistic regression model, balance will dominate other predictors and drive most of the classification accuracy. The practical implication is that credit card companies should focus intensively on monitoring and managing customer balances, as this single metric provides exceptional predictive power for default risk.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Boxplots: Balance by Student Status</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Default, <span class="fu">aes</span>(<span class="at">x =</span> student, <span class="at">y =</span> balance, <span class="at">fill =</span> student)) <span class="sc">+</span></span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#619CFF"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#F564E3"</span>)) <span class="sc">+</span></span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Balance by Student Status"</span>,</span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Student"</span>,</span>
<span id="cb387-7"><a href="#cb387-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Balance ($)"</span>) <span class="sc">+</span></span>
<span id="cb387-8"><a href="#cb387-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb387-9"><a href="#cb387-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb387-10"><a href="#cb387-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-11"><a href="#cb387-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p5)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP4_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Non-Students (Blue Box - Left)</strong></p>
<p><strong>Central Tendency:</strong></p>
<ul>
<li><p><strong>Median</strong>: ~$750 (thick horizontal black line in middle of box)</p></li>
<li><p>Position: Lower third of the balance range</p></li>
</ul>
<p><strong>Spread (Interquartile Range - IQR):</strong></p>
<ul>
<li><p><strong>25th percentile (Q1)</strong>: ~$400 (bottom of box)</p></li>
<li><p><strong>75th percentile (Q3)</strong>: ~$1,100 (top of box)</p></li>
<li><p><strong>IQR</strong>: ~$700 (height of the blue box)</p></li>
</ul>
<p><strong>Whiskers (Range):</strong></p>
<ul>
<li><p><strong>Lower whisker</strong>: non-students with unusually high balances</p></li>
<li><p>Approximately 10-15 outlier points visible</p></li>
</ul>
<p><strong>Distribution characteristics:</strong></p>
<ul>
<li><p><strong>Center:</strong> Lower (median ~$750)</p></li>
<li><p><strong>Spread:</strong> Moderate variability</p></li>
<li><p><strong>Shape:</strong> Right-skewed (outliers on high end)</p></li>
</ul>
<p><strong>Students (Pink/Magenta Box - Right)</strong></p>
<p><strong>Box (Interquartile Range):</strong></p>
<ul>
<li><p><strong>Lower quartile (Q1):</strong> ~$650</p></li>
<li><p><strong>Median (dark line):</strong> ~$1,000</p></li>
<li><p><strong>Upper quartile (Q3):</strong> ~$1,400</p></li>
<li><p><strong>IQR:</strong> ~$750 ($1,400 - $650)</p></li>
</ul>
<p><strong>Whiskers:</strong></p>
<ul>
<li><p><strong>Lower whisker:</strong> Extends down to ~$0</p></li>
<li><p><strong>Upper whisker:</strong> Extends up to ~$2,300</p></li>
</ul>
<p><strong>Outliers:</strong></p>
<ul>
<li><p><strong>Several black dots above upper whisker</strong> (~$2,300 - $2,650)</p></li>
<li><p>Fewer outliers than non-students (approximately 5-8 points)</p></li>
<li><p>But they reach similar maximum values</p></li>
</ul>
<p><strong>Distribution characteristics:</strong></p>
<ul>
<li><p><strong>Center:</strong> Higher (median ~$1,000)</p></li>
<li><p><strong>Spread:</strong> Similar variability to non-students</p></li>
<li><p><strong>Shape:</strong> Also right-skewed</p></li>
</ul>
<p>Students carry significantly higher credit card balances than non-students (median $1,000 vs $750, p &lt; 0.001). This $250 difference in median balance explains why students have a higher crude default rate (4.31% vs 2.92%) - balance is the mechanism through which student status affects default risk. However, the substantial overlap in balance distributions between groups, and the presence of high-balance individuals in both populations, suggests that balance itself is the critical predictor rather than student status per se. In the multivariable logistic regression, after controlling for balance and income, we expect the student coefficient to be negative, indicating that at the same balance level, students are actually less likely to default. This plot provides visual evidence of the confounding relationship that creates Simpson’s Paradox in this dataset.</p>
</section>
<section id="b.-check-if-two-ways-and-three-way-interactions-are-significant." class="level4">
<h4 class="anchored" data-anchor-id="b.-check-if-two-ways-and-three-way-interactions-are-significant.">b. Check if two-ways and three-way interactions are significant.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert default to numeric for modeling (Yes = 1, No = 0)</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>Default<span class="sc">$</span>default_numeric <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Default<span class="sc">$</span>default <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Base model (main effects only)</span></span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Model 1: Main Effects Only ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Model 1: Main Effects Only ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb390"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a>model_main <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> student <span class="sc">+</span> balance <span class="sc">+</span> income,</span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> Default,</span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-5"><a href="#cb390-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_main)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = default ~ student + balance + income, family = binomial(link = "logit"), 
    data = Default)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.087e+01  4.923e-01 -22.080  &lt; 2e-16 ***
studentYes  -6.468e-01  2.363e-01  -2.738  0.00619 ** 
balance      5.737e-03  2.319e-04  24.738  &lt; 2e-16 ***
income       3.033e-06  8.203e-06   0.370  0.71152    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2920.6  on 9999  degrees of freedom
Residual deviance: 1571.5  on 9996  degrees of freedom
AIC: 1579.5

Number of Fisher Scoring iterations: 8</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC (Main Effects):"</span>, <span class="fu">AIC</span>(model_main), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC (Main Effects): 1579.545 </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: student * balance</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Model 2: Main Effects + student: balance ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Model 2: Main Effects + student: balance ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a>model_student_balance <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> student <span class="sc">+</span> balance <span class="sc">+</span> income <span class="sc">+</span> student<span class="sc">:</span>balance,</span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> Default,</span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-5"><a href="#cb396-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_student_balance)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = default ~ student + balance + income + student:balance, 
    family = binomial(link = "logit"), data = Default)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        -1.099e+01  5.667e-01 -19.399   &lt;2e-16 ***
studentYes         -2.856e-01  8.239e-01  -0.347    0.729    
balance             5.817e-03  2.938e-04  19.801   &lt;2e-16 ***
income              3.016e-06  8.226e-06   0.367    0.714    
studentYes:balance -2.184e-04  4.781e-04  -0.457    0.648    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2920.6  on 9999  degrees of freedom
Residual deviance: 1571.3  on 9995  degrees of freedom
AIC: 1581.3

Number of Fisher Scoring iterations: 8</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(model_student_balance), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 1581.338 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test significance of interaction</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test for student:balance interaction:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test for student:balance interaction:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>anova_sb <span class="ot">&lt;-</span> <span class="fu">anova</span>(model_main, model_student_balance, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anova_sb)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: default ~ student + balance + income
Model 2: default ~ student + balance + income + student:balance
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1      9996     1571.5                     
2      9995     1571.3  1  0.20712    0.649</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>The effect of balance on default <strong>does NOT differ significantly</strong> between students and non-students</p></li>
<li><p>Students and non-students show similar balance-to-default relationships</p></li>
<li><p>The coefficient is tiny (-0.000218) and statistically insignificant</p></li>
</ul>
<p><strong>What this means:</strong></p>
<ul>
<li><p>❌ <strong>HYPOTHESIS REJECTED</strong>: “Balance affects students differently”</p></li>
<li><p>✅ Balance has a <strong>universal effect</strong> across both groups</p></li>
<li><p>For every $1,000 increase in balance, the odds multiply by the same factor for students and non-students</p></li>
<li><p>No evidence that students are more/less sensitive to high balances</p></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3: student * income</span></span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Model 3: Main Effects + student:income ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Model 3: Main Effects + student:income ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a>model_student_income <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> student <span class="sc">+</span> balance <span class="sc">+</span> income <span class="sc">+</span> student<span class="sc">:</span>income,</span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> Default,</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_student_income)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = default ~ student + balance + income + student:income, 
    family = binomial(link = "logit"), data = Default)

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       -1.081e+01  5.031e-01 -21.495   &lt;2e-16 ***
studentYes        -9.343e-01  6.067e-01  -1.540    0.124    
balance            5.737e-03  2.319e-04  24.736   &lt;2e-16 ***
income             1.644e-06  8.633e-06   0.190    0.849    
studentYes:income  1.429e-05  2.772e-05   0.516    0.606    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2920.6  on 9999  degrees of freedom
Residual deviance: 1571.3  on 9995  degrees of freedom
AIC: 1581.3

Number of Fisher Scoring iterations: 8</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(model_student_income), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 1581.279 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test significance</span></span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test for student:income interaction:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test for student:income interaction:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>anova_si <span class="ot">&lt;-</span> <span class="fu">anova</span>(model_main, model_student_income, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anova_si)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: default ~ student + balance + income
Model 2: default ~ student + balance + income + student:income
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1      9996     1571.5                     
2      9995     1571.3  1  0.26628   0.6058</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>The effect of income on default <strong>does NOT differ</strong> between students and non-students</p></li>
<li><p>Income is already a weak predictor (main effect p = 0.712)</p></li>
<li><p>Adding interaction makes it no better</p></li>
</ul>
<p><strong>What this means:</strong></p>
<ul>
<li><p>❌ <strong>HYPOTHESIS REJECTED</strong>: “Income affects students differently”</p></li>
<li><p>✅ Income has <strong>minimal effect</strong> for everyone</p></li>
<li><p>No evidence that students benefit more/less from higher income</p></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4: balance * income</span></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Model 4: Main Effects + balance:income ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Model 4: Main Effects + balance:income ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a>model_balance_income <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> student <span class="sc">+</span> balance <span class="sc">+</span> income <span class="sc">+</span> balance<span class="sc">:</span>income,</span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> Default,</span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-5"><a href="#cb416-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_balance_income)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = default ~ student + balance + income + balance:income, 
    family = binomial(link = "logit"), data = Default)

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -1.055e+01  9.904e-01 -10.650  &lt; 2e-16 ***
studentYes     -6.338e-01  2.384e-01  -2.659  0.00784 ** 
balance         5.532e-03  5.943e-04   9.309  &lt; 2e-16 ***
income         -6.884e-06  2.797e-05  -0.246  0.80556    
balance:income  6.325e-09  1.703e-08   0.371  0.71035    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2920.6  on 9999  degrees of freedom
Residual deviance: 1571.4  on 9995  degrees of freedom
AIC: 1581.4

Number of Fisher Scoring iterations: 8</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb418"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(model_balance_income), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 1581.407 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test significance</span></span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test for balance:income interaction:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test for balance:income interaction:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb422"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a>anova_bi <span class="ot">&lt;-</span> <span class="fu">anova</span>(model_main, model_balance_income, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anova_bi)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: default ~ student + balance + income
Model 2: default ~ student + balance + income + balance:income
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1      9996     1571.5                     
2      9995     1571.4  1  0.13827     0.71</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>The joint effect of balance and income <strong>does NOT exist</strong></p></li>
<li><p>Balance effect doesn’t depend on income level</p></li>
<li><p>No evidence of debt-to-income ratio mattering</p></li>
</ul>
<p><strong>What this means:</strong></p>
<ul>
<li><p>❌ <strong>HYPOTHESIS REJECTED</strong>: “High balance is worse at low income”</p></li>
<li><p>✅ Balance effect is <strong>constant across income levels</strong></p></li>
<li><p>The coefficient is essentially zero (6.3 × 10⁻⁹)</p></li>
</ul>
<p><strong>Practical implication:</strong></p>
<ul>
<li><p>Debt-to-income ratio doesn’t add predictive value</p></li>
<li><p>Balance alone captures the risk, regardless of income</p></li>
<li><p>This is surprising but clear in the data</p></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 5: All two-way interactions</span></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Model 5: All Two-Way Interactions ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Model 5: All Two-Way Interactions ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a>model_all_2way <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> student <span class="sc">*</span> balance <span class="sc">+</span> student <span class="sc">*</span> income <span class="sc">+</span> balance <span class="sc">*</span> income,</span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> Default,</span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-5"><a href="#cb426-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_all_2way)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = default ~ student * balance + student * income + 
    balance * income, family = binomial(link = "logit"), data = Default)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        -1.104e+01  1.866e+00  -5.914 3.33e-09 ***
studentYes         -5.201e-01  1.344e+00  -0.387    0.699    
balance             5.882e-03  1.180e-03   4.983 6.27e-07 ***
income              4.050e-06  4.459e-05   0.091    0.928    
studentYes:balance -2.551e-04  7.905e-04  -0.323    0.747    
studentYes:income   1.447e-05  2.779e-05   0.521    0.602    
balance:income     -1.579e-09  2.815e-08  -0.056    0.955    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2920.6  on 9999  degrees of freedom
Residual deviance: 1571.1  on 9993  degrees of freedom
AIC: 1585.1

Number of Fisher Scoring iterations: 8</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(model_all_2way), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 1585.066 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test significance</span></span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test for all two-way interactions:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test for all two-way interactions:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a>anova_all2 <span class="ot">&lt;-</span> <span class="fu">anova</span>(model_main, model_all_2way, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anova_all2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: default ~ student + balance + income
Model 2: default ~ student * balance + student * income + balance * income
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1      9996     1571.5                     
2      9993     1571.1  3  0.47911   0.9235</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>Even testing all three interactions <strong>jointly</strong> shows no significance</p></li>
<li><p>p = 0.923 means there’s a 92% chance we’d see this improvement by random chance alone</p></li>
<li><p>AIC increases by <strong>5.5 points</strong> - substantially worse model</p></li>
<li><p>Adding 3 parameters provides essentially <strong>zero improvement</strong></p></li>
</ul>
<p><strong>What this means:</strong></p>
<ul>
<li><p>❌ <strong>NO INTERACTIONS ARE NEEDED</strong></p></li>
<li><p>Main effects model is clearly superior</p></li>
<li><p>Interactions only add noise and complexity</p></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb434"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6: Three-way interaction</span></span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Model 6: Three-Way Interaction ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Model 6: Three-Way Interaction ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a>model_3way <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> student <span class="sc">*</span> balance <span class="sc">*</span> income,</span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> Default,</span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb436-4"><a href="#cb436-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-5"><a href="#cb436-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_3way)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = default ~ student * balance * income, family = binomial(link = "logit"), 
    data = Default)

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.083e+01  1.962e+00  -5.521 3.37e-08 ***
studentYes                -1.536e+00  3.397e+00  -0.452    0.651    
balance                    5.750e-03  1.244e-03   4.622 3.80e-06 ***
income                    -9.887e-07  4.718e-05  -0.021    0.983    
studentYes:balance         3.548e-04  2.032e-03   0.175    0.861    
studentYes:income          6.366e-05  1.531e-04   0.416    0.678    
balance:income             1.664e-09  2.986e-08   0.056    0.956    
studentYes:balance:income -2.930e-08  8.970e-08  -0.327    0.744    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2920.6  on 9999  degrees of freedom
Residual deviance: 1571.0  on 9992  degrees of freedom
AIC: 1587

Number of Fisher Scoring iterations: 8</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(model_3way), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 1586.959 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test significance of three-way interaction</span></span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test for three-way interaction:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test for three-way interaction:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb442"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a>anova_3way <span class="ot">&lt;-</span> <span class="fu">anova</span>(model_all_2way, model_3way, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anova_3way)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: default ~ student * balance + student * income + balance * income
Model 2: default ~ student * balance * income
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1      9993     1571.1                     
2      9992     1571.0  1  0.10661    0.744</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also compare to main effects</span></span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Three-way model vs main effects only:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Three-way model vs main effects only:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb446"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a>anova_3way_main <span class="ot">&lt;-</span> <span class="fu">anova</span>(model_main, model_3way, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anova_3way_main)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: default ~ student + balance + income
Model 2: default ~ student * balance * income
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1      9996     1571.5                     
2      9992     1571.0  4  0.58572   0.9646</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>The three-way interaction is <strong>completely insignificant</strong></p></li>
<li><p>p = 0.965 is about as far from significant as possible</p></li>
<li><p>AIC = 1587.0 is the <strong>worst</strong> of all models tested</p></li>
<li><p>The coefficient is infinitesimally small (-2.93 × 10⁻⁸)</p></li>
</ul>
<p><strong>What this means:</strong></p>
<ul>
<li><p>❌ <strong>STRONGLY REJECT THREE-WAY INTERACTION</strong></p></li>
<li><p>No evidence that the balance-income relationship differs for students</p></li>
<li><p>This complex interaction adds nothing but overfitting</p></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Summary of Interaction Tests ---</span></span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">=== SUMMARY OF INTERACTION TESTS ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>

=== SUMMARY OF INTERACTION TESTS ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb450"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a>interaction_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Interaction =</span> <span class="fu">c</span>(<span class="st">"student:balance"</span>, <span class="st">"student:income"</span>, <span class="st">"balance:income"</span>, </span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"All 2-way"</span>, <span class="st">"3-way"</span>),</span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(model_student_balance), <span class="fu">AIC</span>(model_student_income), </span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">AIC</span>(model_balance_income), <span class="fu">AIC</span>(model_all_2way), <span class="fu">AIC</span>(model_3way)),</span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> <span class="fu">c</span>(</span>
<span id="cb450-7"><a href="#cb450-7" aria-hidden="true" tabindex="-1"></a>    anova_sb<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chi)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb450-8"><a href="#cb450-8" aria-hidden="true" tabindex="-1"></a>    anova_si<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chi)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb450-9"><a href="#cb450-9" aria-hidden="true" tabindex="-1"></a>    anova_bi<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chi)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb450-10"><a href="#cb450-10" aria-hidden="true" tabindex="-1"></a>    anova_all2<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chi)</span><span class="st">`</span>[<span class="dv">2</span>],</span>
<span id="cb450-11"><a href="#cb450-11" aria-hidden="true" tabindex="-1"></a>    anova_3way_main<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chi)</span><span class="st">`</span>[<span class="dv">2</span>]</span>
<span id="cb450-12"><a href="#cb450-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb450-13"><a href="#cb450-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Significant =</span> <span class="fu">c</span>(</span>
<span id="cb450-14"><a href="#cb450-14" aria-hidden="true" tabindex="-1"></a>    anova_sb<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chi)</span><span class="st">`</span>[<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb450-15"><a href="#cb450-15" aria-hidden="true" tabindex="-1"></a>    anova_si<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chi)</span><span class="st">`</span>[<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb450-16"><a href="#cb450-16" aria-hidden="true" tabindex="-1"></a>    anova_bi<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chi)</span><span class="st">`</span>[<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb450-17"><a href="#cb450-17" aria-hidden="true" tabindex="-1"></a>    anova_all2<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chi)</span><span class="st">`</span>[<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb450-18"><a href="#cb450-18" aria-hidden="true" tabindex="-1"></a>    anova_3way_main<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chi)</span><span class="st">`</span>[<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb450-19"><a href="#cb450-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb450-20"><a href="#cb450-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb450-21"><a href="#cb450-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-22"><a href="#cb450-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(interaction_summary)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Interaction      AIC   p_value Significant
1 student:balance 1581.338 0.6490372       FALSE
2  student:income 1581.279 0.6058392       FALSE
3  balance:income 1581.407 0.7100063       FALSE
4       All 2-way 1585.066 0.9234563       FALSE
5           3-way 1586.959 0.9646368       FALSE</code></pre>
</div>
</div>
<p><strong>Statistical Evidence:</strong></p>
<ul>
<li><p><strong>ALL p-values &gt; 0.60</strong> (none even close to 0.05 threshold)</p></li>
<li><p><strong>ALL AIC values INCREASE</strong> (worse fit when adding interactions)</p></li>
<li><p><strong>Deviance reductions are TINY</strong> (&lt; 1 point improvements)</p></li>
<li><p><strong>Main effects model is the BEST</strong> (lowest AIC = 1579.5)</p></li>
</ul>
<p><strong>None of the interactions are statistically significant:</strong></p>
<ol type="1">
<li><p><strong>student:balance interaction</strong>: Not significant (p = 0.649)</p>
<ul>
<li>The effect of balance on default does not differ between students and non-students</li>
</ul></li>
<li><p><strong>student:income interaction</strong>: Not significant (p = 0.606)</p>
<ul>
<li>The effect of income on default does not differ between students and non-students</li>
</ul></li>
<li><p><strong>balance:income interaction</strong>: Not significant (p = 0.710)</p>
<ul>
<li><p>The effect of balance on default does not depend on income level</p></li>
<li><p>No evidence of debt-to-income ratio effect</p></li>
</ul></li>
<li><p><strong>All two-way interactions jointly</strong>: Not significant (p = 0.923)</p>
<ul>
<li>Even testing all three together shows no improvement</li>
</ul></li>
<li><p><strong>Three-way interaction</strong>: Not significant (p = 0.744 for 3-way term alone, p = 0.965 comparing to main effects)</p>
<ul>
<li>The most complex interaction adds nothing</li>
</ul></li>
</ol>
<p><strong>Model selection:</strong> The <strong>main effects model</strong> is clearly best:</p>
<ul>
<li><p>Lowest AIC (1579.5)</p></li>
<li><p>All interaction models have higher (worse) AIC</p></li>
<li><p>Simple, interpretable, and adequate</p></li>
</ul>
<p>c. Choose the best model (including interactions if they are significant). Interpret the coefficient estimate of model.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare all models</span></span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== AIC Comparison of All Models ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== AIC Comparison of All Models ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a>model_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Main Effects"</span>, <span class="st">"student: balance"</span>, <span class="st">"student:income"</span>, </span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">"balance:income"</span>, <span class="st">"All 2-way"</span>, <span class="st">"3-way"</span>),</span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Formula =</span> <span class="fu">c</span>(<span class="st">"~ student + balance + income"</span>,</span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"~ student + balance + income + student:balance"</span>,</span>
<span id="cb454-6"><a href="#cb454-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">"~ student + balance + income + student: income"</span>,</span>
<span id="cb454-7"><a href="#cb454-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">"~ student + balance + income + balance:income"</span>,</span>
<span id="cb454-8"><a href="#cb454-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">"~ student * balance + student * income + balance * income"</span>,</span>
<span id="cb454-9"><a href="#cb454-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">"~ student * balance * income"</span>),</span>
<span id="cb454-10"><a href="#cb454-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_Parameters =</span> <span class="fu">c</span>(<span class="fu">length</span>(<span class="fu">coef</span>(model_main)),</span>
<span id="cb454-11"><a href="#cb454-11" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">length</span>(<span class="fu">coef</span>(model_student_balance)),</span>
<span id="cb454-12"><a href="#cb454-12" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">length</span>(<span class="fu">coef</span>(model_student_income)),</span>
<span id="cb454-13"><a href="#cb454-13" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">length</span>(<span class="fu">coef</span>(model_balance_income)),</span>
<span id="cb454-14"><a href="#cb454-14" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">length</span>(<span class="fu">coef</span>(model_all_2way)),</span>
<span id="cb454-15"><a href="#cb454-15" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">length</span>(<span class="fu">coef</span>(model_3way))),</span>
<span id="cb454-16"><a href="#cb454-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(model_main), <span class="fu">AIC</span>(model_student_balance), <span class="fu">AIC</span>(model_student_income),</span>
<span id="cb454-17"><a href="#cb454-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">AIC</span>(model_balance_income), <span class="fu">AIC</span>(model_all_2way), <span class="fu">AIC</span>(model_3way)),</span>
<span id="cb454-18"><a href="#cb454-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Deviance =</span> <span class="fu">c</span>(<span class="fu">deviance</span>(model_main), <span class="fu">deviance</span>(model_student_balance),</span>
<span id="cb454-19"><a href="#cb454-19" aria-hidden="true" tabindex="-1"></a>               <span class="fu">deviance</span>(model_student_income), <span class="fu">deviance</span>(model_balance_income),</span>
<span id="cb454-20"><a href="#cb454-20" aria-hidden="true" tabindex="-1"></a>               <span class="fu">deviance</span>(model_all_2way), <span class="fu">deviance</span>(model_3way)),</span>
<span id="cb454-21"><a href="#cb454-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Pseudo_R2 =</span> <span class="fu">c</span>(</span>
<span id="cb454-22"><a href="#cb454-22" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">-</span> <span class="fu">deviance</span>(model_main) <span class="sc">/</span> model_main<span class="sc">$</span>null.deviance,</span>
<span id="cb454-23"><a href="#cb454-23" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">-</span> <span class="fu">deviance</span>(model_student_balance) <span class="sc">/</span> model_student_balance<span class="sc">$</span>null.deviance,</span>
<span id="cb454-24"><a href="#cb454-24" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">-</span> <span class="fu">deviance</span>(model_student_income) <span class="sc">/</span> model_student_income<span class="sc">$</span>null.deviance,</span>
<span id="cb454-25"><a href="#cb454-25" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">-</span> <span class="fu">deviance</span>(model_balance_income) <span class="sc">/</span> model_balance_income<span class="sc">$</span>null.deviance,</span>
<span id="cb454-26"><a href="#cb454-26" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">-</span> <span class="fu">deviance</span>(model_all_2way) <span class="sc">/</span> model_all_2way<span class="sc">$</span>null.deviance,</span>
<span id="cb454-27"><a href="#cb454-27" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">-</span> <span class="fu">deviance</span>(model_3way) <span class="sc">/</span> model_3way<span class="sc">$</span>null.deviance</span>
<span id="cb454-28"><a href="#cb454-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb454-29"><a href="#cb454-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb454-30"><a href="#cb454-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-31"><a href="#cb454-31" aria-hidden="true" tabindex="-1"></a>model_comparison <span class="ot">&lt;-</span> model_comparison[<span class="fu">order</span>(model_comparison<span class="sc">$</span>AIC), ]</span>
<span id="cb454-32"><a href="#cb454-32" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model_comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Model                                                   Formula
1     Main Effects                              ~ student + balance + income
3   student:income            ~ student + balance + income + student: income
2 student: balance            ~ student + balance + income + student:balance
4   balance:income             ~ student + balance + income + balance:income
5        All 2-way ~ student * balance + student * income + balance * income
6            3-way                              ~ student * balance * income
  N_Parameters      AIC Deviance Pseudo_R2
1            4 1579.545 1571.545 0.4619194
3            5 1581.279 1571.279 0.4620106
2            5 1581.338 1571.338 0.4619904
4            5 1581.407 1571.407 0.4619668
5            7 1585.066 1571.066 0.4620835
6            8 1586.959 1570.959 0.4621200</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">*** Best Model by AIC:"</span>, model_comparison<span class="sc">$</span>Model[<span class="dv">1</span>], <span class="st">"***</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
*** Best Model by AIC: Main Effects ***</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select best model</span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (model_comparison<span class="sc">$</span>Model[<span class="dv">1</span>] <span class="sc">==</span> <span class="st">"Main Effects"</span>) {</span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> model_main</span>
<span id="cb458-4"><a href="#cb458-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (model_comparison<span class="sc">$</span>Model[<span class="dv">1</span>] <span class="sc">==</span> <span class="st">"student:balance"</span>) {</span>
<span id="cb458-5"><a href="#cb458-5" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> model_student_balance</span>
<span id="cb458-6"><a href="#cb458-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (model_comparison<span class="sc">$</span>Model[<span class="dv">1</span>] <span class="sc">==</span> <span class="st">"student: income"</span>) {</span>
<span id="cb458-7"><a href="#cb458-7" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> model_student_income</span>
<span id="cb458-8"><a href="#cb458-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (model_comparison<span class="sc">$</span>Model[<span class="dv">1</span>] <span class="sc">==</span> <span class="st">"balance:income"</span>) {</span>
<span id="cb458-9"><a href="#cb458-9" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> model_balance_income</span>
<span id="cb458-10"><a href="#cb458-10" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (model_comparison<span class="sc">$</span>Model[<span class="dv">1</span>] <span class="sc">==</span> <span class="st">"All 2-way"</span>) {</span>
<span id="cb458-11"><a href="#cb458-11" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> model_all_2way</span>
<span id="cb458-12"><a href="#cb458-12" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb458-13"><a href="#cb458-13" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> model_3way</span>
<span id="cb458-14"><a href="#cb458-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb458-15"><a href="#cb458-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-16"><a href="#cb458-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Stepwise selection as alternative</span></span>
<span id="cb458-17"><a href="#cb458-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Stepwise Model Selection ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Stepwise Model Selection ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>model_stepwise <span class="ot">&lt;-</span> <span class="fu">step</span>(model_main, </span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> model_main, <span class="at">upper =</span> model_3way),</span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1579.54
default ~ student + balance + income

                  Df Deviance    AIC
&lt;none&gt;                 1571.5 1579.5
+ student:income   1   1571.3 1581.3
+ student:balance  1   1571.3 1581.3
+ balance:income   1   1571.4 1581.4</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb462"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Stepwise Selected Model ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Stepwise Selected Model ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb464"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_stepwise)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = default ~ student + balance + income, family = binomial(link = "logit"), 
    data = Default)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.087e+01  4.923e-01 -22.080  &lt; 2e-16 ***
studentYes  -6.468e-01  2.363e-01  -2.738  0.00619 ** 
balance      5.737e-03  2.319e-04  24.738  &lt; 2e-16 ***
income       3.033e-06  8.203e-06   0.370  0.71152    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2920.6  on 9999  degrees of freedom
Residual deviance: 1571.5  on 9996  degrees of freedom
AIC: 1579.5

Number of Fisher Scoring iterations: 8</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb466"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare stepwise with best by AIC</span></span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Comparison:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Comparison:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best by manual AIC:"</span>, model_comparison<span class="sc">$</span>Model[<span class="dv">1</span>], <span class="st">"- AIC ="</span>, </span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(model_comparison<span class="sc">$</span>AIC[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best by manual AIC: Main Effects - AIC = 1579.54 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb470"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Stepwise selected:  AIC ="</span>, <span class="fu">round</span>(<span class="fu">AIC</span>(model_stepwise), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stepwise selected:  AIC = 1579.54 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb472"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the best model</span></span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">AIC</span>(model_stepwise) <span class="sc">&lt;</span> <span class="fu">AIC</span>(best_model)) {</span>
<span id="cb472-3"><a href="#cb472-3" aria-hidden="true" tabindex="-1"></a>  final_model <span class="ot">&lt;-</span> model_stepwise</span>
<span id="cb472-4"><a href="#cb472-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Final Model:  Stepwise selected model</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb472-5"><a href="#cb472-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb472-6"><a href="#cb472-6" aria-hidden="true" tabindex="-1"></a>  final_model <span class="ot">&lt;-</span> best_model</span>
<span id="cb472-7"><a href="#cb472-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Final Model:"</span>, model_comparison<span class="sc">$</span>Model[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb472-8"><a href="#cb472-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Final Model: Main Effects </code></pre>
</div>
</div>
<p><strong>MODEL SELECTION</strong></p>
</section>
<section id="complete-model-comparison" class="level3">
<h3 class="anchored" data-anchor-id="complete-model-comparison"><strong>Complete Model Comparison</strong></h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Model</strong></th>
<th><strong>Formula</strong></th>
<th><strong>AIC</strong></th>
<th><strong>Rank</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Main Effects</strong> ✓</td>
<td><code>~ student + balance + income</code></td>
<td><strong>1579.54</strong></td>
<td><strong>1st (BEST)</strong></td>
</tr>
<tr class="even">
<td>student:income</td>
<td><code>~ student + balance + income + student:income</code></td>
<td>1581.28</td>
<td>2nd</td>
</tr>
<tr class="odd">
<td>student: balance</td>
<td><code>~ student + balance + income + student:balance</code></td>
<td>1581.34</td>
<td>3rd</td>
</tr>
<tr class="even">
<td>balance:income</td>
<td><code>~ student + balance + income + balance:income</code></td>
<td>1581.41</td>
<td>4th</td>
</tr>
<tr class="odd">
<td>All 2-way</td>
<td><code>~ student * balance + student * income + balance * income</code></td>
<td>1585.07</td>
<td>5th</td>
</tr>
<tr class="even">
<td>3-way</td>
<td><code>~ student * balance * income</code></td>
<td>1586.96</td>
<td>6th (WORST)</td>
</tr>
</tbody>
</table>
<pre><code>Start:  AIC = 1579.54
default ~ student + balance + income

Candidate additions:
  + student:income   → AIC = 1581.3  (WORSE)
  + student:balance  → AIC = 1581.3  (WORSE)
  + balance:income   → AIC = 1581.4  (WORSE)
  
Decision: &lt;none&gt; (keep main effects only) Stepwise selection confirms the main effects model is optimal.</code></pre>
<p>Final Model : Main effect - Model 1</p>
<ol type="1">
<li><p><strong>Balance is THE critical predictor</strong> (z = 24.7, p &lt; 0.001)</p>
<ul>
<li><p>Exponential relationship with default</p></li>
<li><p>$1,000 increase multiplies odds by 310</p></li>
<li><p>Explains 46% of deviance alone</p></li>
</ul></li>
<li><p><strong>Students are SAFER after adjustment</strong> (OR = 0.52, p = 0.006)</p>
<ul>
<li><p>Simpson’s Paradox: crude rate higher, adjusted rate lower</p></li>
<li><p>Family support likely explanation</p></li>
<li><p>Don’t discriminate against students!</p></li>
</ul></li>
<li><p><strong>Income doesn’t matter</strong> (p = 0.71)</p>
<ul>
<li><p>No significant effect after controlling for balance</p></li>
<li><p>Balance captures financial distress better</p></li>
<li><p>Could be dropped from model</p></li>
</ul></li>
<li><p><strong>No interactions needed</strong> (all p &gt; 0.60)</p>
<ul>
<li><p>Additive model is optimal</p></li>
<li><p>Universal risk assessment rules</p></li>
<li><p>Simpler is better!</p></li>
</ul></li>
<li><p><strong>Excellent model performance</strong></p>
<ul>
<li><p>Pseudo R² = 0.462 (exceptionally strong)</p></li>
<li><p>AIC = 1579.54 (best of all models)</p></li>
<li><p>High discrimination ability</p></li>
</ul></li>
</ol>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>