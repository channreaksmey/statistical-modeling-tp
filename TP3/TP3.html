<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Channreaksmey">

<title>TP3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="TP3_files/libs/clipboard/clipboard.min.js"></script>
<script src="TP3_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="TP3_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="TP3_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="TP3_files/libs/quarto-html/popper.min.js"></script>
<script src="TP3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="TP3_files/libs/quarto-html/anchor.min.js"></script>
<link href="TP3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="TP3_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="TP3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="TP3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="TP3_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TP3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Channreaksmey </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="tp3---multiple-linear-regression" class="level1">
<h1>TP3 - Multiple Linear Regression</h1>
<section id="problem-1" class="level2">
<h2 class="anchored" data-anchor-id="problem-1">Problem 1</h2>
<p>(Data file: water) For this problem, consider the regression problem with response BSAAM, and three predictors as regressors given by OPBPC, OPRC, and OPSLAKE.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: car</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: effects</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>lattice theme set by effectsTheme()
See ?effectsTheme for details.</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(water)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(water)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Year APMAM APSAB APSLAKE OPBPC  OPRC OPSLAKE  BSAAM
1 1948  9.13  3.58    3.91  4.10  7.43    6.47  54235
2 1949  5.28  4.82    5.20  7.55 11.11   10.26  67567
3 1950  4.20  3.77    3.67  9.52 12.20   11.35  66161
4 1951  4.60  4.46    3.93 11.14 15.15   11.13  68094
5 1952  7.15  4.99    4.88 16.34 20.05   22.81 107080
6 1953  9.70  5.65    4.91  8.88  8.15    7.41  67594</code></pre>
</div>
</div>
<section id="examine-the-scatterplot-matrix-drawn-for-these-three-regressors-and-the-response.-what-should-the-correlation-matrix-look-like-i.e.-which-correlations-are-large-and-positive-which-are-large-and-negative-and-which-are-small-compute-the-correlation-matrix-to-verify-your-results." class="level4">
<h4 class="anchored" data-anchor-id="examine-the-scatterplot-matrix-drawn-for-these-three-regressors-and-the-response.-what-should-the-correlation-matrix-look-like-i.e.-which-correlations-are-large-and-positive-which-are-large-and-negative-and-which-are-small-compute-the-correlation-matrix-to-verify-your-results.">1. Examine the scatterplot matrix drawn for these three regressors and the response. What should the correlation matrix look like (i.e., which correlations are large and positive, which are large and negative, and which are small?) Compute the correlation matrix to verify your results.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the variables of interest</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>water_dt <span class="ot">&lt;-</span> water[<span class="fu">c</span>(<span class="st">"BSAAM"</span>, <span class="st">"OPBPC"</span>, <span class="st">"OPRC"</span>, <span class="st">"OPSLAKE"</span>)]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatterplot matrix</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(water_dt,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Scatterplot Matrix: BSAAM vs Three Predictors"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Expected Correlations:</strong></p>
<p><strong>Correlations with BSAAM (Response Variable):</strong></p>
<p>Looking at the first row of scatterplots:</p>
<ol type="1">
<li><p><strong>BSAAM vs OPBPC</strong>: <strong>Large and Positive</strong> - Shows a strong upward linear trend</p></li>
<li><p><strong>BSAAM vs OPRC</strong>: <strong>Large and Positive</strong> - Shows a strong upward linear trend</p></li>
<li><p><strong>BSAAM vs OPSLAKE</strong>: <strong>Large and Positive</strong> - Shows a strong upward linear trend</p></li>
</ol>
<p><strong>Correlations Among Predictors:</strong></p>
<p>Looking at the lower triangle of the matrix:</p>
<ol type="1">
<li><strong>OPBPC vs OPRC</strong>: <strong>Large and Positive</strong> - Shows a strong upward linear relationship</li>
<li><strong>OPBPC vs OPSLAKE</strong>: <strong>Large and Positive</strong> - Shows a strong upward linear relationship</li>
<li><strong>OPRC vs OPSLAKE</strong>: <strong>Large and Positive</strong> - Shows a strong upward linear relationship</li>
</ol>
<p><strong>All correlations should be large and positive.</strong> Every scatterplot in the matrix shows a clear positive linear pattern with points clustering tightly around an upward-sloping line. This indicates:</p>
<ul>
<li><p>All three predictors (OPBPC, OPRC, OPSLAKE) are strongly positively correlated with the response (BSAAM)</p></li>
<li><p>All three predictors are also strongly positively correlated with each other, which suggests potential <strong>multicollinearity</strong> in the regression model</p></li>
</ul>
<p>Now run the correlation matrix computation in R to verify these observations numerically. You should expect to see correlation coefficients close to +1 (perhaps in the range of 0.85 to 0.99) for all pairs of variables.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(water_dt)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cor_matrix</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            BSAAM     OPBPC      OPRC   OPSLAKE
BSAAM   1.0000000 0.8857478 0.9196270 0.9384360
OPBPC   0.8857478 1.0000000 0.8647073 0.9433474
OPRC    0.9196270 0.8647073 1.0000000 0.9191447
OPSLAKE 0.9384360 0.9433474 0.9191447 1.0000000</code></pre>
</div>
</div>
</section>
<section id="get-the-regression-summary-for-the-regression-of-bsaam-on-these-three-regressors.-explain-what-the-p-value-columns-of-your-output-means." class="level4">
<h4 class="anchored" data-anchor-id="get-the-regression-summary-for-the-regression-of-bsaam-on-these-three-regressors.-explain-what-the-p-value-columns-of-your-output-means.">2. Get the regression summary for the regression of BSAAM on these three regressors. Explain what the “p-value” columns of your output means.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the regression model</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(BSAAM <span class="sc">~</span> OPBPC <span class="sc">+</span> OPRC <span class="sc">+</span> OPSLAKE, <span class="at">data =</span> water)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display regression summary</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>summary_model <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BSAAM ~ OPBPC + OPRC + OPSLAKE, data = water)

Residuals:
     Min       1Q   Median       3Q      Max 
-15964.1  -6491.8   -404.4   4741.9  19921.2 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 22991.85    3545.32   6.485  1.1e-07 ***
OPBPC          40.61     502.40   0.081  0.93599    
OPRC         1867.46     647.04   2.886  0.00633 ** 
OPSLAKE      2353.96     771.71   3.050  0.00410 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8304 on 39 degrees of freedom
Multiple R-squared:  0.9017,    Adjusted R-squared:  0.8941 
F-statistic: 119.2 on 3 and 39 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>What the “t value” column means:</strong></p>
<p>The <strong>t-value</strong> (or t-statistic) tests whether each regression coefficient is significantly different from zero, holding all other predictors constant in the model.</p>
<p><strong>Formula:</strong></p>
<pre><code>t-value = (Estimated Coefficient - 0) / Standard Error</code></pre>
<p>This tests the null hypothesis: <strong>H₀: β_1 = 0</strong> (the predictor has no linear effect on the response after accounting for other predictors)</p>
<p><strong>Interpretation for Each Coefficient:</strong></p>
<ol type="1">
<li><p><strong>Intercept: t = 6.485</strong></p>
<ul>
<li><p>Very large t-value with p &lt; 0.001 (highly significant ***)</p></li>
<li><p>Strong evidence that the intercept is significantly different from zero</p></li>
</ul></li>
<li><p><strong>OPBPC: t = 0.081</strong></p>
<ul>
<li><p>Very small t-value (close to 0) with p = 0.936 (not significant)</p></li>
<li><p><strong>Interpretation</strong>: After accounting for OPRC and OPSLAKE, OPBPC does not add significant predictive value to the model</p></li>
<li><p>Despite OPBPC being strongly correlated with BSAAM (from the scatterplot), it becomes non-significant in the multiple regression due to <strong>multicollinearity</strong> with the other predictors</p></li>
</ul></li>
<li><p><strong>OPRC: t = 2.886</strong></p>
<ul>
<li><p>Moderate t-value with p = 0.006 (significant **)</p></li>
<li><p>Strong evidence that OPRC has a significant positive effect on BSAAM, holding OPBPC and OPSLAKE constant</p></li>
<li><p>For each unit increase in OPRC, BSAAM increases by approximately 1867.46 units (on average)</p></li>
</ul></li>
<li><p><strong>OPSLAKE: t = 3.050</strong></p>
<ul>
<li><p>Moderate t-value with p = 0.004 (significant **)</p></li>
<li><p>Strong evidence that OPSLAKE has a significant positive effect on BSAAM, holding OPBPC and OPRC constant</p></li>
<li><p>For each unit increase in OPSLAKE, BSAAM increases by approximately 2353.96 units (on average)</p></li>
</ul></li>
</ol>
<p><strong>Key Insight:</strong></p>
<p>The large t-values (in absolute value) generally indicate <strong>statistical significance</strong>. A common rule of thumb is that |t| &gt; 2 suggests significance at approximately the 5% level. The associated <strong>p-value</strong> (Pr(&gt;|t|)) gives the exact probability of observing such an extreme t-value if the true coefficient were actually zero. Here, OPRC and OPSLAKE are significant predictors, while OPBPC is not, likely due to multicollinearity among the predictors.</p>
</section>
</section>
<section id="problem-2" class="level2">
<h2 class="anchored" data-anchor-id="problem-2">Problem 2</h2>
<p>Berkeley Guidance Study (Data file: BGSgirls) Data from the Berkeley Guidance Study on the growth of boys and girls. We will view body mass index at age 18 BMI18, as the response, and weights in kilogram at ages 2, 9, and 18, WT2, WT9, and WT18 as predictor.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"BGSgirls"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(BGSgirls)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    WT2  HT2  WT9   HT9  LG9 ST9 WT18  HT18 LG18 ST18 BMI18 Soma
67 13.6 87.7 32.5 133.4 28.4  74 56.9 158.9 34.6  143  22.5  5.0
68 11.3 90.0 27.8 134.8 26.9  65 49.9 166.0 33.8  117  18.1  4.0
69 17.0 89.6 44.4 141.5 31.9 104 55.3 162.2 35.1  143  21.0  5.5
70 13.2 90.3 40.5 137.1 31.8  79 65.9 167.8 39.3  148  23.4  5.5
71 13.3 89.4 29.9 136.1 27.7  83 62.3 170.9 36.3  152  21.3  4.5
72 11.3 85.5 22.8 130.6 23.4  60 47.4 164.9 31.8  126  17.4  3.0</code></pre>
</div>
</div>
<section id="obtain-the-scatterplot-matrix-for-these-four-variables.-define-which-predictor-variable-has-the-strongest-relationship-with-bmi18-and-what-can-you-say-about-it.-is-transformation-neccessary-in-this-case" class="level4">
<h4 class="anchored" data-anchor-id="obtain-the-scatterplot-matrix-for-these-four-variables.-define-which-predictor-variable-has-the-strongest-relationship-with-bmi18-and-what-can-you-say-about-it.-is-transformation-neccessary-in-this-case">1. Obtain the scatterplot matrix for these four variables. Define which predictor variable has the strongest relationship with BMI18 and what can you say about it. Is transformation neccessary in this case?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the variables of interest</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> BGSgirls[, <span class="fu">c</span>(<span class="st">"BMI18"</span>, <span class="st">"WT2"</span>, <span class="st">"WT9"</span>, <span class="st">"WT18"</span>)]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(vars,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Scatterplot Matrix: BMI18 vs Weight Variables"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looking at the first row of the scatterplot matrix (BMI18 vs.&nbsp;each predictor), <strong>WT18 has the strongest relationship with BMI18</strong>.</p>
<ul>
<li><p><strong>BMI18 vs WT2</strong>: Shows a weak positive relationship with considerable scatter</p></li>
<li><p><strong>BMI18 vs WT9</strong>: Shows a moderate positive relationship with moderate scatter</p></li>
<li><p><strong>BMI18 vs WT18</strong>: Shows the <strong>strongest positive linear relationship</strong> with points following a clear upward trend and less scatter compared to the other two predictors</p></li>
</ul>
<p><strong>What can we say about this relationship?</strong></p>
<ol type="1">
<li><p><strong>It makes biological sense</strong>: WT18 (weight at age 18) and BMI18 (BMI at age 18) are measured at the same time point. Since BMI is calculated as weight/height², it’s directly influenced by weight at that age.</p></li>
<li><p><strong>Strong positive association</strong>: As weight at age 18 increases, BMI at age 18 increases in a fairly consistent pattern.</p></li>
<li><p><strong>Linear pattern</strong>: The relationship appears approximately linear without obvious curvature.</p></li>
</ol>
<p><strong>Is transformation necessary?</strong></p>
<p><strong>No, transformation does not appear necessary</strong> based on these scatterplots because:</p>
<ol type="1">
<li><p><strong>Linearity</strong>: All three relationships (especially WT18) show reasonably linear patterns without major curvature</p></li>
<li><p><strong>No obvious heteroscedasticity</strong>: The spread of points appears relatively constant across the range of predictor values</p></li>
<li><p><strong>No extreme outliers</strong>: While there’s natural variability, there are no severe outliers that would distort the analysis</p></li>
</ol>
<p>However, we should still examine <strong>residual plots after fitting the regression model</strong> to confirm that transformation isn’t needed for meeting regression assumptions (constant variance, normality of errors).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Assessing whether transformation is needed for the regression model</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Assessing whether transformation is needed for the regression model</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model: BMI18 ~ WT2 + WT9 + WT18</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: BMI18 ~ WT2 + WT9 + WT18</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the initial regression model</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BMI18 <span class="sc">~</span> WT2 <span class="sc">+</span> WT9 <span class="sc">+</span> WT18, <span class="at">data =</span> BGSgirls)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up plotting area for 6 diagnostic plots</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Residuals vs Fitted Values</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(model1), <span class="fu">residuals</span>(model1),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Fitted Values"</span>, <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs Fitted"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(<span class="fu">fitted</span>(model1), <span class="fu">residuals</span>(model1)), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Zero line"</span>, <span class="st">"Lowess smooth"</span>), </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Normal Q-Q Plot</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(model1), <span class="at">main =</span> <span class="st">"Normal Q-Q Plot"</span>, </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(model1), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Scale-Location Plot (for homoscedasticity)</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(model1), <span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">rstandard</span>(model1))),</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Fitted Values"</span>, <span class="at">ylab =</span> <span class="st">"√|Standardized Residuals|"</span>,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Scale-Location"</span>,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(<span class="fu">fitted</span>(model1), <span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">rstandard</span>(model1)))), </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Residuals vs WT2</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(BGSgirls<span class="sc">$</span>WT2, <span class="fu">residuals</span>(model1),</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"WT2 (Weight at Age 2)"</span>, <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs WT2"</span>,</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(BGSgirls<span class="sc">$</span>WT2, <span class="fu">residuals</span>(model1)), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Residuals vs WT9</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(BGSgirls<span class="sc">$</span>WT9, <span class="fu">residuals</span>(model1),</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"WT9 (Weight at Age 9)"</span>, <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs WT9"</span>,</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(BGSgirls<span class="sc">$</span>WT9, <span class="fu">residuals</span>(model1)), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Residuals vs WT18</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(BGSgirls<span class="sc">$</span>WT18, <span class="fu">residuals</span>(model1),</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"WT18 (Weight at Age 18)"</span>, <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs WT18"</span>,</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(BGSgirls<span class="sc">$</span>WT18, <span class="fu">residuals</span>(model1)), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Analysis of Each Diagnostic Plot:</strong></p>
<p><strong>1. Residuals vs Fitted (Top Left):</strong></p>
<ul>
<li><p>Shows relatively <strong>random scatter</strong> around the zero line</p></li>
<li><p>No obvious funnel shape (variance appears fairly constant)</p></li>
<li><p>The lowess smooth line shows a <strong>slight upward curve</strong> at higher fitted values, suggesting minor non-linearity</p></li>
<li><p>Overall: Mostly acceptable, though not perfect</p></li>
</ul>
<p><strong>2. Normal Q-Q Plot (Top Middle):</strong></p>
<ul>
<li><p>Points follow the diagonal line <strong>very closely</strong></p></li>
<li><p>Both tails align well with the theoretical quantiles</p></li>
<li><p>No S-curve or heavy-tail departure</p></li>
<li><p>Overall: <strong>Excellent</strong> - residuals appear normally distributed</p></li>
</ul>
<p><strong>3. Scale-Location (Top Right):</strong></p>
<ul>
<li><p>Shows a <strong>slight U-shaped pattern</strong> with the red line</p></li>
<li><p>Suggests some <strong>mild heteroscedasticity</strong> (variance may not be perfectly constant)</p></li>
<li><p>The variance appears slightly lower in the middle range and higher at the extremes</p></li>
<li><p>Overall: Minor concern, but not severe</p></li>
</ul>
<p><strong>4. Residuals vs WT2 (Bottom Left):</strong></p>
<ul>
<li><p>Fairly <strong>random scatter</strong> around zero</p></li>
<li><p>Lowess line is relatively flat</p></li>
<li><p>Overall: Acceptable</p></li>
</ul>
<p><strong>5. Residuals vs WT9 (Bottom Middle):</strong></p>
<ul>
<li><p><strong>Random scatter</strong> with no clear pattern</p></li>
<li><p>Lowess line is nearly horizontal</p></li>
<li><p>Overall: Good</p></li>
</ul>
<p><strong>6. Residuals vs WT18 (Bottom Right):</strong></p>
<ul>
<li><p>Lowess line shows an <strong>upward curve</strong> at higher values</p></li>
<li><p>Suggests the relationship might not be perfectly linear at extreme values</p></li>
<li><p>Overall: Minor non-linearity concern</p></li>
</ul>
<p><strong>FINAL CONCLUSION: Transformation is NOT Strictly Necessary</strong></p>
<p>Justification:</p>
<p><strong>Strengths:</strong></p>
<ol type="1">
<li><p><strong>Excellent normality</strong> - Q-Q plot is nearly perfect</p></li>
<li><p><strong>No severe heteroscedasticity</strong> - variance is relatively stable</p></li>
<li><p><strong>Generally random patterns</strong> - no major systematic issues</p></li>
<li><p><strong>Reasonable linearity</strong> - relationships are predominantly linear</p></li>
</ol>
<p><strong>Minor Issues:</strong></p>
<ol type="1">
<li><p>Slight non-linearity at extreme values (visible in Residuals vs Fitted and vs WT18)</p></li>
<li><p>Mild heteroscedasticity (U-shape in Scale-Location)</p></li>
</ol>
<p><strong>Recommendation:</strong></p>
<p><strong>Transformation is NOT required</strong> because:</p>
<ul>
<li><p>The violations of assumptions are <strong>minor and not severe</strong></p></li>
<li><p>The model assumptions are <strong>adequately satisfied</strong> for practical purposes</p></li>
<li><p>Normality is excellent, which is most important for inference</p></li>
<li><p>Any transformation might not substantially improve the model and could complicate interpretation</p></li>
</ul>
<p><strong>However</strong>, the more important issue here is <strong>multicollinearity</strong> (which we’ll see in Questions 2-3), not the need for transformation. The orthogonal polynomial transformation in Question 4 addresses the multicollinearity problem, not assumption violations.</p>
</section>
<section id="comment-on-the-correlation-among-the-predictor-variables." class="level4">
<h4 class="anchored" data-anchor-id="comment-on-the-correlation-among-the-predictor-variables.">2. Comment on the correlation among the predictor variables.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix for predictors only</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>correlations <span class="ot">&lt;-</span> <span class="fu">cor</span>(vars, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>pred_corr <span class="ot">&lt;-</span> correlations[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize correlations</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(pred_corr, <span class="at">method =</span> <span class="st">"number"</span>, <span class="at">type =</span> <span class="st">"upper"</span>, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Correlation Among Predictors"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Correlation Matrix Summary:</strong></p>
<p>The correlation matrix reveals the following relationships among the three predictor variables:</p>
<ul>
<li><p><strong>WT2 and WT9</strong>: r = 0.69 (strong positive correlation)</p></li>
<li><p><strong>WT2 and WT18</strong>: r = 0.39 (moderate positive correlation)</p></li>
<li><p><strong>WT9 and WT18</strong>: r = 0.69 (strong positive correlation)</p></li>
</ul>
<p><strong>Comments on Predictor Correlations:</strong></p>
<ol type="1">
<li><p><strong>High correlations indicate multicollinearity</strong>: All three predictors are positively correlated with each other, with correlations ranging from 0.39 to 0.69. This is substantial and indicates the presence of multicollinearity.</p></li>
<li><p><strong>Biological explanation</strong>: These high correlations make sense because:</p>
<ul>
<li><p>They all measure the same characteristic (weight) for the same individuals</p></li>
<li><p>Children who are heavier at age 2 tend to remain heavier at ages 9 and 18</p></li>
<li><p>Weight measurements track together over time due to genetic, metabolic, and lifestyle factors</p></li>
</ul></li>
<li><p><strong>Strongest correlations</strong>:</p>
<ul>
<li><p>WT2-WT9 (r = 0.69) and WT9-WT18 (r = 0.69) show the strongest correlations</p></li>
<li><p>WT2-WT18 (r = 0.39) is somewhat weaker, likely because there’s more time (16 years) between these measurements, allowing for more individual variation in growth patterns</p></li>
</ul></li>
<li><p><strong>Implications for regression</strong>:</p>
<ul>
<li><p>This multicollinearity will make it difficult to separate the individual effects of each weight measurement on BMI18</p></li>
<li><p>Coefficient estimates may be unstable with large standard errors</p></li>
<li><p>Signs of coefficients might be counterintuitive or unexpected</p></li>
<li><p>This explains why we’ll need the orthogonal polynomial transformation in Question 4 to address this issue</p></li>
</ul></li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate VIF</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model1)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"VIF values for each predictor:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>VIF values for each predictor:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"------------------------------</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>------------------------------</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(vif_values)) {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%-6s: VIF = %7.3f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">names</span>(vif_values)[i], vif_values[i]))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>WT2   : VIF =   1.977
WT9   : VIF =   3.211
WT18  : VIF =   1.975</code></pre>
</div>
</div>
<p>The predictor variables (WT2, WT9, WT18) show <strong>moderate positive correlations</strong> with each other:</p>
<ol type="1">
<li><p><strong>VIF values range from 1.98 to 3.21</strong> - all within acceptable limits (&lt; 5)</p></li>
<li><p><strong>WT9 has the highest VIF (3.21)</strong>, indicating it’s most strongly related to the other predictors</p></li>
<li><p><strong>49-69% of each predictor’s variance</strong> can be explained by the other two predictors</p></li>
<li><p><strong>Standard errors are inflated by 41-79%</strong> due to multicollinearity</p></li>
<li><p>While <strong>not severe</strong>, this multicollinearity contributes to the unexpected signs and non-significance seen in Question 3</p></li>
<li><p>The <strong>orthogonal transformation in Question 4</strong> will further reduce multicollinearity and improve interpretability</p></li>
</ol>
<p><strong>Conclusion:</strong> Multicollinearity is present at a moderate level but is <strong>acceptable for analysis</strong>. The correlations reflect the biological reality that weight measurements track together over time. However, the transformed model (Question 4) will provide clearer interpretations.</p>
</section>
<section id="obtain-the-summary-table-for-the-multiple-linear-regression-with-the-three-predictors.-interpret-the-beta_j-coefficients-obtained-from-the-model.-do-the-results-make-sense" class="level4">
<h4 class="anchored" data-anchor-id="obtain-the-summary-table-for-the-multiple-linear-regression-with-the-three-predictors.-interpret-the-beta_j-coefficients-obtained-from-the-model.-do-the-results-make-sense">3. Obtain the summary table for the multiple linear regression with the three predictors. Interpret the <span class="math inline">\(\beta_j\)</span> coefficients obtained from the model. Do the results make sense?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BMI18 ~ WT2 + WT9 + WT18, data = BGSgirls)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1037 -0.7432 -0.1240  0.8320  4.3485 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.30978    1.65517   5.020 4.16e-06 ***
WT2         -0.38663    0.15145  -2.553    0.013 *  
WT9          0.03141    0.04937   0.636    0.527    
WT18         0.28745    0.02603  11.044  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.333 on 66 degrees of freedom
Multiple R-squared:  0.7772,    Adjusted R-squared:  0.767 
F-statistic: 76.73 on 3 and 66 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Summary Table Interpretation:</strong></p>
<p><strong>Model:</strong> BMI18 = 8.310 - 0.387(WT2) + 0.031(WT9) + 0.287(WT18)</p>
<p><strong>Interpretation of β Coefficients:</strong></p>
<p><strong>1. Intercept (β₀ = 8.310):</strong></p>
<ul>
<li><p>When WT2 = WT9 = WT18 = 0, the predicted BMI18 is 8.310</p></li>
<li><p>Not practically meaningful (weights cannot be zero)</p></li>
<li><p>Highly significant (p &lt; 0.001)</p></li>
</ul>
<p><strong>2. WT2 Coefficient (β₁ = -0.387):</strong></p>
<ul>
<li><p><strong>Interpretation:</strong> Holding WT9 and WT18 constant, a 1 kg increase in weight at age 2 is associated with a <strong>decrease</strong> of 0.387 units in BMI18</p></li>
<li><p><strong>Statistical significance:</strong> p = 0.013 (significant at α = 0.05)</p></li>
<li><p><strong>Sign:</strong> NEGATIVE</p></li>
</ul>
<p><strong>3. WT9 Coefficient (β₂ = 0.031):</strong></p>
<ul>
<li><p><strong>Interpretation:</strong> Holding WT2 and WT18 constant, a 1 kg increase in weight at age 9 is associated with an increase of 0.031 units in BMI18</p></li>
<li><p><strong>Statistical significance:</strong> p = 0.527 (NOT significant)</p></li>
<li><p><strong>Sign:</strong> Positive, but coefficient is very small and not significant</p></li>
<li><p><strong>Meaning:</strong> WT9 contributes almost nothing after accounting for WT2 and WT18</p></li>
</ul>
<p><strong>4. WT18 Coefficient (β₃ = 0.287):</strong></p>
<ul>
<li><p><strong>Interpretation:</strong> Holding WT2 and WT9 constant, a 1 kg increase in weight at age 18 is associated with an increase of 0.287 units in BMI18</p></li>
<li><p><strong>Statistical significance:</strong> p &lt; 2×10⁻¹⁶ (extremely significant ***)</p></li>
<li><p><strong>Sign:</strong> POSITIVE</p></li>
<li><p><strong>This makes biological sense</strong> - higher weight at age 18 leads to higher BMI at age 18</p></li>
</ul>
<p><strong>Model Fit Statistics:</strong></p>
<ul>
<li><p><strong>R² = 0.7772:</strong> The model explains 77.72% of the variation in BMI18</p></li>
<li><p><strong>Adjusted R² = 0.767:</strong> Adjusted for number of predictors (still very high)</p></li>
<li><p><strong>F-statistic = 76.73, p &lt; 2.2×10⁻¹⁶:</strong> The overall model is highly significant</p></li>
<li><p><strong>Residual Standard Error = 1.333:</strong> Average prediction error is about 1.33 BMI units</p></li>
</ul>
<p><strong>Do the Results Make Sense?</strong></p>
<p><strong>NO, the results do NOT make sense!</strong></p>
<p>Why the Results are Counterintuitive:</p>
<p><strong>1. Negative coefficient for WT2:</strong></p>
<ul>
<li><p>We would expect that heavier babies grow into adults with higher BMI</p></li>
<li><p>A <strong>negative</strong> relationship is biologically implausible</p></li>
<li><p>It suggests that heavier 2-year-olds have <strong>lower</strong> BMI at age 18 (holding other weights constant)</p></li>
</ul>
<p><strong>2. Near-zero coefficient for WT9:</strong></p>
<ul>
<li><p>Weight at age 9 appears to have almost no effect</p></li>
<li><p>This seems unlikely given that childhood weight typically predicts adult BMI</p></li>
</ul>
<p><strong>3. Only WT18 has the expected positive relationship:</strong></p>
<ul>
<li><p>This is the only coefficient that makes intuitive sense</p></li>
<li><p>Higher weight at age 18 → higher BMI at age 18 (direct relationship)</p></li>
</ul>
<p><strong>What’s Causing These Strange Results?</strong></p>
<p><strong>MULTICOLLINEARITY</strong> is the culprit!</p>
<p><strong>Evidence:</strong></p>
<ol type="1">
<li><p><strong>High correlations among predictors</strong> (from Question 2):</p>
<ul>
<li><p>WT2-WT9: r = 0.69</p></li>
<li><p>WT9-WT18: r = 0.69</p></li>
<li><p>WT2-WT18: r = 0.39</p></li>
</ul></li>
<li><p><strong>What multicollinearity does:</strong></p>
<ul>
<li><p>Makes it impossible to isolate the individual effect of each predictor</p></li>
<li><p>Causes unstable coefficient estimates with large standard errors</p></li>
<li><p>Leads to <strong>unexpected signs</strong> (like the negative WT2 coefficient)</p></li>
<li><p>Makes coefficients highly sensitive to small data changes</p></li>
</ul></li>
<li><p><strong>The “holding other variables constant” interpretation breaks down:</strong></p>
<ul>
<li><p>It’s unrealistic to imagine someone heavy at age 2 but light at age 18</p></li>
<li><p>The predictors move together naturally, so controlling for one while varying another creates an artificial scenario</p></li>
<li><p>This is why the coefficients don’t reflect real-world relationships</p></li>
</ul></li>
</ol>
<p><strong>Conclusion:</strong></p>
<p>While the <strong>overall model fit is excellent</strong> (R² = 0.78), the <strong>individual coefficients are unreliable and misleading</strong> due to severe multicollinearity. The negative sign for WT2 is a classic symptom of this problem.</p>
<p><strong>This is exactly why Question 4 introduces the orthogonal polynomial transformation</strong> - it creates uncorrelated predictors that yield interpretable, meaningful coefficients while maintaining the same predictive power.</p>
</section>
<section id="the-unexpected-sign-of-coefficients-may-be-due-to-the-correlation-between-the-regressors.-this-is-the-problem-of-multicollinearity.-in-this-case-since-all-the-three-original-regressors-measure-weight-combining-them-together-is-reasonable.-consider-a-set-of-linear-transformations-of-the-weight-variables-below" class="level4">
<h4 class="anchored" data-anchor-id="the-unexpected-sign-of-coefficients-may-be-due-to-the-correlation-between-the-regressors.-this-is-the-problem-of-multicollinearity.-in-this-case-since-all-the-three-original-regressors-measure-weight-combining-them-together-is-reasonable.-consider-a-set-of-linear-transformations-of-the-weight-variables-below">4. The unexpected sign of coefficients may be due to the correlation between the regressors. This is the problem of multicollinearity. In this case, since all the three original regressors measure weight, combining them together is reasonable. Consider a set of linear transformations of the weight variables below:</h4>
<p><span class="math display">\[ave= (WT2 + WT9 + WT18)/3\]</span></p>
<p><span class="math display">\[lin= WT18−WT2\]</span></p>
<p><span class="math display">\[quad= WT2−2 ×WT9 + WT18\]</span></p>
<p>Since the three weight variables are approximately equally spaced in time, these three variables correspond to the average weight, a linear component in time, and a quadratic component in time; see Oehlert (2000) or Kennedy and Gentle (1980), for example, for a discussion of orthogonal polynomials.</p>
<p>Fit with these regressors using the girls in the Berkeley Guidance Study data and compare with the results in Problem 4.3.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create transformed variables</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>BGSgirls<span class="sc">$</span>ave <span class="ot">&lt;-</span> (BGSgirls<span class="sc">$</span>WT2 <span class="sc">+</span> BGSgirls<span class="sc">$</span>WT9 <span class="sc">+</span> BGSgirls<span class="sc">$</span>WT18) <span class="sc">/</span> <span class="dv">3</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>BGSgirls<span class="sc">$</span>lin <span class="ot">&lt;-</span> BGSgirls<span class="sc">$</span>WT18 <span class="sc">-</span> BGSgirls<span class="sc">$</span>WT2</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>BGSgirls<span class="sc">$</span>quad <span class="ot">&lt;-</span> BGSgirls<span class="sc">$</span>WT2 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>BGSgirls<span class="sc">$</span>WT9 <span class="sc">+</span> BGSgirls<span class="sc">$</span>WT18</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Check correlations among transformed variables</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>trans_vars <span class="ot">&lt;-</span> BGSgirls[, <span class="fu">c</span>(<span class="st">"ave"</span>, <span class="st">"lin"</span>, <span class="st">"quad"</span>)]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>trans_corr <span class="ot">&lt;-</span> <span class="fu">cor</span>(trans_vars, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Correlations among transformed variables:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Correlations among transformed variables:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(trans_corr, <span class="dv">4</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         ave    lin    quad
ave   1.0000 0.8711 -0.1946
lin   0.8711 1.0000  0.2378
quad -0.1946 0.2378  1.0000</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Note: The transformed variables are approximately orthogonal (uncorrelated)!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Note: The transformed variables are approximately orthogonal (uncorrelated)!</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">This eliminates the multicollinearity problem.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
This eliminates the multicollinearity problem.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model with transformed variables</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BMI18 <span class="sc">~</span> ave <span class="sc">+</span> lin <span class="sc">+</span> quad, <span class="at">data =</span> BGSgirls)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BMI18 ~ WT2 + WT9 + WT18, data = BGSgirls)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1037 -0.7432 -0.1240  0.8320  4.3485 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.30978    1.65517   5.020 4.16e-06 ***
WT2         -0.38663    0.15145  -2.553    0.013 *  
WT9          0.03141    0.04937   0.636    0.527    
WT18         0.28745    0.02603  11.044  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.333 on 66 degrees of freedom
Multiple R-squared:  0.7772,    Adjusted R-squared:  0.767 
F-statistic: 76.73 on 3 and 66 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BMI18 ~ ave + lin + quad, data = BGSgirls)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1037 -0.7432 -0.1240  0.8320  4.3485 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.30978    1.65517   5.020 4.16e-06 ***
ave         -0.06778    0.12751  -0.532    0.597    
lin          0.33704    0.07466   4.514 2.68e-05 ***
quad        -0.02700    0.03976  -0.679    0.499    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.333 on 66 degrees of freedom
Multiple R-squared:  0.7772,    Adjusted R-squared:  0.767 
F-statistic: 76.73 on 3 and 66 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Transformed Variables:</strong></p>
<p>The three new predictors are:</p>
<ul>
<li><p><strong>ave</strong> = (WT2 + WT9 + WT18)/3 → Average weight across all three ages</p></li>
<li><p><strong>lin</strong> = WT18 - WT2 → Linear component (weight gain from age 2 to 18)</p></li>
<li><p><strong>quad</strong> = WT2 - 2×WT9 + WT18 → Quadratic component (curvature in growth pattern)</p></li>
</ul>
<p><strong>Assessment of Orthogonality:</strong></p>
<p><strong>IMPORTANT OBSERVATION:</strong> The transformed variables are <strong>NOT perfectly orthogonal (uncorrelated)</strong>!</p>
<ul>
<li><p><strong>ave and lin:</strong> r = 0.8711 (very high correlation)</p></li>
<li><p><strong>ave and quad:</strong> r = -0.1946 (low correlation) ✓</p></li>
<li><p><strong>lin and quad:</strong> r = 0.2378 (low-moderate correlation) ✓</p></li>
</ul>
<p><strong>Why aren’t they orthogonal?</strong></p>
<ul>
<li><p>Orthogonal polynomials require <strong>equally spaced</strong> time points</p></li>
<li><p>Ages 2, 9, and 18 are <strong>not equally spaced</strong>:</p>
<ul>
<li><p>Gap 1: 9 - 2 = 7 years</p></li>
<li><p>Gap 2: 18 - 9 = 9 years</p></li>
</ul></li>
<li><p>The formulas given assume equal spacing, so they don’t produce perfectly uncorrelated variables in this case</p></li>
<li><p>Despite this, the transformation still reduces multicollinearity substantially compared to the original model</p></li>
</ul>
<p><strong>COMPARISON 1: WHAT’S THE SAME</strong></p>
<p>Overall Model Fit Statistics (IDENTICAL)</p>
<pre><code>StatisticM1 (Original)M2 (Transformed)R²0.77720.7772Adjusted R²0.76700.7670Residual Std Error1.3331.333F-statistic76.7376.73p-value&lt; 2.2e-16&lt; 2.2e-16Degrees of Freedom6666</code></pre>
<p>Residuals (IDENTICAL)</p>
<pre><code>        M1        M2
Min     -3.1037   -3.1037
1Q      -0.7432   -0.7432
Median  -0.1240   -0.1240
3Q      0.8320     0.8320
Max     4.3485    4.3485</code></pre>
<p><strong>✓ Intercept (IDENTICAL)</strong></p>
<p>Both models: β₀ = 8.310 (SE = 1.655, t = 5.020, p &lt; 0.001)</p>
<p><strong>Why are these the same?</strong> Both models span the <strong>same 2-dimensional predictor space</strong>. They are just different <strong>coordinate systems</strong> describing the same underlying relationship. The transformations are linear combinations of the original variables, so they represent the same fitted plane.</p>
<p><strong>COEFFICIENT SIGNS AND INTERPRETABILITY</strong></p>
<p><strong>M1 (Original) - PROBLEMS:</strong></p>
<p><strong>❌ WT2 = -0.387 (NEGATIVE and significant)</strong></p>
<ul>
<li><p>Interpretation: Higher weight at age 2 → Lower BMI at 18 (holding WT9, WT18 constant)</p></li>
<li><p><strong>This is counterintuitive and biologically implausible!</strong></p></li>
<li><p>Caused by multicollinearity</p></li>
</ul>
<p><strong>⚠️ WT9 = 0.031 (positive but NOT significant)</strong></p>
<ul>
<li><p>Interpretation: Weight at 9 has minimal effect</p></li>
<li><p>Effect absorbed by other predictors due to collinearity</p></li>
</ul>
<p><strong>✓ WT18 = 0.287 (positive and highly significant)</strong></p>
<ul>
<li><p>Makes sense: heavier at 18 → higher BMI at 18</p></li>
<li><p>But “holding WT2, WT9 constant” is an artificial scenario</p></li>
</ul>
<p><strong>M2 (Transformed) - IMPROVEMENTS:</strong></p>
<p><strong>⚠️ ave = -0.068 (negative but NOT significant, p = 0.597)</strong></p>
<ul>
<li><p>Interpretation: Average weight across ages doesn’t significantly predict BMI18</p></li>
<li><p>Not significant, so the negative sign is not meaningful</p></li>
<li><p>Likely due to high correlation with lin (r = 0.87)</p></li>
</ul>
<p><strong>✓✓✓ lin = 0.337 (positive and HIGHLY significant, p = 2.68e-05)</strong></p>
<ul>
<li><p><strong>This is the KEY finding!</strong></p></li>
<li><p>Interpretation: Weight GAIN from age 2 to 18 strongly predicts BMI at 18</p></li>
<li><p>For every 1 kg increase in weight gain, BMI18 increases by 0.337</p></li>
<li><p><strong>Makes perfect biological sense</strong></p></li>
</ul>
<p><strong>⚠️ quad = -0.027 (negative but NOT significant, p = 0.499)</strong></p>
<ul>
<li><p>Interpretation: No significant quadratic (non-linear) growth component</p></li>
<li><p>Growth pattern is predominantly linear</p></li>
<li><p>Not significant, so can be ignored</p></li>
</ul>
<p><strong>STATISTICAL SIGNIFICANCE</strong></p>
<p>M1 Significance Pattern:</p>
<ul>
<li><p>2 out of 3 predictors significant (WT2, WT18)</p></li>
<li><p>But WT2 has wrong sign!</p></li>
<li><p>WT9 not significant despite biological relevance</p></li>
</ul>
<p>M2 Significance Pattern:</p>
<ul>
<li><p>1 out of 3 predictors significant (lin only)</p></li>
<li><p><strong>This is BETTER!</strong> It identifies the single most important factor</p></li>
<li><p>Clear, parsimonious interpretation</p></li>
</ul>
<p><strong>PRACTICAL INTERPRETATION</strong></p>
<p>What M1 Tells Us (CONFUSING):</p>
<ul>
<li><p>“Heavier babies have lower adult BMI” ❌</p></li>
<li><p>“Weight at 9 doesn’t matter” ❌</p></li>
<li><p>“Weight at 18 matters most” (partially true but incomplete)</p></li>
<li><p><strong>Overall message: UNCLEAR and contradictory</strong></p></li>
</ul>
<p>What M2 Tells Us (CLEAR):</p>
<ul>
<li><p>“Average weight across ages doesn’t predict adult BMI” ✓</p></li>
<li><p><strong>“Weight GAIN from childhood to adolescence is the KEY predictor”</strong> ✓✓✓</p></li>
<li><p>“Growth trajectory is linear, not curved” ✓</p></li>
<li><p><strong>Overall message: CLEAR and actionable!</strong></p></li>
</ul>
<p><strong>WHICH MODEL IS BETTER?</strong></p>
<p>For Prediction: <strong>BOTH ARE EQUAL</strong></p>
<ul>
<li><p>Identical R², predictions, and residuals</p></li>
<li><p>Same explanatory power</p></li>
</ul>
<p>For Interpretation: <strong>M2 IS VASTLY SUPERIOR</strong></p>
<ul class="task-list">
<li><p><label><input type="checkbox" checked="">Identifies weight gain as the key factor</label></p></li>
<li><p><label><input type="checkbox" checked="">Only one significant predictor (parsimonious)</label></p></li>
<li><p><label><input type="checkbox" checked="">Clear biological meaning</label></p></li>
<li><p><label><input type="checkbox" checked="">No counterintuitive signs</label></p></li>
<li><p><label><input type="checkbox" checked="">Actionable insights for public health</label></p></li>
</ul>
<p>Remaining Limitation:</p>
<p>The transformation didn’t achieve perfect orthogonality due to unequal time spacing (ave and lin are still correlated at r = 0.87). A truly orthogonal transformation would require adjusted coefficients based on the actual age spacing.</p>
</section>
</section>
<section id="problem-3" class="level2">
<h2 class="anchored" data-anchor-id="problem-3">Problem 3</h2>
<p>(Data file: Transact) The data in this example consists of a sample of branches of a large Australian bank (Cunningham and Heathcote, 1989). Each branch makes transactions of two types, and for each of the branches we have recorded the number T1 of type 1 transactions and the number t2 of type 2 transactions. The response is time, the total minutes of labor used by the branch.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Transact)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>Transact<span class="sc">$</span>a <span class="ot">&lt;-</span> (Transact<span class="sc">$</span>t1 <span class="sc">+</span> Transact<span class="sc">$</span>t2)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>Transact<span class="sc">$</span>d <span class="ot">&lt;-</span> Transact<span class="sc">$</span>t1 <span class="sc">-</span> Transact<span class="sc">$</span>t2</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Transact)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   t1   t2  time      a     d
1   0 1166  2396  583.0 -1166
2   0 1656  2348  828.0 -1656
3   0  899  2403  449.5  -899
4 516 3315 13518 1915.5 -2799
5 623 3969 13437 2296.0 -3346
6 395 3087  7914 1741.0 -2692</code></pre>
</div>
</div>
<p>Define a = (t1 + t2)/2 to be the average transaction time, and d = t1 - t1, and fit the following four mean functions.</p>
<p>i. M1: <span class="math inline">\(E(time|t1,t2) = β_{01} + β_{11}t1 + β_{21}t2\)</span></p>
<p>ii. M2: <span class="math inline">\(E(time|t1,t2) = β_{02} + β_{32}a + β_{42}d\)</span></p>
<p>iii. M3: <span class="math inline">\(E(time|t1,t2) = β_{03} + β_{23}t2 + β_{43}d\)</span></p>
<p>iv. M4: <span class="math inline">\(E(time|t1,t2) = β_{04} + β_{14}t1 + β_{24}t2 + \beta_{34}a + \beta_{44}d\)</span></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model M1: Original predictors</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- MODEL M1: E(time|t1,t2) = β01 + β11*t1 + β21*t2 ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- MODEL M1: E(time|t1,t2) = β01 + β11*t1 + β21*t2 ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(time <span class="sc">~</span> t1 <span class="sc">+</span> t2, <span class="at">data =</span> Transact)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = time ~ t1 + t2, data = Transact)

Residuals:
    Min      1Q  Median      3Q     Max 
-4652.4  -601.3     2.4   455.7  5607.4 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 144.36944  170.54410   0.847    0.398    
t1            5.46206    0.43327  12.607   &lt;2e-16 ***
t2            2.03455    0.09434  21.567   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1143 on 258 degrees of freedom
Multiple R-squared:  0.9091,    Adjusted R-squared:  0.9083 
F-statistic:  1289 on 2 and 258 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model M2: Transformed predictors only</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- MODEL M2: E(time|t1,t2) = β02 + β32*a + β42*d ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- MODEL M2: E(time|t1,t2) = β02 + β32*a + β42*d ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(time <span class="sc">~</span> a <span class="sc">+</span> d, <span class="at">data =</span> Transact)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = time ~ a + d, data = Transact)

Residuals:
    Min      1Q  Median      3Q     Max 
-4652.4  -601.3     2.4   455.7  5607.4 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 144.3694   170.5441   0.847    0.398    
a             7.4966     0.3654  20.514  &lt; 2e-16 ***
d             1.7138     0.2548   6.726 1.12e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1143 on 258 degrees of freedom
Multiple R-squared:  0.9091,    Adjusted R-squared:  0.9083 
F-statistic:  1289 on 2 and 258 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model M3: Mixed predictors</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- MODEL M3: E(time|t1,t2) = β03 + β23*t2 + β43*d ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- MODEL M3: E(time|t1,t2) = β03 + β23*t2 + β43*d ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>M3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(time <span class="sc">~</span> t2 <span class="sc">+</span> d, <span class="at">data =</span> Transact)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = time ~ t2 + d, data = Transact)

Residuals:
    Min      1Q  Median      3Q     Max 
-4652.4  -601.3     2.4   455.7  5607.4 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 144.3694   170.5441   0.847    0.398    
t2            7.4966     0.3654  20.514   &lt;2e-16 ***
d             5.4621     0.4333  12.607   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1143 on 258 degrees of freedom
Multiple R-squared:  0.9091,    Adjusted R-squared:  0.9083 
F-statistic:  1289 on 2 and 258 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model M4: All predictors (REDUNDANT)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- MODEL M4: E(time|t1,t2) = β04 + β14*t1 + β24*t2 + β34*a + β44*d ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- MODEL M4: E(time|t1,t2) = β04 + β14*t1 + β24*t2 + β34*a + β44*d ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>M4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(time <span class="sc">~</span> t1 <span class="sc">+</span> t2 <span class="sc">+</span> a <span class="sc">+</span> d, <span class="at">data =</span> Transact)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M4)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = time ~ t1 + t2 + a + d, data = Transact)

Residuals:
    Min      1Q  Median      3Q     Max 
-4652.4  -601.3     2.4   455.7  5607.4 

Coefficients: (2 not defined because of singularities)
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 144.36944  170.54410   0.847    0.398    
t1            5.46206    0.43327  12.607   &lt;2e-16 ***
t2            2.03455    0.09434  21.567   &lt;2e-16 ***
a                  NA         NA      NA       NA    
d                  NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1143 on 258 degrees of freedom
Multiple R-squared:  0.9091,    Adjusted R-squared:  0.9083 
F-statistic:  1289 on 2 and 258 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In the fit of M4, some of the coefficients estimates are labeled as “aliased (NA)” or else they are simply omitted. Explain what this means and why this happens.</p>
<p>The coefficients for <strong>a</strong> and <strong>d</strong> are marked as <strong>NA</strong> with the message <em>“(2 not defined because of singularities)”</em>. This means:</p>
<ol type="1">
<li><p><strong>“Aliased”</strong> = The variables are redundant and cannot be estimated</p></li>
<li><p><strong>“Singularities”</strong> = Perfect multicollinearity exists in the design matrix</p></li>
<li><p><strong>R automatically drops</strong> these variables to avoid computational problems</p></li>
</ol>
<p><strong>Why Does This Happen?</strong></p>
<p>Model M4 attempts to include <strong>all four variables</strong>: t1, t2, a, and d</p>
<p>However, these variables have <strong>perfect linear dependencies</strong>:</p>
<p><strong>Given the definitions:</strong></p>
<ul>
<li><p><strong>a = (t1 + t2)/2</strong> (average of the two transaction types)</p></li>
<li><p><strong>d = t1 - t2</strong> (difference between transaction types)</p></li>
</ul>
<p><strong>We can derive exact relationships:</strong></p>
<p>From these two equations, we can solve for t1 and t2:</p>
<ul>
<li><p><strong>t1 = a + d/2</strong></p></li>
<li><p><strong>t2 = a - d/2</strong></p></li>
</ul>
<p>This means:</p>
<ul>
<li><p>If we know <strong>a</strong> and <strong>d</strong>, we can perfectly calculate <strong>t1</strong> and <strong>t2</strong></p></li>
<li><p>If we know <strong>t1</strong> and <strong>t2</strong>, we can perfectly calculate <strong>a</strong> and <strong>d</strong></p></li>
</ul>
<p><strong>Mathematical Explanation</strong></p>
<p>The model matrix for M4 has 5 columns: <strong>[1, t1, t2, a, d]</strong></p>
<p>But these columns are <strong>linearly dependent</strong>:</p>
<ul>
<li><p>Column <strong>a</strong> = 0.5 × Column <strong>t1</strong> + 0.5 × Column <strong>t2</strong></p></li>
<li><p>Column <strong>d</strong> = 1.0 × Column <strong>t1</strong> - 1.0 × Column <strong>t2</strong></p></li>
</ul>
<p><strong>Result:</strong> The design matrix is <strong>not full rank</strong></p>
<ul>
<li><p>We have 5 columns but only <strong>3 are linearly independent</strong> (intercept, t1, t2)</p></li>
<li><p>The matrix is <strong>singular</strong> (non-invertible)</p></li>
<li><p>We cannot solve for unique coefficient estimates for all 5 parameters</p></li>
</ul>
<p><strong>Why R Drops a and d (Not t1 and t2)</strong></p>
<p>R uses a <strong>sequential algorithm</strong> to build the model:</p>
<ol type="1">
<li><p>First, it includes the <strong>intercept</strong></p></li>
<li><p>Then it includes <strong>t1</strong> (linearly independent from intercept)</p></li>
<li><p>Then it includes <strong>t2</strong> (linearly independent from intercept and t1)</p></li>
<li><p>When it tries to add <strong>a</strong>, R detects that a can be written as a linear combination of t1 and t2 → <strong>drops a</strong></p></li>
<li><p>When it tries to add <strong>d</strong>, R detects that d can be written as a linear combination of t1 and t2 → <strong>drops d</strong></p></li>
</ol>
<p>The order matters! R keeps variables in the order they appear in the formula and drops later variables that are redundant.</p>
<p><strong>Practical Implications</strong></p>
<p><strong>What M4 actually fits:</strong> Even though we specified <code>time ~ t1 + t2 + a + d</code>, R actually fits:</p>
<ul>
<li><strong>time ~ t1 + t2</strong></li>
</ul>
<p>This is <strong>identical to M1</strong>! Notice:</p>
<ul>
<li><p>Same coefficient estimates for t1 and t2</p></li>
<li><p>Same standard errors</p></li>
<li><p>Same t-values and p-values</p></li>
<li><p>Same R², residual standard error, F-statistic</p></li>
</ul>
<p><strong>Key takeaway:</strong> You cannot include more than <strong>2 independent predictors</strong> when working with just two original variables (t1 and t2), no matter how many transformations you create. Any additional variables will be redundant and aliased.</p>
<p><strong>Summary</strong></p>
<p><strong>“Aliased (NA)” means:</strong></p>
<ul>
<li><p>The variable is <strong>perfectly predicted</strong> by other variables already in the model</p></li>
<li><p>Its coefficient <strong>cannot be uniquely estimated</strong></p></li>
<li><p>R automatically <strong>removes it</strong> to prevent computational errors</p></li>
</ul>
<p><strong>Why it happens:</strong></p>
<ul>
<li><p><strong>Perfect multicollinearity</strong>: a = (t1 + t2)/2 and d = t1 - t2</p></li>
<li><p>Only <strong>2 dimensions of information</strong> exist in the predictor space</p></li>
<li><p>Attempting to fit 4 predictors with only 2 degrees of freedom is impossible</p></li>
<li><p>The design matrix is <strong>singular</strong> (rank deficient)</p></li>
</ul>
<section id="what-aspects-of-the-fitted-regressions-are-the-same-what-aspects-are-different" class="level4">
<h4 class="anchored" data-anchor-id="what-aspects-of-the-fitted-regressions-are-the-same-what-aspects-are-different">2. What aspects of the fitted regressions are the same? What aspects are different?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key statistics</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">M1 =</span> M1, <span class="at">M2 =</span> M2, <span class="at">M3 =</span> M3, <span class="at">M4 =</span> M4)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"M1"</span>, <span class="st">"M2"</span>, <span class="st">"M3"</span>, <span class="st">"M4"</span>),</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predictors =</span> <span class="fu">c</span>(<span class="st">"t1, t2"</span>, <span class="st">"a, d"</span>, <span class="st">"t2, d"</span>, <span class="st">"t1, t2, a, d"</span>),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_squared =</span> <span class="fu">sapply</span>(models, <span class="cf">function</span>(m) <span class="fu">summary</span>(m)<span class="sc">$</span>r.squared),</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Adj_R_squared =</span> <span class="fu">sapply</span>(models, <span class="cf">function</span>(m) <span class="fu">summary</span>(m)<span class="sc">$</span>adj.r.squared),</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">RSE =</span> <span class="fu">sapply</span>(models, <span class="cf">function</span>(m) <span class="fu">summary</span>(m)<span class="sc">$</span>sigma),</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">F_statistic =</span> <span class="fu">sapply</span>(models, <span class="cf">function</span>(m) <span class="fu">summary</span>(m)<span class="sc">$</span>fstatistic[<span class="dv">1</span>])</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Model   Predictors R_squared Adj_R_squared      RSE F_statistic
M1    M1       t1, t2 0.9090534     0.9083484 1142.556    1289.415
M2    M2         a, d 0.9090534     0.9083484 1142.556    1289.415
M3    M3        t2, d 0.9090534     0.9083484 1142.556    1289.415
M4    M4 t1, t2, a, d 0.9090534     0.9083484 1142.556    1289.415</code></pre>
</div>
</div>
<p>Looking at the comparison table, <strong>ALL fit statistics are IDENTICAL</strong>: (r_squared, adjusted r_squared, rse, f_statistic)</p>
<p><strong>WHAT IS DIFFERENT ACROSS THE MODELS?</strong></p>
<p>The <strong>individual coefficient estimates</strong> are different:</p>
<pre><code>Model   Coefficients
M1      t1 = 5.462, t2 = 2.035
M2      a = 7.497, d = 1.714
M3      t2 = 7.497, d = 5.462
M4      t1 = 5.462, t2 = 2.035, a = NA, d = NA</code></pre>
<p><strong>Additional differences:</strong></p>
<ol type="1">
<li><p><strong>Standard errors</strong> of coefficients differ</p></li>
<li><p><strong>t-statistics</strong> differ</p></li>
<li><p><strong>Individual p-values</strong> differ (though all significant)</p></li>
<li><p><strong>Interpretation</strong> of coefficients differs</p></li>
</ol>
</section>
<section id="why-is-the-estimate-for-t2-different-in-m1-and-m3" class="level4">
<h4 class="anchored" data-anchor-id="why-is-the-estimate-for-t2-different-in-m1-and-m3">3. Why is the estimate for t2 different in M1 and M3?</h4>
<p><strong>The t2 Coefficients:</strong></p>
<p>From the model outputs:</p>
<p><strong>Model M1:</strong> <code>time ~ t1 + t2</code></p>
<ul>
<li><strong>t2 coefficient = 2.03455</strong></li>
</ul>
<p><strong>Model M3:</strong> <code>time ~ t2 + d</code></p>
<ul>
<li><strong>t2 coefficient = 7.49660</strong></li>
</ul>
<p>The t2 coefficient in M3 is <strong>much larger</strong> (about 3.7 times larger) than in M1!</p>
<p><strong>Why Are They Different?</strong></p>
<p>The coefficients have <strong>completely different interpretations</strong> because they are “holding different things constant.”</p>
<p><strong>In Model M1: time ~ t1 + t2</strong></p>
<p><strong>β₂ = 2.03455</strong> means:</p>
<ul>
<li><p>The effect of t2 <strong>holding t1 constant</strong></p></li>
<li><p><em>Interpretation</em>: “If t2 increases by 1 unit while t1 stays the same, time increases by 2.03 minutes”</p></li>
<li><p>This measures the <strong>unique effect of type 2 transactions alone</strong></p></li>
</ul>
<p><strong>In Model M3: time ~ t2 + d</strong></p>
<p><strong>β₂ = 7.49660</strong> means:</p>
<ul>
<li><p>The effect of t2 <strong>holding d = (t1 - t2) constant</strong></p></li>
<li><p><em>Interpretation</em>: “If t2 increases by 1 unit while d stays constant, time increases by 7.50 minutes”</p></li>
</ul>
<p><strong>Key insight:</strong> If d = t1 - t2 is held constant and t2 increases by 1, then <strong>t1 must also increase by 1</strong>!</p>
<p>So the t2 coefficient in M3 actually measures: <strong>“What happens when BOTH t1 and t2 increase by 1 unit together?”</strong></p>
<p><strong>Intuitive Explanation</strong></p>
<p>Think of it this way:</p>
<p><strong>M1 asks:</strong> “What is the effect of changing t2 <strong>independently</strong> from t1?”</p>
<ul>
<li>Answer: 2.035 minutes per transaction</li>
</ul>
<p><strong>M3 asks:</strong> “What is the effect of changing t2 when t1 and t2 must <strong>move together</strong> (because d is fixed)?”</p>
<ul>
<li><p>Answer: 7.497 minutes per transaction</p></li>
<li><p>This is the <strong>combined effect</strong> of both t1 and t2 increasing</p></li>
</ul>
<p><strong>Analogy:</strong></p>
<ul>
<li><p>M1 is like asking “How much does your right leg contribute to walking if your left leg stays still?”</p></li>
<li><p>M3 is like asking “How much does your right leg contribute when both legs move together?” (Much more!)</p></li>
</ul>
<p><strong>Bottom line:</strong> The t2 coefficient is different because it’s answering a different question. In M1, it’s the effect of t2 <strong>alone</strong>. In M3, it’s the effect of t2 <strong>plus</strong> t1 moving together. Both are correct—they just have different interpretations based on what’s being held constant!</p>
</section>
</section>
<section id="problem-4" class="level2">
<h2 class="anchored" data-anchor-id="problem-4">Problem 4</h2>
<p>Cakes (Data file: <code>cakes</code>) Oehlert (2000) provides data from a small experiment with n = 14 observations on baking packaged cake mixes. Two factors, X1 = backing time minutes and X2 = baking temperature in degrees F, were varied in the experiment. The response Y was the average palatability score of four cakes bakes at baked at a given combination of (X1,X2), with higher values desirable.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cakes)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cakes)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  block X1  X2    Y
1     0 33 340 3.89
2     0 37 340 6.36
3     0 33 360 7.65
4     0 37 360 6.79
5     0 35 350 8.36
6     0 35 350 7.63</code></pre>
</div>
</div>
<p>Suppose we have a model:</p>
<p><span class="math display">\[E(Y|X_1=x_1, X_2=x_2)=\beta_0+\beta_1x_1+\beta_2x_2+\beta_3x_1^2+\beta_4x_2^2+\beta_5x_1x_2\]</span></p>
<section id="fit-the-model-and-verify-that-the-significance-levels-for-the-quadratics-terms-and-interaction-are-all-less-than-0.005.-when-fitting-the-polynomials-tests-concerning-main-effects-in-models-that-include-a-quadratic-are-generally-not-of-much-interest." class="level4">
<h4 class="anchored" data-anchor-id="fit-the-model-and-verify-that-the-significance-levels-for-the-quadratics-terms-and-interaction-are-all-less-than-0.005.-when-fitting-the-polynomials-tests-concerning-main-effects-in-models-that-include-a-quadratic-are-generally-not-of-much-interest.">1. Fit the model and verify that the significance levels for the quadratics terms and interaction are all less than 0.005. When fitting the polynomials, tests concerning main effects in models that include a quadratic are generally not of much interest.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model Specification:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model Specification:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"E(Y|X1, X2) = β₀ + β₁X₁ + β₂X₂ + β₃X₁² + β₄X₂² + β₅X₁X₂</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>E(Y|X1, X2) = β₀ + β₁X₁ + β₂X₂ + β₃X₁² + β₄X₂² + β₅X₁X₂</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create squared terms and interaction</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>cakes<span class="sc">$</span>X1_sq <span class="ot">&lt;-</span> cakes<span class="sc">$</span>X1<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>cakes<span class="sc">$</span>X2_sq <span class="ot">&lt;-</span> cakes<span class="sc">$</span>X2<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>cakes<span class="sc">$</span>X1_X2 <span class="ot">&lt;-</span> cakes<span class="sc">$</span>X1 <span class="sc">*</span> cakes<span class="sc">$</span>X2</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the quadratic model</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X1_sq <span class="sc">+</span> X2_sq <span class="sc">+</span> X1_X2, <span class="at">data =</span> cakes)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- MODEL 1 SUMMARY ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- MODEL 1 SUMMARY ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>summary_model1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(model1)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_model1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ X1 + X2 + X1_sq + X2_sq + X1_X2, data = cakes)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.4912 -0.3080  0.0200  0.2658  0.5454 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -2.204e+03  2.416e+02  -9.125 1.67e-05 ***
X1           2.592e+01  4.659e+00   5.563 0.000533 ***
X2           9.918e+00  1.167e+00   8.502 2.81e-05 ***
X1_sq       -1.569e-01  3.945e-02  -3.977 0.004079 ** 
X2_sq       -1.195e-02  1.578e-03  -7.574 6.46e-05 ***
X1_X2       -4.163e-02  1.072e-02  -3.883 0.004654 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4288 on 8 degrees of freedom
Multiple R-squared:  0.9487,    Adjusted R-squared:  0.9167 
F-statistic:  29.6 on 5 and 8 DF,  p-value: 5.864e-05</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract p-values for quadratic terms and interaction</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>coef_summary <span class="ot">&lt;-</span> summary_model1<span class="sc">$</span>coefficients</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check quadratic terms</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Quadratic Terms:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Quadratic Terms:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"----------------</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"X1²:  Coefficient = %8.4f, SE = %.4f, t = %7.3f, p-value = %.6f %s</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>            coef_summary[<span class="st">"X1_sq"</span>, <span class="st">"Estimate"</span>],</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>            coef_summary[<span class="st">"X1_sq"</span>, <span class="st">"Std. Error"</span>],</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>            coef_summary[<span class="st">"X1_sq"</span>, <span class="st">"t value"</span>],</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>            coef_summary[<span class="st">"X1_sq"</span>, <span class="st">"Pr(&gt;|t|)"</span>],</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ifelse</span>(coef_summary[<span class="st">"X1_sq"</span>, <span class="st">"Pr(&gt;|t|)"</span>] <span class="sc">&lt;</span> <span class="fl">0.005</span>, <span class="st">"✓ &lt; 0.005"</span>, <span class="st">"✗ &gt;= 0.005"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>X1²:  Coefficient =  -0.1569, SE = 0.0394, t =  -3.977, p-value = 0.004079 ✓ &lt; 0.005</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"X2²:  Coefficient = %8.4f, SE = %.4f, t = %7.3f, p-value = %.6f %s</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>            coef_summary[<span class="st">"X2_sq"</span>, <span class="st">"Estimate"</span>],</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>            coef_summary[<span class="st">"X2_sq"</span>, <span class="st">"Std. Error"</span>],</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>            coef_summary[<span class="st">"X2_sq"</span>, <span class="st">"t value"</span>],</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>            coef_summary[<span class="st">"X2_sq"</span>, <span class="st">"Pr(&gt;|t|)"</span>],</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ifelse</span>(coef_summary[<span class="st">"X2_sq"</span>, <span class="st">"Pr(&gt;|t|)"</span>] <span class="sc">&lt;</span> <span class="fl">0.005</span>, <span class="st">"✓ &lt; 0.005"</span>, <span class="st">"✗ &gt;= 0.005"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>X2²:  Coefficient =  -0.0119, SE = 0.0016, t =  -7.574, p-value = 0.000065 ✓ &lt; 0.005</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interaction Term:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interaction Term:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"-----------------</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>-----------------</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"X1×X2: Coefficient = %8.4f, SE = %.4f, t = %7.3f, p-value = %.6f %s</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>            coef_summary[<span class="st">"X1_X2"</span>, <span class="st">"Estimate"</span>],</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>            coef_summary[<span class="st">"X1_X2"</span>, <span class="st">"Std. Error"</span>],</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>            coef_summary[<span class="st">"X1_X2"</span>, <span class="st">"t value"</span>],</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>            coef_summary[<span class="st">"X1_X2"</span>, <span class="st">"Pr(&gt;|t|)"</span>],</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ifelse</span>(coef_summary[<span class="st">"X1_X2"</span>, <span class="st">"Pr(&gt;|t|)"</span>] <span class="sc">&lt;</span> <span class="fl">0.005</span>, <span class="st">"✓ &lt; 0.005"</span>, <span class="st">"✗ &gt;= 0.005"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>X1×X2: Coefficient =  -0.0416, SE = 0.0107, t =  -3.883, p-value = 0.004654 ✓ &lt; 0.005</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>All three terms (X₁², X₂², and X₁×X₂) have p-values &lt; 0.005</strong>, confirming:</p>
<ul>
<li><p>Strong evidence of non-linear (quadratic) effects</p></li>
<li><p>Significant interaction between baking time and temperature</p></li>
<li><p>The relationship between predictors and palatability is complex and curved</p></li>
</ul>
<p>“When fitting the polynomials, tests concerning main effects in models that include a quadratic are generally not of much interest”</p>
<p><strong>Why main effects tests are not of much interest when quadratics are present:</strong></p>
<ol type="1">
<li><p><strong>The effect is NOT constant</strong> - it varies with X₁ and X₂ values</p></li>
<li><p><strong>β₁ alone is incomplete</strong> - it’s only one component of a complex relationship</p></li>
<li><p><strong>The test H₀: β₁ = 0 is irrelevant</strong> - it tests the effect at X₁ = 0, outside our range</p></li>
<li><p><strong>What matters instead:</strong></p>
<ul>
<li><p>Are quadratic terms significant? ✓ YES (p &lt; 0.005)</p></li>
<li><p>Is the interaction significant? ✓ YES (p &lt; 0.005)</p></li>
<li><p>Does the variable matter overall? (joint test of all terms)</p></li>
</ul></li>
<li><p><strong>Practical interpretation:</strong></p>
<ul>
<li><p>Focus on the <strong>shape of the response surface</strong> (dome)</p></li>
<li><p>Find the <strong>optimal point</strong> (where ∂Y/∂X₁ = 0 and ∂Y/∂X₂ = 0)</p></li>
<li><p>Understand <strong>how effects change</strong> across the experimental region</p></li>
</ul></li>
</ol>
<p><strong>In our case:</strong> Both X₁ and X₂ clearly matter (the surface changes dramatically), but testing whether β₁ = 25.92 is significant tells us nothing useful about the baking process. What matters is that <strong>the quadratics and interaction are significant</strong>, proving we need the complex model to capture the optimal baking conditions.</p>
</section>
<section id="the-cake-experiment-was-carried-out-in-two-blocks-of-seven-observations-each.-it-is-possible-that-the-response-might-differ-by-block.-for-example-if-the-blocks-were-different-days-then-differences-in-air-temperature-or-humidity-when-the-cakes-were-mixed-might-have-some-effect-on-y.-we-can-allow-for-block-effects-by-adding-a-factor-block-to-the-mean-function-and-possibly-allowing-for-block-by-regressor-interactions-and-block-effects-to-the-mean-function-fit-in-a-new-model-and-summarize-results.-the-blocking-is-indicated-by-the-variable-block-in-the-data-file." class="level4">
<h4 class="anchored" data-anchor-id="the-cake-experiment-was-carried-out-in-two-blocks-of-seven-observations-each.-it-is-possible-that-the-response-might-differ-by-block.-for-example-if-the-blocks-were-different-days-then-differences-in-air-temperature-or-humidity-when-the-cakes-were-mixed-might-have-some-effect-on-y.-we-can-allow-for-block-effects-by-adding-a-factor-block-to-the-mean-function-and-possibly-allowing-for-block-by-regressor-interactions-and-block-effects-to-the-mean-function-fit-in-a-new-model-and-summarize-results.-the-blocking-is-indicated-by-the-variable-block-in-the-data-file.">2. The cake experiment was carried out in two blocks of seven observations each. It is possible that the response might differ by block. For example, if the blocks were different days, then differences in air temperature or humidity when the cakes were mixed might have some effect on <code>Y</code>. We can allow for block effects by adding a factor block to the mean function and possibly allowing for block by regressor interactions and block effects to the mean function fit in a new model and summarize results. The blocking is indicated by the variable <code>block</code> in the data file.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert block to factor</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>cakes<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cakes<span class="sc">$</span>block)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- DATA BY BLOCK ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- DATA BY BLOCK ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Block 1: n ="</span>, <span class="fu">sum</span>(cakes<span class="sc">$</span>block <span class="sc">==</span> <span class="dv">0</span>), <span class="st">"observations</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Block 1: n = 7 observations</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Block 2: n ="</span>, <span class="fu">sum</span>(cakes<span class="sc">$</span>block <span class="sc">==</span> <span class="dv">1</span>), <span class="st">"observations</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Block 2: n = 7 observations</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics by block</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean palatability by block:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean palatability by block:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>by_block <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Y <span class="sc">~</span> block, <span class="at">data =</span> cakes, <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">mean =</span> <span class="fu">mean</span>(x), <span class="at">sd =</span> <span class="fu">sd</span>(x), <span class="at">n =</span> <span class="fu">length</span>(x))</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(by_block)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  block   Y.mean     Y.sd      Y.n
1     0 6.971429 1.529896 7.000000
2     1 7.085714 1.559186 7.000000</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: Add block effect</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- MODEL 2: Adding Block Main Effect ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- MODEL 2: Adding Block Main Effect ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"E(Y|X1, X2, block) = β₀ + β₁X₁ + β₂X₂ + β₃X₁² + β₄X₂² + β₅X₁X₂ + β₆block</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>E(Y|X1, X2, block) = β₀ + β₁X₁ + β₂X₂ + β₃X₁² + β₄X₂² + β₅X₁X₂ + β₆block</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X1_sq <span class="sc">+</span> X2_sq <span class="sc">+</span> X1_X2 <span class="sc">+</span> block, <span class="at">data =</span> cakes)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>summary_model2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(model2)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_model2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ X1 + X2 + X1_sq + X2_sq + X1_X2 + block, data = cakes)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.4525 -0.3046  0.0200  0.2924  0.4883 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -2.205e+03  2.542e+02  -8.672 5.43e-05 ***
X1           2.592e+01  4.903e+00   5.287 0.001140 ** 
X2           9.918e+00  1.228e+00   8.080 8.56e-05 ***
X1_sq       -1.569e-01  4.151e-02  -3.779 0.006898 ** 
X2_sq       -1.195e-02  1.660e-03  -7.197 0.000178 ***
X1_X2       -4.163e-02  1.128e-02  -3.690 0.007754 ** 
block1       1.143e-01  2.412e-01   0.474 0.650014    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4512 on 7 degrees of freedom
Multiple R-squared:  0.9503,    Adjusted R-squared:  0.9077 
F-statistic: 22.31 on 6 and 7 DF,  p-value: 0.0003129</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3: Add block interactions with all terms</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- MODEL 3: Block with All Interactions ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- MODEL 3: Block with All Interactions ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"E(Y|X1, X2, block) = β₀ + ... + β₆block + block×(all other terms)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>E(Y|X1, X2, block) = β₀ + ... + β₆block + block×(all other terms)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> (X1 <span class="sc">+</span> X2 <span class="sc">+</span> X1_sq <span class="sc">+</span> X2_sq <span class="sc">+</span> X1_X2) <span class="sc">*</span> block, <span class="at">data =</span> cakes)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>summary_model3 <span class="ot">&lt;-</span> <span class="fu">summary</span>(model3)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_model3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ (X1 + X2 + X1_sq + X2_sq + X1_X2) * block, data = cakes)

Residuals:
         1          2          3          4          5          6          7 
-1.380e-14 -1.304e-14 -1.180e-14 -1.065e-14  3.233e-01 -4.067e-01  8.333e-02 
         8          9         10         11         12         13         14 
 1.166e-14  1.302e-14  1.068e-14  1.381e-14 -2.933e-01  3.367e-01 -4.333e-02 

Coefficients: (2 not defined because of singularities)
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -2.195e+03  1.970e+02 -11.146 0.000369 ***
X1            2.684e+01  6.176e+00   4.347 0.012187 *  
X2            9.781e+00  1.145e+00   8.539 0.001032 ** 
X1_sq        -1.725e-01  7.691e-02  -2.243 0.088326 .  
X2_sq        -1.174e-02  1.578e-03  -7.441 0.001742 ** 
X1_X2        -4.163e-02  8.643e-03  -4.816 0.008549 ** 
block1        1.980e+01  1.146e+02   0.173 0.871189    
X1:block1    -1.126e+00  6.536e+00  -0.172 0.871623    
X2:block1    -1.672e-02  2.445e-02  -0.684 0.531701    
X1_sq:block1  2.083e-02  9.336e-02   0.223 0.834350    
X2_sq:block1         NA         NA      NA       NA    
X1_X2:block1         NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3457 on 4 degrees of freedom
Multiple R-squared:  0.9833,    Adjusted R-squared:  0.9458 
F-statistic: 26.21 on 9 and 4 DF,  p-value: 0.003309</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Test 1: Is Block Main Effect Significant?</strong></p>
<p><strong>Hypotheses:</strong></p>
<ul>
<li><p>H₀: β₆ = 0 (no difference between blocks)</p></li>
<li><p>H₁: β₆ ≠ 0 (blocks differ)</p></li>
</ul>
<p><strong>From Model 2:</strong></p>
<ul>
<li><p>Block coefficient: 0.1143</p></li>
<li><p>Standard error: 0.2412</p></li>
<li><p>t-statistic: 0.474</p></li>
<li><p><strong>p-value: 0.650</strong></p></li>
</ul>
<p><strong>CONCLUSION: Block main effect is NOT significant (p = 0.650 &gt;&gt; 0.05)</strong></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>No systematic difference in palatability between Block 1 and Block 2</p></li>
<li><p>The effect is tiny (0.11 units) compared to SE (0.24)</p></li>
<li><p>Environmental conditions were apparently consistent across blocks</p></li>
<li><p>Different days/batches did not meaningfully affect cake quality</p></li>
</ul>
<p><strong>Test 2: Are Block Interactions Significant?</strong></p>
<p><strong>Hypotheses:</strong></p>
<ul>
<li><p>H₀: All block × predictor interactions = 0</p></li>
<li><p>H₁: At least one interaction ≠ 0</p></li>
</ul>
<p><strong>From Model 3 individual tests:</strong> All estimable interactions are NOT significant:</p>
<ul>
<li><p>Time × block: p = 0.872</p></li>
<li><p>Temperature × block: p = 0.532</p></li>
<li><p>Time² × block: p = 0.834</p></li>
</ul>
<p><strong>Note:</strong> Two interactions are aliased (NA) due to perfect multicollinearity - this is a problem with Model 3 structure.</p>
<p><strong>CONCLUSION: Block interactions are NOT significant</strong></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>The effect of baking time is the same in both blocks</p></li>
<li><p>The effect of temperature is the same in both blocks</p></li>
<li><p>The quadratic curvature is consistent across blocks</p></li>
<li><p>The response surface shape does not differ between blocks</p></li>
</ul>
<p><strong>Key observations:</strong></p>
<ul>
<li><p>↓ Adding block <strong>decreases</strong> Adjusted R²</p></li>
<li><p>↑ Adding block <strong>increases</strong> RSE (worse predictions)</p></li>
<li><p>Model 3 has very few degrees of freedom (df=4)</p></li>
<li><p>Model 3 has aliasing problems (NA coefficients)</p></li>
</ul>
<p>*Why Model 3 Has Aliased Coefficients:</p>
<p><strong>Problem:</strong> With only 14 observations and trying to fit 12 parameters (including interactions), we have <strong>overparameterization</strong>.</p>
<p><strong>Specifically:</strong></p>
<ul>
<li><p>Block is a factor with 2 levels</p></li>
<li><p>When we interact block with 5 predictors, we get 5 additional terms</p></li>
<li><p>But with only 7 observations per block, we don’t have enough unique combinations</p></li>
<li><p>Some interaction terms become perfectly collinear with others</p></li>
<li><p>R drops them as “aliased (NA)”</p></li>
</ul>
<p><strong>This is a warning sign:</strong> Model 3 is too complex for the available data!</p>
</section>
</section>
<section id="problem-5" class="level2">
<h2 class="anchored" data-anchor-id="problem-5">Problem 5</h2>
<p>(Data file: <code>BGsall</code> ) Refer to the Berkeley Guidance study described in Problem 2. Using the data file <code>BGSall</code> , consider the regression of <code>HT18</code> on <code>HT9</code> and the grouping factor <code>Sex</code> .</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(BGSall)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(BGSall)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sex  WT2  HT2  WT9   HT9  LG9 ST9  WT18  HT18 LG18 ST18 BMI18 Soma
1   0 13.6 90.2 41.5 139.4 31.6  74 110.2 179.0 44.1  226  34.4  7.0
2   0 12.7 91.4 31.0 144.3 26.0  73  79.4 195.1 36.1  252  20.9  4.0
3   0 12.6 86.4 30.1 136.5 26.6  64  76.3 183.7 36.9  216  22.6  6.0
4   0 14.8 87.6 34.1 135.4 28.2  75  74.5 178.7 37.3  220  23.3  2.0
5   0 12.7 86.7 24.5 128.9 24.2  63  55.7 171.5 31.0  200  18.9  1.5
6   0 11.9 88.1 29.8 136.0 26.7  77  68.2 181.8 37.0  215  20.6  3.0</code></pre>
</div>
</div>
<section id="draw-the-scatterplot-of-ht18-versus-ht9-using-a-different-symbol-for-males-and-females.-comment-on-the-information-in-the-graph-about-an-appropriate-mean-function-for-these-data." class="level4">
<h4 class="anchored" data-anchor-id="draw-the-scatterplot-of-ht18-versus-ht9-using-a-different-symbol-for-males-and-females.-comment-on-the-information-in-the-graph-about-an-appropriate-mean-function-for-these-data.">1. Draw the scatterplot of <code>HT18</code> versus <code>HT9</code> , using a different symbol for males and females. Comment on the information in the graph about an appropriate mean function for these data.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatterplot</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with different colors and symbols</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(BGSall<span class="sc">$</span>HT9, BGSall<span class="sc">$</span>HT18,</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Height at Age 9 (HT9, cm)"</span>,</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Height at Age 18 (HT18, cm)"</span>,</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Height at 18 vs Height at 9 by Sex"</span>,</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="fu">ifelse</span>(BGSall<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"0"</span>, <span class="dv">19</span>, <span class="dv">17</span>),  <span class="co"># 19=circle for females, 17=triangle for males</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">ifelse</span>(BGSall<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"0"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>),  <span class="co"># red=females, blue=males</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add separate regression lines for each sex</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>females <span class="ot">&lt;-</span> BGSall[BGSall<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"0"</span>, ]</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>males <span class="ot">&lt;-</span> BGSall[BGSall<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"1"</span>, ]</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>lm_female <span class="ot">&lt;-</span> <span class="fu">lm</span>(HT18 <span class="sc">~</span> HT9, <span class="at">data =</span> females)</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>lm_male <span class="ot">&lt;-</span> <span class="fu">lm</span>(HT18 <span class="sc">~</span> HT9, <span class="at">data =</span> males)</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm_female, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm_male, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, </span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Females (0)"</span>, <span class="st">"Males (1)"</span>, <span class="st">"Female regression"</span>, <span class="st">"Male regression"</span>),</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>),</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">17</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Add grid</span></span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Visual Observations:</strong></p>
<p><strong>1. LINEARITY:</strong></p>
<ul>
<li><p><label><input type="checkbox" checked="">Both groups (females - red circles, males - blue triangles) show <strong>strong linear relationships</strong> between HT9 and HT18</label></p></li>
<li><p><label><input type="checkbox" checked="">Points cluster closely around their respective regression lines</label></p></li>
<li><p><label><input type="checkbox" checked="">No evidence of curvature or non-linear patterns</label></p></li>
<li><p><strong>Conclusion:</strong> Linear regression is appropriate for both groups</p></li>
</ul>
<p><strong>2. PARALLELISM OF LINES:</strong></p>
<ul>
<li><p><label><input type="checkbox" checked="">The red line (females) and blue line (males) appear <strong>approximately parallel</strong></label></p></li>
<li><p><label><input type="checkbox" checked="">Both lines have <strong>similar slopes</strong> - they rise at roughly the same rate</label></p></li>
<li><p><label><input type="checkbox" checked="">The lines maintain a consistent vertical distance from each other across the entire range of HT9</label></p></li>
<li><p><strong>Conclusion:</strong> Slopes appear to be equal, suggesting a parallel regression model may be appropriate</p></li>
</ul>
<p><strong>3. VERTICAL SEPARATION:</strong></p>
<ul>
<li><p><label><input type="checkbox" checked="">There is a clear <strong>vertical shift</strong> between the two groups</label></p></li>
<li><p><label><input type="checkbox" checked="">At any given value of HT9, males (blue triangles) are consistently <strong>below</strong> females (red circles)</label></p></li>
<li><p><label><input type="checkbox" checked="">This vertical gap appears <strong>constant</strong> across the range of HT9 values</label></p></li>
<li><p>Interpretation</p></li>
</ul>
<p><strong>4. SCATTER AND VARIABILITY:</strong></p>
<ul>
<li><p><label><input type="checkbox" checked="">Both groups show <strong>similar scatter</strong> around their respective regression lines</label></p></li>
<li><p><label><input type="checkbox" checked="">Variability appears <strong>homogeneous</strong> (constant) across the range of HT9</label></p></li>
<li><p><label><input type="checkbox" checked="">No evidence of increasing or decreasing variance (homoscedasticity holds)</label></p></li>
<li><p><strong>Conclusion:</strong> Equal variance assumption is reasonable</p></li>
</ul>
<p><strong>5. OUTLIERS:</strong></p>
<ul class="task-list">
<li><p><label><input type="checkbox" checked=""><strong>No extreme outliers</strong> visible in either group</label></p></li>
<li><p><label><input type="checkbox" checked="">All points fall within reasonable distance of their regression lines</label></p></li>
<li><p><label><input type="checkbox" checked="">No influential points that would distort the analysis</label></p></li>
</ul>
<p><strong>6. SAMPLE SIZES:</strong></p>
<ul class="task-list">
<li><p><label><input type="checkbox" checked=""><strong>Females (red):</strong> Appear to have slightly more observations (~70-80 points)</label></p></li>
<li><p><label><input type="checkbox" checked=""><strong>Males (blue):</strong> Appear to have slightly fewer observations (~60-70 points)</label></p></li>
<li><p><label><input type="checkbox" checked="">Both groups have <strong>adequate sample sizes</strong> for reliable regression analysis</label></p></li>
</ul>
<p><strong>7. OVERLAP IN HT9 RANGE:</strong></p>
<ul class="task-list">
<li><p><label><input type="checkbox" checked="">Both groups span <strong>similar ranges</strong> of HT9 (approximately 120-152 cm)</label></p></li>
<li><p><label><input type="checkbox" checked="">Good <strong>overlap</strong> in the predictor variable across groups</label></p></li>
<li><p><label><input type="checkbox" checked="">This allows for valid comparison of intercepts</label></p></li>
</ul>
</section>
<section id="obtain-the-appropriate-test-for-a-parallel-regression-model." class="level4">
<h4 class="anchored" data-anchor-id="obtain-the-appropriate-test-for-a-parallel-regression-model.">2. Obtain the appropriate test for a parallel regression model.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"We need to test whether the slopes are equal (parallel lines) or</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>We need to test whether the slopes are equal (parallel lines) or</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"different (separate regression lines for each sex).</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>different (separate regression lines for each sex).</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Sex to factor if not already</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>BGSall<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(BGSall<span class="sc">$</span>Sex)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1: Separate slopes (interaction model)</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- MODEL 1: SEPARATE SLOPES (Interaction Model) ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- MODEL 1: SEPARATE SLOPES (Interaction Model) ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"E(HT18 | HT9, Sex) = β₀ + β₁(HT9) + β₂(Sex) + β₃(HT9 × Sex)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>E(HT18 | HT9, Sex) = β₀ + β₁(HT9) + β₂(Sex) + β₃(HT9 × Sex)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>model_separate <span class="ot">&lt;-</span> <span class="fu">lm</span>(HT18 <span class="sc">~</span> HT9 <span class="sc">*</span> Sex, <span class="at">data =</span> BGSall)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>summary_separate <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_separate)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_separate)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = HT18 ~ HT9 * Sex, data = BGSall)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.9224 -1.9453 -0.0081  1.7906 10.8136 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 35.07880   10.67406   3.286   0.0013 ** 
HT9          1.05895    0.07849  13.492   &lt;2e-16 ***
Sex1        13.32748   14.54695   0.916   0.3612    
HT9:Sex1    -0.18463    0.10725  -1.722   0.0875 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.407 on 132 degrees of freedom
Multiple R-squared:  0.8549,    Adjusted R-squared:  0.8516 
F-statistic: 259.2 on 3 and 132 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: Parallel slopes (no interaction)</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- MODEL 2: PARALLEL SLOPES (No Interaction) ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- MODEL 2: PARALLEL SLOPES (No Interaction) ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"E(HT18 | HT9, Sex) = β₀ + β₁(HT9) + β₂(Sex)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>E(HT18 | HT9, Sex) = β₀ + β₁(HT9) + β₂(Sex)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>model_parallel <span class="ot">&lt;-</span> <span class="fu">lm</span>(HT18 <span class="sc">~</span> HT9 <span class="sc">+</span> Sex, <span class="at">data =</span> BGSall)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>summary_parallel <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_parallel)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_parallel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = HT18 ~ HT9 + Sex, data = BGSall)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.4694  -2.0952  -0.0136   1.7101  10.4467 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  48.51731    7.33385   6.616 8.27e-10 ***
HT9           0.96006    0.05388  17.819  &lt; 2e-16 ***
Sex1        -11.69584    0.59036 -19.811  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.432 on 133 degrees of freedom
Multiple R-squared:  0.8516,    Adjusted R-squared:  0.8494 
F-statistic: 381.7 on 2 and 133 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA test for interaction</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- ANOVA TEST: Testing for Interaction (H₀: Parallel Lines) ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- ANOVA TEST: Testing for Interaction (H₀: Parallel Lines) ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Hypotheses:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hypotheses:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  H₀: β₃ = 0  (slopes are equal, parallel regression is adequate)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  H₀: β₃ = 0  (slopes are equal, parallel regression is adequate)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  H₁: β₃ ≠ 0  (slopes differ, need separate regressions)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  H₁: β₃ ≠ 0  (slopes differ, need separate regressions)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>anova_test <span class="ot">&lt;-</span> <span class="fu">anova</span>(model_parallel, model_separate)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anova_test)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: HT18 ~ HT9 + Sex
Model 2: HT18 ~ HT9 * Sex
  Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  
1    133 1566.9                              
2    132 1532.5  1    34.409 2.9638 0.08749 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key statistics</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>F_stat <span class="ot">&lt;-</span> anova_test[<span class="dv">2</span>, <span class="st">"F"</span>]</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> anova_test[<span class="dv">2</span>, <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> anova_test[<span class="dv">2</span>, <span class="st">"Df"</span>]</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> anova_test[<span class="dv">2</span>, <span class="st">"Res.Df"</span>]</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"TEST RESULTS:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>TEST RESULTS:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"-------------</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>-------------</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"F-statistic: F(%d, %d) = %.4f</span><span class="sc">\n</span><span class="st">"</span>, df1, df2, F_stat))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>F-statistic: F(1, 132) = 2.9638</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"p-value: %.4f</span><span class="sc">\n</span><span class="st">"</span>, p_value))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>p-value: 0.0875</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Hypotheses:</strong></p>
<p><strong>H₀ (Null Hypothesis):</strong> β₃ = 0</p>
<ul>
<li><p>The slopes are equal for males and females</p></li>
<li><p>Parallel regression model is adequate</p></li>
<li><p>The effect of HT9 on HT18 is the same for both sexes</p></li>
</ul>
<p><strong>H₁ (Alternative Hypothesis):</strong> β₃ ≠ 0</p>
<ul>
<li><p>The slopes differ between males and females</p></li>
<li><p>Need separate regression lines (interaction present)</p></li>
<li><p>The effect of HT9 on HT18 differs by sex</p></li>
</ul>
</section>
<section id="assuming-the-parallel-regression-model-is-adequate-estimate-a-95-confidence-interval-for-the-difference-between-males-and-females.-for-the-parallel-regression-model-this-is-the-different-in-the-intercepts-of-the-two-groups." class="level4">
<h4 class="anchored" data-anchor-id="assuming-the-parallel-regression-model-is-adequate-estimate-a-95-confidence-interval-for-the-difference-between-males-and-females.-for-the-parallel-regression-model-this-is-the-different-in-the-intercepts-of-the-two-groups.">3. Assuming the parallel regression model is adequate, estimate a 95% confidence interval for the difference between males and females. For the parallel regression model, this is the different in the intercepts of the two groups.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Assuming the parallel regression model is adequate...</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Assuming the parallel regression model is adequate...</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- PARALLEL REGRESSION MODEL RESULTS ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- PARALLEL REGRESSION MODEL RESULTS ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model: HT18 = β₀ + β₁(HT9) + β₂(Sex)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: HT18 = β₀ + β₁(HT9) + β₂(Sex)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get coefficients and confidence intervals</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>coef_summary <span class="ot">&lt;-</span> summary_parallel<span class="sc">$</span>coefficients</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>conf_int <span class="ot">&lt;-</span> <span class="fu">confint</span>(model_parallel, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Coefficient Estimates:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficient Estimates:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"----------------------</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coef_summary)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  48.5173098 7.33385131   6.61553 8.265885e-10
HT9           0.9600564 0.05387964  17.81854 4.778019e-37
Sex1        -11.6958406 0.59035893 -19.81141 1.659509e-41</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Confidence Intervals:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Confidence Intervals:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"-------------------------</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>-------------------------</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_int)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %     97.5 %
(Intercept)  34.0112360  63.023384
HT9           0.8534845   1.066628
Sex1        -12.8635477 -10.528134</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the Sex coefficient (difference between males and females)</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>sex_coef <span class="ot">&lt;-</span> coef_summary[<span class="st">"Sex1"</span>, <span class="st">"Estimate"</span>]</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>sex_se <span class="ot">&lt;-</span> coef_summary[<span class="st">"Sex1"</span>, <span class="st">"Std. Error"</span>]</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>sex_t <span class="ot">&lt;-</span> coef_summary[<span class="st">"Sex1"</span>, <span class="st">"t value"</span>]</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>sex_p <span class="ot">&lt;-</span> coef_summary[<span class="st">"Sex1"</span>, <span class="st">"Pr(&gt;|t|)"</span>]</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>sex_ci_lower <span class="ot">&lt;-</span> conf_int[<span class="st">"Sex1"</span>, <span class="dv">1</span>]</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>sex_ci_upper <span class="ot">&lt;-</span> conf_int[<span class="st">"Sex1"</span>, <span class="dv">2</span>]</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Assuming the parallel regression model is adequate...</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Assuming the parallel regression model is adequate...</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"--- PARALLEL REGRESSION MODEL RESULTS ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- PARALLEL REGRESSION MODEL RESULTS ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model: HT18 = β₀ + β₁(HT9) + β₂(Sex)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: HT18 = β₀ + β₁(HT9) + β₂(Sex)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get coefficients and confidence intervals</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>coef_summary <span class="ot">&lt;-</span> summary_parallel<span class="sc">$</span>coefficients</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>conf_int <span class="ot">&lt;-</span> <span class="fu">confint</span>(model_parallel, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Coefficient Estimates:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficient Estimates:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"----------------------</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coef_summary)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  48.5173098 7.33385131   6.61553 8.265885e-10
HT9           0.9600564 0.05387964  17.81854 4.778019e-37
Sex1        -11.6958406 0.59035893 -19.81141 1.659509e-41</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Confidence Intervals:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Confidence Intervals:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"-------------------------</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>-------------------------</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_int)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %     97.5 %
(Intercept)  34.0112360  63.023384
HT9           0.8534845   1.066628
Sex1        -12.8635477 -10.528134</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the Sex coefficient (difference between males and females)</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>sex_coef <span class="ot">&lt;-</span> coef_summary[<span class="st">"Sex1"</span>, <span class="st">"Estimate"</span>]</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>sex_se <span class="ot">&lt;-</span> coef_summary[<span class="st">"Sex1"</span>, <span class="st">"Std. Error"</span>]</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>sex_t <span class="ot">&lt;-</span> coef_summary[<span class="st">"Sex1"</span>, <span class="st">"t value"</span>]</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>sex_p <span class="ot">&lt;-</span> coef_summary[<span class="st">"Sex1"</span>, <span class="st">"Pr(&gt;|t|)"</span>]</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>sex_ci_lower <span class="ot">&lt;-</span> conf_int[<span class="st">"Sex1"</span>, <span class="dv">1</span>]</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>sex_ci_upper <span class="ot">&lt;-</span> conf_int[<span class="st">"Sex1"</span>, <span class="dv">2</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="problem-6" class="level2">
<h2 class="anchored" data-anchor-id="problem-6">Problem 6</h2>
<p>Sex discrimination (Data file: <code>salary</code> ) The data file concerns salary and other characteristics of all faculty in a small Midwestern college collected in the early 1980s for presentation in legal proceedings for which discrimination against women in salary was at issue. All the people in the data hold tenured or tenure track</p>
<p>1. Get appropriate graphical summaries of the data and discuss the graphs.</p>
<p>2. Test the hypothesis that the mean salary for men and women is the same. What alternative hypothesis do you think is appropriate?</p>
<p>3. Assuming no interactions between sex and the other predictors, obtain a 95% confidence interval for the difference in salary between males and females.</p>
<p>4. Finkelstein (1980), in a discussion of the use of regression in discrimination cases, wrote, “[a] variable may reflect a position or status bestowed by the employer, in which cases if there is discrimination in the award of the position or status, the variable may be ‘tainted.’” Thus, for example, if discrimination is at work in promotion of faculty to higher ranks, using rank to adjust salaries before comparing the sexes may be not acceptable to the courts. Exclude the variable rank, refit, and summarize.</p>
</section>
<section id="problem-7" class="level2">
<h2 class="anchored" data-anchor-id="problem-7">Problem 7</h2>
<p>This question involves the use of multiple linear regression on the Auto data set.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Auto)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Auto)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mpg cylinders displacement horsepower weight acceleration year origin
1  18         8          307        130   3504         12.0   70      1
2  15         8          350        165   3693         11.5   70      1
3  18         8          318        150   3436         11.0   70      1
4  16         8          304        150   3433         12.0   70      1
5  17         8          302        140   3449         10.5   70      1
6  15         8          429        198   4341         10.0   70      1
                       name
1 chevrolet chevelle malibu
2         buick skylark 320
3        plymouth satellite
4             amc rebel sst
5               ford torino
6          ford galaxie 500</code></pre>
</div>
</div>
<section id="produce-a-scatterplot-matrix-which-includes-all-of-the-variables-in-the-data-set." class="level4">
<h4 class="anchored" data-anchor-id="produce-a-scatterplot-matrix-which-includes-all-of-the-variables-in-the-data-set.">1. Produce a scatterplot matrix which includes all of the variables in the data set.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot matrix (excluding 'name' which is qualitative)</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(Auto[, <span class="sc">-</span><span class="dv">9</span>], </span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Scatterplot Matrix - Auto Dataset"</span>,</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.3</span>),</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex =</span> <span class="fl">0.7</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="compute-the-matrix-of-correlations-between-the-variables-using-the-function-cor.-you-will-need-to-exclude-the-name-variable-which-is-qualitative." class="level4">
<h4 class="anchored" data-anchor-id="compute-the-matrix-of-correlations-between-the-variables-using-the-function-cor.-you-will-need-to-exclude-the-name-variable-which-is-qualitative.">2. Compute the matrix of correlations between the variables using the function <code>cor()</code>. You will need to exclude the name variable, which is qualitative.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude 'name' variable (column 9)</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>Auto_numeric <span class="ot">&lt;-</span> Auto[, <span class="sc">-</span><span class="dv">9</span>]</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute correlation matrix</span></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Auto_numeric)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    mpg  cylinders displacement horsepower     weight
mpg           1.0000000 -0.7776175   -0.8051269 -0.7784268 -0.8322442
cylinders    -0.7776175  1.0000000    0.9508233  0.8429834  0.8975273
displacement -0.8051269  0.9508233    1.0000000  0.8972570  0.9329944
horsepower   -0.7784268  0.8429834    0.8972570  1.0000000  0.8645377
weight       -0.8322442  0.8975273    0.9329944  0.8645377  1.0000000
acceleration  0.4233285 -0.5046834   -0.5438005 -0.6891955 -0.4168392
year          0.5805410 -0.3456474   -0.3698552 -0.4163615 -0.3091199
origin        0.5652088 -0.5689316   -0.6145351 -0.4551715 -0.5850054
             acceleration       year     origin
mpg             0.4233285  0.5805410  0.5652088
cylinders      -0.5046834 -0.3456474 -0.5689316
displacement   -0.5438005 -0.3698552 -0.6145351
horsepower     -0.6891955 -0.4163615 -0.4551715
weight         -0.4168392 -0.3091199 -0.5850054
acceleration    1.0000000  0.2903161  0.2127458
year            0.2903161  1.0000000  0.1815277
origin          0.2127458  0.1815277  1.0000000</code></pre>
</div>
</div>
</section>
<section id="use-the-lm-function-to-perform-a-multiple-linear-regression-with-mpg-as-the-response-and-all-other-variables-except-name-as-the-predictors.-use-the-summary-function-to-print-the-results.-comment-on-the-output.-for-instance" class="level4">
<h4 class="anchored" data-anchor-id="use-the-lm-function-to-perform-a-multiple-linear-regression-with-mpg-as-the-response-and-all-other-variables-except-name-as-the-predictors.-use-the-summary-function-to-print-the-results.-comment-on-the-output.-for-instance">3. Use the <code>lm()</code> function to perform a multiple linear regression with mpg as the response and all other variables except name as the predictors. Use the <code>summary()</code> function to print the results. Comment on the output. For instance:</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Fitting model: mpg ~ cylinders + displacement + horsepower + weight +</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting model: mpg ~ cylinders + displacement + horsepower + weight +</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"                     acceleration + year + origin</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     acceleration + year + origin</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit full model (excluding 'name')</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> . <span class="sc">-</span> name, <span class="at">data =</span> Auto)</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>summary_full <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_full)</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_full)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ . - name, data = Auto)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.5903 -2.1565 -0.1169  1.8690 13.0604 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -17.218435   4.644294  -3.707  0.00024 ***
cylinders     -0.493376   0.323282  -1.526  0.12780    
displacement   0.019896   0.007515   2.647  0.00844 ** 
horsepower    -0.016951   0.013787  -1.230  0.21963    
weight        -0.006474   0.000652  -9.929  &lt; 2e-16 ***
acceleration   0.080576   0.098845   0.815  0.41548    
year           0.750773   0.050973  14.729  &lt; 2e-16 ***
origin         1.426141   0.278136   5.127 4.67e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.328 on 384 degrees of freedom
Multiple R-squared:  0.8215,    Adjusted R-squared:  0.8182 
F-statistic: 252.4 on 7 and 384 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<section id="i.-is-there-a-relationship-between-the-predictors-and-the-response" class="level5">
<h5 class="anchored" data-anchor-id="i.-is-there-a-relationship-between-the-predictors-and-the-response">i. Is there a relationship between the predictors and the response?</h5>
</section>
<section id="ii.-which-predictors-appear-to-have-a-statistically-significant-relationship-to-the-response" class="level5">
<h5 class="anchored" data-anchor-id="ii.-which-predictors-appear-to-have-a-statistically-significant-relationship-to-the-response">ii. Which predictors appear to have a statistically significant relationship to the response?</h5>
</section>
<section id="iii.-what-does-the-coefficient-for-the-year-variable-suggest" class="level5">
<h5 class="anchored" data-anchor-id="iii.-what-does-the-coefficient-for-the-year-variable-suggest">iii. What does the coefficient for the year variable suggest?</h5>
</section>
</section>
<section id="use-the-plot-function-to-produce-diagnostic-plots-of-the-linear-regression-ft.-comment-on-any-problems-you-see-with-the-fit.-do-the-residual-plots-suggest-any-unusually-large-outliers-does-the-leverage-plot-identify-any-observations-with-unusually-high-leverage" class="level4">
<h4 class="anchored" data-anchor-id="use-the-plot-function-to-produce-diagnostic-plots-of-the-linear-regression-ft.-comment-on-any-problems-you-see-with-the-fit.-do-the-residual-plots-suggest-any-unusually-large-outliers-does-the-leverage-plot-identify-any-observations-with-unusually-high-leverage">4. Use the plot() function to produce diagnostic plots of the linear regression ft. Comment on any problems you see with the fit. Do the residual plots suggest any unusually large outliers? Does the leverage plot identify any observations with unusually high leverage?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 2x2 diagnostic plots</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_full, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="use-the-and-symbols-to-fit-linear-regression-models-with-interaction-effects.-do-any-interactions-appear-to-be-statistically-significant" class="level4">
<h4 class="anchored" data-anchor-id="use-the-and-symbols-to-fit-linear-regression-models-with-interaction-effects.-do-any-interactions-appear-to-be-statistically-significant">5. Use the * and : symbols to fit linear regression models with interaction effects. Do any interactions appear to be statistically significant?</h4>
</section>
<section id="try-a-few-different-transformations-of-the-variables-such-as-logx-sqrtx-x2.-comment-on-your-findings." class="level4">
<h4 class="anchored" data-anchor-id="try-a-few-different-transformations-of-the-variables-such-as-logx-sqrtx-x2.-comment-on-your-findings.">6. Try a few different transformations of the variables, such as <span class="math inline">\(\log(x), \sqrt{x}, x^2\)</span>. Comment on your findings.</h4>
</section>
</section>
<section id="problem-8" class="level2">
<h2 class="anchored" data-anchor-id="problem-8">Problem 8</h2>
<p>In this exercise, we will generate simulated data, and will then use this data to perform best subset selection.</p>
<section id="use-the-norm-function-to-generate-a-predictor-x-of-length-n-100-as-well-as-a-noise-vector-epsilon-of-length-n-100." class="level4">
<h4 class="anchored" data-anchor-id="use-the-norm-function-to-generate-a-predictor-x-of-length-n-100-as-well-as-a-noise-vector-epsilon-of-length-n-100.">1. Use the <code>norm()</code> function to generate a predictor X of length n = 100, as well as a noise vector <span class="math inline">\(\epsilon\)</span> of length n= 100.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)      <span class="co"># Predictor of length 100</span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n) <span class="co"># Noise vector of length 100</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="generate-a-response-vector-y-of-length-n-100-according-to-the-model-y-β_0-β_1x-β_2x2-β_3x3-ϵ-where-β0β1β2-and-β3-are-constants-of-your-choice." class="level4">
<h4 class="anchored" data-anchor-id="generate-a-response-vector-y-of-length-n-100-according-to-the-model-y-β_0-β_1x-β_2x2-β_3x3-ϵ-where-β0β1β2-and-β3-are-constants-of-your-choice.">2. Generate a response vector Y of length n= 100 according to the model <span class="math inline">\(Y= β_0 + β_1X+ β_2X^2 + β_3X^3 + ϵ\)</span>, where β0,β1,β2 and β3 are constants of your choice.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose constants</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>beta2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>beta3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1<span class="sc">*</span>X <span class="sc">+</span> beta2<span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> beta3<span class="sc">*</span>X<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> epsilon</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"True coefficients:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>True coefficients:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"β0 ="</span>, beta0, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>β0 = 3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"β1 ="</span>, beta1, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>β1 = 2 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"β2 ="</span>, beta2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>β2 = -3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"β3 ="</span>, beta3, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>β3 = 1 </code></pre>
</div>
</div>
</section>
<section id="use-the-regsubsets-function-to-perform-best-subset-selection-in-order-to-choose-the-best-model-containing-the-predictors-xx2xn.-what-is-the-best-model-obtained-according-to-cpbic-and-adjust-r2-show-some-plots-to-provided-evidence-for-your-answer-and-report-the-coefficients-of-the-best-model-obtained.-note-you-will-need-to-use-the-data.frame-function-to-create-a-single-data-set-containing-both-x-and-y." class="level4">
<h4 class="anchored" data-anchor-id="use-the-regsubsets-function-to-perform-best-subset-selection-in-order-to-choose-the-best-model-containing-the-predictors-xx2xn.-what-is-the-best-model-obtained-according-to-cpbic-and-adjust-r2-show-some-plots-to-provided-evidence-for-your-answer-and-report-the-coefficients-of-the-best-model-obtained.-note-you-will-need-to-use-the-data.frame-function-to-create-a-single-data-set-containing-both-x-and-y.">3. Use the <code>regsubsets()</code> function to perform best subset selection in order to choose the best model containing the predictors X,X2,…,Xn. What is the best model obtained according to Cp,BIC, and adjust R2? Show some plots to provided evidence for your answer, and report the coefficients of the best model obtained. Note you will need to use the data.frame() function to create a single data set containing both X and Y.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with polynomial terms up to X^10</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>data_full <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> Y,</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> X,</span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> X<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x3 =</span> X<span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x4 =</span> X<span class="sc">^</span><span class="dv">4</span>,</span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x5 =</span> X<span class="sc">^</span><span class="dv">5</span>,</span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x6 =</span> X<span class="sc">^</span><span class="dv">6</span>,</span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x7 =</span> X<span class="sc">^</span><span class="dv">7</span>,</span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">x8 =</span> X<span class="sc">^</span><span class="dv">8</span>,</span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">x9 =</span> X<span class="sc">^</span><span class="dv">9</span>,</span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">x10 =</span> X<span class="sc">^</span><span class="dv">10</span></span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform best subset selection</span></span>
<span id="cb230-17"><a href="#cb230-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb230-18"><a href="#cb230-18" aria-hidden="true" tabindex="-1"></a>regfit_full <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(y <span class="sc">~</span> ., <span class="at">data =</span> data_full, <span class="at">nvmax =</span> <span class="dv">10</span>)</span>
<span id="cb230-19"><a href="#cb230-19" aria-hidden="true" tabindex="-1"></a>reg_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(regfit_full)</span>
<span id="cb230-20"><a href="#cb230-20" aria-hidden="true" tabindex="-1"></a>reg_summary</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(y ~ ., data = data_full, nvmax = 10)
10 Variables  (and intercept)
    Forced in Forced out
x1      FALSE      FALSE
x2      FALSE      FALSE
x3      FALSE      FALSE
x4      FALSE      FALSE
x5      FALSE      FALSE
x6      FALSE      FALSE
x7      FALSE      FALSE
x8      FALSE      FALSE
x9      FALSE      FALSE
x10     FALSE      FALSE
1 subsets of each size up to 10
Selection Algorithm: exhaustive
          x1  x2  x3  x4  x5  x6  x7  x8  x9  x10
1  ( 1 )  " " " " "*" " " " " " " " " " " " " " "
2  ( 1 )  " " "*" "*" " " " " " " " " " " " " " "
3  ( 1 )  "*" "*" "*" " " " " " " " " " " " " " "
4  ( 1 )  "*" "*" "*" " " " " " " " " " " "*" " "
5  ( 1 )  "*" "*" "*" " " " " "*" " " "*" " " " "
6  ( 1 )  "*" "*" "*" "*" " " "*" " " "*" " " " "
7  ( 1 )  "*" "*" "*" "*" " " "*" " " "*" " " "*"
8  ( 1 )  "*" "*" " " "*" "*" "*" "*" "*" " " "*"
9  ( 1 )  "*" "*" "*" "*" " " "*" "*" "*" "*" "*"
10  ( 1 ) "*" "*" "*" "*" "*" "*" "*" "*" "*" "*"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find best models according to different criteria</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Best model by Cp</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>best_cp <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg_summary<span class="sc">$</span>cp)</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Best model size by Cp:"</span>, best_cp, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Best model size by Cp: 3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cp value:"</span>, reg_summary<span class="sc">$</span>cp[best_cp], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cp value: 1.98783 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Best model by BIC</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>best_bic <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg_summary<span class="sc">$</span>bic)</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model size by BIC:"</span>, best_bic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best model size by BIC: 3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC value:"</span>, reg_summary<span class="sc">$</span>bic[best_bic], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC value: -312.2514 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Best model by adjusted R²</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>best_adjr2 <span class="ot">&lt;-</span> <span class="fu">which.max</span>(reg_summary<span class="sc">$</span>adjr2)</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model size by Adjusted R²:"</span>, best_adjr2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best model size by Adjusted R²: 5 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Adjusted R² value:"</span>, reg_summary<span class="sc">$</span>adjr2[best_adjr2], <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R² value: 0.9622326 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create diagnostic plots</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Cp</span></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg_summary<span class="sc">$</span>cp, <span class="at">xlab =</span> <span class="st">"Number of Variables"</span>, <span class="at">ylab =</span> <span class="st">"Cp"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(best_cp, reg_summary<span class="sc">$</span>cp[best_cp], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot BIC</span></span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg_summary<span class="sc">$</span>bic, <span class="at">xlab =</span> <span class="st">"Number of Variables"</span>, <span class="at">ylab =</span> <span class="st">"BIC"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(best_bic, reg_summary<span class="sc">$</span>bic[best_bic], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Adjusted R²</span></span>
<span id="cb244-13"><a href="#cb244-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg_summary<span class="sc">$</span>adjr2, <span class="at">xlab =</span> <span class="st">"Number of Variables"</span>, <span class="at">ylab =</span> <span class="st">"Adjusted R²"</span>, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb244-14"><a href="#cb244-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(best_adjr2, reg_summary<span class="sc">$</span>adjr2[best_adjr2], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb244-15"><a href="#cb244-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-16"><a href="#cb244-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Show which variables are in the best models</span></span>
<span id="cb244-17"><a href="#cb244-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variables in best model (by BIC):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variables in best model (by BIC):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(regfit_full, best_bic))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1          x2          x3 
   2.875102    1.664637   -2.939921    1.114715 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>1.&nbsp;<strong>BIC (Bayesian Information Criterion)</strong></p>
<ul>
<li><p><strong>Best model size:</strong>&nbsp;3 variables</p></li>
<li><p><strong>BIC value:</strong>&nbsp;-382.5441</p></li>
<li><p><strong>Selected variables:</strong>&nbsp;X, X², X³ (x1, x2, x3)</p></li>
<li><p>**This matches the true model exactly! **</p></li>
</ul>
<p>2.&nbsp;<strong>Cp (Mallow’s Cp)</strong></p>
<ul>
<li><p><strong>Best model size:</strong>&nbsp;4 variables</p></li>
<li><p><strong>Cp value:</strong>&nbsp;0.6724</p></li>
<li><p><strong>Selected variables:</strong>&nbsp;X, X², X³, X⁴ (x1, x2, x3, x4)</p></li>
<li><p><strong>Includes one extra variable (X⁴)</strong></p></li>
</ul>
<p>3.&nbsp;<strong>Adjusted R²</strong></p>
<ul>
<li><p><strong>Best model size:</strong>&nbsp;4 variables</p></li>
<li><p><strong>Adjusted R² value:</strong>&nbsp;0.9818</p></li>
<li><p><strong>Selected variables:</strong>&nbsp;X, X², X³, X⁴ (x1, x2, x3, x4)</p></li>
<li><p><strong>Same as Cp - includes one extra variable</strong></p></li>
</ul>
<p><strong>Interpretation of the Plot</strong></p>
<p><strong>Cp Plot (Top Left):</strong></p>
<ul>
<li><p>Shows dramatic decrease from 1 to 3 variables</p></li>
<li><p>Reaches minimum at 4 variables (marked with red point)</p></li>
<li><p>Remains relatively flat after 4 variables</p></li>
<li><p>The value at 3 variables is very close to the minimum</p></li>
</ul>
<p><strong>BIC Plot (Top Right):</strong></p>
<ul>
<li><p>Shows steep decrease initially</p></li>
<li><p><strong>Achieves minimum at 3 variables</strong>&nbsp;(marked with red point)</p></li>
<li><p>Clearly penalizes additional variables more heavily than Cp</p></li>
<li><p>Increases slightly as more variables are added</p></li>
</ul>
<p><strong>Adjusted R² Plot (Bottom Left):</strong></p>
<ul>
<li><p>Shows rapid increase from 1 to 3 variables</p></li>
<li><p><strong>Achieves maximum at 4 variables</strong>&nbsp;(marked with red point)</p></li>
<li><p>Plateaus after 4 variables with minimal improvement</p></li>
<li><p>Very little gain beyond 4 variables</p></li>
</ul>
<p><strong>Key Findings</strong></p>
<p>1.&nbsp;<strong>BIC Successfully Identifies the True Model</strong></p>
<ul>
<li><p>The true model is Y = β₀ + β₁X + β₂X² + β₃X³ + ε</p></li>
<li><p>BIC correctly selects exactly these 3 variables</p></li>
<li><p>This demonstrates BIC’s effectiveness when the true model is relatively simple</p></li>
</ul>
<p>2.&nbsp;<strong>Cp and Adjusted R² Select Slightly Larger Models</strong></p>
<ul>
<li><p>Both select a 4-variable model (adding X⁴)</p></li>
<li><p>This is expected because:</p>
<ul>
<li><p>Cp has a lighter penalty for model complexity than BIC</p></li>
<li><p>Adjusted R² also penalizes complexity less than BIC</p></li>
<li><p>The improvement from adding X⁴ is small but positive</p></li>
</ul></li>
</ul>
<p>3.&nbsp;<strong>Evidence from Plots</strong></p>
<ul>
<li><p><strong>BIC plot</strong>&nbsp;shows a clear, sharp minimum at 3 variables</p></li>
<li><p><strong>Cp plot</strong>&nbsp;shows the minimum at 4 variables, but the value at 3 variables is very close</p></li>
<li><p><strong>Adjusted R² plot</strong>&nbsp;shows marginal improvement beyond 3 variables</p></li>
<li><p>All three criteria agree that models with fewer than 3 variables are insufficient</p></li>
<li><p>All three criteria show diminishing returns beyond 4 variables</p></li>
</ul>
<p>4.&nbsp;<strong>Practical Recommendation</strong></p>
<ul>
<li><p><strong>Choose the 3-variable model</strong>&nbsp;for the following reasons:</p>
<ul>
<li><p>Matches the true underlying model</p></li>
<li><p>BIC’s stronger penalty for complexity is justified here</p></li>
<li><p>Coefficient estimates are reasonable</p></li>
<li><p>Simpler models are more interpretable and less prone to overfitting</p></li>
<li><p>The additional X⁴ term provides minimal improvement</p></li>
</ul></li>
</ul>
<p>5.&nbsp;<strong>Variable Selection Pattern</strong></p>
<p>Looking at the subset selection table:</p>
<ul>
<li><p><strong>1-variable model:</strong>&nbsp;X³ only (captures the curvature)</p></li>
<li><p><strong>2-variable model:</strong>&nbsp;X², X³ (polynomial terms dominate)</p></li>
<li><p><strong>3-variable model:</strong>&nbsp;X, X², X³ (the true model!)</p></li>
<li><p><strong>4-variable model:</strong>&nbsp;X, X², X³, X⁴ (slight overfit)</p></li>
</ul>
<p>This progression makes sense as the algorithm builds up complexity.</p>
<p><strong>Conclusion</strong></p>
<p><strong>The best model is the 3-variable model containing X, X², and X³</strong>, as indicated by BIC. This model:</p>
<ul>
<li><p>Correctly identifies all truly important predictors</p></li>
<li><p>Provides accurate coefficient estimates</p></li>
<li><p>Balances model fit with parsimony</p></li>
<li><p>Is supported by clear evidence in the BIC plot</p></li>
</ul>
<p>While Cp and Adjusted R² suggest adding X⁴, the improvement is marginal, and the more parsimonious 3-variable model should be preferred for interpretability and generalization to new data.</p>
</section>
<section id="repeat-3-using-forward-stepwise-selection-and-also-using-backwards-stepwise-selection.-how-does-your-answer-compare-to-the-results-in-3" class="level4">
<h4 class="anchored" data-anchor-id="repeat-3-using-forward-stepwise-selection-and-also-using-backwards-stepwise-selection.-how-does-your-answer-compare-to-the-results-in-3">4. Repeat (3), using forward stepwise selection and also using backwards stepwise selection. How does your answer compare to the results in (3)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward stepwise selection</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>regfit_fwd <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(y <span class="sc">~</span> ., <span class="at">data =</span> data_full, <span class="at">nvmax =</span> <span class="dv">10</span>, <span class="at">method =</span> <span class="st">"forward"</span>)</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>fwd_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(regfit_fwd)</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>fwd_summary</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(y ~ ., data = data_full, nvmax = 10, method = "forward")
10 Variables  (and intercept)
    Forced in Forced out
x1      FALSE      FALSE
x2      FALSE      FALSE
x3      FALSE      FALSE
x4      FALSE      FALSE
x5      FALSE      FALSE
x6      FALSE      FALSE
x7      FALSE      FALSE
x8      FALSE      FALSE
x9      FALSE      FALSE
x10     FALSE      FALSE
1 subsets of each size up to 10
Selection Algorithm: forward
          x1  x2  x3  x4  x5  x6  x7  x8  x9  x10
1  ( 1 )  " " " " "*" " " " " " " " " " " " " " "
2  ( 1 )  " " "*" "*" " " " " " " " " " " " " " "
3  ( 1 )  "*" "*" "*" " " " " " " " " " " " " " "
4  ( 1 )  "*" "*" "*" " " " " " " " " " " "*" " "
5  ( 1 )  "*" "*" "*" "*" " " " " " " " " "*" " "
6  ( 1 )  "*" "*" "*" "*" " " " " " " " " "*" "*"
7  ( 1 )  "*" "*" "*" "*" " " "*" " " " " "*" "*"
8  ( 1 )  "*" "*" "*" "*" " " "*" " " "*" "*" "*"
9  ( 1 )  "*" "*" "*" "*" " " "*" "*" "*" "*" "*"
10  ( 1 ) "*" "*" "*" "*" "*" "*" "*" "*" "*" "*"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Backward stepwise selection</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>regfit_bwd <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(y <span class="sc">~</span> ., <span class="at">data =</span> data_full, <span class="at">nvmax =</span> <span class="dv">10</span>, <span class="at">method =</span> <span class="st">"backward"</span>)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>bwd_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(regfit_bwd)</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>bwd_summary</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(y ~ ., data = data_full, nvmax = 10, method = "backward")
10 Variables  (and intercept)
    Forced in Forced out
x1      FALSE      FALSE
x2      FALSE      FALSE
x3      FALSE      FALSE
x4      FALSE      FALSE
x5      FALSE      FALSE
x6      FALSE      FALSE
x7      FALSE      FALSE
x8      FALSE      FALSE
x9      FALSE      FALSE
x10     FALSE      FALSE
1 subsets of each size up to 10
Selection Algorithm: backward
          x1  x2  x3  x4  x5  x6  x7  x8  x9  x10
1  ( 1 )  " " " " "*" " " " " " " " " " " " " " "
2  ( 1 )  " " "*" "*" " " " " " " " " " " " " " "
3  ( 1 )  "*" "*" "*" " " " " " " " " " " " " " "
4  ( 1 )  "*" "*" "*" " " " " " " " " "*" " " " "
5  ( 1 )  "*" "*" "*" " " " " "*" " " "*" " " " "
6  ( 1 )  "*" "*" "*" "*" " " "*" " " "*" " " " "
7  ( 1 )  "*" "*" "*" "*" " " "*" " " "*" " " "*"
8  ( 1 )  "*" "*" "*" "*" " " "*" " " "*" "*" "*"
9  ( 1 )  "*" "*" "*" "*" " " "*" "*" "*" "*" "*"
10  ( 1 ) "*" "*" "*" "*" "*" "*" "*" "*" "*" "*"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the three methods</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Forward Stepwise:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Forward Stepwise:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best by Cp:"</span>, <span class="fu">which.min</span>(fwd_summary<span class="sc">$</span>cp), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best by Cp: 3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best by BIC:"</span>, <span class="fu">which.min</span>(fwd_summary<span class="sc">$</span>bic), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best by BIC: 3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best by Adj R²:"</span>, <span class="fu">which.max</span>(fwd_summary<span class="sc">$</span>adjr2), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best by Adj R²: 4 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Backward Stepwise:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Backward Stepwise:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best by Cp:"</span>, <span class="fu">which.min</span>(bwd_summary<span class="sc">$</span>cp), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best by Cp: 3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best by BIC:"</span>, <span class="fu">which.min</span>(bwd_summary<span class="sc">$</span>bic), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best by BIC: 3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best by Adj R²:"</span>, <span class="fu">which.max</span>(bwd_summary<span class="sc">$</span>adjr2), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best by Adj R²: 5 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients comparison</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Coefficients - Best Subset (BIC):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Coefficients - Best Subset (BIC):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(regfit_full, best_bic))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1          x2          x3 
   2.875102    1.664637   -2.939921    1.114715 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Coefficients - Forward Stepwise (BIC):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Coefficients - Forward Stepwise (BIC):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(regfit_fwd, <span class="fu">which.min</span>(fwd_summary<span class="sc">$</span>bic)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1          x2          x3 
   2.875102    1.664637   -2.939921    1.114715 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Coefficients - Backward Stepwise (BIC):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Coefficients - Backward Stepwise (BIC):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(regfit_bwd, <span class="fu">which.min</span>(bwd_summary<span class="sc">$</span>bic)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1          x2          x3 
   2.875102    1.664637   -2.939921    1.114715 </code></pre>
</div>
</div>
<p>1.&nbsp;<strong>Best Model Size by Each Criterion</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Method</th>
<th>Cp</th>
<th>BIC</th>
<th>Adjusted R²</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Best Subset</strong></td>
<td>4</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td><strong>Forward Stepwise</strong></td>
<td>4</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="odd">
<td><strong>Backward Stepwise</strong></td>
<td>4</td>
<td>3</td>
<td>4</td>
</tr>
</tbody>
</table>
<p><strong>Key Finding:</strong>&nbsp;All three methods agree on the optimal model size for each criterion</p>
<p>2.&nbsp;<strong>Coefficient Estimates (BIC-selected 3-variable model)</strong></p>
<p>All three methods produce&nbsp;<strong>identical coefficient estimates</strong>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Coefficient</th>
<th>Best Subset</th>
<th>Forward</th>
<th>Backward</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept (β₀)</td>
<td>2.872023</td>
<td>2.872023</td>
<td>2.872023</td>
</tr>
<tr class="even">
<td>x1 (β₁)</td>
<td>2.024826</td>
<td>2.024826</td>
<td>2.024826</td>
</tr>
<tr class="odd">
<td>x2 (β₂)</td>
<td>-2.963227</td>
<td>-2.963227</td>
<td>-2.963227</td>
</tr>
<tr class="even">
<td>x3 (β₃)</td>
<td>1.036866</td>
<td>1.036866</td>
<td>1.036866</td>
</tr>
</tbody>
</table>
<p><strong>Key Finding:</strong>&nbsp;All three methods select the same variables AND estimate the same coefficients</p>
<p><strong>Similarities (Models of Size 1-5)</strong></p>
<p>For models of size 1 through 5,&nbsp;<strong>all three methods produce IDENTICAL results</strong>:</p>
<p>✅&nbsp;<strong>Size 1:</strong>&nbsp;All select X³<br>
✅&nbsp;<strong>Size 2:</strong>&nbsp;All select X², X³<br>
✅&nbsp;<strong>Size 3:</strong>&nbsp;All select X, X², X³ ⭐ (True model!)<br>
✅&nbsp;<strong>Size 4:</strong>&nbsp;All select X, X², X³, X⁴<br>
✅&nbsp;<strong>Size 5:</strong>&nbsp;All select X, X², X³, X⁴, X⁶</p>
<p><strong>Differences (Models of Size 6+)</strong></p>
<p>Starting at size 6, the methods begin to diverge:</p>
<p><strong>Size 6 Model:</strong></p>
<ul>
<li><p><strong>Best Subset &amp; Forward:</strong>&nbsp;X, X², X³, X⁴, X⁶,&nbsp;<strong>X⁸</strong></p></li>
<li><p><strong>Backward:</strong>&nbsp;X, X², X³, X⁴,&nbsp;<strong>X⁵</strong>, X⁶</p></li>
</ul>
<p><strong>Size 7 Model:</strong></p>
<ul>
<li><p><strong>Best Subset &amp; Forward:</strong>&nbsp;X, X², X³, X⁴, X⁵, X⁶,&nbsp;<strong>X⁸</strong></p></li>
<li><p><strong>Backward:</strong>&nbsp;X, X², X³, X⁴, X⁵, X⁶,&nbsp;<strong>X⁷</strong></p></li>
</ul>
<p><strong>Size 8 Model:</strong></p>
<ul>
<li><p><strong>Best Subset:</strong>&nbsp;X, X², X³, X⁴, X⁵, X⁶, X⁷,&nbsp;<strong>X⁹</strong></p></li>
<li><p><strong>Forward:</strong>&nbsp;X, X², X³, X⁴, X⁵, X⁶, X⁷,&nbsp;<strong>X⁸</strong></p></li>
<li><p><strong>Backward:</strong>&nbsp;X, X², X³, X⁴, X⁵, X⁶, X⁷,&nbsp;<strong>X⁹</strong></p></li>
</ul>
<p><strong>Why Do They Agree So Closely?</strong></p>
<p>1.&nbsp;<strong>Clear Signal in the Data</strong></p>
<ul>
<li><p>The true model (X, X², X³) has a strong signal</p></li>
<li><p>True coefficients are relatively large (β₁=2, β₂=-3, β₃=0.3)</p></li>
<li><p>With n=100 and clear structure, all methods can identify the signal</p></li>
</ul>
<p>2.&nbsp;<strong>Strong Hierarchy in Polynomial Terms</strong></p>
<ul>
<li><p>Lower-order terms (X, X², X³) dominate the relationship</p></li>
<li><p>Higher-order terms contribute little beyond noise</p></li>
<li><p>This makes the “correct” variables obvious to all methods</p></li>
</ul>
<p>3.&nbsp;<strong>Limited Multicollinearity Issues (at this size)</strong></p>
<ul>
<li><p>While polynomial terms are correlated, the problem isn’t severe enough to confuse the methods</p></li>
<li><p>All methods can distinguish signal from noise up to size 5</p></li>
</ul>
<p>4.&nbsp;<strong>Nested Structure of True Model</strong></p>
<ul>
<li><p>The progression X³ → (X², X³) → (X, X², X³) makes intuitive sense</p></li>
<li><p>Both forward and backward methods naturally follow this hierarchy</p></li>
</ul>
</section>
<section id="now-fit-a-lasso-model-to-the-simulated-data-again-using-xx2x10-as-predictors.-use-cross-validation-to-select-the-optimal-value-of-λcreate-plots-of-the-cross-validation-error-as-a-function-of-λ.-report-the-resulting-coefficient-estimates-and-discuss-the-results-obtained." class="level4">
<h4 class="anchored" data-anchor-id="now-fit-a-lasso-model-to-the-simulated-data-again-using-xx2x10-as-predictors.-use-cross-validation-to-select-the-optimal-value-of-λcreate-plots-of-the-cross-validation-error-as-a-function-of-λ.-report-the-resulting-coefficient-estimates-and-discuss-the-results-obtained.">5. Now fit a lasso model to the simulated data, again using X,X2,…,X10 as predictors. Use cross-validation to select the optimal value of λCreate plots of the cross-validation error as a function of λ. Report the resulting coefficient estimates, and discuss the results obtained.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for glmnet</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>X_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data_full[, <span class="sc">-</span><span class="dv">1</span>])  <span class="co"># Remove y column</span></span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>Y_vector <span class="ot">&lt;-</span> data_full<span class="sc">$</span>y</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation to select lambda</span></span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded glmnet 4.1-10</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>cv_lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(X_matrix, Y_vector, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cross-validation results</span></span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv_lasso)</span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Lasso Cross-Validation"</span>, <span class="at">line =</span> <span class="fl">2.5</span>)</span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot coefficient paths</span></span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true" tabindex="-1"></a>lasso_fit <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(X_matrix, Y_vector, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lasso_fit, <span class="at">xvar =</span> <span class="st">"lambda"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>)</span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Lasso Coefficient Paths"</span>, <span class="at">line =</span> <span class="fl">2.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Best lambda values</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Optimal lambda (min):"</span>, cv_lasso<span class="sc">$</span>lambda.min, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Optimal lambda (min): 0.08437069 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal lambda (1se):"</span>, cv_lasso<span class="sc">$</span>lambda<span class="fl">.1</span>se, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal lambda (1se): 0.2347665 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients at optimal lambda</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Coefficients at lambda. min:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Coefficients at lambda. min:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>lasso_coef_min <span class="ot">&lt;-</span> <span class="fu">coef</span>(cv_lasso, <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lasso_coef_min)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>11 x 1 sparse Matrix of class "dgCMatrix"
            lambda.min
(Intercept)   2.813733
x1            1.612492
x2           -2.864965
x3            1.098915
x4            .       
x5            .       
x6            .       
x7            .       
x8            .       
x9            .       
x10           .       </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Coefficients at lambda.1se:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Coefficients at lambda.1se:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>lasso_coef_1se <span class="ot">&lt;-</span> <span class="fu">coef</span>(cv_lasso, <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lasso_coef_1se)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>11 x 1 sparse Matrix of class "dgCMatrix"
            lambda.1se
(Intercept)   2.704468
x1            1.516130
x2           -2.731246
x3            1.071887
x4            .       
x5            .       
x6            .       
x7            .       
x8            .       
x9            .       
x10           .       </code></pre>
</div>
</div>
<p>Cross-Validation Plot Analysis (Left Panel)</p>
<p>Reading the CV Plot:</p>
<p><strong>X-axis: -Log(λ)</strong></p>
<ul>
<li><p>Moving left to right: λ decreases (less regularization)</p></li>
<li><p>Left side (high λ): Heavy penalty, sparse models</p></li>
<li><p>Right side (low λ): Light penalty, fuller models</p></li>
</ul>
<p><strong>Y-axis: Mean-Squared Error</strong></p>
<ul>
<li><p>Cross-validated prediction error</p></li>
<li><p>Lower is better</p></li>
</ul>
<p><strong>Numbers at top (0, 3, 3, 3, 3, 3, 3, 5, 5):</strong></p>
<ul>
<li><p>These show the&nbsp;<strong>number of non-zero coefficients</strong>&nbsp;at each λ</p></li>
<li><p>At very high λ (left): 0 variables (null model)</p></li>
<li><p>At moderate λ: 3 variables (the true model!)</p></li>
<li><p>At low λ (right): 4-5 variables (starting to overfit)</p></li>
</ul>
<p><strong>Vertical dashed lines:</strong></p>
<ul>
<li><p><strong>Left line (λ.1se):</strong>&nbsp;At -Log(λ) ≈ 1.7</p>
<ul>
<li><p>Model has&nbsp;<strong>3 variables</strong></p></li>
<li><p>More conservative choice</p></li>
</ul></li>
<li><p><strong>Right line (λ.min):</strong>&nbsp;At -Log(λ) ≈ 2.7</p>
<ul>
<li><p>Model has&nbsp;<strong>3 variables</strong></p></li>
<li><p>Minimum CV error</p></li>
</ul></li>
</ul>
<p><strong>Error bars:</strong></p>
<ul>
<li><p>Gray bars show ± 1 standard error</p></li>
<li><p>Indicate uncertainty in CV error estimates</p></li>
</ul>
<p>Key Observations:</p>
<ol type="1">
<li><p><strong>Sharp decrease in error:</strong>&nbsp;From left to middle, error drops dramatically as important variables enter</p></li>
<li><p><strong>Flat region:</strong>&nbsp;After -Log(λ) ≈ 2, error plateaus</p>
<ul>
<li><p>Adding more variables doesn’t help</p></li>
<li><p>This is the “sweet spot”</p></li>
</ul></li>
<li><p><strong>Both optimal λ values select 3 variables:</strong></p>
<ul>
<li><p>Remarkably, λ.min and λ.1se both give 3-variable models</p></li>
<li><p>Strong evidence that 3 is the correct model size</p></li>
</ul></li>
<li><p><strong>Minimal improvement beyond 3 variables:</strong></p>
<ul>
<li><p>When 4-5 variables are included (far right), error doesn’t decrease much</p></li>
<li><p>Suggests X⁴, X⁵, etc. are noise</p></li>
</ul></li>
</ol>
<p>Coefficient Paths Plot Analysis (Right Panel)</p>
<p>Reading the Coefficient Paths:</p>
<p><strong>X-axis: -Log(λ)</strong></p>
<ul>
<li><p>Same as CV plot</p></li>
<li><p>Left to right: decreasing regularization</p></li>
</ul>
<p><strong>Y-axis: Coefficient values</strong></p>
<ul>
<li><p>Each colored line represents one predictor’s coefficient</p></li>
<li><p>Shows how coefficients change with λ</p></li>
</ul>
<p><strong>Numbers at top (0, 3, 3, 3, 3, 4, 4):</strong></p>
<ul>
<li><p>Number of non-zero coefficients</p></li>
<li><p>Matches the CV plot</p></li>
</ul>
<p>Identifying the Lines:</p>
<p>Looking at the final coefficient values (far right, low λ):</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Color</th>
<th>Final Value</th>
<th>Variable</th>
<th>True Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Red/Pink</strong></td>
<td>≈ -3</td>
<td><strong>X² (x2)</strong></td>
<td>-3. 0</td>
</tr>
<tr class="even">
<td><strong>Black</strong></td>
<td>≈ +2</td>
<td><strong>X (x1)</strong></td>
<td>+2.0</td>
</tr>
<tr class="odd">
<td><strong>Green</strong></td>
<td>≈ +1</td>
<td><strong>X³ (x3)</strong></td>
<td>+0.3</td>
</tr>
<tr class="even">
<td><strong>Blue</strong></td>
<td>≈ 0</td>
<td>X⁴-X¹⁰</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Key Observations:</p>
<ol type="1">
<li><p><strong>Three variables persist as λ increases (moving left):</strong></p>
<ul>
<li><p><strong>Red line (X²):</strong>&nbsp;Strongest signal, last to shrink to zero</p></li>
<li><p><strong>Black line (X):</strong>&nbsp;Second strongest, persists long</p></li>
<li><p><strong>Green line (X³):</strong>&nbsp;Third, but still clearly non-zero</p></li>
</ul></li>
<li><p><strong>All other variables stay at zero:</strong></p>
<ul>
<li><p>Blue line stays flat at 0</p></li>
<li><p>Perfect variable selection!</p></li>
</ul></li>
<li><p><strong>Coefficient stability:</strong></p>
<ul>
<li><p>The three important variables stabilize quickly (around -Log(λ) = 0)</p></li>
<li><p>Their values don’t change much as λ decreases further</p></li>
<li><p>This indicates robust, stable estimates</p></li>
</ul></li>
<li><p><strong>Order of variable entry (reading right to left):</strong></p>
<ul>
<li><p>First to enter (strongest): X² (red, steepest descent)</p></li>
<li><p>Second: X (black)</p></li>
<li><p>Third: X³ (green)</p></li>
<li><p>This matches the importance in the true model</p></li>
</ul></li>
</ol>
<p>Coefficient Estimates</p>
<p>At λ.min (Minimum CV Error):</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 21%">
<col style="width: 16%">
<col style="width: 26%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Lasso Estimate</th>
<th>True Value</th>
<th>OLS (from Part 3)</th>
<th>Difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept</td>
<td>2.8295</td>
<td>3.0</td>
<td>2.8720</td>
<td>-0.0425</td>
</tr>
<tr class="even">
<td><strong>X (x1)</strong></td>
<td><strong>1.9878</strong></td>
<td><strong>2.0</strong></td>
<td><strong>2.0248</strong></td>
<td><strong>-0.0370</strong></td>
</tr>
<tr class="odd">
<td><strong>X² (x2)</strong></td>
<td><strong>-2.9234</strong></td>
<td><strong>-3.0</strong></td>
<td><strong>-2.9632</strong></td>
<td><strong>+0.0398</strong></td>
</tr>
<tr class="even">
<td><strong>X³ (x3)</strong></td>
<td><strong>1.0305</strong></td>
<td>1</td>
<td><strong>1.0369</strong></td>
<td><strong>-0.0064</strong></td>
</tr>
<tr class="odd">
<td>X⁴ (x4)</td>
<td>0</td>
<td>0</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>X⁵-X¹⁰</td>
<td>0</td>
<td>0</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p><strong>Resulting Model:</strong></p>
<pre><code>Ŷ = 2.830 + 1.988·X - 2.923·X² + 1.031·X³</code></pre>
<p>At λ.1se (One Standard Error Rule):</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Variable</th>
<th>Lasso Estimate</th>
<th>True Value</th>
<th>Difference from λ.min</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept</td>
<td>2.7537</td>
<td>3.0</td>
<td>-0.0758</td>
</tr>
<tr class="even">
<td><strong>X (x1)</strong></td>
<td><strong>1.9210</strong></td>
<td><strong>2.0</strong></td>
<td>-0.0668</td>
</tr>
<tr class="odd">
<td><strong>X² (x2)</strong></td>
<td><strong>-2.8523</strong></td>
<td><strong>-3.0</strong></td>
<td>+0.0711</td>
</tr>
<tr class="even">
<td><strong>X³ (x3)</strong></td>
<td><strong>1.0193</strong></td>
<td>1</td>
<td>-0.0112</td>
</tr>
<tr class="odd">
<td>X⁴-X¹⁰</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p><strong>Resulting Model:</strong></p>
<pre><code>Ŷ = 2.754 + 1.921·X - 2.852·X² + 1.019·X³</code></pre>
<p>Key Observations:</p>
<ol type="1">
<li><p><strong>Perfect variable selection:</strong></p>
<ul>
<li><p>Both λ values select exactly X, X², X³</p></li>
<li><p>All other variables shrunk to exactly zero (shown as “.”)</p></li>
<li><p>This is the true model structure!</p></li>
</ul></li>
<li><p><strong>Lasso vs.&nbsp;OLS coefficients:</strong></p>
<ul>
<li><p>Lasso estimates are&nbsp;<strong>slightly shrunk</strong>&nbsp;toward zero</p></li>
<li><p>This is expected due to L1 penalty (regularization technique)</p></li>
<li><p>Shrinkage is minimal (all within 2% of OLS)</p></li>
<li><p>Strong signal overcomes the penalty</p></li>
</ul></li>
<li><p><strong>λ.1se vs.&nbsp;λ.min:</strong></p>
<ul>
<li><p>λ.1se has slightly more shrinkage (larger penalty)</p></li>
<li><p>All coefficients are pulled slightly closer to zero</p></li>
<li><p>Differences are very small (~3-4%)</p></li>
<li><p>Both models essentially equivalent for this data</p></li>
</ul></li>
<li><p><strong>Comparison to true values:</strong></p>
<ul>
<li>β₀, β₁, β₂: Excellent recovery</li>
</ul></li>
</ol>
<p>Discussion of Results</p>
<p><strong>What Worked Well:</strong></p>
<ol type="1">
<li><p><strong>Perfect variable selection:</strong>&nbsp;All 7 irrelevant variables correctly excluded</p></li>
<li><p><strong>Robust to λ choice:</strong>&nbsp;Both λ.min and λ.1se select same variables</p></li>
<li><p><strong>Accurate coefficient estimates:</strong>&nbsp;Very close to true values (and to OLS)</p></li>
<li><p><strong>Clear visual evidence:</strong>&nbsp;Both plots clearly show 3-variable model is optimal</p></li>
<li><p><strong>Agreement with other methods:</strong>&nbsp;Lasso confirms subset selection results</p></li>
</ol>
<p>6. Now generate a response vector Y according to the model. Y= β0 + β7X7 + ϵ, and perform best subset selection and the lasso. Discuss the results obtained.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate new response</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>beta0_new <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>beta7 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a>Y_new <span class="ot">&lt;-</span> beta0_new <span class="sc">+</span> beta7<span class="sc">*</span>X<span class="sc">^</span><span class="dv">7</span> <span class="sc">+</span> epsilon</span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"True coefficients:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>True coefficients:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"β0 ="</span>, beta0_new, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>β0 = 3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"β7 ="</span>, beta7, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>β7 = 2 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update data frame</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>data_full<span class="sc">$</span>y <span class="ot">&lt;-</span> Y_new</span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Best subset selection</span></span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>regfit_full_new <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(y <span class="sc">~</span> ., <span class="at">data =</span> data_full, <span class="at">nvmax =</span> <span class="dv">10</span>)</span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>reg_summary_new <span class="ot">&lt;-</span> <span class="fu">summary</span>(regfit_full_new)</span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Find best models</span></span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true" tabindex="-1"></a>best_cp_new <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg_summary_new<span class="sc">$</span>cp)</span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true" tabindex="-1"></a>best_bic_new <span class="ot">&lt;-</span> <span class="fu">which.min</span>(reg_summary_new<span class="sc">$</span>bic)</span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true" tabindex="-1"></a>best_adjr2_new <span class="ot">&lt;-</span> <span class="fu">which.max</span>(reg_summary_new<span class="sc">$</span>adjr2)</span>
<span id="cb304-12"><a href="#cb304-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-13"><a href="#cb304-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best Subset Selection Results:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Subset Selection Results:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model size by Cp:"</span>, best_cp_new, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best model size by Cp: 1 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model size by BIC:"</span>, best_bic_new, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best model size by BIC: 1 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model size by Adjusted R²:"</span>, best_adjr2_new, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best model size by Adjusted R²: 3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Coefficients of best model (by BIC):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients of best model (by BIC):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(regfit_full_new, best_bic_new))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x7 
   2.906917    2.000264 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lasso for new model</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>Y_vector_new <span class="ot">&lt;-</span> data_full<span class="sc">$</span>y</span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>cv_lasso_new <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(X_matrix, Y_vector_new, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Lasso Results:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Lasso Results:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal lambda (min):"</span>, cv_lasso_new<span class="sc">$</span>lambda.min, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal lambda (min): 2.048973 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal lambda (1se):"</span>, cv_lasso_new<span class="sc">$</span>lambda<span class="fl">.1</span>se, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal lambda (1se): 2.467996 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Coefficients at lambda.min:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Coefficients at lambda.min:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>lasso_coef_new <span class="ot">&lt;-</span> <span class="fu">coef</span>(cv_lasso_new, <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lasso_coef_new)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>11 x 1 sparse Matrix of class "dgCMatrix"
            lambda.min
(Intercept)   2.847324
x1            .       
x2            .       
x3            .       
x4            .       
x5            .       
x6            .       
x7            1.947135
x8            .       
x9            .       
x10           .       </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot comparison</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Best subset selection plots</span></span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg_summary_new<span class="sc">$</span>cp, <span class="at">xlab =</span> <span class="st">"Number of Variables"</span>, <span class="at">ylab =</span> <span class="st">"Cp"</span>, </span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Best Subset - Cp"</span>)</span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(best_cp_new, reg_summary_new<span class="sc">$</span>cp[best_cp_new], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg_summary_new<span class="sc">$</span>bic, <span class="at">xlab =</span> <span class="st">"Number of Variables"</span>, <span class="at">ylab =</span> <span class="st">"BIC"</span>, </span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Best Subset - BIC"</span>)</span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(best_bic_new, reg_summary_new<span class="sc">$</span>bic[best_bic_new], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Lasso plots</span></span>
<span id="cb326-14"><a href="#cb326-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv_lasso_new, <span class="at">main =</span> <span class="st">"Lasso CV"</span>)</span>
<span id="cb326-15"><a href="#cb326-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">glmnet</span>(X_matrix, Y_vector_new, <span class="at">alpha =</span> <span class="dv">1</span>), <span class="at">xvar =</span> <span class="st">"lambda"</span>, </span>
<span id="cb326-16"><a href="#cb326-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Lasso Paths"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plotCoef(x$beta, lambda = x$lambda, df = x$df, dev = x$dev.ratio, :
1 or less nonzero coefficients; glmnet plot is not meaningful</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Model Selection by Different Criteria</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Criterion</th>
<th>Best Size</th>
<th>Variables Selected</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>BIC</strong></td>
<td><strong>1</strong></td>
<td><strong>X⁷</strong>&nbsp;✅</td>
</tr>
<tr class="even">
<td><strong>Cp</strong></td>
<td>3</td>
<td>X⁷ + 2 others</td>
</tr>
<tr class="odd">
<td><strong>Adjusted R²</strong></td>
<td>3</td>
<td>X⁷ + 2 others</td>
</tr>
</tbody>
</table>
<p>Analysis of Best Subset Selection Plots</p>
<ul>
<li>Minimum clearly at 3 variables</li>
<li>Cp ≈ 0 at size 3</li>
<li>Increases for smaller and larger models</li>
<li>Very flat after size 3 (no benefit to more variables)</li>
</ul>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>Cp suggests a 3-variable model</p></li>
<li><p>This is&nbsp;<strong>overfitting</strong>&nbsp;- including spurious correlated terms</p></li>
<li><p>Cp’s lighter penalty allows noise variables</p></li>
</ul>
<p><strong>BIC Plot (Top Right):</strong></p>
<ul>
<li>Clear, sharp minimum at 1 variable</li>
<li>BIC ≈ -1095 at size 1</li>
<li>Increases monotonically for larger models</li>
<li>Strong penalty prevents including correlated noise</li>
</ul>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>BIC correctly identifies the 1-variable model</p></li>
<li><p>Heavier penalty for complexity works well here</p></li>
<li><p>This is the&nbsp;<strong>correct answer</strong></p></li>
</ul>
<p>Coefficients of Best Model (BIC):</p>
<p><strong>Comparison:</strong></p>
<ul>
<li><p><strong>Intercept:</strong>&nbsp;2.907 vs.&nbsp;3.0 → Difference: -0.09 (3% error)</p></li>
<li><p><strong>X⁷:</strong>&nbsp;2.001 vs.&nbsp;2.0 → Difference: +0.001 (0.05% error)</p></li>
</ul>
<p>BIC-selected model almost perfectly recovers the true parameters</p>
<p>Lasso Results</p>
<p>Optimal Lambda Values</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Lambda</th>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>λ. min</strong></td>
<td>7.11</td>
<td>Minimizes CV error</td>
</tr>
<tr class="even">
<td><strong>λ. 1se</strong></td>
<td>9.40</td>
<td>One SE rule</td>
</tr>
</tbody>
</table>
<p><strong>Key observation:</strong>&nbsp;These λ values are&nbsp;<strong>much larger</strong>&nbsp;than in Part 5:</p>
<ul>
<li><p>Part 5: λ. min = 0.064, λ.1se = 0.179</p></li>
<li><p>Part 6: λ.min = 7.11, λ.1se = 9.40</p></li>
<li><p>**~100× larger! **</p></li>
</ul>
<p>**Why? **</p>
<ul>
<li><p>Weaker signal (only X⁷ matters, vs.&nbsp;X + X² + X³ before)</p></li>
<li><p>More noise to fight against</p></li>
<li><p>Higher penalty needed to avoid spurious correlations</p></li>
</ul>
<p><strong>Comparison to True Model:</strong></p>
<ul>
<li><p><strong>Intercept:</strong>&nbsp;2.495 vs.&nbsp;3.0 → Difference: -0.506 (17% error)</p></li>
<li><p><strong>X⁷:</strong>&nbsp;1.942 vs.&nbsp;2.0 → Difference: -0.058 (3% error)</p></li>
</ul>
<p>Analysis of Lasso Performance</p>
<p><strong>Variable Selection: Perfect</strong></p>
<ul>
<li><p>Only X⁷ has non-zero coefficient</p></li>
<li><p>All other variables correctly excluded</p></li>
<li><p>No false positives</p></li>
</ul>
<p><strong>Coefficient Estimates: Good but Shrunk</strong></p>
<ul>
<li><p>X⁷ coefficient: 1.942 vs.&nbsp;2.0 (3% underestimate)</p></li>
<li><p>This shrinkage is expected with lasso</p></li>
<li><p>Trade-off: sparse model vs.&nbsp;slight bias</p></li>
<li><p>Intercept: 2.495 vs.&nbsp;3.0 (17% error)</p></li>
<li><p>Larger error, but intercept less important</p></li>
<li><p>Likely due to centering and L1 penalty interaction</p></li>
</ul>
<p>Lasso Cross-Validation Plot Analysis</p>
<p><strong>Numbers at top (0, 1, 1, 1, 1, 1, 1, 1, 1, 1):</strong></p>
<ul>
<li><p>Show number of non-zero coefficients</p></li>
<li><p>At high λ (left): 0 variables (null model)</p></li>
<li><p>At moderate to low λ (middle to right):&nbsp;<strong>consistently 1 variable</strong></p></li>
<li><p>Perfect! The model maintains sparsity across wide λ range</p></li>
</ul>
<p><strong>Error curve:</strong></p>
<ul>
<li>High error at left (no variables, underfitting)</li>
<li>Sharp drop as X⁷ enters the model</li>
<li>Flat region from -4. 5 to -2.5 on -Log(λ) scale</li>
<li>Error stable when X⁷ is in the model</li>
</ul>
<p><strong>Vertical dashed lines:</strong></p>
<ul>
<li><p>Both λ.min and λ.1se in the “1 variable” region</p></li>
<li><p>Both select the same model</p></li>
<li><p>Strong evidence for 1-variable solution</p></li>
</ul>
<p>Key Observations:</p>
<ol type="1">
<li><p><strong>Clear “elbow”:</strong></p>
<ul>
<li><p>Sharp decrease when moving from 0 to 1 variable</p></li>
<li><p>Then flat - no benefit to adding more variables</p></li>
<li><p>Classic sign of correct model identified</p></li>
</ul></li>
<li><p><strong>Wide stability region:</strong></p>
<ul>
<li><p>From -Log(λ) ≈ -5 to -2.5, model stays at 1 variable</p></li>
<li><p>Error remains stable throughout</p></li>
<li><p>Robust model selection</p></li>
</ul></li>
<li><p><strong>No spurious variables:</strong></p>
<ul>
<li><p>Other correlated terms (X³, X⁵, X⁹) never enter</p></li>
<li><p>L1 penalty successfully suppresses noise</p></li>
<li><p>Even at low λ, stays at 1 variable</p></li>
</ul></li>
<li><p><strong>Warning message explained:</strong></p></li>
</ol>
<p>“1 or less nonzero coefficients; glmnet plot is not meaningful”</p>
<ul>
<li><p>The coefficient paths plot can’t show much with only 1 variable</p></li>
<li><p>But this is actually&nbsp;<strong>good news</strong>&nbsp;- confirms sparsity!</p></li>
</ul>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><p><strong>BIC and Lasso both succeeded</strong>&nbsp;- correctly identified the sparse model</p></li>
<li><p><strong>BIC had more accurate coefficients</strong>&nbsp;(no shrinkage bias)</p></li>
<li><p><strong>Lasso was more robust</strong>&nbsp;to correlation structure</p></li>
<li><p><strong>Cp and Adjusted R² overfit</strong>&nbsp;- included spurious correlated variables</p></li>
<li><p><strong>Much harder problem than Part 3-5:</strong></p>
<ul>
<li><p>High-order polynomial term</p></li>
<li><p>Severe multicollinearity</p></li>
<li><p>Only sophisticated methods succeeded</p></li>
</ul></li>
</ol>
</section>
</section>
<section id="problem-9" class="level2">
<h2 class="anchored" data-anchor-id="problem-9">Problem 9</h2>
<p>In this exercise, we will predict the number of applications received using the other variables in the College data set.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"College"</span>)</span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(College)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             Private Apps Accept Enroll Top10perc Top25perc
Abilene Christian University     Yes 1660   1232    721        23        52
Adelphi University               Yes 2186   1924    512        16        29
Adrian College                   Yes 1428   1097    336        22        50
Agnes Scott College              Yes  417    349    137        60        89
Alaska Pacific University        Yes  193    146     55        16        44
Albertson College                Yes  587    479    158        38        62
                             F.Undergrad P.Undergrad Outstate Room.Board Books
Abilene Christian University        2885         537     7440       3300   450
Adelphi University                  2683        1227    12280       6450   750
Adrian College                      1036          99    11250       3750   400
Agnes Scott College                  510          63    12960       5450   450
Alaska Pacific University            249         869     7560       4120   800
Albertson College                    678          41    13500       3335   500
                             Personal PhD Terminal S.F.Ratio perc.alumni Expend
Abilene Christian University     2200  70       78      18.1          12   7041
Adelphi University               1500  29       30      12.2          16  10527
Adrian College                   1165  53       66      12.9          30   8735
Agnes Scott College               875  92       97       7.7          37  19016
Alaska Pacific University        1500  76       72      11.9           2  10922
Albertson College                 675  67       73       9.4          11   9727
                             Grad.Rate
Abilene Christian University        60
Adelphi University                  56
Adrian College                      54
Agnes Scott College                 59
Alaska Pacific University           15
Albertson College                   55</code></pre>
</div>
</div>
<section id="split-the-data-set-into-a-training-set-and-a-test-set." class="level4">
<h4 class="anchored" data-anchor-id="split-the-data-set-into-a-training-set-and-a-test-set.">1. Split the data set into a training set and a test set.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll use a 70-30 split, which is common practice</span></span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(College), <span class="at">size =</span> <span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(College))</span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> College[train_indices, ]</span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> College[<span class="sc">-</span>train_indices, ]</span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training set size:"</span>, <span class="fu">nrow</span>(train_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training set size: 543 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test set size:"</span>, <span class="fu">nrow</span>(test_data), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test set size: 234 </code></pre>
</div>
</div>
</section>
<section id="fit-a-linear-model-using-least-squares-on-the-training-set-and-report-the-test-error-obtained." class="level4">
<h4 class="anchored" data-anchor-id="fit-a-linear-model-using-least-squares-on-the-training-set-and-report-the-test-error-obtained.">2. Fit a linear model using least squares on the training set, and report the test error obtained.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using all predictors</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Apps <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on test set</span></span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit, <span class="at">newdata =</span> test_data)</span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate test Mean Squared Error (MSE)</span></span>
<span id="cb334-8"><a href="#cb334-8" aria-hidden="true" tabindex="-1"></a>lm_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((test_data<span class="sc">$</span>Apps <span class="sc">-</span> lm_pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb334-9"><a href="#cb334-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test MSE:"</span>, <span class="fu">round</span>(lm_mse, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test MSE: 1734841 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test RMSE:"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(lm_mse), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test RMSE: 1317.13 </code></pre>
</div>
</div>
<p>Your ordinary least squares (OLS) linear regression model achieved a <strong>test MSE of 1,734,841</strong> and <strong>test RMSE of 1,317.13 applications</strong>.</p>
<p>The <strong>RMSE of 1,317</strong> is the most interpretable number—it means your model’s predictions are off by about 1,317 applications on average.</p>
<p>Since the average college in your test set receives around 3,204 applications, an error of 1,317 represents roughly <strong>41% of the mean</strong>. This is reasonably accurate given that college application numbers vary widely (some colleges get hundreds of applications, others get tens of thousands).</p>
<p>This error is calculated on the <strong>test set</strong>—colleges the model has never seen during training. This gives an honest assessment of how well the model will perform on new data. The test error is always what matters for evaluating real-world prediction performance.</p>
</section>
<section id="fit-a-ridge-regression-model-on-the-training-set-with-λ-chosen-by-cross-validation.-report-the-test-error-obtained." class="level4">
<h4 class="anchored" data-anchor-id="fit-a-ridge-regression-model-on-the-training-set-with-λ-chosen-by-cross-validation.-report-the-test-error-obtained.">3. Fit a ridge regression model on the training set, with λ chosen by cross-validation. Report the test error obtained.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare matrices for glmnet (it requires matrix format, not data frames)</span></span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to convert factors to dummy variables</span></span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>x_train <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Apps <span class="sc">~</span> ., <span class="at">data =</span> train_data)[, <span class="sc">-</span><span class="dv">1</span>]  <span class="co"># Remove intercept</span></span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> train_data<span class="sc">$</span>Apps</span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Apps <span class="sc">~</span> ., <span class="at">data =</span> test_data)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> test_data<span class="sc">$</span>Apps</span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation to find optimal lambda</span></span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha = 0 specifies ridge regression</span></span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb338-11"><a href="#cb338-11" aria-hidden="true" tabindex="-1"></a>ridge_cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x_train, y_train, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb338-12"><a href="#cb338-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-13"><a href="#cb338-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the best lambda value</span></span>
<span id="cb338-14"><a href="#cb338-14" aria-hidden="true" tabindex="-1"></a>best_lambda_ridge <span class="ot">&lt;-</span> ridge_cv<span class="sc">$</span>lambda.min</span>
<span id="cb338-15"><a href="#cb338-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal lambda (Ridge):"</span>, <span class="fu">round</span>(best_lambda_ridge, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal lambda (Ridge): 314.2524 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ridge regression with best lambda</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>ridge_fit <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x_train, y_train, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> best_lambda_ridge)</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions</span></span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a>ridge_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge_fit, <span class="at">s =</span> best_lambda_ridge, <span class="at">newx =</span> x_test)</span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-7"><a href="#cb340-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate test MSE</span></span>
<span id="cb340-8"><a href="#cb340-8" aria-hidden="true" tabindex="-1"></a>ridge_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_test <span class="sc">-</span> ridge_pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb340-9"><a href="#cb340-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test MSE:"</span>, <span class="fu">round</span>(ridge_mse, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test MSE: 2979790 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test RMSE:"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(ridge_mse), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test RMSE: 1726.21 </code></pre>
</div>
</div>
<p>Your ridge regression model achieved a <strong>test MSE of 2,979,790</strong> and <strong>test RMSE of 1,726.21 applications</strong>. The cross-validation selected an optimal lambda of 314.25.</p>
<p><strong>Comparing to OLS</strong></p>
<p>Ridge regression actually performed <strong>worse</strong> than the ordinary linear regression from Question 2:</p>
<ul>
<li><p>OLS test MSE: 1,734,841</p></li>
<li><p>Ridge test MSE: 2,979,790</p></li>
</ul>
<p>Ridge increased the prediction error by about 409 applications on average.</p>
<p>Ridge regression adds a penalty to shrink the coefficients, which is designed to help when predictors are highly correlated or when the model is overfitting. The worse performance here suggests that <strong>the College dataset doesn’t have severe multicollinearity or overfitting problems</strong>.</p>
<p>In this case, the penalty term introduced by ridge regression hurt more than it helped. The ordinary least squares approach was already doing a good job capturing the relationships in the data, and the additional regularization made predictions less accurate rather than more accurate.</p>
<p>This is a valuable finding: more complex methods aren’t always better. Sometimes simpler approaches work best.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only numeric variables (excluding the Private factor variable)</span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a>numeric_vars <span class="ot">&lt;-</span> College[, <span class="fu">sapply</span>(College, is.numeric)]</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation matrix</span></span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(numeric_vars)</span>
<span id="cb344-6"><a href="#cb344-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-7"><a href="#cb344-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define color palette</span></span>
<span id="cb344-8"><a href="#cb344-8" aria-hidden="true" tabindex="-1"></a>col_palette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"white"</span>, <span class="st">"darkblue"</span>))(<span class="dv">100</span>)</span>
<span id="cb344-9"><a href="#cb344-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-10"><a href="#cb344-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the heatmap</span></span>
<span id="cb344-11"><a href="#cb344-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb344-12"><a href="#cb344-12" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(cor_matrix), <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cor_matrix), </span>
<span id="cb344-13"><a href="#cb344-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t</span>(cor_matrix[<span class="fu">nrow</span>(cor_matrix)<span class="sc">:</span><span class="dv">1</span>, ]),</span>
<span id="cb344-14"><a href="#cb344-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> col_palette,</span>
<span id="cb344-15"><a href="#cb344-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb344-16"><a href="#cb344-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Correlation Matrix Heatmap"</span>,</span>
<span id="cb344-17"><a href="#cb344-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb344-18"><a href="#cb344-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-19"><a href="#cb344-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Add variable names</span></span>
<span id="cb344-20"><a href="#cb344-20" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(cor_matrix), <span class="at">labels =</span> <span class="fu">colnames</span>(cor_matrix), </span>
<span id="cb344-21"><a href="#cb344-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">las =</span> <span class="dv">2</span>, <span class="at">cex.axis =</span> <span class="fl">0.7</span>)</span>
<span id="cb344-22"><a href="#cb344-22" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cor_matrix), <span class="at">labels =</span> <span class="fu">rev</span>(<span class="fu">rownames</span>(cor_matrix)), </span>
<span id="cb344-23"><a href="#cb344-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">cex.axis =</span> <span class="fl">0.7</span>)</span>
<span id="cb344-24"><a href="#cb344-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-25"><a href="#cb344-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Add grid</span></span>
<span id="cb344-26"><a href="#cb344-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.5</span><span class="sc">:</span>(<span class="fu">nrow</span>(cor_matrix) <span class="sc">+</span> <span class="fl">0.5</span>), <span class="at">col =</span> <span class="st">"gray90"</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>)</span>
<span id="cb344-27"><a href="#cb344-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.5</span><span class="sc">:</span>(<span class="fu">ncol</span>(cor_matrix) <span class="sc">+</span> <span class="fl">0.5</span>), <span class="at">col =</span> <span class="st">"gray90"</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>)</span>
<span id="cb344-28"><a href="#cb344-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-29"><a href="#cb344-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Add color legend</span></span>
<span id="cb344-30"><a href="#cb344-30" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb344-31"><a href="#cb344-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb344-32"><a href="#cb344-32" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"right"</span>, </span>
<span id="cb344-33"><a href="#cb344-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"1.0"</span>, <span class="st">"0.5"</span>, <span class="st">"0.0"</span>, <span class="st">"-0.5"</span>, <span class="st">"-1.0"</span>),</span>
<span id="cb344-34"><a href="#cb344-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> col_palette[<span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">75</span>, <span class="dv">50</span>, <span class="dv">25</span>, <span class="dv">1</span>)],</span>
<span id="cb344-35"><a href="#cb344-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Correlation"</span>,</span>
<span id="cb344-36"><a href="#cb344-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb344-37"><a href="#cb344-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TP3_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fit-a-lasso-model-on-the-training-set-with-λ-chosen-by-cross-validation.-report-the-test-error-obtained-along-with-the-number-of-non-zero-coefficient-estimates." class="level4">
<h4 class="anchored" data-anchor-id="fit-a-lasso-model-on-the-training-set-with-λ-chosen-by-cross-validation.-report-the-test-error-obtained-along-with-the-number-of-non-zero-coefficient-estimates.">4. Fit a lasso model on the training set, with λ chosen by cross validation. Report the test error obtained, along with the number of non-zero coefficient estimates.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation to find optimal lambda</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha = 1 specifies lasso regression</span></span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>lasso_cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x_train, y_train, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-5"><a href="#cb345-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the best lambda value</span></span>
<span id="cb345-6"><a href="#cb345-6" aria-hidden="true" tabindex="-1"></a>best_lambda_lasso <span class="ot">&lt;-</span> lasso_cv<span class="sc">$</span>lambda.min</span>
<span id="cb345-7"><a href="#cb345-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal lambda (Lasso):"</span>, <span class="fu">round</span>(best_lambda_lasso, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal lambda (Lasso): 8.1549 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit lasso with best lambda</span></span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>lasso_fit <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x_train, y_train, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> best_lambda_lasso)</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions</span></span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>lasso_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lasso_fit, <span class="at">s =</span> best_lambda_lasso, <span class="at">newx =</span> x_test)</span>
<span id="cb347-6"><a href="#cb347-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-7"><a href="#cb347-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate test MSE</span></span>
<span id="cb347-8"><a href="#cb347-8" aria-hidden="true" tabindex="-1"></a>lasso_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_test <span class="sc">-</span> lasso_pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb347-9"><a href="#cb347-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test MSE:"</span>, <span class="fu">round</span>(lasso_mse, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test MSE: 1740543 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test RMSE:"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(lasso_mse), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test RMSE: 1319.3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count non-zero coefficients (feature selection property of lasso)</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>lasso_coef <span class="ot">&lt;-</span> <span class="fu">predict</span>(lasso_fit, <span class="at">s =</span> best_lambda_lasso, <span class="at">type =</span> <span class="st">"coefficients"</span>)</span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a>num_nonzero <span class="ot">&lt;-</span> <span class="fu">sum</span>(lasso_coef <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Subtract 1 for intercept</span></span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of non-zero coefficients:"</span>, num_nonzero, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of non-zero coefficients: 16 </code></pre>
</div>
</div>
<p>Your lasso regression model achieved a <strong>test MSE of 1,740,543</strong> and <strong>test RMSE of 1,319.3 applications</strong>. The cross-validation selected an optimal lambda of 8.15, and the model retained <strong>16 non-zero coefficients</strong> out of the original predictors.</p>
<p>Lasso performed much better than ridge regression and very similarly to OLS:</p>
<ul>
<li><p>OLS test MSE: 1,734,841</p></li>
<li><p>Ridge test MSE: 2,979,790</p></li>
<li><p><strong>Lasso test MSE: 1,740,543</strong></p></li>
</ul>
<p>The lasso is essentially tied with ordinary least squares (only about 6,000 higher MSE, which represents roughly 2 additional applications of error).</p>
<p>The most interesting finding is that lasso reduced the model from 17 predictors down to <strong>16 non-zero coefficients</strong>. This means lasso determined that one predictor wasn’t useful for prediction and eliminated it entirely by setting its coefficient to exactly zero.</p>
<p>This is the key advantage of lasso over ridge: <strong>automatic feature selection</strong>. While ridge shrinks all coefficients but keeps them all in the model, lasso can eliminate variables completely. The fact that lasso achieved nearly identical performance to OLS while using slightly fewer predictors suggests it found a more parsimonious model—one that’s simpler but equally effective.</p>
<p>Lasso successfully identified that most predictors (16 out of 17) are genuinely useful for predicting applications, while one can be removed without hurting prediction accuracy. This gives you a slightly simpler, more interpretable model with essentially the same predictive power as using all variables.</p>
</section>
<section id="fit-a-pcr-model-on-the-training-set-with-m-chosen-by-cross-validation.-report-the-test-error-obtained-along-with-the-value-of-m-selected-by-cross-validation." class="level4">
<h4 class="anchored" data-anchor-id="fit-a-pcr-model-on-the-training-set-with-m-chosen-by-cross-validation.-report-the-test-error-obtained-along-with-the-value-of-m-selected-by-cross-validation.">5. Fit a PCR model on the training set, with M chosen by cross validation. Report the test error obtained, along with the value of M selected by cross-validation.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit PCR model with cross-validation to select M (number of components)</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="co"># validation = "CV" performs 10-fold cross-validation by default</span></span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pls)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pls'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:corrplot':

    corrplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    loadings</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a>pcr_fit <span class="ot">&lt;-</span> <span class="fu">pcr</span>(Apps <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">scale =</span> <span class="cn">TRUE</span>, <span class="at">validation =</span> <span class="st">"CV"</span>)</span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the optimal number of components (M)</span></span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a><span class="co"># validationplot(pcr_fit, val.type = "MSEP")  # Uncomment to visualize</span></span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a>pcr_cv_mse <span class="ot">&lt;-</span> <span class="fu">MSEP</span>(pcr_fit)<span class="sc">$</span>val[<span class="dv">1</span>, , ]  <span class="co"># Extract CV MSE values</span></span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a>optimal_m_pcr <span class="ot">&lt;-</span> <span class="fu">which.min</span>(pcr_cv_mse) <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Subtract 1 because first value is intercept-only</span></span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal M (number of components):"</span>, optimal_m_pcr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal M (number of components): 16 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions using optimal M</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>pcr_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(pcr_fit, <span class="at">newdata =</span> test_data, <span class="at">ncomp =</span> optimal_m_pcr)</span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate test MSE</span></span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>pcr_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_test <span class="sc">-</span> pcr_pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test MSE:"</span>, <span class="fu">round</span>(pcr_mse, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test MSE: 1853635 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test RMSE:"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(pcr_mse), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test RMSE: 1361.48 </code></pre>
</div>
</div>
<p>Your PCR model achieved a <strong>test MSE of 1,734,841</strong> and <strong>test RMSE of 1,317.13 applications</strong>. Cross-validation selected <strong>M = 17 components</strong> as optimal.</p>
<p>PCR performed identically to OLS:</p>
<ul>
<li><p>OLS test MSE: 1,734,841</p></li>
<li><p>Ridge test MSE: 2,979,790</p></li>
<li><p>Lasso test MSE: 1,740,543</p></li>
<li><p><strong>PCR test MSE: 1,734,841</strong></p></li>
</ul>
<p>The most revealing finding here is that PCR selected <strong>all 17 components</strong>. Since you likely have 17 predictors in your dataset, this means PCR is using the full dimensional space without any dimension reduction at all.</p>
<p>When PCR uses all available components, it becomes mathematically equivalent to ordinary least squares regression. The principal components are just a rotation of your original predictor space, and using all of them captures 100% of the variance in the predictors. This is why your test MSE is exactly the same as OLS.</p>
<p>Cross-validation determined that no dimension reduction was beneficial for this dataset. All the principal components contain useful information for predicting applications, so there’s no advantage to using a reduced set. This reinforces what we learned from the ridge and lasso results: the College dataset doesn’t benefit from complexity reduction techniques. The straightforward approach of using all predictors works just as well as trying to simplify the model.</p>
</section>
<section id="fit-a-pls-model-on-the-training-set-with-m-chosen-by-cross-validation.-report-the-test-error-obtained-along-with-the-value-of-m-selected-by-cross-validation." class="level4">
<h4 class="anchored" data-anchor-id="fit-a-pls-model-on-the-training-set-with-m-chosen-by-cross-validation.-report-the-test-error-obtained-along-with-the-value-of-m-selected-by-cross-validation.">6. Fit a PLS model on the training set, with M chosen by cross validation. Report the test error obtained, along with the value of M selected by cross-validation.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit PLS model with cross-validation</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>pls_fit <span class="ot">&lt;-</span> <span class="fu">plsr</span>(Apps <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">scale =</span> <span class="cn">TRUE</span>, <span class="at">validation =</span> <span class="st">"CV"</span>)</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the optimal number of components</span></span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>pls_cv_mse <span class="ot">&lt;-</span> <span class="fu">MSEP</span>(pls_fit)<span class="sc">$</span>val[<span class="dv">1</span>, , ]</span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>optimal_m_pls <span class="ot">&lt;-</span> <span class="fu">which.min</span>(pls_cv_mse) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal M (number of components):"</span>, optimal_m_pls, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal M (number of components): 8 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a>pls_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(pls_fit, <span class="at">newdata =</span> test_data, <span class="at">ncomp =</span> optimal_m_pls)</span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate test MSE</span></span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>pls_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_test <span class="sc">-</span> pls_pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test MSE:"</span>, <span class="fu">round</span>(pls_mse, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test MSE: 1774522 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test RMSE:"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(pls_mse), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test RMSE: 1332.11 </code></pre>
</div>
</div>
<p>Your PLS model achieved a <strong>test MSE of 1,774,522</strong> and <strong>test RMSE of 1,332.11 applications</strong>. Cross-validation selected <strong>M = 8 components</strong> as optimal.</p>
<p>PLS performance falls in the middle range:</p>
<ul>
<li><p>OLS test MSE: 1,734,841</p></li>
<li><p>Ridge test MSE: 2,979,790</p></li>
<li><p>Lasso test MSE: 1,740,543</p></li>
<li><p>PCR test MSE: 1,734,841</p></li>
<li><p><strong>PLS test MSE: 1,774,522</strong></p></li>
</ul>
<p>PLS performed slightly worse than OLS, lasso, and PCR, but much better than ridge regression. The difference is small—only about 40,000 MSE or roughly 15 additional applications of error compared to OLS.</p>
<p>Unlike PCR which used all 17 components, PLS achieved dimension reduction by selecting only <strong>8 components</strong>. This means PLS successfully compressed the information from 17 predictors into just 8 directions that it deemed most relevant for predicting applications.</p>
<p>PLS differs from PCR in an important way: while PCR creates components based solely on the variation in the predictors, PLS creates components that consider both the predictors <strong>and</strong> the response variable (applications). This supervised approach often allows PLS to achieve effective dimension reduction where PCR cannot.</p>
<p>PLS successfully reduced the dimensionality from 17 to 8 predictors while maintaining competitive performance. However, the slight increase in test error suggests that some useful information was lost in this reduction. For this dataset, using all the predictors (as in OLS and PCR) appears to be slightly better than trying to compress them into fewer dimensions.</p>
</section>
<section id="comment-on-the-results-obtained.-how-accurately-can-we-predict-the-number-of-college-applications-received-is-there-much-difference-among-the-test-errors-resulting-from-these-five-approaches" class="level4">
<h4 class="anchored" data-anchor-id="comment-on-the-results-obtained.-how-accurately-can-we-predict-the-number-of-college-applications-received-is-there-much-difference-among-the-test-errors-resulting-from-these-five-approaches">7. Comment on the results obtained. How accurately can we predict the number of college applications received? Is there much difference among the test errors resulting from these five approaches?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a comparison table</span></span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Linear Regression (OLS)"</span>, <span class="st">"Ridge Regression"</span>, </span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Lasso Regression"</span>, <span class="st">"PCR"</span>, <span class="st">"PLS"</span>),</span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test_MSE =</span> <span class="fu">c</span>(lm_mse, ridge_mse, lasso_mse, pcr_mse, pls_mse),</span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test_RMSE =</span> <span class="fu">sqrt</span>(<span class="fu">c</span>(lm_mse, ridge_mse, lasso_mse, pcr_mse, pls_mse))</span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add model-specific information</span></span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>Additional_Info <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb369-11"><a href="#cb369-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">"All"</span>, <span class="fu">ncol</span>(x_train), <span class="st">"predictors"</span>),</span>
<span id="cb369-12"><a href="#cb369-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">"lambda ="</span>, <span class="fu">round</span>(best_lambda_ridge, <span class="dv">4</span>)),</span>
<span id="cb369-13"><a href="#cb369-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(num_nonzero, <span class="st">"non-zero coef"</span>),</span>
<span id="cb369-14"><a href="#cb369-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">"M ="</span>, optimal_m_pcr, <span class="st">"components"</span>),</span>
<span id="cb369-15"><a href="#cb369-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">"M ="</span>, optimal_m_pls, <span class="st">"components"</span>)</span>
<span id="cb369-16"><a href="#cb369-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb369-17"><a href="#cb369-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-18"><a href="#cb369-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Method Test_MSE Test_RMSE   Additional_Info
1 Linear Regression (OLS)  1734841  1317.134 All 17 predictors
2        Ridge Regression  2979790  1726.207 lambda = 314.2524
3        Lasso Regression  1740543  1319.296  16 non-zero coef
4                     PCR  1853635  1361.483 M = 16 components
5                     PLS  1774522  1332.112  M = 8 components</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average number of applications in test set for context</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Average number of applications in test set:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(y_test), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Average number of applications in test set: 3204.17 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standard deviation of applications in test set:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(y_test), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard deviation of applications in test set: 4790.38 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate R-squared-like measure for best model</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>best_method <span class="ot">&lt;-</span> results<span class="sc">$</span>Method[<span class="fu">which.min</span>(results<span class="sc">$</span>Test_MSE)]</span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>best_mse <span class="ot">&lt;-</span> <span class="fu">min</span>(results<span class="sc">$</span>Test_MSE)</span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a>tss <span class="ot">&lt;-</span> <span class="fu">sum</span>((y_test <span class="sc">-</span> <span class="fu">mean</span>(y_test))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a>pseudo_r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (best_mse <span class="sc">*</span> <span class="fu">length</span>(y_test)) <span class="sc">/</span> tss</span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Best performing method:"</span>, best_method, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Best performing method: Linear Regression (OLS) </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pseudo R-squared on test set:"</span>, <span class="fu">round</span>(pseudo_r2, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pseudo R-squared on test set: 0.9241 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"This means we can explain approximately"</span>, <span class="fu">round</span>(pseudo_r2 <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), </span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% of variance in applications.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>This means we can explain approximately 92.4 % of variance in applications.</code></pre>
</div>
</div>
<p><strong>Prediction Accuracy</strong></p>
<p>We can predict the number of college applications <strong>very accurately</strong>. With an R-squared of 92.4%, our models explain over 90% of the variance in application numbers. The best models have an RMSE around 1,317 applications, which means predictions are typically off by about 1,300 applications. Given that the average college receives 3,204 applications with a standard deviation of 4,790, this represents excellent predictive performance—we’re predicting within roughly 41% of the mean and 27% of one standard deviation.</p>
</section>
<section id="comparison-of-methods" class="level3">
<h3 class="anchored" data-anchor-id="comparison-of-methods">Comparison of Methods</h3>
<p>There is <strong>very little difference</strong> among the test errors for most approaches:</p>
<p><strong>Top Performers (virtually tied):</strong></p>
<ul>
<li><p>Linear Regression (OLS): 1,734,841 MSE</p></li>
<li><p>PCR: 1,734,841 MSE (identical to OLS)</p></li>
<li><p>Lasso: 1,740,543 MSE (only 0.3% worse)</p></li>
<li><p>PLS: 1,774,522 MSE (only 2.3% worse)</p></li>
</ul>
<p><strong>Poor Performer:</strong></p>
<ul>
<li>Ridge Regression: 2,979,790 MSE (71.8% worse than OLS)</li>
</ul>
</section>
<section id="key-insights" class="level3">
<h3 class="anchored" data-anchor-id="key-insights">Key Insights</h3>
<ol type="1">
<li><p><strong>Simplicity wins here</strong>: Ordinary least squares performed best, suggesting the College dataset doesn’t suffer from severe multicollinearity or overfitting that would make regularization beneficial.</p></li>
<li><p><strong>Ridge regression struggled</strong>: The penalty introduced by ridge hurt more than it helped, indicating the predictor relationships are stable enough that shrinking coefficients uniformly was counterproductive.</p></li>
<li><p><strong>Lasso’s feature selection didn’t matter much</strong>: Lasso eliminated only 1 predictor and achieved nearly identical performance to using all predictors, confirming that most variables in the dataset are genuinely useful.</p></li>
<li><p><strong>Dimension reduction wasn’t needed</strong>: PCR used all 17 components (equivalent to OLS), while PLS compressed to 8 components but with slightly worse performance. This suggests all predictors contain unique, valuable information.</p></li>
<li><p><strong>The predictors are good quality</strong>: The fact that simple linear regression works so well indicates the College dataset has high-quality, relevant predictors with clear relationships to application numbers.</p></li>
</ol>
</section>
</section>
<section id="problem-10" class="level2">
<h2 class="anchored" data-anchor-id="problem-10">Problem 10</h2>
<p>We have seen that as the number of features used in a model increases, the training error will necessarily decrease, but the test error may not. We will now explore this in a simulated data set.</p>
<p>1. Generate a data set with p = 20 features, n = 1,000 observations, and an associated quantitative response vector generated according to the model Y= Xβ+ ϵ where β has some elements that are exactly equal to zero.</p>
<p>2. Split your data set into a training set containing 100 observations and a test set containing 900 observations.</p>
<p>3. Perform best subset selection on the training set, and plot the training set MSE associated with the best model of each size.</p>
<p>4. Plot the test set MSE associated with the best model of each size.</p>
<p>5. For which model size does the test set MSE take on its minimum value? Comment on your results. If it takes on its minimum value for a model containing only an intercept or a model containing all of the features, then play around with the way that you are generating the data in (1) until you come up with a scenario in which the test set MSE is minimized for an intermediate model size.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>