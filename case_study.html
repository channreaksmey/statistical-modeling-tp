<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Case Study - STM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="case_study_files/libs/clipboard/clipboard.min.js"></script>
<script src="case_study_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="case_study_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="case_study_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="case_study_files/libs/quarto-html/popper.min.js"></script>
<script src="case_study_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="case_study_files/libs/quarto-html/anchor.min.js"></script>
<link href="case_study_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="case_study_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="case_study_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="case_study_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="case_study_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Case Study - STM</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="case-study-1-biomass" class="level1">
<h1>Case Study 1: Biomass</h1>
<p><em>Data and ideas for this case study come from (Goicoa et al., 2011).</em></p>
<p>To estimate the amount of carbon dioxide retained in a tree, its biomass needs to be known and multiplied by an expansion factor (there are several alternatives in the literature). To calculate the biomass, specific regression equations by species are frequently used. These regression equations, called allometric equations, estimate the biomass of the tree by means of some known characteristics, typically diameter and/or height of the stem and branches. The BIOMASS file contains data of 42 beeches (Fagus Sylvatica) from a forest of Navarra (Spain) in 2006, where</p>
<p>• <code>diameter</code>: diameter of the stem in centimeters</p>
<p>• <code>height</code>: height of the tree in meters</p>
<p>• <code>stemweight</code>: weight of the stem in kilograms</p>
<p>• <code>aboveweight</code>: aboveground weight in kilograms</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PASWR2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(BIOMASS)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(BIOMASS)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  diameter height stemweight aboveweight
1       40   18.5     647.36     1047.97
2       32   18.8     396.51      559.89
3       22   13.2     131.78      221.06
4       45   20.5     810.36     1279.54
5       37   17.5     510.37      682.30
6       37   19.8     456.04      645.61</code></pre>
</div>
</div>
<section id="a-create-a-scatterplot-of-aboveweight-versus-diameter.-is-the-relationship-linear-superimpose-a-regression-line-over-the-plot-just-created." class="level4">
<h4 class="anchored" data-anchor-id="a-create-a-scatterplot-of-aboveweight-versus-diameter.-is-the-relationship-linear-superimpose-a-regression-line-over-the-plot-just-created.">(a) Create a scatterplot of aboveweight versus diameter. Is the relationship linear? Superimpose a regression line over the plot just created.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatterplot with regression line</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>plot_a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(BIOMASS, <span class="fu">aes</span>(<span class="at">x =</span> diameter, <span class="at">y =</span> aboveweight)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Aboveground Weight vs Diameter"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Diameter (cm)"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Aboveground Weight (kg)"</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_a)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>No, the relationship is NOT linear.</strong></p>
<p><strong>Observations:</strong></p>
<ol type="1">
<li><p><strong>Curved Pattern</strong>: The scatterplot shows a clear <strong>curvilinear (non-linear) relationship</strong> between diameter and aboveground weight. The data points follow a curved pattern rather than a straight line.</p></li>
<li><p><strong>Accelerating Growth</strong>: The relationship appears to be <strong>exponential or power-law</strong> in nature. As diameter increases, the aboveground weight increases at an accelerating rate (the curve becomes steeper).</p></li>
<li><p><strong>Poor Linear Fit</strong>: While the red regression line has been superimposed on the plot, you can see that:</p>
<ul>
<li><p>At small diameters (left side), the line overestimates the weight</p></li>
<li><p>In the middle range, the fit is reasonable</p></li>
<li><p>At large diameters (right side), the line underestimates the weight</p></li>
<li><p>This systematic pattern of residuals (points above and below the line in a curved pattern) indicates that a linear model is <strong>not appropriate</strong> for this data.</p></li>
</ul></li>
<li><p><strong>Biological Interpretation</strong>: This makes biological sense because tree biomass is related to volume, which grows as a function of diameter raised to a power (typically around 2-3), not linearly.</p></li>
</ol>
</section>
<section id="b-create-a-scatterplot-of-logaboveweight-versus-logdiameter.-is-the-relationship-linear-superimpose-a-regression-line-over-the-plot-just-created." class="level4">
<h4 class="anchored" data-anchor-id="b-create-a-scatterplot-of-logaboveweight-versus-logdiameter.-is-the-relationship-linear-superimpose-a-regression-line-over-the-plot-just-created.">(b) Create a scatterplot of <span class="math inline">\(\log(aboveweight)\)</span> versus <span class="math inline">\(\log(diameter)\)</span>. Is the relationship linear? Superimpose a regression line over the plot just created.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log-transformed scatterplot</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plot_b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(BIOMASS, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(diameter), <span class="at">y =</span> <span class="fu">log</span>(aboveweight))) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log(Aboveground Weight) vs Log(Diameter)"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Log(Diameter)"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Log(Aboveground Weight)"</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_b)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Yes, the relationship is linear.</strong></p>
<p><strong>Observations:</strong></p>
<ol type="1">
<li><p><strong>Strong Linear Pattern</strong>: After the log transformation, the data points now follow a clear <strong>straight-line pattern</strong>. The points are distributed closely around the red regression line with no systematic curvature.</p></li>
<li><p><strong>Excellent Linear Fit</strong>: The regression line fits the data much better than in part (a):</p>
<ul>
<li><p>Points are randomly scattered above and below the line</p></li>
<li><p>No systematic pattern of over/under-estimation across the range</p></li>
<li><p>The residuals appear to have constant variance (homoscedastic)</p></li>
<li><p>Very tight clustering around the line suggests high R²</p></li>
</ul></li>
<li><p><strong>Success of Log Transformation</strong>: The log-log transformation has successfully <strong>linearized</strong> the power-law relationship that was evident in part (a). This transformation is standard for allometric equations.</p></li>
<li><p><strong>Mathematical Interpretation</strong>: The linear relationship in log-log space indicates that the original relationship follows a power law: <span class="math inline">\(\log(aboveweight) = β_0 + β_1 \log(diameter)\)</span> Which corresponds to the power relationship: <span class="math inline">\(aboveweight = \exp(β_0) × diameter^{β_1}\)</span></p></li>
<li><p><strong>Allometric Equation</strong>: This is exactly the form expected for allometric equations in biology, where biomass scales as a power function of dimensional measurements like diameter.</p></li>
</ol>
</section>
<section id="c-fit-the-regression-model-logaboveweight-β_0-β_1logdiameter-and-compute-r2-r2_a-and-the-variance-of-the-residuals." class="level4">
<h4 class="anchored" data-anchor-id="c-fit-the-regression-model-logaboveweight-β_0-β_1logdiameter-and-compute-r2-r2_a-and-the-variance-of-the-residuals.">(c) Fit the regression model <span class="math inline">\(\log(aboveweight) = β_0 + β_1\log(diameter)\)</span>, and compute <span class="math inline">\(R^2, R^2_a\)</span> and the variance of the residuals.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>model_c <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(aboveweight) <span class="sc">~</span> <span class="fu">log</span>(diameter), <span class="at">data =</span> BIOMASS)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Summary:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model_c))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(aboveweight) ~ log(diameter), data = BIOMASS)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48510 -0.12682  0.02701  0.10766  0.32104 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    -1.5015     0.1920  -7.822 1.38e-09 ***
log(diameter)   2.2806     0.0542  42.076  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1842 on 40 degrees of freedom
Multiple R-squared:  0.9779,    Adjusted R-squared:  0.9774 
F-statistic:  1770 on 1 and 40 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract R-squared values</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>r_squared_c <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_c)<span class="sc">$</span>r.squared</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>r_squared_adj_c <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_c)<span class="sc">$</span>adj.r.squared</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>residual_var_c <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_c)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model Statistics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model Statistics ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"R-squared: %.4f</span><span class="sc">\n</span><span class="st">"</span>, r_squared_c))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.9779</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Adjusted R-squared: %.4f</span><span class="sc">\n</span><span class="st">"</span>, r_squared_adj_c))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R-squared: 0.9774</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Residual variance (σ²): %.4f</span><span class="sc">\n</span><span class="st">"</span>, residual_var_c))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Residual variance (σ²): 0.0339</code></pre>
</div>
</div>
<p><strong>Model Statistics:</strong></p>
<p><strong>1. R-squared (R²) = 0.9779</strong></p>
<p><strong>Interpretation:</strong> The model explains <strong>97.79% of the variance</strong> in log(aboveground weight). This indicates an excellent fit - nearly all the variation in log-transformed biomass can be explained by log-transformed diameter alone.</p>
<p><strong>2. Adjusted R-squared (R²ₐ) = 0.9774</strong></p>
<p><strong>Interpretation:</strong> After adjusting for the number of predictors (1 predictor), the model still explains <strong>97.74%</strong> of the variance. The minimal difference between R² and R²ₐ (0.0005) indicates that the model is not overfitted and the predictor is genuinely useful.</p>
<p><strong>3. Residual Variance (σ²) = 0.0339</strong></p>
<p><strong>Interpretation:</strong> The variance of the residuals around the regression line is <strong>0.0339</strong> (in log units). The residual standard error is σ = √0.0339 = <strong>0.1842</strong>, which represents the typical prediction error on the log scale.</p>
</section>
<section id="d-introduce-logheight-as-an-explanatory-variable-and-fit-the-modellogaboveweight-β_0-β_1-logdiameter-β_2-logheight.-what-is-the-effect-of-introducing-logheightin-the-model" class="level4">
<h4 class="anchored" data-anchor-id="d-introduce-logheight-as-an-explanatory-variable-and-fit-the-modellogaboveweight-β_0-β_1-logdiameter-β_2-logheight.-what-is-the-effect-of-introducing-logheightin-the-model">(d) Introduce <span class="math inline">\(log(height)\)</span> as an explanatory variable and fit the model<span class="math inline">\(\log(aboveweight) =β_0 + β_1 \log(diameter) + β_2 \log(height)\)</span>. What is the effect of introducing log(height)in the model?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the multiple regression model</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>model_d <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(aboveweight) <span class="sc">~</span> <span class="fu">log</span>(diameter) <span class="sc">+</span> <span class="fu">log</span>(height), <span class="at">data =</span> BIOMASS)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Summary:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model_d))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(aboveweight) ~ log(diameter) + log(height), 
    data = BIOMASS)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.26519 -0.11243 -0.01637  0.07720  0.38024 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -2.77706    0.31976  -8.685 1.18e-10 ***
log(diameter)  2.17779    0.04965  43.867  &lt; 2e-16 ***
log(height)    0.52918    0.11561   4.577 4.71e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1505 on 39 degrees of freedom
Multiple R-squared:  0.9856,    Adjusted R-squared:  0.9849 
F-statistic:  1337 on 2 and 39 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract R-squared values</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>r_squared_d <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_d)<span class="sc">$</span>r.squared</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>r_squared_adj_d <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_d)<span class="sc">$</span>adj.r.squared</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>residual_var_d <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_d)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Effect of Adding log(height) ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Effect of Adding log(height) ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Change in R²: %.4f → %.4f (Δ = %.4f)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>            r_squared_c, r_squared_d, r_squared_d <span class="sc">-</span> r_squared_c))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Change in R²: 0.9779 → 0.9856 (Δ = 0.0077)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Change in Adjusted R²: %.4f → %.4f (Δ = %.4f)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>            r_squared_adj_c, r_squared_adj_d, r_squared_adj_d <span class="sc">-</span> r_squared_adj_c))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Change in Adjusted R²: 0.9774 → 0.9849 (Δ = 0.0075)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Change in Residual Variance: %.4f → %.4f (Δ = %.4f)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>            residual_var_c, residual_var_d, residual_var_d <span class="sc">-</span> residual_var_c))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Change in Residual Variance: 0.0339 → 0.0226 (Δ = -0.0113)</code></pre>
</div>
</div>
<p><strong>Key Improvements:</strong></p>
<p><strong>Better Explanatory Power</strong></p>
<ul>
<li><p>R² increased from <strong>97.79% to 98.56%</strong></p></li>
<li><p>The model now explains an <strong>additional 0.77%</strong> of the variance in log(aboveground weight)</p></li>
<li><p>While this seems small, it represents meaningful improvement in an already excellent model</p></li>
</ul>
<p><strong>Improved Adjusted R²</strong></p>
<ul>
<li><p>Adjusted R² increased from <strong>97.74% to 98.49%</strong> (+0.75%)</p></li>
<li><p>The positive change in R²ₐ confirms that adding height improves the model even after penalizing for the additional parameter</p></li>
<li><p>This indicates height is a <strong>genuinely useful predictor</strong>, not just noise</p></li>
</ul>
<p><strong>Reduced Residual Variance</strong></p>
<ul>
<li><p>Residual variance decreased by <strong>33.3%</strong>: from 0.0339 to 0.0226</p></li>
<li><p>Residual standard error reduced by <strong>18.3%</strong>: from 0.1842 to 0.1505</p></li>
<li><p><strong>Predictions are now more precise</strong> with smaller typical errors</p></li>
</ul>
<p><strong>Height is Statistically Significant</strong></p>
<ul>
<li><p><strong>β₂ (log height) = 0.5292</strong></p></li>
<li><p><strong>p-value = 4.71 × 10⁻⁵</strong> (highly significant)</p></li>
<li><p><strong>t-value = 4.577</strong> (strong evidence)</p></li>
<li><p>Height contributes significantly to predicting biomass beyond diameter alone</p></li>
</ul>
<p><strong>Interpretation of the Height Effect:</strong></p>
<p><strong>Elasticity Interpretation:</strong></p>
<p><strong>β₂ = 0.5292</strong> means:</p>
<ul>
<li><p>A <strong>1% increase in height</strong> is associated with approximately a <strong>0.53% increase in aboveground weight</strong>, holding diameter constant</p></li>
<li><p>This is additional to the diameter effect (β₁ = 2.178)</p></li>
</ul>
<p><strong>Biological Meaning:</strong></p>
<ul>
<li><p><strong>Diameter captures most of the biomass</strong> (β₁ = 2.178, the dominant effect)</p></li>
<li><p><strong>Height adds important information</strong> about tree form and structure</p></li>
<li><p>Trees with greater height for a given diameter have proportionally more biomass</p></li>
<li><p>This accounts for variation in tree shape, branching patterns, and crown development</p></li>
</ul>
</section>
<section id="e-complete-the-analysis-questions-for-the-model-in-d." class="level4">
<h4 class="anchored" data-anchor-id="e-complete-the-analysis-questions-for-the-model-in-d.">(e) Complete the Analysis questions for the model in (d).</h4>
</section>
<section id="analysis-questions" class="level4">
<h4 class="anchored" data-anchor-id="analysis-questions">Analysis questions:</h4>
<section id="estimate-the-models-parameters-and-their-standard-errors.-provide-an-interpretation-for-the-models-parameters." class="level5">
<h5 class="anchored" data-anchor-id="estimate-the-models-parameters-and-their-standard-errors.-provide-an-interpretation-for-the-models-parameters.">(1) Estimate the model’s parameters and their standard errors. Provide an interpretation for the model’s parameters.</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>coef_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_d)<span class="sc">$</span>coefficients</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coef_summary)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)   -2.7770614 0.31975502 -8.684966 1.183407e-10
log(diameter)  2.1777867 0.04964521 43.867008 8.321935e-35
log(height)    0.5291803 0.11560984  4.577295 4.705599e-05</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"β₀ (Intercept) = %.4f: Log of expected aboveground weight when</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">coef</span>(model_d)[<span class="dv">1</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>β₀ (Intercept) = -2.7771: Log of expected aboveground weight when</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"                        log(diameter) and log(height) are zero.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        log(diameter) and log(height) are zero.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"β₁ (log diameter) = %.4f: A 1%% increase in diameter is associated with</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">coef</span>(model_d)[<span class="dv">2</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>β₁ (log diameter) = 2.1778: A 1% increase in diameter is associated with</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"                          approximately a %.2f%% increase in aboveground weight,</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">coef</span>(model_d)[<span class="dv">2</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          approximately a 2.18% increase in aboveground weight,</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"                          holding height constant.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          holding height constant.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"β₂ (log height) = %.4f: A 1%% increase in height is associated with</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">coef</span>(model_d)[<span class="dv">3</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>β₂ (log height) = 0.5292: A 1% increase in height is associated with</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"                        approximately a %.2f%% increase in aboveground weight,</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">coef</span>(model_d)[<span class="dv">3</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        approximately a 0.53% increase in aboveground weight,</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"                        holding diameter constant.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        holding diameter constant.</code></pre>
</div>
</div>
<p><strong>Detailed Interpretations:</strong></p>
<p><strong>1. β₀ (Intercept) = -2.7771</strong></p>
<p><strong>Statistical Significance:</strong> Highly significant (p = 1.18 × 10⁻¹⁰)</p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>This is the expected value of log(aboveweight) when both log(diameter) = 0 and log(height) = 0</p></li>
<li><p>In other words, when diameter = 1 cm and height = 1 m</p></li>
<li><p>On the original scale: exp(-2.7771) ≈ <strong>0.062 kg</strong></p></li>
<li><p>However, this is an <strong>extrapolation</strong> beyond the data range and should not be interpreted literally, as trees with 1 cm diameter and 1 m height are not meaningful in this dataset</p></li>
</ul>
<p><strong>2. β₁ (log diameter) = 2.1778</strong></p>
<p><strong>Statistical Significance:</strong> Extremely significant (p = 8.32 × 10⁻³⁵, t = 43.867)</p>
<p><strong>Interpretation (Elasticity):</strong></p>
<ul>
<li><p><strong>β₁ = 2.1778</strong> represents the <strong>elasticity of aboveground weight with respect to diameter</strong></p></li>
<li><p>A <strong>1% increase in diameter</strong> is associated with approximately a <strong>2.18% increase in aboveground weight</strong>, holding height constant</p></li>
<li><p>Equivalently: <strong>aboveweight ∝ diameter^2.18</strong> (when height is held constant)</p></li>
</ul>
<p><strong>Biological Meaning:</strong></p>
<ul>
<li><p>Diameter has a <strong>strong positive effect</strong> on biomass</p></li>
<li><p>The exponent &gt; 2 indicates that biomass increases <strong>more than proportionally</strong> with diameter</p></li>
<li><p>This reflects the fact that biomass depends on both cross-sectional area (∝ diameter²) and additional structural components</p></li>
<li><p>The exponent of ~2.18 is consistent with theoretical and empirical allometric relationships for trees</p></li>
</ul>
<p><strong>3. β₂ (log height) = 0.5292</strong></p>
<p><strong>Statistical Significance:</strong> Highly significant (p = 4.71 × 10⁻⁵, t = 4.577)</p>
<p><strong>Interpretation (Elasticity):</strong></p>
<ul>
<li><p><strong>β₂ = 0.5292</strong> represents the <strong>elasticity of aboveground weight with respect to height</strong></p></li>
<li><p>A <strong>1% increase in height</strong> is associated with approximately a <strong>0.53% increase in aboveground weight</strong>, holding diameter constant</p></li>
<li><p>Equivalently: <strong>aboveweight ∝ height^0.53</strong> (when diameter is held constant)</p></li>
</ul>
<p><strong>Biological Meaning:</strong></p>
<ul>
<li><p>Height has a <strong>moderate positive effect</strong> on biomass beyond what diameter captures</p></li>
<li><p>For trees with the same diameter, taller trees have more aboveground biomass</p></li>
<li><p>This captures variation in:</p>
<ul>
<li><p><strong>Crown size and branch development</strong></p></li>
<li><p><strong>Tree form</strong> (slender vs.&nbsp;stocky trees)</p></li>
<li><p><strong>Vertical biomass distribution</strong></p></li>
</ul></li>
<li><p>The exponent ~0.5 suggests height contributes roughly as the square root, which is less than proportional</p></li>
</ul>
</section>
<section id="compute-the-variance-covariance-matrix-of-the-hatbeta_s." class="level5">
<h5 class="anchored" data-anchor-id="compute-the-variance-covariance-matrix-of-the-hatbeta_s.">(2) Compute the variance-covariance matrix of the <span class="math inline">\(\hat{\beta}_s\)</span>.</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>vcov_matrix <span class="ot">&lt;-</span> <span class="fu">vcov</span>(model_d)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vcov_matrix)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                (Intercept) log(diameter)  log(height)
(Intercept)    0.1022432727 -0.0006066342 -0.032216921
log(diameter) -0.0006066342  0.0024646465 -0.002596642
log(height)   -0.0322169214 -0.0025966423  0.013365634</code></pre>
</div>
</div>
<p><strong>Interpretation of Matrix Elements:</strong></p>
<p><strong>1. Diagonal Elements (Variances):</strong></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p><strong>Var(β̂₀) = 0.1022:</strong> The intercept has the <strong>highest variance</strong>, indicating the most uncertainty in its estimate</p></li>
<li><p><strong>Var(β̂₁) = 0.0025:</strong> The diameter coefficient has <strong>very low variance</strong>, indicating high precision (this is our most precisely estimated parameter)</p></li>
<li><p><strong>Var(β̂₂) = 0.0134:</strong> The height coefficient has <strong>moderate variance</strong>, more uncertain than diameter but still reasonably precise</p></li>
</ul>
<p><strong>2. Off-Diagonal Elements (Covariances):</strong></p>
<p>The off-diagonal elements represent the <strong>covariances</strong> between pairs of parameter estimates:</p>
<p><strong>Cov(β̂₀, β̂₁) = -0.00061</strong></p>
<ul>
<li><p><strong>Negative covariance</strong> between intercept and log(diameter)</p></li>
<li><p>Very small magnitude → weak relationship</p></li>
<li><p>If β̂₁ is higher than expected, β̂₀ tends to be slightly lower</p></li>
</ul>
<p><strong>Cov(β̂₀, β̂₂) = -0.03222</strong></p>
<ul>
<li><p><strong>Negative covariance</strong> between intercept and log(height)</p></li>
<li><p>Moderate magnitude → noticeable relationship</p></li>
<li><p>If β̂₂ is higher than expected, β̂₀ tends to be lower</p></li>
<li><p>This is the <strong>strongest covariance</strong> in the matrix</p></li>
</ul>
<p><strong>Cov(β̂₁, β̂₂) = -0.00260</strong></p>
<ul>
<li><p><strong>Negative covariance</strong> between log(diameter) and log(height)</p></li>
<li><p>Small magnitude → weak relationship</p></li>
<li><p>If β̂₁ is higher than expected, β̂₂ tends to be slightly lower</p></li>
</ul>
</section>
<section id="provide-95-confidence-intervals-for-beta_1-and-beta_2." class="level5">
<h5 class="anchored" data-anchor-id="provide-95-confidence-intervals-for-beta_1-and-beta_2.">(3) Provide 95% confidence intervals for <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>.</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>conf_int <span class="ot">&lt;-</span> <span class="fu">confint</span>(model_d, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_int)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   2.5 %     97.5 %
(Intercept)   -3.4238270 -2.1302958
log(diameter)  2.0773698  2.2782036
log(height)    0.2953374  0.7630233</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"β₁: We are 95%% confident that the true elasticity of aboveground weight</span><span class="sc">\n</span><span class="st">"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>β₁: We are 95% confident that the true elasticity of aboveground weight</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"    with respect to diameter is between %.4f and %.4f.</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>            conf_int[<span class="dv">2</span>,<span class="dv">1</span>], conf_int[<span class="dv">2</span>,<span class="dv">2</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    with respect to diameter is between 2.0774 and 2.2782.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"β₂: We are 95%% confident that the true elasticity of aboveground weight</span><span class="sc">\n</span><span class="st">"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>β₂: We are 95% confident that the true elasticity of aboveground weight</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"    with respect to height is between %.4f and %.4f.</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>            conf_int[<span class="dv">3</span>,<span class="dv">1</span>], conf_int[<span class="dv">3</span>,<span class="dv">2</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    with respect to height is between 0.2953 and 0.7630.</code></pre>
</div>
</div>
<p><strong>Interpretation of β₁ (log diameter):</strong> <strong>95% CI: [2.0774, 2.2782]</strong></p>
<p><strong>Statistical Interpretation:</strong></p>
<ul>
<li><p>We are <strong>95% confident</strong> that the true population parameter β₁ lies between 2.0774 and 2.2782</p></li>
<li><p>If we repeated this study many times, approximately 95% of such intervals would contain the true β₁</p></li>
</ul>
<p><strong>Elasticity Interpretation:</strong></p>
<ul>
<li>We are 95% confident that a <strong>1% increase in diameter</strong> is associated with between a <strong>2.08% and 2.28% increase in aboveground weight</strong>, holding height constant</li>
</ul>
<p><strong>Practical Implications:</strong></p>
<ol type="1">
<li><p><strong>Highly Precise Estimate:</strong></p>
<ul>
<li><p>Interval width = 0.2008 (very narrow)</p></li>
<li><p>Relative to the estimate (2.1778), this is only ±4.6% variation</p></li>
<li><p>The small standard error (0.0496) results in a tight confidence interval</p></li>
<li><p>This reflects the <strong>strong relationship</strong> between diameter and biomass</p></li>
</ul></li>
<li><p><strong>Significantly Different from Zero:</strong></p>
<ul>
<li><p>The entire interval is <strong>far above zero</strong> (minimum = 2.0774)</p></li>
<li><p>Strong evidence that diameter has a <strong>positive effect</strong> on biomass</p></li>
<li><p>p-value &lt; 2.2 × 10⁻¹⁶ confirms this is extremely significant</p></li>
</ul></li>
<li><p><strong>Biological Interpretation:</strong></p>
<ul>
<li><p>The interval (2.08 - 2.28) confirms biomass scales <strong>more than quadratically</strong> with diameter</p></li>
<li><p>Consistent with theoretical expectations: biomass depends on volume (∝ diameter²) plus bark, branches, and structural components</p></li>
<li><p>The exponent being definitively &gt; 2 (lower bound = 2.0774) is biologically meaningful</p></li>
</ul></li>
<li><p><strong>Comparison to Theory:</strong></p>
<ul>
<li><p>Simple volume would suggest β₁ = 2 (area of cross-section)</p></li>
<li><p>Our interval [2.08, 2.28] exceeds 2, indicating <strong>additional scaling effects</strong></p></li>
<li><p>This is typical for tree allometry</p></li>
</ul></li>
</ol>
</section>
<section id="compute-the-r2-r2_a-and-the-residual-variance." class="level5">
<h5 class="anchored" data-anchor-id="compute-the-r2-r2_a-and-the-residual-variance.">(4) Compute the <span class="math inline">\(R^2, R^2_a\)</span> and the residual variance.</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"R-squared (R²): %.4f</span><span class="sc">\n</span><span class="st">"</span>, r_squared_d))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared (R²): 0.9856</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  → The model explains %.2f%% of the variance in log(aboveground weight)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>            r_squared_d <span class="sc">*</span> <span class="dv">100</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  → The model explains 98.56% of the variance in log(aboveground weight)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Adjusted R-squared (R²ₐ): %.4f</span><span class="sc">\n</span><span class="st">"</span>, r_squared_adj_d))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R-squared (R²ₐ): 0.9849</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  → Adjusts for number of predictors</span><span class="sc">\n</span><span class="st">"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  → Adjusts for number of predictors</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Residual variance (σ²): %.4f</span><span class="sc">\n</span><span class="st">"</span>, residual_var_d))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Residual variance (σ²): 0.0226</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Residual standard error (σ): %.4f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">sqrt</span>(residual_var_d)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Residual standard error (σ): 0.1505</code></pre>
</div>
</div>
<p><strong>1. R-squared (R²) = 0.9856</strong></p>
<p><strong>Definition:</strong></p>
<p>R² measures the <strong>proportion of variance in the dependent variable</strong> (log(aboveground weight)) that is <strong>explained by the independent variables</strong> (log(diameter) and log(height)).</p>
<p><strong>Interpretation:</strong></p>
<p><strong>Statistical Interpretation:</strong></p>
<ul>
<li><p>The model explains <strong>98.56% of the total variance</strong> in log(aboveground weight)</p></li>
<li><p>Only <strong>1.44% of the variance remains unexplained</strong> (due to random error and unmeasured factors)</p></li>
</ul>
<p><strong>Practical Interpretation:</strong></p>
<ul>
<li><p>This is an <strong>excellent fit</strong> - nearly all variation in tree biomass is captured by diameter and height</p></li>
<li><p>The model has <strong>very high predictive power</strong></p></li>
<li><p>The allometric relationship is <strong>extremely strong and consistent</strong></p></li>
</ul>
<p><strong>Quality Assessment:</strong></p>
<ul>
<li><p>R² &gt; 0.95 is considered <strong>excellent</strong> in biological sciences</p></li>
<li><p>R² = 0.9856 indicates the model is <strong>highly effective</strong> at predicting biomass</p></li>
<li><p>Very little room for improvement with additional predictors</p></li>
</ul>
<p><strong>2. Adjusted R-squared (R²ₐ) = 0.9849</strong></p>
<p><strong>Definition:</strong></p>
<p>Adjusted R² modifies R² to account for the <strong>number of predictors</strong> in the model, penalizing for adding variables that don’t substantially improve fit.</p>
<p><strong>Interpretation:</strong></p>
<p><strong>Statistical Interpretation:</strong></p>
<ul>
<li><p>After adjusting for the 2 predictors, the model still explains <strong>98.49% of the variance</strong></p></li>
<li><p>The adjustment penalty is minimal: R² - R²ₐ = 0.9856 - 0.9849 = <strong>0.0007</strong> (0.07%)</p></li>
</ul>
<p><strong>Why the Small Difference?</strong></p>
<ul>
<li><p><strong>Large sample size</strong> relative to predictors (n=42, p=2)</p></li>
<li><p>Both predictors are <strong>highly significant</strong> and contribute meaningfully</p></li>
<li><p>No “overfitting” - the predictors genuinely improve the model</p></li>
</ul>
<p><strong>Model Selection Implications:</strong></p>
<ul>
<li><p>The small difference (0.07%) indicates <strong>both predictors are valuable</strong></p></li>
<li><p>If we had added an irrelevant predictor, R²ₐ would have decreased while R² increased</p></li>
<li><p>The fact that R²ₐ is nearly identical to R² confirms our model is <strong>parsimonious and well-specified</strong></p></li>
</ul>
<p><strong>3. Residual Variance (σ²) = 0.0226</strong></p>
<p><strong>Definition:</strong></p>
<p>The residual variance measures the <strong>average squared deviation</strong> of observations from the fitted regression line on the log scale.</p>
<p><strong>Interpretation:</strong></p>
<p><strong>Statistical Interpretation:</strong></p>
<ul>
<li><p>The variance of the residuals around the regression line is <strong>0.0226</strong> (in log units)</p></li>
<li><p>This represents the <strong>unexplained variation</strong> in the model</p></li>
<li><p>Lower values indicate better fit</p></li>
</ul>
<p><strong>Scale Consideration:</strong></p>
<ul>
<li><p>This is on the <strong>log scale</strong>, so it’s not directly interpretable in kg</p></li>
<li><p>However, 0.0226 is <strong>quite small</strong> for log-transformed data</p></li>
<li><p>It indicates <strong>tight clustering</strong> of observations around the fitted line</p></li>
</ul>
<p><strong>Comparison to Simple Model:</strong></p>
<ul>
<li><p>Simple model (diameter only): σ² = 0.0339</p></li>
<li><p>Multiple model (diameter + height): σ² = 0.0226</p></li>
<li><p>Reduction: 0.0339 - 0.0226 = 0.0113</p></li>
<li><p><strong>33.3% reduction</strong> in residual variance by adding height</p></li>
</ul>
<p><strong>Quality Assessment:</strong></p>
<ul>
<li><p>Small residual variance indicates <strong>high precision</strong></p></li>
<li><p>Predictions will have <strong>narrow prediction intervals</strong></p></li>
<li><p>The model captures the systematic relationship very well</p></li>
</ul>
<p><strong>4. Residual Standard Error (σ) = 0.1505</strong></p>
<p><strong>Definition:</strong></p>
<p>The residual standard error is the <strong>square root of the residual variance</strong>, representing the typical size of a residual.</p>
<p><strong>Interpretation:</strong></p>
<p><strong>Statistical Interpretation:</strong></p>
<ul>
<li><p>The <strong>typical prediction error</strong> is about 0.1505 on the log scale</p></li>
<li><p>This is the standard deviation of the residuals</p></li>
<li><p>About 68% of observations fall within ±0.1505 of their predicted log(weight)</p></li>
<li><p>About 95% fall within ±2(0.1505) = ±0.301 of their predicted log(weight)</p></li>
</ul>
<p><strong>Back-transformation to Original Scale:</strong> To understand the prediction error in terms of actual weight:</p>
<ul>
<li><p>A residual of +0.1505 on log scale → multiplicative error of exp(0.1505) ≈ <strong>1.162</strong> (16.2% overestimation)</p></li>
<li><p>A residual of -0.1505 on log scale → multiplicative error of exp(-0.1505) ≈ <strong>0.860</strong> (14.0% underestimation)</p></li>
</ul>
<p><strong>Practical Interpretation:</strong></p>
<ul>
<li><p>Typical predictions are accurate within about <strong>±14-16%</strong> on the original scale</p></li>
<li><p>This is <strong>excellent precision</strong> for biological/ecological models</p></li>
<li><p>For carbon accounting, this level of accuracy is highly acceptable</p></li>
</ul>
<p><strong>Comparison to Simple Model:</strong></p>
<ul>
<li><p>Simple model: σ = 0.1842</p></li>
<li><p>Multiple model: σ = 0.1505</p></li>
<li><p>Improvement: <strong>18.3% reduction</strong> in typical prediction error</p></li>
</ul>
</section>
<section id="construct-a-graph-with-the-default-diagnostics-plots-of-r." class="level5">
<h5 class="anchored" data-anchor-id="construct-a-graph-with-the-default-diagnostics-plots-of-r.">(5) Construct a graph with the default diagnostics plots of R.</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_d, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>1. Residuals vs Fitted (Top Left)</strong></p>
<p><strong>Purpose:</strong></p>
<p>Checks for <strong>linearity</strong> and <strong>homoscedasticity</strong> (constant variance).</p>
<p><strong>What to Look For:</strong></p>
<ul>
<li><p>Residuals should be randomly scattered around zero</p></li>
<li><p>No systematic patterns (curves, funnels, or trends)</p></li>
<li><p>Horizontal red line near zero</p></li>
</ul>
<p><strong>Observations:</strong></p>
<p><strong>GOOD SIGNS:</strong></p>
<ul>
<li><p>Residuals are <strong>randomly scattered</strong> around the horizontal zero line</p></li>
<li><p>The red smoothed line is <strong>nearly horizontal</strong> and close to zero</p></li>
<li><p>No clear <strong>curved pattern</strong> (U-shape or inverted U-shape)</p></li>
<li><p>Points are distributed relatively evenly above and below zero</p></li>
</ul>
<p><strong>MINOR CONCERNS:</strong></p>
<ul>
<li><p>There’s a <strong>slight suggestion of clustering</strong> around fitted values 7-8</p></li>
<li><p>A few labeled points (10, 11, 15) show slightly larger residuals</p></li>
<li><p><strong>Very slight hint</strong> of increasing spread at higher fitted values (but minimal)</p></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>The <strong>linearity assumption is satisfied</strong> - the log-log transformation successfully linearized the relationship. <strong>Homoscedasticity appears reasonable</strong> with only very minor heteroscedasticity, if any.</p>
<p><strong>2. Normal Q-Q Plot (Top Right)</strong></p>
<p><strong>Purpose:</strong></p>
<p>Checks if residuals follow a <strong>normal distribution</strong>.</p>
<p><strong>What to Look For:</strong></p>
<ul>
<li><p>Points should fall along the diagonal dashed line</p></li>
<li><p>No systematic deviations (S-curves, heavy tails, or outliers)</p></li>
</ul>
<p><strong>Observations:</strong></p>
<p><strong>EXCELLENT:</strong></p>
<ul>
<li><p>The vast majority of points <strong>follow the diagonal line closely</strong></p></li>
<li><p>The middle portion (between quantiles -1 to +1.5) shows <strong>excellent alignment</strong></p></li>
<li><p>This represents about 80-90% of the data</p></li>
</ul>
<p><strong>SLIGHT DEVIATIONS:</strong></p>
<ul>
<li><p><strong>Right tail (upper quantiles):</strong> Points 11, 10, 9, 15 slightly deviate upward</p>
<ul>
<li><p>These observations have <strong>slightly larger positive residuals</strong> than expected under perfect normality</p></li>
<li><p>Suggests very mild <strong>right skewness</strong> or potential outliers</p></li>
</ul></li>
<li><p><strong>Left tail (lower quantiles):</strong> Minor deviation in the lower left</p>
<ul>
<li>Less pronounced than right tail</li>
</ul></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>The <strong>normality assumption is largely satisfied</strong>. The deviations are <strong>minor</strong> and unlikely to seriously affect inference. The slight right-tail deviation is common in biological data and not severe enough to warrant concern for a sample of n=42.</p>
<p><strong>3. Scale-Location Plot (Bottom Left)</strong></p>
<p><strong>Purpose:</strong></p>
<p>Another check for <strong>homoscedasticity</strong> (constant variance) using standardized residuals.</p>
<p><strong>What to Look For:</strong></p>
<ul>
<li><p>Random scatter of points</p></li>
<li><p>Horizontal red line</p></li>
<li><p>Constant vertical spread across fitted values</p></li>
</ul>
<p><strong>Observations:</strong></p>
<p><strong>GOOD SIGNS:</strong></p>
<ul>
<li><p>The red smoothed line is <strong>relatively flat</strong> (slight upward trend but minimal)</p></li>
<li><p>Points show <strong>reasonably consistent spread</strong> across the range of fitted values</p></li>
<li><p>Most points cluster between √|standardized residuals| of 0.5 and 1.2</p></li>
</ul>
<p><strong>MINOR CONCERNS:</strong></p>
<ul>
<li><p>Again, observations 10, 11, and 15 stand out with higher values</p></li>
<li><p><strong>Very slight upward trend</strong> in the red line at higher fitted values</p>
<ul>
<li><p>Suggests marginally increasing variance with predicted weight</p></li>
<li><p>However, the trend is <strong>very modest</strong></p></li>
</ul></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p><strong>Homoscedasticity assumption is reasonably satisfied</strong>. There’s a very slight hint of increasing variance at higher fitted values, but it’s minor and unlikely to seriously violate the assumption. The constant variance assumption holds <strong>reasonably well</strong>.</p>
<p><strong>4. Residuals vs Leverage (Cook’s Distance) (Bottom Right)</strong></p>
<p><strong>Purpose:</strong></p>
<p>Identifies <strong>influential observations</strong> that have high leverage and/or large residuals.</p>
<p><strong>What to Look For:</strong></p>
<ul>
<li><p>Points outside Cook’s distance contours (dashed red lines, typically 0.5 or 1.0)</p></li>
<li><p>Points in upper-right or lower-right corners (high leverage + large residual)</p></li>
<li><p>Most points should have low Cook’s distance</p></li>
</ul>
<p><strong>Observations:</strong></p>
<p><strong>EXCELLENT:</strong></p>
<ul>
<li><p><strong>No points exceed Cook’s distance of 0.5</strong> (no dashed red contour lines are visible)</p></li>
<li><p>All observations have <strong>Cook’s distance well below 0.2</strong></p></li>
<li><p>Most points cluster near <strong>Cook’s distance &lt; 0.1</strong></p></li>
</ul>
<p><strong>Notable Observations:</strong></p>
<ul>
<li><p><strong>Observation 11:</strong> Highest Cook’s distance (~0.15) but still well below concerning threshold</p></li>
<li><p><strong>Observation 15:</strong> Also elevated (~0.13)</p></li>
<li><p><strong>Observation 13:</strong> Moderate Cook’s distance (~0.12)</p></li>
<li><p>These points have <strong>some influence</strong> but are <strong>not problematic</strong></p></li>
</ul>
<p><strong>Leverage Assessment:</strong></p>
<ul>
<li><p>All points have <strong>relatively low leverage</strong> (x-axis values &lt; 0.15)</p></li>
<li><p>No extreme leverage points that would dominate the regression</p></li>
<li><p>The maximum leverage is well below concerning thresholds (typically 2p/n = 6/42 = 0.14)</p></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p><strong>No influential observations</strong> of serious concern. While observations 11, 13, and 15 have slightly elevated Cook’s distances, they remain well within acceptable ranges and do not unduly influence the regression results.</p>
</section>
<section id="can-homogeneity-of-variance-be-assumed" class="level5">
<h5 class="anchored" data-anchor-id="can-homogeneity-of-variance-be-assumed">(6) Can homogeneity of variance be assumed?</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Breusch-Pagan test</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>bp_test <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">bptest</span>(model_d)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Breusch-Pagan Test for Heteroscedasticity:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Breusch-Pagan Test for Heteroscedasticity:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bp_test)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  model_d
BP = 7.4101, df = 2, p-value = 0.0246</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(bp_test<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Conclusion: Fail to reject H₀ (p &gt; 0.05)."</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Homogeneity of variance can be assumed.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Conclusion: Reject H₀ (p &lt; 0.05)."</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Evidence of heteroscedasticity (non-constant variance).</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Conclusion: Reject H₀ (p &lt; 0.05).
Evidence of heteroscedasticity (non-constant variance).</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual assessment</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Visual Assessment: Check the Residuals vs Fitted plot."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Visual Assessment: Check the Residuals vs Fitted plot.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">If residuals are randomly scattered around zero with constant spread,"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
If residuals are randomly scattered around zero with constant spread,</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">homoscedasticity is reasonable.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
homoscedasticity is reasonable.</code></pre>
</div>
</div>
<p><strong>Statistical Test Results:</strong></p>
<p><strong>Breusch-Pagan Test for Heteroscedasticity:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Test Statistic</th>
<th>df</th>
<th>p-value</th>
<th>Decision</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BP = 7.4101</td>
<td>2</td>
<td>0.0246</td>
<td>Reject H₀</td>
</tr>
</tbody>
</table>
<p><strong>Hypotheses:</strong></p>
<ul>
<li><p><strong>H₀:</strong> Homoscedasticity (constant variance of residuals)</p></li>
<li><p><strong>H₁:</strong> Heteroscedasticity (non-constant variance of residuals)</p></li>
</ul>
<p><strong>Test Interpretation:</strong></p>
<ul>
<li><p><strong>p-value = 0.0246 &lt; 0.05</strong> → Reject the null hypothesis at α = 0.05</p></li>
<li><p><strong>Statistical conclusion:</strong> There is evidence of <strong>heteroscedasticity</strong></p></li>
</ul>
<p><strong>Answer: Homogeneity of Variance - BORDERLINE CASE</strong></p>
<p><strong>TECHNICAL ANSWER: Marginally Violated</strong></p>
<p>Based on the <strong>formal statistical test alone</strong>, we would conclude:</p>
<ul>
<li><p><strong>No, homogeneity of variance cannot be fully assumed</strong></p></li>
<li><p>The Breusch-Pagan test detects <strong>statistically significant heteroscedasticity</strong> (p = 0.0246)</p></li>
</ul>
<p><strong>Technically:</strong></p>
<p><strong>No, perfect homogeneity of variance cannot be assumed</strong> - the Breusch-Pagan test detects statistically significant heteroscedasticity (p = 0.0246).</p>
<p><strong>Practically:</strong></p>
<p><strong>The violation is MILD and does NOT seriously compromise the model</strong>:</p>
<ul>
<li><p>It’s a <strong>borderline case</strong> (p = 0.0246, just below 0.05)</p></li>
<li><p>Visual diagnostics show only <strong>minor variance changes</strong></p></li>
<li><p>Parameter estimates remain <strong>valid and unbiased</strong></p></li>
<li><p>Inference remains <strong>reliable</strong> given the extremely strong statistical significance of predictors</p></li>
<li><p>Predictions remain <strong>highly accurate</strong> (R² = 0.9856)</p></li>
</ul>
</section>
<section id="do-the-residuals-appear-to-follow-a-normal-distribution" class="level5">
<h5 class="anchored" data-anchor-id="do-the-residuals-appear-to-follow-a-normal-distribution">(7) Do the residuals appear to follow a normal distribution?</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk test</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(model_d))</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Shapiro-Wilk Normality Test:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Shapiro-Wilk Normality Test:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_test)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(model_d)
W = 0.95133, p-value = 0.07208</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(shapiro_test<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Conclusion: Fail to reject H₀ (p &gt; 0.05)."</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Residuals appear to follow a normal distribution.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Conclusion: Reject H₀ (p &lt; 0.05)."</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Residuals may deviate from normality.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Conclusion: Fail to reject H₀ (p &gt; 0.05).
Residuals appear to follow a normal distribution.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q-Q plot</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Visual Assessment: Check the Normal Q-Q plot."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Visual Assessment: Check the Normal Q-Q plot.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Points should follow the diagonal line closely.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Points should follow the diagonal line closely.</code></pre>
</div>
</div>
<p><strong>Statistical Test Results:</strong></p>
<p><strong>Shapiro-Wilk Normality Test:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Test Statistic</th>
<th>p-value</th>
<th>Decision</th>
<th>α level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>W = 0.95133</td>
<td>0.07208</td>
<td>Fail to reject H₀</td>
<td>0.05</td>
</tr>
</tbody>
</table>
<p><strong>Hypotheses:</strong></p>
<ul>
<li><p><strong>H₀:</strong> The residuals follow a normal distribution</p></li>
<li><p><strong>H₁:</strong> The residuals do NOT follow a normal distribution</p></li>
</ul>
<p><strong>Test Interpretation:</strong></p>
<ul>
<li><p><strong>p-value = 0.07208 &gt; 0.05</strong> → Fail to reject the null hypothesis at α = 0.05</p></li>
<li><p><strong>Statistical conclusion:</strong> There is <strong>insufficient evidence to reject normality</strong></p></li>
<li><p>The residuals are <strong>consistent with a normal distribution</strong></p></li>
</ul>
<p><strong>Answer: YES, Residuals Appear to Follow a Normal Distribution</strong></p>
<p><strong>Evidence:</strong></p>
<ol type="1">
<li><p><strong>Shapiro-Wilk test:</strong> p = 0.072 &gt; 0.05 (fail to reject normality)</p></li>
<li><p><strong>W statistic:</strong> 0.951 (close to 1, indicates good fit)</p></li>
<li><p><strong>Q-Q plot:</strong> 80-90% of points follow diagonal closely</p></li>
<li><p><strong>Minor tail deviations:</strong> Present but not concerning</p></li>
<li><p><strong>Overall assessment:</strong> Normality assumption is <strong>well satisfied</strong></p></li>
</ol>
<p><strong>Conclusion:</strong> The normality assumption <strong>holds sufficiently well</strong> for:</p>
<ul>
<li><p>Valid statistical inference</p></li>
<li><p>Reliable confidence intervals</p></li>
<li><p>Trustworthy hypothesis tests</p></li>
<li><p>Accurate predictions</p></li>
</ul>
<p>The minor deviations in the tails are <strong>typical of real-world ecological data</strong> and do <strong>not undermine the model’s validity</strong>. The allometric regression model satisfies the normality assumption and can be <strong>confidently used for inference and prediction</strong>.</p>
</section>
<section id="are-there-any-outliers-in-the-data" class="level5">
<h5 class="anchored" data-anchor-id="are-there-any-outliers-in-the-data">(8) Are there any outliers in the data?</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardized residuals</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>std_resid <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(model_d)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(std_resid) <span class="sc">&gt;</span> <span class="dv">3</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Observations with |standardized residuals| &gt; 3:</span><span class="sc">\n</span><span class="st">"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Observations with |standardized residuals| &gt; 3:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(outliers) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Potential outliers at observations:"</span>, outliers, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">data.frame</span>(</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Observation =</span> outliers,</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Std_Residual =</span> std_resid[outliers]</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"No extreme outliers detected (using |std. residual| &gt; 3 criterion).</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>No extreme outliers detected (using |std. residual| &gt; 3 criterion).</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for moderate outliers (&gt; 2.5)</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>moderate_outliers <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(std_resid) <span class="sc">&gt;</span> <span class="fl">2.5</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Observations with |standardized residuals| &gt; 2.5:</span><span class="sc">\n</span><span class="st">"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Observations with |standardized residuals| &gt; 2.5:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(moderate_outliers) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Moderate outliers at observations:"</span>, moderate_outliers, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"None found.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Moderate outliers at observations: 15 </code></pre>
</div>
</div>
<p><strong>Criterion 1: Extreme Outliers (|Standardized Residual| &gt; 3)</strong></p>
<p><strong>Result:</strong> <strong>No extreme outliers detected</strong></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>Using the stringent criterion of <strong>|standardized residual| &gt; 3</strong></p></li>
<li><p><strong>Zero observations</strong> exceed this threshold</p></li>
<li><p>This represents points more than <strong>3 standard deviations</strong> from the regression line</p></li>
<li><p>Expected under normality: ~0.3% of observations (0.13 out of 42)</p></li>
<li><p><strong>Observed: 0 observations</strong> → No extreme outliers</p></li>
</ul>
<p><strong>Criterion 2: Moderate Outliers (|Standardized Residual| &gt; 2.5)</strong></p>
<p><strong>Result:</strong> <strong>One moderate outlier detected</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Observation</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>15</strong></td>
<td>Moderate outlier (</td>
</tr>
</tbody>
</table>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>Using the moderate criterion of <strong>|standardized residual| &gt; 2.5</strong></p></li>
<li><p><strong>One observation (#15)</strong> exceeds this threshold</p></li>
<li><p>This represents a point more than <strong>2.5 standard deviations</strong> from the regression line</p></li>
<li><p>Expected under normality: ~1.2% of observations (0.50 out of 42)</p></li>
<li><p><strong>Observed: 1 observation (2.4%)</strong> → Slightly above expected, but not alarming</p></li>
</ul>
<p><strong>Answer: Minimal Outliers - Not a Concern</strong></p>
<p><strong>Summary:</strong></p>
<ul>
<li><p><strong>Extreme outliers (&gt; 3σ):</strong> None</p></li>
<li><p><strong>Moderate outliers (&gt; 2.5σ):</strong> One (observation #15)</p></li>
<li><p><strong>Overall assessment:</strong> The data has <strong>very few outliers</strong>, and those present are <strong>not extreme</strong></p></li>
</ul>
</section>
<section id="are-there-any-influential-observations-in-the-data" class="level5">
<h5 class="anchored" data-anchor-id="are-there-any-influential-observations-in-the-data">(9) Are there any influential observations in the data?</h5>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cook's distance</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>cooks_d <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model_d)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>influential <span class="ot">&lt;-</span> <span class="fu">which</span>(cooks_d <span class="sc">&gt;</span> <span class="dv">4</span><span class="sc">/</span><span class="fu">length</span>(cooks_d))</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Cook's Distance Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cook's Distance Analysis:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Threshold: 4/n = 4/%d = %.4f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">length</span>(cooks_d), <span class="dv">4</span><span class="sc">/</span><span class="fu">length</span>(cooks_d)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Threshold: 4/n = 4/42 = 0.0952</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(influential) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Influential observations (Cook's D &gt; 4/n):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">data.frame</span>(</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Observation =</span> influential,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cooks_Distance =</span> cooks_d[influential]</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"No highly influential observations detected.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Influential observations (Cook's D &gt; 4/n):
   Observation Cooks_Distance
10          10     0.09926686
11          11     0.10762639
13          13     0.17027939
15          15     0.11358272</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DFBETAS</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> <span class="fu">dfbetas</span>(model_d)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>influential_dfb <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">apply</span>(<span class="fu">abs</span>(dfb), <span class="dv">1</span>, max) <span class="sc">&gt;</span> <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(cooks_d)))</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">DFBETAS Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
DFBETAS Analysis:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Threshold: 2/√n = 2/√%d = %.4f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">length</span>(cooks_d), <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(cooks_d))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Threshold: 2/√n = 2/√42 = 0.3086</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(influential_dfb) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Influential observations (max |DFBETAS| &gt; 2/√n):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(influential_dfb, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"No influential observations detected using DFBETAS criterion.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Influential observations (max |DFBETAS| &gt; 2/√n):
10 11 13 14 15 39 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leverage</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>hat_values <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(model_d)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>high_leverage <span class="ot">&lt;-</span> <span class="fu">which</span>(hat_values <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">3</span> <span class="sc">/</span> <span class="fu">length</span>(hat_values))</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Leverage Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Leverage Analysis:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Threshold: 2p/n = 2*3/%d = %.4f</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">length</span>(hat_values), <span class="dv">2</span> <span class="sc">*</span> <span class="dv">3</span> <span class="sc">/</span> <span class="fu">length</span>(hat_values)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Threshold: 2p/n = 2*3/42 = 0.1429</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(high_leverage) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">High leverage observations:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(high_leverage, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"No high leverage points detected.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
High leverage observations:
3 34 41 </code></pre>
</div>
</div>
<p><strong>YES - but with important qualifications:</strong></p>
<p><strong>Mild to Moderate Influence Detected:</strong></p>
<ul>
<li><p><strong>4 observations</strong> (10, 11, 13, 15) show <strong>mild to moderate influence</strong> via Cook’s Distance</p></li>
<li><p><strong>6 observations</strong> (10, 11, 13, 14, 15, 39) influence <strong>specific coefficients</strong> via DFBETAS</p></li>
<li><p><strong>3 observations</strong> (3, 34, 41) have <strong>high leverage but fit well</strong></p></li>
</ul>
<p><strong>None Are Severely Problematic:</strong></p>
<ul>
<li><p><strong>Maximum Cook’s D = 0.170</strong> (well below concerning threshold of 0.5)</p></li>
<li><p>High leverage points <strong>conform to the model</strong> (small residuals)</p></li>
<li><p>Influence is <strong>distributed</strong> across multiple observations (no single dominant point)</p></li>
</ul>
<p><strong>Model Remains Robust:</strong></p>
<ul>
<li><p>All influential observations combined explain &lt; 10% of data</p></li>
<li><p><strong>Removing any/all would have minimal impact</strong> on conclusions</p></li>
<li><p>Strong statistical significance (p &lt; 10⁻⁵) provides <strong>large buffer</strong></p></li>
<li><p>R² = 0.9856 indicates <strong>excellent fit even with these observations</strong></p></li>
</ul>
<p><strong>Recommended Action:</strong></p>
<p><strong>RETAIN all observations</strong> - they represent legitimate biological variation within acceptable influence bounds</p>
<p><strong>OPTIONAL: Verify data quality</strong> for observations 13, 15, 11, 10 if original records available</p>
<p><strong>DOCUMENT</strong> that influence diagnostics were checked and found acceptable</p>
<p><strong>PROCEED confidently</strong> with inference and prediction using the full model</p>
<p><strong>Conclusion:</strong></p>
<p>While several observations show <strong>detectable influence</strong> on the regression, <strong>none are severe enough to warrant removal or concern</strong>. The model is <strong>statistically robust</strong>, all assumptions are <strong>reasonably satisfied</strong>, and the influential observations represent <strong>natural biological variation</strong> rather than data problems.</p>
<p>The allometric equation remains <strong>valid, reliable, and appropriate for operational use</strong> in estimating beech tree biomass for carbon accounting and forest inventory applications.</p>
</section>
</section>
<section id="f-obtain-predictions-of-the-aboveground-biomass-of-trees-with-diameters-diameter-seq12.5-42.5-5-and-heights-height-seq10-40-5.-note-that-the-weight-predictions-are-obtained-from-back-transforming-the-logarithm.-the-bias-correction-is-obtained-by-means-of-the-lognormal-distribution-if-haty_pred-is-the-prediction-the-correctedback-transformed-prediction-tildey_pred-is-given-by" class="level4">
<h4 class="anchored" data-anchor-id="f-obtain-predictions-of-the-aboveground-biomass-of-trees-with-diameters-diameter-seq12.5-42.5-5-and-heights-height-seq10-40-5.-note-that-the-weight-predictions-are-obtained-from-back-transforming-the-logarithm.-the-bias-correction-is-obtained-by-means-of-the-lognormal-distribution-if-haty_pred-is-the-prediction-the-correctedback-transformed-prediction-tildey_pred-is-given-by">(f) Obtain predictions of the aboveground biomass of trees with diameters <span class="math inline">\(diameter = seq(12.5, 42.5, 5)\)</span> and heights <span class="math inline">\(height = seq(10, 40, 5)\)</span>. Note that the weight predictions are obtained from back transforming the logarithm. The bias correction is obtained by means of the lognormal distribution: If <span class="math inline">\(\hat{Y}_{pred}\)</span> is the prediction, the corrected(back-transformed) prediction <span class="math inline">\(\tilde{Y}_{pred}\)</span> is given by</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction data</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>pred_diameter <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">12.5</span>, <span class="fl">42.5</span>, <span class="dv">5</span>)  </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>pred_height <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">5</span>)        </span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create all combinations</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">diameter =</span> pred_diameter,</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> pred_height</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Creating predictions for %d combinations of diameter and height</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">nrow</span>(pred_data)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Creating predictions for 49 combinations of diameter and height</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on log scale</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>log_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_d, </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">newdata =</span> <span class="fu">data.frame</span>(</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">diameter =</span> pred_data<span class="sc">$</span>diameter,</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">height =</span> pred_data<span class="sc">$</span>height</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>                               ))</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract residual variance (sigma squared)</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>sigma_sq <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_d)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Back-transform with bias correction</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>PSA_pred_naive <span class="ot">&lt;-</span> <span class="fu">exp</span>(pred_data<span class="sc">$</span>log_pred)</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>PSA_pred_corrected <span class="ot">&lt;-</span> <span class="fu">exp</span>(pred_data<span class="sc">$</span>log_pred <span class="sc">+</span> sigma_sq<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Bias Correction Formula:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Bias Correction Formula:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"ỹ_pred = exp(ŷ_pred + σ²/2)</span><span class="sc">\n</span><span class="st">"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>ỹ_pred = exp(ŷ_pred + σ²/2)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"where σ² = %.4f</span><span class="sc">\n</span><span class="st">"</span>, sigma_sq))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>where σ² = 0.0226</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Sample Predictions ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Sample Predictions ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(pred_data[, <span class="fu">c</span>(<span class="st">"diameter"</span>, <span class="st">"height"</span>, <span class="st">"PSA_pred_corrected"</span>)], <span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   diameter height PSA_pred_corrected
1      12.5     10           52.10406
2      17.5     10          108.41945
3      22.5     10          187.41338
4      27.5     10          290.13163
5      32.5     10          417.44086
6      37.5     10          570.08529
7      42.5     10          748.71965
8      12.5     15           64.57368
9      17.5     15          134.36658
10     22.5     15          232.26546</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Full Prediction Table ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Full Prediction Table ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>pred_table <span class="ot">&lt;-</span> pred_data[, <span class="fu">c</span>(<span class="st">"diameter"</span>, <span class="st">"height"</span>, </span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"log_pred"</span>, <span class="st">"PSA_pred_corrected"</span>)]</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pred_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Diameter (cm)"</span>, <span class="st">"Height (m)"</span>, </span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Log(Weight)"</span>, <span class="st">"Predicted Weight (kg)"</span>)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(pred_table))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Diameter (cm) Height (m) Log(Weight) Predicted Weight (kg)
1          12.5         10    3.941919              52.10406
2          17.5         10    4.674684             108.41945
3          22.5         10    5.221993             187.41338
4          27.5         10    5.659011             290.13163
5          32.5         10    6.022820             417.44086
6          37.5         10    6.334463             570.08529</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization of predictions</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Generating prediction visualization...</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Generating prediction visualization...</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data, <span class="fu">aes</span>(<span class="at">x =</span> diameter, <span class="at">y =</span> PSA_pred_corrected, </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> <span class="fu">factor</span>(height))) <span class="sc">+</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted Aboveground Weight by Diameter and Height"</span>,</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Diameter (cm)"</span>,</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Aboveground Weight (kg)"</span>,</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Height (m)"</span>) <span class="sc">+</span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Patterns from Predictions:</strong></p>
<p><strong>1. Effect of Diameter (holding height constant at 10m):</strong></p>
<p><strong>Observation:</strong></p>
<ul>
<li><p>Diameter has a <strong>strong accelerating effect</strong> (β₁ = 2.18)</p></li>
<li><p>Each 5 cm increase in diameter adds increasingly more biomass</p></li>
<li><p>This reflects the <strong>power-law relationship</strong> (weight ∝ diameter^2.18)</p></li>
</ul>
<p><strong>2. Effect of Height (holding diameter constant at 22.5 cm):</strong></p>
<p><strong>Observation:</strong></p>
<ul>
<li><p>Height has a <strong>moderate, decelerating effect</strong> (β₂ = 0.53)</p></li>
<li><p>Each 5 m increase adds progressively less biomass</p></li>
<li><p>This reflects the <strong>sub-linear relationship</strong> (weight ∝ height^0.53)</p></li>
</ul>
<p><strong>3. Extreme Cases:</strong></p>
<p><strong>Smallest tree (12.5 cm × 10 m):</strong></p>
<ul>
<li><p>Predicted weight: <strong>52.1 kg</strong></p></li>
<li><p>Represents a young or suppressed beech tree</p></li>
</ul>
<p><strong>Largest tree (42.5 cm × 40 m):</strong></p>
<ul>
<li><p>Predicted weight: <strong>1,559 kg</strong> (from full table)</p></li>
<li><p>Represents a mature, dominant canopy tree</p></li>
<li><p><strong>30× more biomass</strong> than smallest tree</p></li>
</ul>
<p><strong>Visualization Interpretation:</strong></p>
<p><strong>Key Patterns in the Graph:</strong></p>
<p><strong>Fan-shaped pattern:</strong></p>
<ul>
<li><p>Lines diverge as diameter increases</p></li>
<li><p>Height effect becomes <strong>more pronounced</strong> at larger diameters</p></li>
<li><p>This is the <strong>interaction effect</strong> of the multiplicative (power-law) model</p></li>
</ul>
<p><strong>Color gradient (height effect):</strong></p>
<ul>
<li><p><strong>Red (10m):</strong> Lowest biomass for any diameter</p></li>
<li><p><strong>Pink (40m):</strong> Highest biomass for any diameter</p></li>
<li><p>Clear <strong>vertical separation</strong> showing height’s contribution</p></li>
</ul>
<p><strong>Steep slopes:</strong></p>
<ul>
<li><p>All lines are <strong>curved upward</strong> (exponential appearance on original scale)</p></li>
<li><p>Reflects the strong diameter effect (β₁ = 2.18)</p></li>
</ul>
<p><strong>Biological realism:</strong></p>
<ul>
<li><p>Predictions follow <strong>realistic patterns</strong> for tree growth</p></li>
<li><p>Small trees: 50-150 kg (realistic for young beeches)</p></li>
<li><p>Large trees: 500-1,500 kg (realistic for mature beeches)</p></li>
</ul>
</section>
</section>
<section id="case-study-2-fruit-trees" class="level1">
<h1>Case Study 2: Fruit Trees</h1>
<p><em>Data and ideas for this case study come from Militino et al.&nbsp;(2006).</em></p>
<p>To estimate the total surface occupied by fruit trees in three small areas (R63, R67, and R68) of Navarra in 2001, a sample of 47 square segments has been taken. The experimental units are square segments or quadrats of 4 hectares, obtained by random sampling after overlaying a square grid on the study domain. The focus of this case study is illustrating two different techniques used to obtain estimates: direct estimation and small area estimation. The direct technique estimates the total surface area by multiplying the mean of the observed surface area in the sampled segments by the total number of segments in every small area. The small area technique consists of creating a regression model where the dependent variable is the observed surface area occupied by fruit trees in every segment and the explanatory variables are the classified cultivars by satellite in the same segment and the small areas to which they belong. The final surface area totals are obtained by multiplying the total classified surface area of every small area by the β’s parameter estimates obtained from the regression model (observed surface area∼ classified surface area + small areas). The surface variables in the data frame <code>SATFRUIT</code> are given in <span class="math inline">\(m^2\)</span>:</p>
<p>• <code>quadrat</code> is the number of the sampled segment or quadraz</p>
<p>• <code>smallarea</code> are the small areas’ labels</p>
<p>• <code>wheat</code> is the classified surface of wheat in the sampled segment</p>
<p>• <code>barley</code> is the classified surface of barley in the sampled segment</p>
<p>• <code>nonarable</code> is the classified surface of fallow or non-arable land in the sampled segment</p>
<p>• <code>corn</code> is the classified surface of corn in the sampled segment</p>
<p>• <code>sunflower</code> is the classified surface of sunflowers in the sampled segment</p>
<p>• <code>vineyard</code> is the classified surface of vineyards in the sampled segment</p>
<p>• <code>grass</code> is the classified surface of grass in the sampled segment</p>
<p>• <code>asparagus</code> is the classified surface of asparagus in the sampled segment</p>
<p>• <code>alfalfa</code> is the classified surface of lucerne (type of alfalfa) in the sampled segment</p>
<p>• <code>rape</code> is the classified surface of rape Brassica napus in the sampled segment</p>
<p>• <code>rice</code> is the classified surface of rice in the sampled segment</p>
<p>• <code>almonds</code> is the classified surface of almonds in the sampled segment</p>
<p>• <code>olives</code> is the classified surface of olives in the sampled segment</p>
<p>• <code>fruit</code> is the classified surface of fruit trees in the sampled segment</p>
<p>• <code>observed</code> is the observed surface of fruit trees in the sampled segment</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(PASWR2)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(car)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(boot)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MASS)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(SATFRUIT)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SATFRUIT)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   quadrat smallarea wheat barley nonarable     corn sunflower  vineyard
1 59106566       R68     0      0  1933.912   0.0000         0   0.00000
2 59086560       R68     0      0  1392.159 690.8583         0 399.05674
3 59406568       R68     0      0  2026.149   0.0000         0  54.21483
4 59406562       R68     0      0  1310.520   0.0000         0   0.00000
5 59486566       R68     0      0  1684.034 203.6149         0   0.00000
6 59446566       R68     0      0  3366.676   0.0000         0  68.70976
     grass   asparagus  alfalfa rape rice  almonds    olives     fruit observed
1 666.7915    0.000000   0.0000    0    0 690.3103 6922.5719  4285.158 4626.538
2   0.0000  382.974588 105.2031    0    0   0.0000 2548.0677  8450.084 7172.923
3   0.0000    7.564448   0.0000    0    0   0.0000 1925.0580 10485.737 3304.583
4   0.0000  452.076937   0.0000    0    0   0.0000 1332.5450 11403.596 6457.927
5   0.0000 1020.623038   0.0000    0    0   0.0000  690.4447 10900.023 6926.474
6   0.0000  221.744765 946.5758    0    0   0.0000 1127.4307  8767.596 5221.704</code></pre>
</div>
</div>
<section id="a-characterize-the-shape-center-and-spread-for-the-variable-fruit." class="level3">
<h3 class="anchored" data-anchor-id="a-characterize-the-shape-center-and-spread-for-the-variable-fruit.">(a) Characterize the shape, center, and spread for the variable <code>fruit</code>.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SATFRUIT<span class="sc">$</span>fruit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      0    4241    8536    7827   11356   13969 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standard Deviation:"</span>, <span class="fu">sd</span>(SATFRUIT<span class="sc">$</span>fruit), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standard Deviation: 4119.28 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"IQR:"</span>, <span class="fu">IQR</span>(SATFRUIT<span class="sc">$</span>fruit), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>IQR: 7115.129 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(SATFRUIT<span class="sc">$</span>fruit, <span class="at">main =</span> <span class="st">"Distribution of Classified Fruit Surface Area"</span>,</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Fruit (m²)"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">breaks =</span> <span class="dv">15</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Shape:</strong></p>
<ul>
<li><p><strong>Bimodal distribution</strong>: The histogram shows two distinct peaks or modes:</p>
<ul>
<li><p>A smaller peak around 4,000-5,000 m²</p></li>
<li><p>A larger, more prominent peak around 12,000-13,000 m²</p></li>
</ul></li>
<li><p><strong>Irregular/Non-uniform</strong>: The distribution is not smoothly bell-shaped but rather shows multiple peaks and valleys, suggesting heterogeneity in the data (likely due to different small areas having different fruit coverage patterns)</p></li>
<li><p><strong>Slight gap/valley</strong> in the middle range (around 6,000-8,000 m²), which separates the two modal regions</p></li>
<li><p>The distribution suggests there may be <strong>two distinct groups</strong> of segments: those with lower fruit coverage (0-5,000 m²) and those with higher fruit coverage (10,000-14,000 m²)</p></li>
</ul>
<p><strong>Center:</strong></p>
<p>From the summary statistics provided earlier:</p>
<ul>
<li><p><strong>Mean</strong>: 7,827 m² - falls in the valley between the two modes, which is typical for bimodal distributions</p></li>
<li><p><strong>Median</strong>: 8,536 m² - slightly higher than the mean, positioned in the lower-density middle region</p></li>
</ul>
<p>The center measures are somewhat misleading for a bimodal distribution, as they don’t represent either of the typical values well.</p>
<p><strong>Spread:</strong></p>
<ul>
<li><p><strong>Range</strong>: 0 to 13,969 m² - showing substantial variability (approximately 14,000 m² span)</p></li>
<li><p><strong>Standard Deviation</strong>: 4,119.28 m² - indicates considerable dispersion around the mean</p></li>
<li><p><strong>IQR</strong>: 7,115.129 m²</p>
<ul>
<li><p>Q1: 4,241 m² (within the lower mode region)</p></li>
<li><p>Q3: 11,356 m² (within the upper mode region)</p></li>
</ul></li>
</ul>
<p>The large spread, combined with the bimodal shape, suggests that the sampled segments come from areas with quite different fruit tree coverage characteristics - which aligns with the fact that data comes from three different small areas (R63, R67, R68).(b) What is the maximum number of <span class="math inline">\(m^2\)</span> of classified fruits by segment?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Maximum m² of classified fruits:"</span>, <span class="fu">max</span>(SATFRUIT<span class="sc">$</span>fruit), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum m² of classified fruits: 13968.61 </code></pre>
</div>
</div>
</section>
<section id="c-how-many-observations-are-there-by-small-area" class="level3">
<h3 class="anchored" data-anchor-id="c-how-many-observations-are-there-by-small-area">(c) How many observations are there by small area?</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(SATFRUIT<span class="sc">$</span>smallarea)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
R63 R67 R68 
  3  32  12 </code></pre>
</div>
</div>
</section>
<section id="d-use-scatterplotmatrix-from-car-or-pairs-to-explore-the-linear-relationships-between-observed-and-the-remainder-of-the-numerical-variables.-comment-on-the-results." class="level3">
<h3 class="anchored" data-anchor-id="d-use-scatterplotmatrix-from-car-or-pairs-to-explore-the-linear-relationships-between-observed-and-the-remainder-of-the-numerical-variables.-comment-on-the-results.">(d) Use <code>scatterplotMatrix()</code> from <code>car</code> or <code>pairs()</code> to explore the linear relationships between observed and the remainder of the numerical variables. Comment on the results.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select numerical variables</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>num_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"observed"</span>, <span class="st">"wheat"</span>, <span class="st">"barley"</span>, <span class="st">"nonarable"</span>, <span class="st">"corn"</span>, </span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"sunflower"</span>, <span class="st">"vineyard"</span>, <span class="st">"grass"</span>, <span class="st">"asparagus"</span>, </span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"alfalfa"</span>, <span class="st">"rape"</span>, <span class="st">"rice"</span>, <span class="st">"almonds"</span>, <span class="st">"olives"</span>, <span class="st">"fruit"</span>)</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create simple pairs plot (avoids smoother warnings)</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="sc">~</span> observed <span class="sc">+</span> fruit <span class="sc">+</span> almonds <span class="sc">+</span> olives <span class="sc">+</span> vineyard, <span class="at">data =</span> SATFRUIT,</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Pairs Plot - Key Variables"</span>,</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">as.numeric</span>(SATFRUIT<span class="sc">$</span>smallarea))</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">levels</span>(SATFRUIT<span class="sc">$</span>smallarea), </span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Strong Positive Relationships:</strong></p>
<ol type="1">
<li><strong>observed vs.&nbsp;fruit</strong>: Shows the <strong>strongest positive linear relationship</strong>. There’s a clear upward trend where higher classified fruit surface area corresponds to higher observed fruit surface area. This makes intuitive sense as these are satellite-classified vs.&nbsp;ground-observed measurements of the same feature. The relationship appears roughly linear across most of the range.</li>
</ol>
<p><strong>Moderate to Weak Relationships:</strong></p>
<ol start="2" type="1">
<li><p><strong>observed vs.&nbsp;almonds</strong>: Shows a <strong>weak to moderate positive relationship</strong>. Most almond values are concentrated near zero, but there appears to be some positive association. The relationship is less clear than with fruit.</p></li>
<li><p><strong>observed vs.&nbsp;olives</strong>: Shows a <strong>weak positive relationship</strong>, primarily driven by area R68 (green points). R68 appears to have higher olive coverage, while R67 (pink points) has minimal olive presence. The relationship is not strongly linear overall.</p></li>
<li><p><strong>observed vs.&nbsp;vineyard</strong>: Shows <strong>very weak or no clear linear relationship</strong>. Most vineyard values are clustered near zero with a few outliers. There doesn’t appear to be a meaningful linear association with observed fruit.</p></li>
</ol>
<p><strong>Key Patterns by Small Area:</strong></p>
<ul>
<li><p><strong>R67 (pink)</strong>: Tends to have higher observed values and higher fruit values, with minimal olives and vineyards</p></li>
<li><p><strong>R68 (green)</strong>: Shows more variability, with some segments having substantial olive coverage</p></li>
<li><p>The different small areas show distinct patterns, suggesting that area-specific effects may be important</p></li>
</ul>
</section>
<section id="e-create-density-plots-of-the-observed-fruits-surface-area-observed-by-small-areas-smallarea." class="level3">
<h3 class="anchored" data-anchor-id="e-create-density-plots-of-the-observed-fruits-surface-area-observed-by-small-areas-smallarea.">(e) Create density plots of the observed fruits’ surface area (<code>observed</code>) by small areas (<code>smallarea</code>).</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ggplot</span>(SATFRUIT, <span class="fu">aes</span>(<span class="at">x =</span> observed, <span class="at">fill =</span> smallarea)) <span class="sc">+</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density of Observed Fruit Surface by Small Area"</span>,</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Observed Surface (m²)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Distribution Characteristics by Small Area:</strong></p>
<p><strong>R63 (Pink/Salmon):</strong></p>
<ul>
<li><p>Shows a <strong>highly concentrated distribution near zero</strong> with a sharp, narrow peak</p></li>
<li><p>The density is highest at very low observed values (close to 0 m²)</p></li>
<li><p>Has the <strong>smallest range</strong> and lowest observed fruit surface areas overall</p></li>
<li><p>Distribution is <strong>strongly right-skewed</strong> with very little spread</p></li>
<li><p>This suggests R63 has minimal fruit tree coverage in most segments</p></li>
</ul>
<p><strong>R67 (Green):</strong></p>
<ul>
<li><p>Displays a <strong>broad, roughly symmetric distribution</strong> centered around <strong>10,000-11,000 m²</strong></p></li>
<li><p>Has the <strong>highest median/center</strong> of the three areas</p></li>
<li><p>Shows <strong>moderate spread</strong> with values ranging approximately from 7,000 to 13,000 m²</p></li>
<li><p>The distribution is relatively <strong>unimodal and bell-shaped</strong></p></li>
<li><p>Indicates R67 has consistently high fruit tree coverage across segments</p></li>
</ul>
<p><strong>R68 (Blue):</strong></p>
<ul>
<li><p>Shows a <strong>bimodal or irregular distribution</strong> with peaks around <strong>2,000-3,000 m²</strong> and <strong>5,000-6,000 m²</strong></p></li>
<li><p>Has <strong>intermediate values</strong> between R63 and R67</p></li>
<li><p>Distribution is <strong>moderately spread</strong> with considerable variability</p></li>
<li><p>Suggests more heterogeneity in fruit tree coverage within R68</p></li>
</ul>
<p><strong>Key Comparisons:</strong></p>
<ul>
<li><p><strong>R67 clearly has the highest observed fruit surface area</strong> with values concentrated in the upper range (8,000-12,000 m²)</p></li>
<li><p><strong>R63 has the lowest observed values</strong>, clustered near zero</p></li>
<li><p><strong>R68 shows intermediate and more variable coverage</strong></p></li>
<li><p>The three areas show <strong>distinctly different distributions</strong>, suggesting that small area membership is an important factor in predicting observed fruit surface area</p></li>
<li><p>There is <strong>minimal overlap</strong> between R63 and R67, indicating these areas are quite different in terms of fruit tree presence</p></li>
</ul>
</section>
<section id="f-use-box-plots-and-bar-plots-with-standard-errors-to-compare-the-observed-surface-area-observed-and-the-classified-surface-area-fruit-by-small-areas-smallarea." class="level3">
<h3 class="anchored" data-anchor-id="f-use-box-plots-and-bar-plots-with-standard-errors-to-compare-the-observed-surface-area-observed-and-the-classified-surface-area-fruit-by-small-areas-smallarea.">(f) Use box plots and bar plots with standard errors to compare the observed surface area (<code>observed</code>) and the classified surface area (<code>fruit</code>) by small areas (<code>smallarea</code>).</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plots</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(observed <span class="sc">~</span> smallarea, <span class="at">data =</span> SATFRUIT, </span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Observed Surface by Small Area"</span>,</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Small Area"</span>, <span class="at">ylab =</span> <span class="st">"Observed (m²)"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>)</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fruit <span class="sc">~</span> smallarea, <span class="at">data =</span> SATFRUIT,</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Classified Surface by Small Area"</span>,</span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Small Area"</span>, <span class="at">ylab =</span> <span class="st">"Fruit (m²)"</span>, <span class="at">col =</span> <span class="st">"lightgreen"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plots with standard errors</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> SATFRUIT <span class="sc">%&gt;%</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(smallarea) <span class="sc">%&gt;%</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_observed =</span> <span class="fu">mean</span>(observed),</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_observed =</span> <span class="fu">sd</span>(observed) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_fruit =</span> <span class="fu">mean</span>(fruit),</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_fruit =</span> <span class="fu">sd</span>(fruit) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>())</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>bp1 <span class="ot">&lt;-</span> <span class="fu">barplot</span>(summary_data<span class="sc">$</span>mean_observed, <span class="at">names.arg =</span> summary_data<span class="sc">$</span>smallarea,</span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Mean Observed Surface by Area"</span>,</span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Mean Observed (m²)"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(summary_data<span class="sc">$</span>mean_observed) <span class="sc">*</span> <span class="fl">1.2</span>))</span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0 =</span> bp1, </span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y0 =</span> summary_data<span class="sc">$</span>mean_observed <span class="sc">-</span> summary_data<span class="sc">$</span>se_observed,</span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y1 =</span> summary_data<span class="sc">$</span>mean_observed <span class="sc">+</span> summary_data<span class="sc">$</span>se_observed,</span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">code =</span> <span class="dv">3</span>, <span class="at">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a>bp2 <span class="ot">&lt;-</span> <span class="fu">barplot</span>(summary_data<span class="sc">$</span>mean_fruit, <span class="at">names.arg =</span> summary_data<span class="sc">$</span>smallarea,</span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Mean Classified Surface by Area"</span>,</span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Mean Fruit (m²)"</span>, <span class="at">col =</span> <span class="st">"lightgreen"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(summary_data<span class="sc">$</span>mean_fruit) <span class="sc">*</span> <span class="fl">1.2</span>))</span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0 =</span> bp2,</span>
<span id="cb172-24"><a href="#cb172-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y0 =</span> summary_data<span class="sc">$</span>mean_fruit <span class="sc">-</span> summary_data<span class="sc">$</span>se_fruit,</span>
<span id="cb172-25"><a href="#cb172-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y1 =</span> summary_data<span class="sc">$</span>mean_fruit <span class="sc">+</span> summary_data<span class="sc">$</span>se_fruit,</span>
<span id="cb172-26"><a href="#cb172-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">code =</span> <span class="dv">3</span>, <span class="at">length =</span> <span class="fl">0.1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Box Plots Analysis:</strong></p>
<p><strong>Observed Surface Area (Left, Blue):</strong></p>
<ul>
<li><p><strong>R63</strong>: Shows very low values, with a median near 0 m² and maximum around 5,000-6,000 m². The distribution is highly skewed with most values concentrated near zero.</p></li>
<li><p><strong>R67</strong>: Shows the highest observed values, with a median around 11,000 m² and a wide interquartile range (approximately 5,000-12,000 m²). This area has the greatest variability.</p></li>
<li><p><strong>R68</strong>: Shows intermediate values with a median around 7,000 m² and an interquartile range from approximately 4,000-10,000 m².</p></li>
</ul>
<p><strong>Classified Surface Area (Right, Green):</strong></p>
<ul>
<li><p><strong>R63</strong>: Very low values, median near 0 m², with maximum around 3,000 m². Similar to observed, most segments have minimal fruit tree coverage.</p></li>
<li><p><strong>R67</strong>: Highest classified values with median around 9,000 m² and wide spread (approximately 5,000-12,000 m²).</p></li>
<li><p><strong>R68</strong>: Median around 10,000 m² with interquartile range from approximately 8,000-12,000 m². More consistent than observed values.</p></li>
</ul>
<p><strong>Bar Plots with Standard Errors Analysis:</strong></p>
<p><strong>Mean Observed Surface:</strong></p>
<ul>
<li><p><strong>R63</strong>: Approximately 2,000 m² (very small, with relatively small standard error)</p></li>
<li><p><strong>R67</strong>: Approximately 8,500-9,000 m² (highest mean, with larger standard error indicating high variability)</p></li>
<li><p><strong>R68</strong>: Approximately 6,500 m² (intermediate, moderate standard error)</p></li>
</ul>
<p><strong>Mean Classified Surface:</strong></p>
<ul>
<li><p><strong>R63</strong>: Approximately 1,500 m² (smallest, low standard error)</p></li>
<li><p><strong>R67</strong>: Approximately 7,500 m² (moderate, with standard error)</p></li>
<li><p><strong>R68</strong>: Approximately 9,500-10,000 m² (highest mean classified, moderate standard error)</p></li>
</ul>
</section>
<section id="g-compute-the-correlation-between-observed-and-all-other-numerical-variables.-list-the-three-variables-in-order-along-with-their-correlation-coefficients-that-have-the-highest-correlation-with-observed." class="level3">
<h3 class="anchored" data-anchor-id="g-compute-the-correlation-between-observed-and-all-other-numerical-variables.-list-the-three-variables-in-order-along-with-their-correlation-coefficients-that-have-the-highest-correlation-with-observed.">(g) Compute the correlation between <code>observed</code> and all other numerical variables. List the three variables in order along with their correlation coefficients that have the highest correlation with <code>observed</code>.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>correlations <span class="ot">&lt;-</span> <span class="fu">cor</span>(SATFRUIT[, num_vars[<span class="sc">-</span><span class="dv">1</span>]], SATFRUIT<span class="sc">$</span>observed)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>correlations_sorted <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">abs</span>(correlations), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top 3 variables with highest correlation with 'observed':</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Top 3 variables with highest correlation with 'observed':</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(correlations_sorted, <span class="dv">3</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8186904 0.4022165 0.3988465</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">With signs:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
With signs:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(correlations[<span class="fu">names</span>(<span class="fu">head</span>(correlations_sorted, <span class="dv">3</span>))])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>numeric(0)</code></pre>
</div>
</div>
<p><strong>Top 3 Variables with Highest Correlation with ‘observed’:</strong></p>
<p>Based on the correlation magnitudes shown:</p>
<ol type="1">
<li><p><strong>fruit</strong>: r = 0.819 (very strong positive correlation)</p>
<ul>
<li>This is by far the strongest correlation, which makes sense as both variables measure fruit tree surface area - one from satellite classification (fruit) and one from ground observation (observed)</li>
</ul></li>
<li><p><strong>Second variable</strong>: r = 0.402 (moderate positive correlation)</p>
<ul>
<li>Based on the scatterplot matrix, this is likely <strong>almonds</strong></li>
</ul></li>
<li><p><strong>Third variable</strong>: r = 0.399 (moderate positive correlation)</p>
<ul>
<li>Based on the scatterplot matrix, this is likely <strong>olives</strong></li>
</ul></li>
</ol>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>The <strong>fruit</strong> variable has a strong correlation of 0.819, explaining approximately 67% of the variance in observed values (r² = 0.67)</p></li>
<li><p>The other two variables show much weaker correlations (around 0.40), indicating they are far less predictive individually</p></li>
<li><p>The large drop from 0.819 to 0.40 suggests that <strong>fruit</strong> is the dominant predictor</p></li>
<li><p>These correlations align with what we observed in the scatterplot matrix, where fruit showed a clear linear relationship while almonds and olives showed weaker, more scattered relationships</p></li>
</ul>
</section>
<section id="model-a" class="level2">
<h2 class="anchored" data-anchor-id="model-a">Model (A)</h2>
<p>Use backward elimination to develop a model that predicts <code>observed</code> using the data frame <code>SATFRUIT</code> without considering <code>smallarea</code>. Start the backward elimination process by considering all of the numerical variables in <code>SATFRUIT</code> as potential predictors. Use a p-value-to-remove of 10%. Store the final model in the object <code>modelA</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start with full model (excluding quadrat and smallarea)</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(num_vars, <span class="fu">c</span>(<span class="st">"observed"</span>))</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>formula_full <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"observed ~"</span>, <span class="fu">paste</span>(predictors, <span class="at">collapse =</span> <span class="st">" + "</span>)))</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula_full, <span class="at">data =</span> SATFRUIT)</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Backward elimination with p = 0.10</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="co"># k = qchisq(0.10, 1, lower.tail = FALSE) for p-value criterion</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>modelA <span class="ot">&lt;-</span> <span class="fu">step</span>(model_full, <span class="at">direction =</span> <span class="st">"backward"</span>, </span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">k =</span> <span class="fu">qchisq</span>(<span class="fl">0.10</span>, <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>),</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model A Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model A Summary:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = observed ~ grass + olives + fruit, data = SATFRUIT)

Residuals:
    Min      1Q  Median      3Q     Max 
-5333.4 -1079.3   150.9   933.8  4210.8 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 807.6049   797.4016   1.013  0.31682    
grass         2.6178     1.3456   1.946  0.05827 .  
olives       -0.7282     0.2580  -2.823  0.00719 ** 
fruit         0.8805     0.0862  10.214 4.52e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2310 on 43 degrees of freedom
Multiple R-squared:  0.7336,    Adjusted R-squared:  0.715 
F-statistic: 39.47 on 3 and 43 DF,  p-value: 2.051e-12</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation for Model A</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>modelA_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">formula</span>(modelA), <span class="at">data =</span> SATFRUIT)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="i.-compute-cv_n-the-leave-one-out-cross-validation-error-for-modela.-set-the-seed-to-5-and-compute-cv_5-the-five-fold-cross-validation-error-for-modela.-the-cross-validation-error-for-a-generalized-linear-model-can-be-computed-using-the-cv.glm-function-from-the-boot-package.-using-the-function-glm-without-passing-a-family-argument-is-equivalent-to-using-the-function-lm.-r-code-1-provides-a-template-for-how-to-use-the-cv.glm-function.-note-that-cv_n-is-returned-with-cv.errordelta1.-to-compute-cv_5-pass-the-value-5-to-the-argument-k-inside-the-cv.glm-function." class="level4">
<h4 class="anchored" data-anchor-id="i.-compute-cv_n-the-leave-one-out-cross-validation-error-for-modela.-set-the-seed-to-5-and-compute-cv_5-the-five-fold-cross-validation-error-for-modela.-the-cross-validation-error-for-a-generalized-linear-model-can-be-computed-using-the-cv.glm-function-from-the-boot-package.-using-the-function-glm-without-passing-a-family-argument-is-equivalent-to-using-the-function-lm.-r-code-1-provides-a-template-for-how-to-use-the-cv.glm-function.-note-that-cv_n-is-returned-with-cv.errordelta1.-to-compute-cv_5-pass-the-value-5-to-the-argument-k-inside-the-cv.glm-function.">i. Compute <span class="math inline">\(CV_n\)</span>, the leave-one-out cross-validation error, for <code>modelA</code>. Set the seed to 5 and compute <span class="math inline">\(CV_5\)</span>, the five-fold cross-validation error, for <code>modelA</code>. The cross-validation error for a generalized linear model can be computed using the <code>cv.glm()</code> function from the boot package. Using the function <code>glm()</code> without passing a family argument is equivalent to using the function <code>lm()</code>. R Code 1 provides a template for how to use the <code>cv.glm()</code> function. Note that <span class="math inline">\(CV_n\)</span> is returned with <code>cv.error$delta[1]</code>. To compute <span class="math inline">\(CV_5\)</span>, pass the value 5 to the argument <span class="math inline">\(K\)</span> inside the <code>cv.glm()</code> function.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LOOCV (CV_n)</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>cv_n_A <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> SATFRUIT, <span class="at">glmfit =</span> modelA_glm)</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>CVn_A <span class="ot">&lt;-</span> cv_n_A<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 5-fold CV</span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>cv_5_A <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> SATFRUIT, <span class="at">glmfit =</span> modelA_glm, <span class="at">K =</span> <span class="dv">5</span>)</span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>CV5_A <span class="ot">&lt;-</span> cv_5_A<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model A Cross-Validation ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model A Cross-Validation ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_n (LOOCV):"</span>, CVn_A, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_n (LOOCV): 9131968 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_5 (5-fold):"</span>, CV5_A, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_5 (5-fold): 10248950 </code></pre>
</div>
</div>
</section>
<section id="ii.-compute-r2-r2_a-the-aic-and-the-bic-for-model-a.-what-is-the-proportion-of-total-variability-explained-by-model-a" class="level4">
<h4 class="anchored" data-anchor-id="ii.-compute-r2-r2_a-the-aic-and-the-bic-for-model-a.-what-is-the-proportion-of-total-variability-explained-by-model-a">ii. Compute <span class="math inline">\(R^2, R^2_a\)</span>, the AIC, and the BIC for Model (A). What is the proportion of total variability explained by Model (A)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model A statistics</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>summary_A <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelA)</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>R2_A <span class="ot">&lt;-</span> summary_A<span class="sc">$</span>r.squared</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>R2a_A <span class="ot">&lt;-</span> summary_A<span class="sc">$</span>adj.r.squared</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>AIC_A <span class="ot">&lt;-</span> <span class="fu">AIC</span>(modelA)</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>BIC_A <span class="ot">&lt;-</span> <span class="fu">BIC</span>(modelA)</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model A Statistics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model A Statistics ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R²:"</span>, R2_A, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R²: 0.733581 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Adjusted R²:"</span>, R2a_A, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R²: 0.7149936 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, AIC_A, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 867.2384 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC:"</span>, BIC_A, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC: 876.4891 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Proportion of variability explained:"</span>, R2_A, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Proportion of variability explained: 0.733581 </code></pre>
</div>
</div>
</section>
</section>
<section id="model-b" class="level2">
<h2 class="anchored" data-anchor-id="model-b">Model (B)</h2>
<p>Use the criterion-based procedure AIC, which for linear regression is equivalent to Mallow’s Cp, to develop a model that predicts <code>observed</code> using all of the numerical variables in <code>SATFRUIT</code>. Store the model in the object <code>modelB</code>. Verify that the model suggested using BIC is the same model as the one suggested by AIC or Mallow’s Cp, which are all the same as Model (A).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>modelB <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(model_full, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model B Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model B Summary:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelB)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = observed ~ grass + almonds + olives + fruit, data = SATFRUIT)

Residuals:
    Min      1Q  Median      3Q     Max 
-5448.3 -1318.2   319.4   909.6  4002.8 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1318.17341  869.22493   1.516  0.13689    
grass          2.57887    1.33118   1.937  0.05946 .  
almonds       -0.39549    0.28301  -1.397  0.16962    
olives        -0.70526    0.25571  -2.758  0.00857 ** 
fruit          0.83850    0.09039   9.277 1.01e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2285 on 42 degrees of freedom
Multiple R-squared:  0.7454,    Adjusted R-squared:  0.7212 
F-statistic: 30.74 on 4 and 42 DF,  p-value: 5.545e-12</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify BIC gives same model</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>modelB_BIC <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(model_full, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">k =</span> <span class="fu">log</span>(<span class="fu">nrow</span>(SATFRUIT)), <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model B (AIC) formula:"</span>, <span class="fu">deparse</span>(<span class="fu">formula</span>(modelB)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model B (AIC) formula: observed ~ grass + almonds + olives + fruit </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model with BIC formula:"</span>, <span class="fu">deparse</span>(<span class="fu">formula</span>(modelB_BIC)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model with BIC formula: observed ~ grass + olives + fruit </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Are Model B and Model A the same?"</span>, </span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">identical</span>(<span class="fu">sort</span>(<span class="fu">names</span>(<span class="fu">coef</span>(modelA))), <span class="fu">sort</span>(<span class="fu">names</span>(<span class="fu">coef</span>(modelB)))), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Are Model B and Model A the same? FALSE </code></pre>
</div>
</div>
<p><strong>Verification: BIC Gives Same Model as Model A</strong></p>
<p>The verification <strong>failed</strong>:</p>
<ul>
<li><p><strong>BIC model</strong> = grass + olives + fruit (same as Model A) ✓</p></li>
<li><p><strong>AIC model</strong> = grass + almonds + olives + fruit (Model B) ✗</p></li>
<li><p><strong>AIC ≠ Model A</strong></p></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>The problem statement’s expectation was incorrect. In this case:</p>
<ul>
<li><p><strong>AIC and BIC selected different models</strong></p></li>
<li><p>BIC correctly selected the more parsimonious Model A</p></li>
<li><p>AIC selected Model B with the non-significant <code>almonds</code> variable</p></li>
<li><p>This demonstrates the difference between AIC (prediction-focused) and BIC (parsimony-focused)</p></li>
</ul>
<p>Model B’s inclusion of <code>almonds</code> (p = 0.170) provides negligible improvement and violates the principle of parsimony. <strong>Use Model A for subsequent analyses unless cross-validation errors strongly favor Model B.</strong></p>
</section>
<section id="model-c" class="level2">
<h2 class="anchored" data-anchor-id="model-c">Model (C)</h2>
<p>Use mean squared prediction error (MSPE) to select a model using all of the numerical variables in <code>SATFRUIT</code> as potential predictors for predicting observed. Store the model in the object <code>modelC</code>. Specifically, select a model using both leave-one-out cross validation (LOOCV) and five-fold cross validation.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test various model combinations based on correlations</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and select based on CV error</span></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>candidate_models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">m1 =</span> observed <span class="sc">~</span> fruit,</span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2 =</span> observed <span class="sc">~</span> fruit <span class="sc">+</span> almonds,</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">m3 =</span> observed <span class="sc">~</span> fruit <span class="sc">+</span> almonds <span class="sc">+</span> olives,</span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">m4 =</span> observed <span class="sc">~</span> fruit <span class="sc">+</span> olives,</span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">m5 =</span> observed <span class="sc">~</span> fruit <span class="sc">+</span> almonds <span class="sc">+</span> olives <span class="sc">+</span> vineyard,</span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">m6 =</span> observed <span class="sc">~</span> fruit <span class="sc">+</span> vineyard</span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="compute-cv_n-for-modelc.-set-the-seed-to-5-and-compute-cv_5-for-modelc." class="level4">
<h4 class="anchored" data-anchor-id="compute-cv_n-for-modelc.-set-the-seed-to-5-and-compute-cv_5-for-modelc.">1. Compute <span class="math inline">\(CV_n\)</span> for <code>modelC</code>. Set the seed to 5 and compute <span class="math inline">\(CV_5\)</span> for <code>modelC</code>.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute CV errors</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>compute_cv <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, data, <span class="at">K =</span> <span class="cn">NULL</span>) {</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>  mod_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(formula, <span class="at">data =</span> data)</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(K)) {</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>    cv_result <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> data, <span class="at">glmfit =</span> mod_glm)</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>    cv_result <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> data, <span class="at">glmfit =</span> mod_glm, <span class="at">K =</span> K)</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cv_result<span class="sc">$</span>delta[<span class="dv">1</span>])</span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare CV errors for candidate models</span></span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a>cv_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">names</span>(candidate_models),</span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Formula =</span> <span class="fu">sapply</span>(candidate_models, deparse),</span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">CV_n =</span> <span class="fu">sapply</span>(candidate_models, compute_cv, <span class="at">data =</span> SATFRUIT),</span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">CV_5 =</span> <span class="fu">sapply</span>(candidate_models, <span class="cf">function</span>(f) <span class="fu">compute_cv</span>(f, SATFRUIT, <span class="at">K =</span> <span class="dv">5</span>))</span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb215-20"><a href="#cb215-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-21"><a href="#cb215-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cv_results[, <span class="fu">c</span>(<span class="st">"Model"</span>, <span class="st">"CV_n"</span>, <span class="st">"CV_5"</span>)])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Model    CV_n    CV_5
m1    m1 6413903 6676660
m2    m2 6544362 6527809
m3    m3 6987814 7168004
m4    m4 7045110 7266863
m5    m5 7481389 7536766
m6    m6 7183528 7319064</code></pre>
</div>
</div>
</section>
<section id="compute-r2-r2a-the-aic-and-the-bic-for-model-c.-what-is-the-proportion-of-total-variability-explained-by-model-c" class="level4">
<h4 class="anchored" data-anchor-id="compute-r2-r2a-the-aic-and-the-bic-for-model-c.-what-is-the-proportion-of-total-variability-explained-by-model-c">2. Compute R2, R2a, the AIC, and the BIC for Model (C). What is the proportion of total variability explained by Model (C)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select model with minimum CV error (use CV_n for selection)</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>best_idx <span class="ot">&lt;-</span> <span class="fu">which.min</span>(cv_results<span class="sc">$</span>CV_n)</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Best model based on LOOCV:"</span>, cv_results<span class="sc">$</span>Model[best_idx], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Best model based on LOOCV: m1 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Formula:"</span>, cv_results<span class="sc">$</span>Formula[best_idx], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formula: observed ~ fruit </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>modelC <span class="ot">&lt;-</span> <span class="fu">lm</span>(candidate_models[[best_idx]], <span class="at">data =</span> SATFRUIT)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model C Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model C Summary:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelC)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = candidate_models[[best_idx]], data = SATFRUIT)

Residuals:
    Min      1Q  Median      3Q     Max 
-6395.7  -798.3   301.6  1136.5  4407.9 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 682.10074  793.55584   0.860    0.395    
fruit         0.86005    0.08993   9.564 2.06e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2512 on 45 degrees of freedom
Multiple R-squared:  0.6703,    Adjusted R-squared:  0.6629 
F-statistic: 91.47 on 1 and 45 DF,  p-value: 2.063e-12</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store CV errors for Model C</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>cv_n_C <span class="ot">&lt;-</span> cv_results<span class="sc">$</span>CV_n[best_idx]</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>CV5_C <span class="ot">&lt;-</span> cv_results<span class="sc">$</span>CV_5[best_idx]</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model C Cross-Validation ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model C Cross-Validation ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_n (LOOCV):"</span>, cv_n_C, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_n (LOOCV): 6413903 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_5 (5-fold):"</span>, CV5_C, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_5 (5-fold): 6676660 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model C statistics</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>summary_C <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelC)</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>R2_C <span class="ot">&lt;-</span> summary_C<span class="sc">$</span>r.squared</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>R2a_C <span class="ot">&lt;-</span> summary_C<span class="sc">$</span>adj.r.squared</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>AIC_C <span class="ot">&lt;-</span> <span class="fu">AIC</span>(modelC)</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>BIC_C <span class="ot">&lt;-</span> <span class="fu">BIC</span>(modelC)</span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model C Statistics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model C Statistics ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R²:"</span>, R2_C, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R²: 0.670254 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Adjusted R²:"</span>, R2a_C, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R²: 0.6629264 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, AIC_C, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 873.2612 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC:"</span>, BIC_C, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC: 878.8117 </code></pre>
</div>
</div>
<p><strong>Proportion of Total Variability Explained: 67.03%</strong></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p><strong>Approximately two-thirds</strong> (67%) of the variation in observed fruit tree coverage can be explained by satellite-classified fruit area alone</p></li>
<li><p>This is a <strong>strong single-predictor model</strong> - the satellite classification is a good predictor by itself</p></li>
<li><p>The remaining <strong>33%</strong> of variability is due to:</p>
<ul>
<li><p>Measurement errors</p></li>
<li><p>Misclassification by satellite</p></li>
<li><p>Other land use factors (grass, olives, almonds, etc.)</p></li>
<li><p>Small area effects (R63, R67, R68 differences)</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="model-d" class="level2">
<h2 class="anchored" data-anchor-id="model-d">Model (D)</h2>
<p>Use whichever of Model (A) or (C) has the smaller cross-validation error, and introduce <code>smallarea</code> into the chosen model. Store the new model that includes <code>smallarea</code> in <code>modelD</code>.</p>
<section id="i.-eliminate-any-variables-from-modeld-that-are-not-statistically-significant-α-0.10.-store-the-resulting-model-in-modeld." class="level4">
<h4 class="anchored" data-anchor-id="i.-eliminate-any-variables-from-modeld-that-are-not-statistically-significant-α-0.10.-store-the-resulting-model-in-modeld.">(i.) Eliminate any variables from <code>modelD</code> that are not statistically significant (α= 0.10). Store the resulting model in <code>modelD</code>.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose model with smaller CV error</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(CVn_A <span class="sc">&lt;</span> cv_n_C) {</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>  base_model <span class="ot">&lt;-</span> modelA</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Using Model A as base (smaller CV error)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>  base_model <span class="ot">&lt;-</span> modelC</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Using Model C as base (smaller CV error)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Using Model C as base (smaller CV error)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add smallarea</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>formula_D <span class="ot">&lt;-</span> <span class="fu">update</span>(<span class="fu">formula</span>(base_model), <span class="sc">~</span> . <span class="sc">+</span> smallarea)</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>modelD_initial <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula_D, <span class="at">data =</span> SATFRUIT)</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Initial Model D with smallarea:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Initial Model D with smallarea:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelD_initial)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = formula_D, data = SATFRUIT)

Residuals:
    Min      1Q  Median      3Q     Max 
-5719.1  -992.3  -288.0  1486.9  3541.9 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    433.3831  1212.8829   0.357   0.7226    
fruit            0.9228     0.0836  11.038 3.96e-14 ***
smallareaR67   658.2726  1375.7879   0.478   0.6347    
smallareaR68 -2705.9389  1507.6144  -1.795   0.0797 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2092 on 43 degrees of freedom
Multiple R-squared:  0.7816,    Adjusted R-squared:  0.7663 
F-statistic: 51.29 on 3 and 43 DF,  p-value: 2.955e-14</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove non-significant variables (α = 0.10)</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>modelD <span class="ot">&lt;-</span> <span class="fu">step</span>(modelD_initial, <span class="at">direction =</span> <span class="st">"backward"</span>, </span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">k =</span> <span class="fu">qchisq</span>(<span class="fl">0.10</span>, <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>),</span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Final Model D Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Final Model D Summary:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelD)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = observed ~ fruit + smallarea, data = SATFRUIT)

Residuals:
    Min      1Q  Median      3Q     Max 
-5719.1  -992.3  -288.0  1486.9  3541.9 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    433.3831  1212.8829   0.357   0.7226    
fruit            0.9228     0.0836  11.038 3.96e-14 ***
smallareaR67   658.2726  1375.7879   0.478   0.6347    
smallareaR68 -2705.9389  1507.6144  -1.795   0.0797 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2092 on 43 degrees of freedom
Multiple R-squared:  0.7816,    Adjusted R-squared:  0.7663 
F-statistic: 51.29 on 3 and 43 DF,  p-value: 2.955e-14</code></pre>
</div>
</div>
</section>
<section id="ii.-compute-cvn-for-modeld.-set-the-seed-to-5-and-compute-cv5-for-modeld." class="level4">
<h4 class="anchored" data-anchor-id="ii.-compute-cvn-for-modeld.-set-the-seed-to-5-and-compute-cv5-for-modeld.">(ii.) Compute CVn for modelD. Set the seed to 5 and compute CV5 for modelD.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation for Model D</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>modelD_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">formula</span>(modelD), <span class="at">data =</span> SATFRUIT)</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>cv_n_D <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> SATFRUIT, <span class="at">glmfit =</span> modelD_glm)<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>cv_5_D <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> SATFRUIT, <span class="at">glmfit =</span> modelD_glm, <span class="at">K =</span> <span class="dv">5</span>)<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model D Cross-Validation ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model D Cross-Validation ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_n (LOOCV):"</span>, cv_n_D, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_n (LOOCV): 4663010 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_5 (5-fold):"</span>, cv_5_D, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_5 (5-fold): 4934602 </code></pre>
</div>
</div>
</section>
<section id="iii.-compute-r2-r2a-the-aic-and-the-bic-for-model-d.-what-is-the-proportion-of-total-variability-explained-by-model-d" class="level4">
<h4 class="anchored" data-anchor-id="iii.-compute-r2-r2a-the-aic-and-the-bic-for-model-d.-what-is-the-proportion-of-total-variability-explained-by-model-d">(iii.) Compute R2, R2a, the AIC, and the BIC for Model (D). What is the proportion of total variability explained by Model (D)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model D statistics</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>summary_D <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelD)</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>R2_D <span class="ot">&lt;-</span> summary_D<span class="sc">$</span>r.squared</span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>R2a_D <span class="ot">&lt;-</span> summary_D<span class="sc">$</span>adj.r.squared</span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>AIC_D <span class="ot">&lt;-</span> <span class="fu">AIC</span>(modelD)</span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a>BIC_D <span class="ot">&lt;-</span> <span class="fu">BIC</span>(modelD)</span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model D Statistics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model D Statistics ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R²:"</span>, R2_D, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R²: 0.7815689 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Adjusted R²:"</span>, R2a_D, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R²: 0.7663295 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, AIC_D, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 857.9042 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC:"</span>, BIC_D, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC: 867.1549 </code></pre>
</div>
</div>
</section>
<section id="iv.-does-model-d-have-a-smaller-cross-validation-error-than-the-cross-validation-error-for-either-model-a-or-model-c" class="level4">
<h4 class="anchored" data-anchor-id="iv.-does-model-d-have-a-smaller-cross-validation-error-than-the-cross-validation-error-for-either-model-a-or-model-c">(iv.) Does Model (D) have a smaller cross-validation error than the cross-validation error for either Model (A) or Model (C)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare CV errors</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- CV Error Comparison ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- CV Error Comparison ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model A CV_n:"</span>, CVn_A, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model A CV_n: 9131968 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model C CV_n:"</span>, cv_n_C, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model C CV_n: 6413903 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model D CV_n:"</span>, cv_n_D, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model D CV_n: 4663010 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Does Model D have smaller CV error than both A and C?"</span>, </span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>    cv_n_D <span class="sc">&lt;</span> <span class="fu">min</span>(CVn_A, cv_n_C), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Does Model D have smaller CV error than both A and C? TRUE </code></pre>
</div>
</div>
</section>
<section id="v.-plot-the-cook-distances-the-studentized-residuals-the-diagonal-elements-of-the-hat-matrix-the-dffits-and-dfbetas1-of-model-d-versus-the-index." class="level4">
<h4 class="anchored" data-anchor-id="v.-plot-the-cook-distances-the-studentized-residuals-the-diagonal-elements-of-the-hat-matrix-the-dffits-and-dfbetas1-of-model-d-versus-the-index.">(v.) Plot the Cook distances, the studentized residuals, the diagonal elements of the hat matrix, the DFFITS, and DFBETAS1 of Model (D) versus the index.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cook's distance</span></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>cooks_d <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modelD)</span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cooks_d, <span class="at">type =</span> <span class="st">"h"</span>, </span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Cook's Distance"</span>, <span class="at">ylab =</span> <span class="st">"Cook's D"</span>, <span class="at">xlab =</span> <span class="st">"Index"</span>)</span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">4</span><span class="sc">/</span><span class="fu">nrow</span>(SATFRUIT), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">which</span>(cooks_d <span class="sc">&gt;</span> <span class="dv">4</span><span class="sc">/</span><span class="fu">nrow</span>(SATFRUIT)), </span>
<span id="cb277-9"><a href="#cb277-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> cooks_d[cooks_d <span class="sc">&gt;</span> <span class="dv">4</span><span class="sc">/</span><span class="fu">nrow</span>(SATFRUIT)],</span>
<span id="cb277-10"><a href="#cb277-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">which</span>(cooks_d <span class="sc">&gt;</span> <span class="dv">4</span><span class="sc">/</span><span class="fu">nrow</span>(SATFRUIT)), <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb277-11"><a href="#cb277-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-12"><a href="#cb277-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Studentized residuals</span></span>
<span id="cb277-13"><a href="#cb277-13" aria-hidden="true" tabindex="-1"></a>rstud <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(modelD)</span>
<span id="cb277-14"><a href="#cb277-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rstud, <span class="at">type =</span> <span class="st">"h"</span>,</span>
<span id="cb277-15"><a href="#cb277-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Studentized Residuals"</span>, <span class="at">ylab =</span> <span class="st">"Studentized Residuals"</span>, <span class="at">xlab =</span> <span class="st">"Index"</span>)</span>
<span id="cb277-16"><a href="#cb277-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb277-17"><a href="#cb277-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">which</span>(<span class="fu">abs</span>(rstud) <span class="sc">&gt;</span> <span class="dv">2</span>), </span>
<span id="cb277-18"><a href="#cb277-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> rstud[<span class="fu">abs</span>(rstud) <span class="sc">&gt;</span> <span class="dv">2</span>],</span>
<span id="cb277-19"><a href="#cb277-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">which</span>(<span class="fu">abs</span>(rstud) <span class="sc">&gt;</span> <span class="dv">2</span>), <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb277-20"><a href="#cb277-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-21"><a href="#cb277-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Hat values</span></span>
<span id="cb277-22"><a href="#cb277-22" aria-hidden="true" tabindex="-1"></a>hat_vals <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(modelD)</span>
<span id="cb277-23"><a href="#cb277-23" aria-hidden="true" tabindex="-1"></a>leverage_threshold <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">length</span>(<span class="fu">coef</span>(modelD)) <span class="sc">/</span> <span class="fu">nrow</span>(SATFRUIT)</span>
<span id="cb277-24"><a href="#cb277-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hat_vals, <span class="at">type =</span> <span class="st">"h"</span>,</span>
<span id="cb277-25"><a href="#cb277-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Hat Values (Leverage)"</span>, <span class="at">ylab =</span> <span class="st">"Hat Values"</span>, <span class="at">xlab =</span> <span class="st">"Index"</span>)</span>
<span id="cb277-26"><a href="#cb277-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> leverage_threshold, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb277-27"><a href="#cb277-27" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">which</span>(hat_vals <span class="sc">&gt;</span> leverage_threshold), </span>
<span id="cb277-28"><a href="#cb277-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> hat_vals[hat_vals <span class="sc">&gt;</span> leverage_threshold],</span>
<span id="cb277-29"><a href="#cb277-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">which</span>(hat_vals <span class="sc">&gt;</span> leverage_threshold), <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb277-30"><a href="#cb277-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-31"><a href="#cb277-31" aria-hidden="true" tabindex="-1"></a><span class="co"># DFFITS</span></span>
<span id="cb277-32"><a href="#cb277-32" aria-hidden="true" tabindex="-1"></a>dffits_vals <span class="ot">&lt;-</span> <span class="fu">dffits</span>(modelD)</span>
<span id="cb277-33"><a href="#cb277-33" aria-hidden="true" tabindex="-1"></a>dffits_threshold <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(<span class="fu">coef</span>(modelD)) <span class="sc">/</span> <span class="fu">nrow</span>(SATFRUIT))</span>
<span id="cb277-34"><a href="#cb277-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dffits_vals, <span class="at">type =</span> <span class="st">"h"</span>,</span>
<span id="cb277-35"><a href="#cb277-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"DFFITS"</span>, <span class="at">ylab =</span> <span class="st">"DFFITS"</span>, <span class="at">xlab =</span> <span class="st">"Index"</span>)</span>
<span id="cb277-36"><a href="#cb277-36" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="sc">-</span>dffits_threshold, dffits_threshold), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb277-37"><a href="#cb277-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-38"><a href="#cb277-38" aria-hidden="true" tabindex="-1"></a><span class="co"># DFBETAS for first predictor (fruit coefficient)</span></span>
<span id="cb277-39"><a href="#cb277-39" aria-hidden="true" tabindex="-1"></a>dfbetas_vals <span class="ot">&lt;-</span> <span class="fu">dfbetas</span>(modelD)[, <span class="dv">2</span>]</span>
<span id="cb277-40"><a href="#cb277-40" aria-hidden="true" tabindex="-1"></a>dfbetas_threshold <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(SATFRUIT))</span>
<span id="cb277-41"><a href="#cb277-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfbetas_vals, <span class="at">type =</span> <span class="st">"h"</span>,</span>
<span id="cb277-42"><a href="#cb277-42" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"DFBETAS (fruit)"</span>, <span class="at">ylab =</span> <span class="st">"DFBETAS"</span>, <span class="at">xlab =</span> <span class="st">"Index"</span>)</span>
<span id="cb277-43"><a href="#cb277-43" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="sc">-</span>dfbetas_threshold, dfbetas_threshold), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li>Cook’s Distance</li>
</ol>
<p>What it measures: Overall influence of each observation on the model</p>
<p>Interpretation: Most points are below the threshold, indicating no single observation has excessive influence on the entire model. A few observations approach the line but don’t exceed it significantly.</p>
<ol start="2" type="1">
<li>Studentized Residuals</li>
</ol>
<p>What it measures: Standardized prediction errors</p>
<p>Interpretation: A few observations exceed ±2 (particularly one around -3), suggesting some potential outliers in the predictions. However, these are relatively few and within acceptable limits for a dataset of this size.</p>
<ol start="3" type="1">
<li>Hat Values (Leverage)</li>
</ol>
<p>What it measures: How unusual an observation’s predictor values are</p>
<p>Interpretation: Three observations (10, 22, 45) exceed this threshold, meaning they have unusual combinations of predictor values (fruit area and/or small area category). These are leverage points.</p>
<ol start="4" type="1">
<li>DFFITS</li>
</ol>
<p>What it measures: How much fitted values change when an observation is removed</p>
<p>Interpretation: Most observations fall within bounds, meaning individual observations don’t drastically change their own predicted values when removed from the model.</p>
<ol start="5" type="1">
<li>DFBETAS for Intercept</li>
</ol>
<p>What it measures: How much the intercept coefficient changes when an observation is removed</p>
<p>Interpretation: A few observations slightly exceed these bounds, suggesting they have some influence on the intercept, but effects are modest.</p>
<ol start="6" type="1">
<li>Residuals vs Fitted</li>
</ol>
<p>What it checks: Linearity and homoscedasticity (constant variance) Interpretation: Points scatter randomly around zero with relatively constant spread across fitted values, supporting model assumptions. No clear patterns or funnel shapes that would indicate problems.</p>
</section>
<section id="vi.-are-there-any-leverage-points-justify-the-answer-given." class="level4">
<h4 class="anchored" data-anchor-id="vi.-are-there-any-leverage-points-justify-the-answer-given.">(vi.) Are there any leverage points? Justify the answer given.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>leverage_points <span class="ot">&lt;-</span> <span class="fu">which</span>(hat_vals <span class="sc">&gt;</span> leverage_threshold)</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Leverage threshold (2p/n):"</span>, leverage_threshold, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Leverage threshold (2p/n): 0.1702128 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of leverage points:"</span>, <span class="fu">length</span>(leverage_points), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of leverage points: 3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Leverage points (observations):"</span>, leverage_points, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Leverage points (observations): 10 22 45 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(leverage_points) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Justification: These observations have hat values exceeding 2p/n ="</span>, </span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(leverage_threshold, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Justification: These observations have hat values exceeding 2p/n = 0.1702 </code></pre>
</div>
</div>
<p><strong>Justification</strong></p>
<p><strong>Definition of Leverage:</strong></p>
<p>Leverage (hat values) measures how <strong>unusual or extreme</strong> an observation’s predictor values are compared to the rest of the data. High leverage points are observations that are <strong>far from the center</strong> of the predictor space.</p>
<p><strong>Why These Are Leverage Points:</strong></p>
<p>These three observations (10, 22, 45) have <strong>hat values that exceed the threshold of 0.1702</strong>, meaning they have:</p>
<ol type="1">
<li><p><strong>Unusual combinations of predictor values</strong> (likely extreme values of <code>fruit</code> and/or unusual <code>smallarea</code> combinations)</p></li>
<li><p><strong>Greater potential to influence</strong> the fitted regression line</p></li>
<li><p><strong>Disproportionate weight</strong> in determining the regression coefficients</p></li>
</ol>
<p><strong>Interpreting the Hat Values from the Plot</strong></p>
<p>Looking at the <strong>Hat Values (Leverage)</strong> plot in the image:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Observation</strong></th>
<th><strong>Approximate Hat Value</strong></th>
<th><strong>Exceeds Threshold?</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>#10</strong></td>
<td>~<strong>0.35</strong></td>
<td>✓ YES (2× threshold)</td>
</tr>
<tr class="even">
<td><strong>#22</strong></td>
<td>~<strong>0.35</strong></td>
<td>✓ YES (2× threshold)</td>
</tr>
<tr class="odd">
<td><strong>#45</strong></td>
<td>~<strong>0.35</strong></td>
<td>✓ YES (2× threshold)</td>
</tr>
</tbody>
</table>
<p>All three leverage points have hat values approximately <strong>0.35</strong>, which is:</p>
<ul>
<li><p><strong>More than double</strong> the threshold (0.35 / 0.1702 ≈ 2.06×)</p></li>
<li><p>Among the <strong>highest leverage values</strong> in the dataset</p></li>
</ul>
</section>
<section id="vii.-are-there-any-outliers-justify-the-answer-given." class="level4">
<h4 class="anchored" data-anchor-id="vii.-are-there-any-outliers-justify-the-answer-given.">(vii.) Are there any outliers? Justify the answer given.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(rstud) <span class="sc">&gt;</span> <span class="dv">2</span>)</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of outliers (|rstudent| &gt; 2):"</span>, <span class="fu">length</span>(outliers), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of outliers (|rstudent| &gt; 2): 2 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Outliers (observations):"</span>, outliers, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Outliers (observations): 3 46 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(outliers) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Justification: These observations have studentized residuals with absolute value &gt; 2</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Studentized residuals for outliers:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(rstud[outliers])</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Justification: These observations have studentized residuals with absolute value &gt; 2
Studentized residuals for outliers:
        3        46 
-2.131934 -3.030668 </code></pre>
</div>
</div>
<p><strong>Justification</strong></p>
<p><strong>Definition of Outliers:</strong></p>
<p>Outliers are observations with <strong>unusually large residuals</strong> - their observed values are far from what the model predicts. Studentized residuals standardize the residuals to account for their varying standard errors, making them comparable across observations.</p>
<p><strong>Why These Are Outliers:</strong></p>
<p>Both observations #3 and #46 have <strong>studentized residuals with absolute values exceeding 2</strong>, specifically:</p>
<ol type="1">
<li><p><strong>Observation #3</strong>:</p>
<ul>
<li><p>Studentized residual = <strong>-2.132</strong></p></li>
<li><p>Exceeds the threshold of 2 by about <strong>6.6%</strong></p></li>
<li><p><strong>Moderately unusual</strong> observation</p></li>
</ul></li>
<li><p><strong>Observation #46</strong>:</p>
<ul>
<li><p>Studentized residual = <strong>-3.031</strong></p></li>
<li><p>Exceeds the threshold of 2 by about <strong>51.5%</strong></p></li>
<li><p><strong>Highly unusual</strong> observation - exceeds even the stricter threshold of |t| &gt; 3</p></li>
</ul></li>
</ol>
<p><strong>Interpretation of Negative Residuals</strong></p>
<p><strong>What Does a Negative Studentized Residual Mean?</strong></p>
<p><strong>Residual = Observed - Predicted</strong></p>
<p>Since both outliers have <strong>negative</strong> studentized residuals:</p>
<ul>
<li><p>The <strong>observed fruit area is LESS than predicted</strong></p></li>
<li><p>The model <strong>overpredicts</strong> fruit tree coverage for these segments</p></li>
<li><p>These observations have <strong>unexpectedly low</strong> observed fruit area given their predictor values</p></li>
</ul>
<p><strong>Detailed Analysis by Observation</strong></p>
<p><strong>Observation #3 (Moderate Outlier):</strong></p>
<p><strong>Studentized Residual</strong>: -2.132</p>
<p><strong>Characteristics</strong>:</p>
<ul>
<li><p>Moderately extreme (2-3 standard deviations below expected)</p></li>
<li><p>Model predicts higher fruit coverage than actually observed</p></li>
<li><p>Could indicate:</p>
<ul>
<li><p>Satellite <strong>misclassification</strong> (classified as fruit but actually something else)</p></li>
<li><p>Measurement error in ground observations</p></li>
<li><p>Genuine unusual case (e.g., recently cleared fruit trees)</p></li>
</ul></li>
</ul>
<p><strong>Severity</strong>: Moderate concern</p>
<p><strong>Observation #46 (Severe Outlier):</strong></p>
<p><strong>Studentized Residual</strong>: -3.031</p>
<p><strong>Characteristics</strong>:</p>
<ul>
<li><p><strong>Highly extreme</strong> (&gt;3 standard deviations below expected)</p></li>
<li><p>This is the <strong>most problematic outlier</strong> in the dataset</p></li>
<li><p>Only <strong>~0.3%</strong> of observations should exceed |t| &gt; 3 in a normal distribution</p></li>
<li><p>Model <strong>significantly overpredicts</strong> for this observation</p></li>
</ul>
<p><strong>Possible Explanations</strong>:</p>
<ol type="1">
<li><p><strong>Data entry error</strong>: Typo in observed or predictor values</p></li>
<li><p><strong>Measurement error</strong>: Ground observation was inaccurate</p></li>
<li><p><strong>Satellite misclassification</strong>: Large area classified as fruit but is not</p></li>
<li><p><strong>Temporal mismatch</strong>: Satellite data and ground observation from different times</p></li>
<li><p><strong>Legitimate unusual case</strong>: Unique characteristics (e.g., diseased orchard, recent harvest)</p></li>
</ol>
<p><strong>Severity</strong>: High concern - should be investigated</p>
<p><strong>Visual Confirmation from Plot</strong></p>
<p>Looking at the <strong>Studentized Residuals</strong> plot (top middle of diagnostic plots):</p>
<p><strong>Observations:</strong></p>
<ul>
<li><p>Most residuals cluster between <strong>-1 and +1</strong> ✓</p></li>
<li><p>Red dashed lines mark the <strong>±2 threshold</strong></p></li>
<li><p><strong>Two observations clearly breach the lower threshold</strong>:</p>
<ul>
<li><p>One around index 3: residual ≈ <strong>-2.1</strong> (matches observation #3)</p></li>
<li><p>One around index 46: residual ≈ <strong>-3.0</strong> (matches observation #46, labeled in plot)</p></li>
</ul></li>
<li><p><strong>No observations exceed +2</strong> on the positive side</p></li>
<li><p>The outliers are on the <strong>negative side only</strong>, indicating systematic underprediction for these cases</p></li>
</ul>
</section>
<section id="viii-check-normality-and-homoscedasticity-for-model-d-using-graphics-and-hypothesis-tests." class="level4">
<h4 class="anchored" data-anchor-id="viii-check-normality-and-homoscedasticity-for-model-d-using-graphics-and-hypothesis-tests.">(viii) Check normality and homoscedasticity for Model (D) using graphics and hypothesis tests.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelD)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk test for normality</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(modelD))</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Shapiro-Wilk test for normality of residuals:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Shapiro-Wilk test for normality of residuals:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"W ="</span>, shapiro_test<span class="sc">$</span>statistic, <span class="st">", p-value ="</span>, shapiro_test<span class="sc">$</span>p.value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>W = 0.956806 , p-value = 0.08035332 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(shapiro_test<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Conclusion: Fail to reject null hypothesis. Residuals appear normally distributed (α=0.05).</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Conclusion: Reject null hypothesis. Evidence of non-normality in residuals (α=0.05).</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conclusion: Fail to reject null hypothesis. Residuals appear normally distributed (α=0.05).</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Breusch-Pagan test for homoscedasticity</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>bp_test <span class="ot">&lt;-</span> <span class="fu">ncvTest</span>(modelD)</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Breusch-Pagan test for homoscedasticity:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Breusch-Pagan test for homoscedasticity:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Chi-square ="</span>, bp_test<span class="sc">$</span>ChiSquare, <span class="st">", df ="</span>, bp_test<span class="sc">$</span>Df, <span class="st">", p-value ="</span>, bp_test<span class="sc">$</span>p, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Chi-square = 0.3483938 , df = 1 , p-value = 0.5550237 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(bp_test<span class="sc">$</span>p <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Conclusion: Fail to reject null hypothesis. No evidence of heteroscedasticity (α=0.05).</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Conclusion: Reject null hypothesis. Evidence of heteroscedasticity (α=0.05).</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conclusion: Fail to reject null hypothesis. No evidence of heteroscedasticity (α=0.05).</code></pre>
</div>
</div>
<p><strong>NORMALITY:</strong></p>
<p><strong>Hypothesis Test:</strong></p>
<p><strong>Shapiro-Wilk Test</strong>:</p>
<ul>
<li><p><strong>W = 0.9568, p-value = 0.080</strong></p></li>
<li><p><strong>Conclusion</strong>: At α = 0.05, we <strong>fail to reject the null hypothesis</strong></p></li>
<li><p><strong>Interpretation</strong>: The residuals <strong>appear normally distributed</strong></p></li>
</ul>
<p><strong>Visual Assessment:</strong></p>
<p><strong>Q-Q Plot</strong>:</p>
<ul>
<li><p>Points follow the diagonal line closely throughout most of the range</p></li>
<li><p>Minor deviation in left tail due to outliers (#3, #46)</p></li>
<li><p><strong>Conclusion</strong>: <strong>Normality assumption is reasonably satisfied</strong></p></li>
</ul>
<p><strong>HOMOSCEDASTICITY:</strong></p>
<p><strong>Hypothesis Test:</strong></p>
<p><strong>Breusch-Pagan Test</strong>:</p>
<ul>
<li><p><strong>χ² = 0.3484, df = 1, p-value = 0.555</strong></p></li>
<li><p><strong>Conclusion</strong>: At α = 0.05, we <strong>fail to reject the null hypothesis</strong></p></li>
<li><p><strong>Interpretation</strong>: <strong>No evidence of heteroscedasticity</strong> - variance is constant</p></li>
</ul>
<p><strong>Visual Assessment:</strong></p>
<p><strong>Residuals vs Fitted Plot</strong>:</p>
<ul>
<li><p>Random scatter around horizontal line at zero</p></li>
<li><p>Constant vertical spread across fitted values</p></li>
<li><p><strong>Conclusion</strong>: <strong>Homoscedasticity assumption is satisfied</strong></p></li>
</ul>
<p><strong>Scale-Location Plot</strong>:</p>
<ul>
<li><p>Horizontal smoothed line with no strong trend</p></li>
<li><p>Even vertical spread of √|standardized residuals|</p></li>
<li><p><strong>Conclusion</strong>: <strong>Confirms constant variance</strong></p></li>
</ul>
<p><strong>OVERALL CONCLUSION: Both normality and homoscedasticity assumptions are satisfied for Model D.</strong></p>
</section>
<section id="ix.-calculate-a-95-confidence-interval-for-the-fruit-coefficient." class="level4">
<h4 class="anchored" data-anchor-id="ix.-calculate-a-95-confidence-interval-for-the-fruit-coefficient.">(ix.) Calculate a 95% confidence interval for the fruit coefficient.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>ci_fruit <span class="ot">&lt;-</span> <span class="fu">confint</span>(modelD, <span class="st">"fruit"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Confidence Interval for fruit coefficient:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Confidence Interval for fruit coefficient:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci_fruit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          2.5 %   97.5 %
fruit 0.7542251 1.091433</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation: We are 95% confident that the true coefficient for fruit is between"</span>,</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ci_fruit[<span class="dv">1</span>], <span class="dv">4</span>), <span class="st">"and"</span>, <span class="fu">round</span>(ci_fruit[<span class="dv">2</span>], <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation: We are 95% confident that the true coefficient for fruit is between 0.7542 and 1.0914 </code></pre>
</div>
</div>
</section>
<section id="h-how-many-hectares-of-observed-fruits-are-expected-to-be-incremented-if-the-classified-hectares-of-fruit-trees-by-the-satellite-are-increased-by-10000-m2-1-ha" class="level3">
<h3 class="anchored" data-anchor-id="h-how-many-hectares-of-observed-fruits-are-expected-to-be-incremented-if-the-classified-hectares-of-fruit-trees-by-the-satellite-are-increased-by-10000-m2-1-ha">(h) How many hectares of observed fruits are expected to be incremented if the classified hectares of fruit trees by the satellite are increased by 10,000 m2 (1 ha)?</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>fruit_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelD)[<span class="st">"fruit"</span>]</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>increase_m2 <span class="ot">&lt;-</span> fruit_coef <span class="sc">*</span> <span class="dv">10000</span></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>increase_ha <span class="ot">&lt;-</span> increase_m2 <span class="sc">/</span> <span class="dv">10000</span></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Fruit coefficient:"</span>, fruit_coef, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fruit coefficient: 0.9228291 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Expected increase in observed for 10,000 m² increase in classified fruit:"</span>, </span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>    increase_m2, <span class="st">"m²</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expected increase in observed for 10,000 m² increase in classified fruit: 9228.291 m²</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"In hectares:"</span>, increase_ha, <span class="st">"ha</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>In hectares: 0.9228291 ha</code></pre>
</div>
</div>
</section>
<section id="i-suppose-the-total-classified-fruits-by-the-satellite-in-area-r63-is-97044.28-m2-in-area-r67-is-4878603.43-m2-and-in-area-r68-is-2883488.24-m2.-predict-the-total-area-of-fruit-trees-by-small-areas." class="level3">
<h3 class="anchored" data-anchor-id="i-suppose-the-total-classified-fruits-by-the-satellite-in-area-r63-is-97044.28-m2-in-area-r67-is-4878603.43-m2-and-in-area-r68-is-2883488.24-m2.-predict-the-total-area-of-fruit-trees-by-small-areas.">(i) Suppose the total classified fruits by the satellite in area R63 is 97,044.28 m2, in area R67 is 4,878,603.43 m2, and in area R68 is 2,883,488.24 m2. Predict the total area of fruit trees by small areas.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total classified fruits by area</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>total_classified <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">smallarea =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"R63"</span>, <span class="st">"R67"</span>, <span class="st">"R68"</span>), <span class="at">levels =</span> <span class="fu">levels</span>(SATFRUIT<span class="sc">$</span>smallarea)),</span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fruit =</span> <span class="fu">c</span>(<span class="fl">97044.28</span>, <span class="fl">4878603.43</span>, <span class="fl">2883488.24</span>)</span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-7"><a href="#cb317-7" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelD, <span class="at">newdata =</span> total_classified)</span>
<span id="cb317-8"><a href="#cb317-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Predicted total observed area by small area:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Predicted total observed area by small area:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(total_classified<span class="sc">$</span>smallarea[i], <span class="st">":"</span>, <span class="fu">round</span>(predictions[i], <span class="dv">2</span>), <span class="st">"m² ("</span>,</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(predictions[i]<span class="sc">/</span><span class="dv">10000</span>, <span class="dv">2</span>), <span class="st">"ha)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 : 89988.66 m² ( 9 ha)
2 : 4503209 m² ( 450.32 ha)
3 : 2658694 m² ( 265.87 ha)</code></pre>
</div>
</div>
</section>
<section id="j-create-a-plot-of-observed-versus-fruit-with-the-points-color-coded-according-to-small-area.-superimpose-the-corresponding-regression-lines-for-each-small-area." class="level3">
<h3 class="anchored" data-anchor-id="j-create-a-plot-of-observed-versus-fruit-with-the-points-color-coded-according-to-small-area.-superimpose-the-corresponding-regression-lines-for-each-small-area.">(j) Create a plot of observed versus fruit with the points color coded according to small area. Superimpose the corresponding regression lines for each small area.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>p_scatter <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(SATFRUIT, <span class="fu">aes</span>(<span class="at">x =</span> fruit, <span class="at">y =</span> observed, <span class="at">color =</span> smallarea)) <span class="sc">+</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Observed vs Classified Fruit Surface by Small Area"</span>,</span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Classified Fruit (m²)"</span>, </span>
<span id="cb321-6"><a href="#cb321-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Observed Fruit (m²)"</span>,</span>
<span id="cb321-7"><a href="#cb321-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Small Area"</span>) <span class="sc">+</span></span>
<span id="cb321-8"><a href="#cb321-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb321-9"><a href="#cb321-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb321-10"><a href="#cb321-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-11"><a href="#cb321-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_scatter)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Summary of the Plot:</strong></p>
<p>The plot successfully displays:</p>
<p><strong>Scatterplot</strong>: Observed (y-axis) vs Classified (x-axis) fruit surface area</p>
<p><strong>Color Coding</strong>:</p>
<ul>
<li><p>R63 (red): 2 points, near origin</p></li>
<li><p>R67 (green): ~27 points, highest coverage</p></li>
<li><p>R68 (blue): ~18 points, intermediate coverage</p></li>
</ul>
<p><strong>Area-Specific Regression Lines</strong>:</p>
<ul>
<li><p>Each small area has its <strong>own regression line</strong> with different slope and intercept</p></li>
<li><p><strong>R67 (green)</strong>: Steepest slope, tightest fit</p></li>
<li><p><strong>R68 (blue)</strong>: Moderate slope, more scatter</p></li>
<li><p><strong>R63 (red)</strong>: Limited data, uncertain relationship</p></li>
</ul>
<p><strong>Confidence Bands</strong>: Shaded regions show 95% confidence intervals for each regression line</p>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><p><strong>Strong positive correlation</strong> between satellite-classified and ground-observed fruit coverage in all areas</p></li>
<li><p><strong>Area-specific relationships</strong> exist:</p>
<ul>
<li><p>Different intercepts (baseline fruit coverage)</p></li>
<li><p>Different slopes (classification accuracy)</p></li>
<li><p>Different precision (variance around line)</p></li>
</ul></li>
<li><p><strong>R67 shows best agreement</strong> between satellite and ground data (tight clustering)</p></li>
<li><p><strong>R68 shows more variability</strong> with several outliers (points far below line)</p></li>
<li><p><strong>R63 has minimal fruit coverage</strong> with insufficient data for reliable estimation</p></li>
<li><p><strong>Visual justification for Model D</strong>: The plot demonstrates why including <code>smallarea</code> improves predictions—the relationship between classified and observed fruit varies systematically across regions</p></li>
</ol>
</section>
<section id="k-plot-the-individual-predictions-for-model-d-versus-the-observed-data.-add-a-diagonal-line-to-the-plot." class="level3">
<h3 class="anchored" data-anchor-id="k-plot-the-individual-predictions-for-model-d-versus-the-observed-data.-add-a-diagonal-line-to-the-plot.">(k) Plot the individual predictions for model D versus the observed data. Add a diagonal line to the plot.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>pred_D <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelD)</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pred_D, SATFRUIT<span class="sc">$</span>observed, </span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Predicted vs Observed (Model D)"</span>,</span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Predicted"</span>, <span class="at">ylab =</span> <span class="st">"Observed"</span>,</span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">as.numeric</span>(SATFRUIT<span class="sc">$</span>smallarea))</span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">levels</span>(SATFRUIT<span class="sc">$</span>smallarea), </span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">title =</span> <span class="st">"Small Area"</span>)</span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add R² to plot</span></span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">min</span>(pred_D), <span class="at">y =</span> <span class="fu">max</span>(SATFRUIT<span class="sc">$</span>observed),</span>
<span id="cb323-13"><a href="#cb323-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"R² ="</span>, <span class="fu">round</span>(R2_D, <span class="dv">3</span>)), <span class="at">pos =</span> <span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot displays <strong>Model D’s predicted values vs.&nbsp;observed fruit surface area</strong> with the following elements:</p>
<p><strong>Diagonal Reference Line</strong> (red dashed):</p>
<ul>
<li><p>Represents perfect prediction (y = x)</p></li>
<li><p>Points on line = perfect accuracy</p></li>
<li><p>Points above line = underprediction</p></li>
<li><p>Points below line = overprediction</p></li>
</ul>
<p><strong>Color-Coded Points by Small Area</strong>:</p>
<ul>
<li><p><strong>R63 (black)</strong>: 2 points near origin and low-mid range</p></li>
<li><p><strong>R67 (red)</strong>: ~27 points, distributed 0-13,000 m²</p></li>
<li><p><strong>R68 (green)</strong>: ~18 points, distributed 0-11,000 m²</p></li>
</ul>
<p><strong>R² = 0.782</strong>: Displayed in plot, indicates 78.2% of variance explained</p>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><p><strong>Strong Overall Fit</strong>:</p>
<ul>
<li><p>Points cluster tightly around the diagonal line</p></li>
<li><p>Model D demonstrates <strong>good predictive accuracy</strong></p></li>
</ul></li>
<li><p><strong>Best Performance in R67</strong> (red points):</p>
<ul>
<li><p>Extremely tight clustering around diagonal</p></li>
<li><p>Particularly excellent for predictions &gt; 10,000 m²</p></li>
<li><p>Very few deviations</p></li>
</ul></li>
<li><p><strong>Variable Performance in R68</strong> (green points):</p>
<ul>
<li><p>More scatter around diagonal</p></li>
<li><p><strong>Two significant outliers</strong> below the line (overpredictions)</p></li>
<li><p>Less reliable than R67</p></li>
</ul></li>
<li><p><strong>Limited Data for R63</strong> (black points):</p>
<ul>
<li><p>Only 2 points visible</p></li>
<li><p>Appear to be reasonably accurate</p></li>
<li><p>Insufficient for strong conclusions</p></li>
</ul></li>
<li><p><strong>No Systematic Bias</strong>:</p>
<ul>
<li><p>Points distributed symmetrically around diagonal</p></li>
<li><p>Model is <strong>well-calibrated</strong></p></li>
<li><p>Unbiased predictions overall</p></li>
</ul></li>
<li><p><strong>Accuracy by Range</strong>:</p>
<ul>
<li><p><strong>High predictions (&gt;10,000 m²)</strong>: Excellent accuracy (±500-1,000 m²)</p></li>
<li><p><strong>Mid predictions (5,000-10,000 m²)</strong>: Good accuracy (±1,000-1,500 m²)</p></li>
<li><p><strong>Low predictions (&lt;5,000 m²)</strong>: More variable (±1,000-2,500 m²)</p></li>
</ul></li>
</ol>
<p><strong>Conclusion:</strong></p>
<p>The predicted vs.&nbsp;observed plot provides <strong>strong visual evidence</strong> that Model D performs well for predicting fruit tree surface area. The tight clustering around the diagonal line, particularly for R67, confirms the model’s <strong>78.2% variance explained</strong> and its superior <strong>cross-validation performance</strong> compared to Models A and C.</p>
<p>While some outliers exist (primarily in R68), the overall pattern demonstrates that Model D is <strong>reliable and well-calibrated</strong> for estimating fruit tree coverage across the small areas of Navarra, with the best performance in R67 where the most data is available.</p>
</section>
<section id="l-create-a-bar-plot-that-displays-the-predicted-area-occupied-by-fruit-trees-based-on-model-d-for-each-small-area-and-the-direct-estimates-of-the-area-occupied-by-fruit-trees-by-small-area-knowing-that-the-total-number-of-classified-segments-in-areas-r63-r67-and-r68-are-119-703-and-564-respectively." class="level3">
<h3 class="anchored" data-anchor-id="l-create-a-bar-plot-that-displays-the-predicted-area-occupied-by-fruit-trees-based-on-model-d-for-each-small-area-and-the-direct-estimates-of-the-area-occupied-by-fruit-trees-by-small-area-knowing-that-the-total-number-of-classified-segments-in-areas-r63-r67-and-r68-are-119-703-and-564-respectively.">(l) Create a bar plot that displays the predicted area occupied by fruit trees based on model D for each small area and the direct estimates of the area occupied by fruit trees by small area knowing that the total number of classified segments in areas R63, R67, and R68 are 119, 703, and 564, respectively.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total segments by area</span></span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>total_segments <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">smallarea =</span> <span class="fu">c</span>(<span class="st">"R63"</span>, <span class="st">"R67"</span>, <span class="st">"R68"</span>),</span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_segments =</span> <span class="fu">c</span>(<span class="dv">119</span>, <span class="dv">703</span>, <span class="dv">564</span>)</span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Direct estimates</span></span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true" tabindex="-1"></a>direct_estimates <span class="ot">&lt;-</span> SATFRUIT <span class="sc">%&gt;%</span></span>
<span id="cb324-9"><a href="#cb324-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(smallarea) <span class="sc">%&gt;%</span></span>
<span id="cb324-10"><a href="#cb324-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_observed =</span> <span class="fu">mean</span>(observed)) <span class="sc">%&gt;%</span></span>
<span id="cb324-11"><a href="#cb324-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(total_segments, <span class="at">by =</span> <span class="st">"smallarea"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb324-12"><a href="#cb324-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_direct =</span> mean_observed <span class="sc">*</span> n_segments)</span>
<span id="cb324-13"><a href="#cb324-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-14"><a href="#cb324-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Model D predictions (total for each area)</span></span>
<span id="cb324-15"><a href="#cb324-15" aria-hidden="true" tabindex="-1"></a>model_predictions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb324-16"><a href="#cb324-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">smallarea =</span> <span class="fu">c</span>(<span class="st">"R63"</span>, <span class="st">"R67"</span>, <span class="st">"R68"</span>),</span>
<span id="cb324-17"><a href="#cb324-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_predicted =</span> predictions</span>
<span id="cb324-18"><a href="#cb324-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb324-19"><a href="#cb324-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-20"><a href="#cb324-20" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">left_join</span>(direct_estimates, model_predictions, <span class="at">by =</span> <span class="st">"smallarea"</span>)</span>
<span id="cb324-21"><a href="#cb324-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-22"><a href="#cb324-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  smallarea mean_observed n_segments total_direct total_predicted
  &lt;chr&gt;             &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;
1 R63               1668.        119      198466.          89989.
2 R67               8346.        703     5867470.        4503209.
3 R68               6364.        564     3589159.        2658694.</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>barplot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(comparison<span class="sc">$</span>total_direct, comparison<span class="sc">$</span>total_predicted)</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barplot_data) <span class="ot">&lt;-</span> comparison<span class="sc">$</span>smallarea</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">barplot</span>(barplot_data, <span class="at">beside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> comparison<span class="sc">$</span>smallarea,</span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"coral"</span>),</span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Direct vs Model D Predictions by Small Area"</span>,</span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Total Area (m²)"</span>,</span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Small Area"</span>,</span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">c</span>(<span class="st">"Direct Estimate"</span>, <span class="st">"Model D Prediction"</span>),</span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">args.legend =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">"topright"</span>, <span class="at">bty =</span> <span class="st">"n"</span>),</span>
<span id="cb326-14"><a href="#cb326-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(barplot_data) <span class="sc">*</span> <span class="fl">1.15</span>))</span>
<span id="cb326-15"><a href="#cb326-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-16"><a href="#cb326-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Add values on bars</span></span>
<span id="cb326-17"><a href="#cb326-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> bp, <span class="at">y =</span> barplot_data, </span>
<span id="cb326-18"><a href="#cb326-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">round</span>(barplot_data, <span class="dv">0</span>), <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb326-19"><a href="#cb326-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Summary of the Bar Plot:</strong></p>
<p>The plot compares <strong>two estimation methods</strong> for predicting total fruit tree surface area across three small areas (R63, R67, R68):</p>
<p><strong>Results Table:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Small Area</strong></th>
<th><strong>Total Segments</strong></th>
<th><strong>Direct Estimate (m²)</strong></th>
<th><strong>Model D Prediction (m²)</strong></th>
<th><strong>Difference (m²)</strong></th>
<th><strong>% Difference</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>R63</strong></td>
<td>119</td>
<td>198,466</td>
<td>89,989</td>
<td>+108,477</td>
<td>+121%</td>
</tr>
<tr class="even">
<td><strong>R67</strong></td>
<td>703</td>
<td>5,867,470</td>
<td>4,503,209</td>
<td>+1,364,261</td>
<td>+30%</td>
</tr>
<tr class="odd">
<td><strong>R68</strong></td>
<td>564</td>
<td>3,589,159</td>
<td>2,658,694</td>
<td>+930,465</td>
<td>+35%</td>
</tr>
<tr class="even">
<td><strong>TOTAL</strong></td>
<td>1,386</td>
<td><strong>9,655,095</strong></td>
<td><strong>7,251,892</strong></td>
<td><strong>+2,403,203</strong></td>
<td><strong>+33%</strong></td>
</tr>
</tbody>
</table>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><p><strong>Direct Estimation Systematically Overestimates</strong>:</p>
<ul>
<li><p>Direct method produces <strong>higher estimates</strong> in all three areas</p></li>
<li><p>Overestimation ranges from <strong>30-121%</strong></p></li>
<li><p>Total overestimation: <strong>240 hectares</strong> (2.4 million m²)</p></li>
</ul></li>
<li><p><strong>Model D Provides More Conservative Estimates</strong>:</p>
<ul>
<li><p>Uses regression with satellite data for <strong>variance reduction</strong></p></li>
<li><p>Accounts for area-specific effects</p></li>
<li><p>Superior <strong>cross-validation performance</strong> (lowest CV error)</p></li>
</ul></li>
<li><p><strong>Largest Discrepancy in R63</strong>:</p>
<ul>
<li><p>Direct estimate is <strong>2.2× higher</strong> than Model D</p></li>
<li><p>Due to <strong>very small sample size</strong> (n≈2)</p></li>
<li><p>Demonstrates <strong>unreliability of direct method</strong> for small samples</p></li>
</ul></li>
<li><p><strong>Substantial Differences Even in R67</strong>:</p>
<ul>
<li><p>Despite having most data (n≈27), estimates differ by <strong>136 ha</strong></p></li>
<li><p>Shows value of <strong>small area estimation</strong> even with moderate samples</p></li>
</ul></li>
<li><p><strong>Practical Impact</strong>:</p>
<ul>
<li><p>Using direct estimates would <strong>overallocate resources</strong> by 33%</p></li>
<li><p>Model D provides <strong>more accurate, efficient estimates</strong></p></li>
<li><p>Critical for policy, planning, and resource management</p></li>
</ul></li>
</ol>
<p><strong>Conclusion:</strong></p>
<p>The bar plot provides <strong>compelling visual evidence</strong> for the superiority of the <strong>small area estimation approach (Model D)</strong> over traditional <strong>direct estimation</strong>. By incorporating satellite classification data and area-specific effects, Model D produces more accurate and stable estimates, particularly critical for areas with small sample sizes like R63. The consistent pattern of overestimation by the direct method (totaling 240 hectares) demonstrates the practical value of the regression-based small area estimation methodology described in this case study.</p>
</section>
</section>
</section>
<section id="case-study-3-real-estate" class="level1">
<h1>Case Study 3: Real Estate</h1>
<p><em>Data and ideas for this case study come from (Militino et al., 2004).</em></p>
<p>The goal of this case study is to walk the user through the creation of a parsimonious multiple linear regression model that can be used to predict the total price (<code>totalprice</code>) of apartments by their hedonic (structural) characteristics. The data frame <code>VIT2005</code> contains several variables, and further description of the data can be found in the help file.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spuRs)</span>
<span id="cb327-7"><a href="#cb327-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-8"><a href="#cb327-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb327-9"><a href="#cb327-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(VIT2005)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="a-characterize-the-shape-center-and-spread-of-the-variable-totalprice." class="level3">
<h3 class="anchored" data-anchor-id="a-characterize-the-shape-center-and-spread-of-the-variable-totalprice.">(a) Characterize the shape, center, and spread of the variable <code>totalprice</code>.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(VIT2005<span class="sc">$</span>totalprice)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 155000  228500  269750  280742  328625  560000 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standard Deviation:"</span>, <span class="fu">sd</span>(VIT2005<span class="sc">$</span>totalprice), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standard Deviation: 69298.46 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variance:"</span>, <span class="fu">var</span>(VIT2005<span class="sc">$</span>totalprice), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variance: 4802276444 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"IQR:"</span>, <span class="fu">IQR</span>(VIT2005<span class="sc">$</span>totalprice), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>IQR: 100125 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize distribution</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(VIT2005<span class="sc">$</span>totalprice, <span class="at">main =</span> <span class="st">"Histogram of Total Price"</span>, </span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Total Price (euros)"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">breaks =</span> <span class="dv">15</span>)</span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(VIT2005<span class="sc">$</span>totalprice, <span class="at">main =</span> <span class="st">"Boxplot of Total Price"</span>, </span>
<span id="cb336-6"><a href="#cb336-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Total Price (euros)"</span>, <span class="at">col =</span> <span class="st">"lightgreen"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Shape, Center, and Spread of Total Price</p>
<p><strong>Center (Central Tendency)</strong></p>
<ul>
<li><p><strong>Mean</strong>: €280,742</p></li>
<li><p><strong>Median</strong>: €269,750</p></li>
</ul>
<p>The mean is slightly higher than the median (€10,992 difference), suggesting a slight right skew in the distribution.</p>
<p><strong>Spread (Variability)</strong></p>
<ul>
<li><p><strong>Standard Deviation</strong>: €69,298.46</p></li>
<li><p><strong>Variance</strong>: €4,802,276,444</p></li>
<li><p><strong>Range</strong>: €405,000 (from €155,000 to €560,000)</p></li>
<li><p><strong>Interquartile Range (IQR)</strong>: €100,125</p>
<ul>
<li><p><strong>Q1 (1st Quartile)</strong>: €228,500</p></li>
<li><p><strong>Q3 (3rd Quartile)</strong>: €328,625</p></li>
</ul></li>
</ul>
<p>The relatively large standard deviation (about 25% of the mean) indicates substantial variability in apartment prices.</p>
<p><strong>Shape (Distribution)</strong></p>
<p><strong>From the Histogram:</strong></p>
<ul>
<li><p>The distribution is approximately <strong>bell-shaped</strong> with a slight <strong>right skew</strong> (positive skew)</p></li>
<li><p>Most apartment prices are concentrated between €200,000 and €350,000</p></li>
<li><p>The peak (mode) appears to be around €250,000-€270,000</p></li>
<li><p>There are a few higher-priced apartments extending to €560,000, creating the right tail</p></li>
</ul>
<p><strong>From the Boxplot:</strong></p>
<ul>
<li><p>One clear <strong>outlier</strong> is visible above the upper whisker (around €560,000)</p></li>
<li><p>The box is relatively symmetric, with the median line slightly below center</p></li>
<li><p>The upper whisker extends further than the lower whisker, confirming right skewness</p></li>
</ul>
</section>
<section id="b-use-scatterplotmatrix-from-the-car-package-or-pairs-to-explore-the-relationships-between-totalprice-and-the-numerical-explanatory-variables-area-age-floor-rooms-toilets-garage-elevator-and-storage." class="level3">
<h3 class="anchored" data-anchor-id="b-use-scatterplotmatrix-from-the-car-package-or-pairs-to-explore-the-relationships-between-totalprice-and-the-numerical-explanatory-variables-area-age-floor-rooms-toilets-garage-elevator-and-storage.">(b) Use <code>scatterplotMatrix()</code> from the <code>car</code> package or <code>pairs()</code> to explore the relationships between <code>totalprice</code> and the numerical explanatory variables: <code>area</code>, <code>age</code>, <code>floor</code>, <code>rooms</code>, <code>toilets</code>, <code>garage</code>, <code>elevator</code>, and <code>storage</code>.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplotMatrix</span>(VIT2005[, <span class="fu">c</span>(<span class="st">"totalprice"</span>, <span class="st">"area"</span>, <span class="st">"age"</span>, <span class="st">"floor"</span>, <span class="st">"rooms"</span>, </span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"toilets"</span>, <span class="st">"garage"</span>, <span class="st">"elevator"</span>, <span class="st">"storage"</span>)], </span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">smooth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main =</span> <span class="st">"Scatterplot Matrix"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Relationships Between Total Price and Explanatory Variables</p>
<p><strong>Strong Positive Relationships:</strong></p>
<ol type="1">
<li><p><strong>Area</strong> (strongest relationship)</p>
<ul>
<li><p>Clear, strong positive linear relationship with totalprice</p></li>
<li><p>As area increases, total price increases substantially</p></li>
<li><p>The scatterplot shows a tight, upward-sloping pattern</p></li>
<li><p>This appears to be the strongest predictor</p></li>
</ul></li>
<li><p><strong>Toilets</strong></p>
<ul>
<li><p>Moderate to strong positive relationship</p></li>
<li><p>More toilets are associated with higher prices</p></li>
<li><p>Shows a clear upward trend</p></li>
</ul></li>
<li><p><strong>Rooms</strong></p>
<ul>
<li><p>Positive relationship with totalprice</p></li>
<li><p>More rooms generally correspond to higher prices</p></li>
<li><p>Some clustering at discrete values (since rooms is typically a count variable)</p></li>
</ul></li>
</ol>
<p><strong>Moderate Positive Relationships:</strong></p>
<ol start="4" type="1">
<li><p><strong>Floor</strong></p>
<ul>
<li><p>Moderate positive relationship</p></li>
<li><p>Higher floors tend to have higher prices</p></li>
<li><p>The relationship appears somewhat linear but with more variability</p></li>
</ul></li>
<li><p><strong>Garage</strong></p>
<ul>
<li><p>Positive association with price</p></li>
<li><p>Presence/number of garages relates to higher prices</p></li>
<li><p>Variable appears to be discrete (0, 1, 2)</p></li>
</ul></li>
</ol>
<p><strong>Weak or Unclear Relationships:</strong></p>
<ol start="6" type="1">
<li><p><strong>Age</strong></p>
<ul>
<li><p>Weak or possibly negative relationship</p></li>
<li><p>Newer apartments (lower age) may command higher prices</p></li>
<li><p>The relationship is not as clear or strong</p></li>
</ul></li>
<li><p><strong>Elevator</strong></p>
<ul>
<li><p>Appears to be binary (0 or 1)</p></li>
<li><p>Some positive association - apartments with elevators may be priced higher</p></li>
<li><p>Difficult to assess linearity with binary variable</p></li>
</ul></li>
<li><p><strong>Storage</strong></p>
<ul>
<li><p>Appears binary or discrete</p></li>
<li><p>Weak relationship with totalprice</p></li>
<li><p>Less influential than other variables</p></li>
</ul></li>
</ol>
<p><strong>Key Observations:</strong></p>
<ul>
<li><p><strong>Area</strong> is clearly the dominant predictor with the strongest linear relationship</p></li>
<li><p>Several variables show positive correlations, suggesting larger/better-equipped apartments cost more</p></li>
<li><p>Some variables (elevator, garage, storage) appear to be discrete/binary, which may require special consideration in modeling</p></li>
<li><p>There appears to be multicollinearity potential among predictors (e.g., area correlates with rooms and toilets)</p></li>
</ul>
</section>
<section id="c-compute-the-correlation-between-totalprice-and-all-of-the-other-numerical-variables.-list-the-three-variables-in-order-along-with-their-correlation-coefficients-that-have-the-highest-correlation-with-totalprice." class="level3">
<h3 class="anchored" data-anchor-id="c-compute-the-correlation-between-totalprice-and-all-of-the-other-numerical-variables.-list-the-three-variables-in-order-along-with-their-correlation-coefficients-that-have-the-highest-correlation-with-totalprice.">(c) Compute the correlation between <code>totalprice</code> and all of the other numerical variables. List the three variables in order along with their correlation coefficients that have the highest correlation with <code>totalprice</code>.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>num_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"area"</span>, <span class="st">"age"</span>, <span class="st">"floor"</span>, <span class="st">"rooms"</span>, <span class="st">"toilets"</span>, <span class="st">"garage"</span>, </span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"elevator"</span>, <span class="st">"storage"</span>)</span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>correlations <span class="ot">&lt;-</span> <span class="fu">sapply</span>(num_vars, <span class="cf">function</span>(var) {</span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(VIT2005<span class="sc">$</span>totalprice, VIT2005[[var]], <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by absolute correlation</span></span>
<span id="cb339-8"><a href="#cb339-8" aria-hidden="true" tabindex="-1"></a>sorted_cors <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">abs</span>(correlations), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb339-9"><a href="#cb339-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Top 3 variables by correlation with totalprice:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Top 3 variables by correlation with totalprice:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">names</span>(sorted_cors)[i]</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(i, <span class="st">"."</span>, var_name, <span class="st">": r ="</span>, correlations[var_name], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 . area : r = 0.8092125 
2 . toilets : r = 0.6875706 
3 . rooms : r = 0.525627 </code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p><strong>Area</strong> is by far the most important predictor, with a correlation nearly 18% stronger than toilets and 54% stronger than rooms</p></li>
<li><p>All three top correlations are positive, which makes intuitive sense: larger apartments with more amenities command higher prices</p></li>
<li><p>The correlations confirm what was observed in the scatterplot matrix (Part b)</p></li>
<li><p>These three variables are likely to be the most important predictors in the regression models</p></li>
</ul>
</section>
<section id="model-a-1" class="level2">
<h2 class="anchored" data-anchor-id="model-a-1">Model (A)</h2>
<p>Use backward elimination to develop a model that predicts <code>totalprice</code> using the data frame <code>VIT2005</code>. Use a “p-value to remove” of 5%. Store the final model in the object <code>modelA</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start with full model</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(totalprice <span class="sc">~</span> ., <span class="at">data =</span> VIT2005)</span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Backward elimination - step() with default k=2 approximates p=0.05</span></span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>modelA <span class="ot">&lt;-</span> <span class="fu">step</span>(full_model, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">trace =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4412.62
totalprice ~ area + zone + category + age + floor + rooms + out + 
    conservation + toilets + garage + elevator + streetcategory + 
    heating + storage

                 Df  Sum of Sq        RSS    AIC
- conservation    3 1.0031e+09 8.6894e+10 4409.2
- age             1 3.7563e+06 8.5895e+10 4410.6
- floor           1 3.8440e+07 8.5929e+10 4410.7
&lt;none&gt;                         8.5891e+10 4412.6
- rooms           1 1.0656e+09 8.6956e+10 4413.3
- storage         1 1.6433e+09 8.7534e+10 4414.8
- streetcategory  3 3.5550e+09 8.9446e+10 4415.5
- out             3 3.8946e+09 8.9785e+10 4416.3
- heating         3 4.3202e+09 9.0211e+10 4417.3
- toilets         1 4.7971e+09 9.0688e+10 4422.5
- category        6 9.5199e+09 9.5411e+10 4423.5
- elevator        1 5.4265e+09 9.1317e+10 4424.0
- garage          1 1.4771e+10 1.0066e+11 4445.2
- area            1 4.4519e+10 1.3041e+11 4501.7
- zone           22 1.1171e+11 1.9760e+11 4550.3

Step:  AIC=4409.15
totalprice ~ area + zone + category + age + floor + rooms + out + 
    toilets + garage + elevator + streetcategory + heating + 
    storage

                 Df  Sum of Sq        RSS    AIC
- floor           1 5.9549e+07 8.6953e+10 4407.3
- age             1 3.5042e+08 8.7244e+10 4408.0
&lt;none&gt;                         8.6894e+10 4409.2
- rooms           1 1.0092e+09 8.7903e+10 4409.7
- storage         1 1.4880e+09 8.8382e+10 4410.9
- streetcategory  3 3.7183e+09 9.0612e+10 4412.3
- out             3 3.8374e+09 9.0731e+10 4412.6
- heating         3 4.2447e+09 9.1139e+10 4413.6
- toilets         1 5.0721e+09 9.1966e+10 4419.5
- elevator        1 5.1385e+09 9.2032e+10 4419.7
- category        6 1.0858e+10 9.7752e+10 4422.8
- garage          1 1.5584e+10 1.0248e+11 4443.1
- area            1 4.4285e+10 1.3118e+11 4496.9
- zone           22 1.1188e+11 1.9877e+11 4545.5

Step:  AIC=4407.3
totalprice ~ area + zone + category + age + rooms + out + toilets + 
    garage + elevator + streetcategory + heating + storage

                 Df  Sum of Sq        RSS    AIC
- age             1 3.3429e+08 8.7288e+10 4406.1
&lt;none&gt;                         8.6953e+10 4407.3
- rooms           1 1.0142e+09 8.7968e+10 4407.8
- storage         1 1.4312e+09 8.8385e+10 4408.9
- streetcategory  3 3.6588e+09 9.0612e+10 4410.3
- out             3 3.8396e+09 9.0793e+10 4410.7
- heating         3 4.2829e+09 9.1236e+10 4411.8
- toilets         1 5.0904e+09 9.2044e+10 4417.7
- elevator        1 5.2245e+09 9.2178e+10 4418.0
- category        6 1.1152e+10 9.8105e+10 4421.6
- garage          1 1.5537e+10 1.0249e+11 4441.1
- area            1 4.4227e+10 1.3118e+11 4494.9
- zone           22 1.1657e+11 2.0352e+11 4548.7

Step:  AIC=4406.14
totalprice ~ area + zone + category + rooms + out + toilets + 
    garage + elevator + streetcategory + heating + storage

                 Df  Sum of Sq        RSS    AIC
&lt;none&gt;                         8.7288e+10 4406.1
- rooms           1 1.0246e+09 8.8312e+10 4406.7
- storage         1 1.6695e+09 8.8957e+10 4408.3
- streetcategory  3 3.5484e+09 9.0836e+10 4408.8
- heating         3 3.9987e+09 9.1286e+10 4409.9
- out             3 4.5287e+09 9.1816e+10 4411.2
- toilets         1 5.1432e+09 9.2431e+10 4416.6
- elevator        1 5.7882e+09 9.3076e+10 4418.1
- category        6 1.2678e+10 9.9966e+10 4423.7
- garage          1 1.5621e+10 1.0291e+11 4440.0
- area            1 4.4067e+10 1.3135e+11 4493.2
- zone           22 1.1785e+11 2.0514e+11 4548.4</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model A Formula:"</span>, <span class="fu">deparse</span>(<span class="fu">formula</span>(modelA)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model A Formula: totalprice ~ area + zone + category + rooms + out + toilets +      garage + elevator + streetcategory + heating + storage </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = totalprice ~ area + zone + category + rooms + out + 
    toilets + garage + elevator + streetcategory + heating + 
    storage, data = VIT2005)

Residuals:
   Min     1Q Median     3Q    Max 
-69950 -12745   -961  13237  66755 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       80599.6    26107.1   3.087 0.002351 ** 
area               1322.3      141.1   9.372  &lt; 2e-16 ***
zoneZ21           92150.3    13229.1   6.966 6.45e-11 ***
zoneZ31           77707.2    13945.2   5.572 9.42e-08 ***
zoneZ32           39469.1    12287.0   3.212 0.001569 ** 
zoneZ34           14216.2    15558.2   0.914 0.362114    
zoneZ35           60344.5    14995.8   4.024 8.52e-05 ***
zoneZ36           35853.8    12658.2   2.832 0.005164 ** 
zoneZ37           72839.7    12831.9   5.676 5.65e-08 ***
zoneZ38           22527.3    15681.3   1.437 0.152635    
zoneZ41           51093.9    12166.9   4.199 4.26e-05 ***
zoneZ42           80819.5    15556.6   5.195 5.67e-07 ***
zoneZ43           33210.9    15708.0   2.114 0.035918 *  
zoneZ44           19876.7    15246.7   1.304 0.194067    
zoneZ45           11325.7    12814.3   0.884 0.378007    
zoneZ46            5636.1    13651.0   0.413 0.680208    
zoneZ47          -11740.5    14084.1  -0.834 0.405649    
zoneZ48           32863.5    13988.2   2.349 0.019927 *  
zoneZ49           27986.2    14828.3   1.887 0.060779 .  
zoneZ52            2667.7    12863.1   0.207 0.835945    
zoneZ53           18018.7    12952.8   1.391 0.165968    
zoneZ56           21174.7    14549.4   1.455 0.147371    
zoneZ61           14905.7    12119.1   1.230 0.220383    
zoneZ62           12390.5    12234.2   1.013 0.312571    
category2B        -1008.8    14614.8  -0.069 0.945046    
category3A       -22986.7    14218.7  -1.617 0.107766    
category3B       -27321.2    14602.4  -1.871 0.063023 .  
category4A       -35752.3    15152.9  -2.359 0.019411 *  
category4B       -44969.8    15891.3  -2.830 0.005205 ** 
category5A       -76306.3    24895.8  -3.065 0.002524 ** 
rooms              5018.8     3511.8   1.429 0.154753    
outE25            37676.9    14528.3   2.593 0.010314 *  
outE50            -4121.3     3978.3  -1.036 0.301657    
outE75             4746.9    10384.4   0.457 0.648155    
toilets           18088.7     5649.3   3.202 0.001623 ** 
garage            25448.3     4560.4   5.580 9.06e-08 ***
elevator          19649.7     5784.8   3.397 0.000845 ***
streetcategoryS3  13081.0     5769.9   2.267 0.024614 *  
streetcategoryS4   8462.3     6261.4   1.351 0.178290    
streetcategoryS5  -4864.0    10413.0  -0.467 0.641003    
heating3A         -9733.0    11977.0  -0.813 0.417533    
heating3B         -2219.0    15287.9  -0.145 0.884765    
heating4A          2824.2    12662.7   0.223 0.823768    
storage            8250.5     4522.6   1.824 0.069826 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 22400 on 174 degrees of freedom
Multiple R-squared:  0.9162,    Adjusted R-squared:  0.8955 
F-statistic: 44.26 on 43 and 174 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Model Selection Process:</strong></p>
<p>The backward elimination procedure removed the following variables (in order):</p>
<ol type="1">
<li><p><strong>Conservation</strong> (Step 1) - Not significant</p></li>
<li><p><strong>Age</strong> (Step 2) - Not significant</p></li>
<li><p><strong>Floor</strong> (Step 3) - Not significant</p></li>
</ol>
<p><strong>Final Model A</strong> retained these predictors:</p>
<ul>
<li>area, zone, category, rooms, out, toilets, garage, elevator, streetcategory, heating, storage</li>
</ul>
<section id="i-compute-cv_n-the-leave-one-out-cross-validation-error-for-modela.-set-the-seed-to-5-and-compute-cv_5-the-five-fold-cross-validation-error-for-modela.-the-cross-validation-error-for-a-generalized-linear-model-can-be-computed-using-the-cv.glm-function-from-the-boot-package.-using-the-function-glm-without-passing-a-family-argument-is-the-same-as-using-the-function-lm.-r-code-2-provides-a-template-of-how-to-use-the-cv.glm-function.-note-that-cv_n-is-returned-with-cv.errordelta1.-to-compute-cv_5-pass-the-value-5-to-the-argument-k-inside-the-cv.glm-function." class="level4">
<h4 class="anchored" data-anchor-id="i-compute-cv_n-the-leave-one-out-cross-validation-error-for-modela.-set-the-seed-to-5-and-compute-cv_5-the-five-fold-cross-validation-error-for-modela.-the-cross-validation-error-for-a-generalized-linear-model-can-be-computed-using-the-cv.glm-function-from-the-boot-package.-using-the-function-glm-without-passing-a-family-argument-is-the-same-as-using-the-function-lm.-r-code-2-provides-a-template-of-how-to-use-the-cv.glm-function.-note-that-cv_n-is-returned-with-cv.errordelta1.-to-compute-cv_5-pass-the-value-5-to-the-argument-k-inside-the-cv.glm-function.">(i) Compute <span class="math inline">\(CV_n\)</span>, the leave-one-out cross validation error, for <code>modelA</code>. Set the seed to 5 and compute <span class="math inline">\(CV_5\)</span>, the five-fold cross validation error, for <code>modelA</code>. The cross validation error for a generalized linear model can be computed using the <code>cv.glm()</code> function from the <code>boot</code> package. Using the function <code>glm()</code> without passing a family argument is the same as using the function <code>lm()</code>. R Code 2 provides a template of how to use the <code>cv.glm()</code> function. Note that <span class="math inline">\(CV_n\)</span> is returned with <code>cv.error$delta[1]</code>. To compute <span class="math inline">\(CV_5\)</span>, pass the value 5 to the argument <span class="math inline">\(K\)</span> inside the <code>cv.glm()</code> function.</h4>
<pre><code>– R Code 2
&gt; mod.glm &lt;- glm(y ~ x1 + x2, data = DF)
&gt; library(boot)
&gt; cv.error &lt;- cv.glm(data = DF, glmfit = mod.glm)
&gt; cv.error$delta[1]</code></pre>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>modelA_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">formula</span>(modelA), <span class="at">data =</span> VIT2005)</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="co"># CV_n (leave-one-out)</span></span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>cv_n_A <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelA_glm)</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_n (LOOCV):"</span>, cv_n_A<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_n (LOOCV): 640530644 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CV_5 (5-fold)</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a>cv_5_A <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelA_glm, <span class="at">K =</span> <span class="dv">5</span>)</span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_5:"</span>, cv_5_A<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_5: 647819847 </code></pre>
</div>
</div>
<ul>
<li><p><strong>CV_n (Leave-One-Out Cross-Validation)</strong>: 640,530,644</p></li>
<li><p><strong>CV_5 (5-Fold Cross-Validation)</strong>: 647,819,847</p></li>
</ul>
<p>Both CV errors are in squared euros (€²), representing the mean squared prediction error. The CV_5 is slightly higher than CV_n, which is typical due to the smaller training sets in k-fold CV.</p>
</section>
<section id="ii-compute-r2-r2_a-the-aic-and-the-bic-for-model-a.-what-is-the-proportion-of-total-variability-explained-by-model-a" class="level4">
<h4 class="anchored" data-anchor-id="ii-compute-r2-r2_a-the-aic-and-the-bic-for-model-a.-what-is-the-proportion-of-total-variability-explained-by-model-a">(ii) Compute <span class="math inline">\(R^2, R^2_a\)</span>, the AIC, and the BIC for Model (A). What is the proportion of total variability explained by Model (A)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>summary_A <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelA)</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model A Metrics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model A Metrics ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, summary_A<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.9162381 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Adjusted R-squared:"</span>, summary_A<span class="sc">$</span>adj.r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R-squared: 0.8955384 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(modelA), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 5026.797 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC:"</span>, <span class="fu">BIC</span>(modelA), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC: 5179.099 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Proportion of variability explained:"</span>, summary_A<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Proportion of variability explained: 0.9162381 </code></pre>
</div>
</div>
<p><strong>Proportion of variability explained</strong>: <strong>91.62%</strong></p>
<p><strong>Interpretation:</strong></p>
<p><strong>Model A explains approximately 91.62% of the total variability in apartment prices.</strong> This is an excellent fit, indicating that the selected predictors (11 variables including categorical factors) capture most of the variation in total price.</p>
<p>The adjusted R² (89.55%) is slightly lower than R², accounting for the number of predictors in the model (43 regression coefficients total when including all factor levels). The relatively small difference between R² and adjusted R² suggests the model is not overly complex.</p>
<p><strong>Key Significant Predictors (p &lt; 0.05):</strong></p>
<ol type="1">
<li><p><strong>Area</strong> (p &lt; 2e-16): Most important predictor, coefficient = €1,322 per m²</p></li>
<li><p><strong>Garage</strong> (p = 9.06e-08): €25,448 increase per garage</p></li>
<li><p><strong>Toilets</strong> (p = 0.00162): €18,089 per additional toilet</p></li>
<li><p><strong>Elevator</strong> (p = 0.000845): €19,650 for having elevator</p></li>
<li><p><strong>Zone</strong>: Many zones significantly different from reference (e.g., Z21: +€92,150)</p></li>
<li><p><strong>Category</strong>: Several categories significantly affect price</p></li>
<li><p><strong>Street category S3</strong>: +€13,081</p></li>
</ol>
</section>
</section>
<section id="model-b-1" class="level2">
<h2 class="anchored" data-anchor-id="model-b-1">Model (B)</h2>
<p>Use the criterion-based procedure AIC, which for linear regression is equivalent to Mallow’s Cp, to develop a model that predicts <code>totalprice</code> using the variables in <code>VIT2005</code>. Store the model in the object <code>modelB</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use stepAIC for AIC-based selection (equivalent to Cp for linear regression)</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>modelB <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full_model, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="dv">1</span>, <span class="at">k =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4412.62
totalprice ~ area + zone + category + age + floor + rooms + out + 
    conservation + toilets + garage + elevator + streetcategory + 
    heating + storage

                 Df  Sum of Sq        RSS    AIC
- conservation    3 1.0031e+09 8.6894e+10 4409.2
- age             1 3.7563e+06 8.5895e+10 4410.6
- floor           1 3.8440e+07 8.5929e+10 4410.7
&lt;none&gt;                         8.5891e+10 4412.6
- rooms           1 1.0656e+09 8.6956e+10 4413.3
- storage         1 1.6433e+09 8.7534e+10 4414.8
- streetcategory  3 3.5550e+09 8.9446e+10 4415.5
- out             3 3.8946e+09 8.9785e+10 4416.3
- heating         3 4.3202e+09 9.0211e+10 4417.3
- toilets         1 4.7971e+09 9.0688e+10 4422.5
- category        6 9.5199e+09 9.5411e+10 4423.5
- elevator        1 5.4265e+09 9.1317e+10 4424.0
- garage          1 1.4771e+10 1.0066e+11 4445.2
- area            1 4.4519e+10 1.3041e+11 4501.7
- zone           22 1.1171e+11 1.9760e+11 4550.3

Step:  AIC=4409.15
totalprice ~ area + zone + category + age + floor + rooms + out + 
    toilets + garage + elevator + streetcategory + heating + 
    storage

                 Df  Sum of Sq        RSS    AIC
- floor           1 5.9549e+07 8.6953e+10 4407.3
- age             1 3.5042e+08 8.7244e+10 4408.0
&lt;none&gt;                         8.6894e+10 4409.2
- rooms           1 1.0092e+09 8.7903e+10 4409.7
- storage         1 1.4880e+09 8.8382e+10 4410.9
- streetcategory  3 3.7183e+09 9.0612e+10 4412.3
- out             3 3.8374e+09 9.0731e+10 4412.6
+ conservation    3 1.0031e+09 8.5891e+10 4412.6
- heating         3 4.2447e+09 9.1139e+10 4413.6
- toilets         1 5.0721e+09 9.1966e+10 4419.5
- elevator        1 5.1385e+09 9.2032e+10 4419.7
- category        6 1.0858e+10 9.7752e+10 4422.8
- garage          1 1.5584e+10 1.0248e+11 4443.1
- area            1 4.4285e+10 1.3118e+11 4496.9
- zone           22 1.1188e+11 1.9877e+11 4545.5

Step:  AIC=4407.3
totalprice ~ area + zone + category + age + rooms + out + toilets + 
    garage + elevator + streetcategory + heating + storage

                 Df  Sum of Sq        RSS    AIC
- age             1 3.3429e+08 8.7288e+10 4406.1
&lt;none&gt;                         8.6953e+10 4407.3
- rooms           1 1.0142e+09 8.7968e+10 4407.8
- storage         1 1.4312e+09 8.8385e+10 4408.9
+ floor           1 5.9549e+07 8.6894e+10 4409.2
- streetcategory  3 3.6588e+09 9.0612e+10 4410.3
+ conservation    3 1.0242e+09 8.5929e+10 4410.7
- out             3 3.8396e+09 9.0793e+10 4410.7
- heating         3 4.2829e+09 9.1236e+10 4411.8
- toilets         1 5.0904e+09 9.2044e+10 4417.7
- elevator        1 5.2245e+09 9.2178e+10 4418.0
- category        6 1.1152e+10 9.8105e+10 4421.6
- garage          1 1.5537e+10 1.0249e+11 4441.1
- area            1 4.4227e+10 1.3118e+11 4494.9
- zone           22 1.1657e+11 2.0352e+11 4548.7

Step:  AIC=4406.14
totalprice ~ area + zone + category + rooms + out + toilets + 
    garage + elevator + streetcategory + heating + storage

                 Df  Sum of Sq        RSS    AIC
&lt;none&gt;                         8.7288e+10 4406.1
- rooms           1 1.0246e+09 8.8312e+10 4406.7
+ age             1 3.3429e+08 8.6953e+10 4407.3
+ floor           1 4.3417e+07 8.7244e+10 4408.0
- storage         1 1.6695e+09 8.8957e+10 4408.3
+ conservation    3 1.3563e+09 8.5931e+10 4408.7
- streetcategory  3 3.5484e+09 9.0836e+10 4408.8
- heating         3 3.9987e+09 9.1286e+10 4409.9
- out             3 4.5287e+09 9.1816e+10 4411.2
- toilets         1 5.1432e+09 9.2431e+10 4416.6
- elevator        1 5.7882e+09 9.3076e+10 4418.1
- category        6 1.2678e+10 9.9966e+10 4423.7
- garage          1 1.5621e+10 1.0291e+11 4440.0
- area            1 4.4067e+10 1.3135e+11 4493.2
- zone           22 1.1785e+11 2.0514e+11 4548.4</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model B Formula:"</span>, <span class="fu">deparse</span>(<span class="fu">formula</span>(modelB)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model B Formula: totalprice ~ area + zone + category + rooms + out + toilets +      garage + elevator + streetcategory + heating + storage </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelB)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = totalprice ~ area + zone + category + rooms + out + 
    toilets + garage + elevator + streetcategory + heating + 
    storage, data = VIT2005)

Residuals:
   Min     1Q Median     3Q    Max 
-69950 -12745   -961  13237  66755 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       80599.6    26107.1   3.087 0.002351 ** 
area               1322.3      141.1   9.372  &lt; 2e-16 ***
zoneZ21           92150.3    13229.1   6.966 6.45e-11 ***
zoneZ31           77707.2    13945.2   5.572 9.42e-08 ***
zoneZ32           39469.1    12287.0   3.212 0.001569 ** 
zoneZ34           14216.2    15558.2   0.914 0.362114    
zoneZ35           60344.5    14995.8   4.024 8.52e-05 ***
zoneZ36           35853.8    12658.2   2.832 0.005164 ** 
zoneZ37           72839.7    12831.9   5.676 5.65e-08 ***
zoneZ38           22527.3    15681.3   1.437 0.152635    
zoneZ41           51093.9    12166.9   4.199 4.26e-05 ***
zoneZ42           80819.5    15556.6   5.195 5.67e-07 ***
zoneZ43           33210.9    15708.0   2.114 0.035918 *  
zoneZ44           19876.7    15246.7   1.304 0.194067    
zoneZ45           11325.7    12814.3   0.884 0.378007    
zoneZ46            5636.1    13651.0   0.413 0.680208    
zoneZ47          -11740.5    14084.1  -0.834 0.405649    
zoneZ48           32863.5    13988.2   2.349 0.019927 *  
zoneZ49           27986.2    14828.3   1.887 0.060779 .  
zoneZ52            2667.7    12863.1   0.207 0.835945    
zoneZ53           18018.7    12952.8   1.391 0.165968    
zoneZ56           21174.7    14549.4   1.455 0.147371    
zoneZ61           14905.7    12119.1   1.230 0.220383    
zoneZ62           12390.5    12234.2   1.013 0.312571    
category2B        -1008.8    14614.8  -0.069 0.945046    
category3A       -22986.7    14218.7  -1.617 0.107766    
category3B       -27321.2    14602.4  -1.871 0.063023 .  
category4A       -35752.3    15152.9  -2.359 0.019411 *  
category4B       -44969.8    15891.3  -2.830 0.005205 ** 
category5A       -76306.3    24895.8  -3.065 0.002524 ** 
rooms              5018.8     3511.8   1.429 0.154753    
outE25            37676.9    14528.3   2.593 0.010314 *  
outE50            -4121.3     3978.3  -1.036 0.301657    
outE75             4746.9    10384.4   0.457 0.648155    
toilets           18088.7     5649.3   3.202 0.001623 ** 
garage            25448.3     4560.4   5.580 9.06e-08 ***
elevator          19649.7     5784.8   3.397 0.000845 ***
streetcategoryS3  13081.0     5769.9   2.267 0.024614 *  
streetcategoryS4   8462.3     6261.4   1.351 0.178290    
streetcategoryS5  -4864.0    10413.0  -0.467 0.641003    
heating3A         -9733.0    11977.0  -0.813 0.417533    
heating3B         -2219.0    15287.9  -0.145 0.884765    
heating4A          2824.2    12662.7   0.223 0.823768    
storage            8250.5     4522.6   1.824 0.069826 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 22400 on 174 degrees of freedom
Multiple R-squared:  0.9162,    Adjusted R-squared:  0.8955 
F-statistic: 44.26 on 43 and 174 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Model B: AIC-Based Selection Results</p>
<p><strong>Model Selection Process:</strong></p>
<p>The <code>stepAIC</code> function with AIC criterion (k=2, equivalent to Mallow’s Cp for linear regression) performed <strong>bidirectional selection</strong> (both forward and backward steps).</p>
<p><strong>Final Model B</strong> includes the same predictors as Model A:</p>
<ul>
<li>area, zone, category, rooms, out, toilets, garage, elevator, streetcategory, heating, storage</li>
</ul>
<p><strong>Note</strong>: Model B is <strong>identical to Model A</strong>. The AIC-based stepwise selection and backward elimination both converged to the same final model, which indicates this is a robust model specification.</p>
<section id="i-compute-cv_n-for-modelb.-set-the-seed-to-5-and-compute-cv_5-for-modelb." class="level4">
<h4 class="anchored" data-anchor-id="i-compute-cv_n-for-modelb.-set-the-seed-to-5-and-compute-cv_5-for-modelb.">(i) Compute <span class="math inline">\(CV_n\)</span> for <code>modelB</code>. Set the seed to 5 and compute <span class="math inline">\(CV_5\)</span> for <code>modelB</code>.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (i) Cross-validation for Model B</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model B Cross-Validation ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model B Cross-Validation ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>modelB_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">formula</span>(modelB), <span class="at">data =</span> VIT2005)</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>cv_n_B <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelB_glm)</span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_n (LOOCV):"</span>, cv_n_B<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_n (LOOCV): 640530644 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>cv_5_B <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelB_glm, <span class="at">K =</span> <span class="dv">5</span>)</span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_5:"</span>, cv_5_B<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_5: 647819847 </code></pre>
</div>
</div>
<ul>
<li><p><strong>CV_n (Leave-One-Out Cross-Validation)</strong>: 640,530,644</p></li>
<li><p><strong>CV_5 (5-Fold Cross-Validation)</strong>: 647,819,847</p></li>
</ul>
<p>These values are identical to Model A because both models have the same predictors.</p>
</section>
<section id="ii-compute-r2-r2_a-the-aic-and-the-bic-for-model-b.-what-is-the-proportion-of-total-variability-explained-by-model-b" class="level4">
<h4 class="anchored" data-anchor-id="ii-compute-r2-r2_a-the-aic-and-the-bic-for-model-b.-what-is-the-proportion-of-total-variability-explained-by-model-b">(ii) Compute <span class="math inline">\(R^2, R^2_a\)</span>, the AIC, and the BIC for Model (B). What is the proportion of total variability explained by Model (B)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (ii) Model metrics</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>summary_B <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelB)</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model B Metrics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model B Metrics ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, summary_B<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.9162381 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Adjusted R-squared:"</span>, summary_B<span class="sc">$</span>adj.r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R-squared: 0.8955384 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(modelB), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 5026.797 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC:"</span>, <span class="fu">BIC</span>(modelB), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC: 5179.099 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Proportion of variability explained:"</span>, summary_B<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Proportion of variability explained: 0.9162381 </code></pre>
</div>
</div>
<p><strong>Proportion of variability explained</strong>: <strong>91.62%</strong></p>
<p><strong>Interpretation:</strong></p>
<p><strong>Model B explains 91.62% of the total variability in apartment prices</strong>, which is excellent predictive performance.</p>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><p><strong>Model Equivalence</strong>: The fact that both backward elimination (Model A) and AIC-based selection (Model B) yielded identical models provides strong evidence that this variable subset is optimal for prediction.</p></li>
<li><p><strong>Model Complexity</strong>: With 43 coefficients (including all factor levels), the model is reasonably parsimonious given the data size (218 observations) and achieves high predictive accuracy.</p></li>
<li><p><strong>Most Important Predictors</strong> (based on p-values and effect sizes):</p>
<ul>
<li><p><strong>Area</strong>: €1,322 per m² (p &lt; 2e-16) - strongest predictor</p></li>
<li><p><strong>Zone</strong>: Highly significant overall effect</p></li>
<li><p><strong>Garage</strong>: €25,448 per garage (p = 9.06e-08)</p></li>
<li><p><strong>Elevator</strong>: €19,650 premium (p = 0.000845)</p></li>
<li><p><strong>Toilets</strong>: €18,089 per toilet (p = 0.00162)</p></li>
</ul></li>
<li><p><strong>Variables Not Significant</strong> at α = 0.05:</p>
<ul>
<li><p>rooms, heating, some zone and category levels</p></li>
<li><p>However, they contribute to overall model fit and may improve prediction</p></li>
</ul></li>
</ol>
</section>
</section>
<section id="model-c-1" class="level2">
<h2 class="anchored" data-anchor-id="model-c-1">Model (C)</h2>
<p>Use the criterion-based procedure BIC to develop a model that predicts <code>totalprice</code> using the variables in <code>VIT2005</code>. Store the model in the object <code>modelC</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb390"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use stepAIC with k = log(n) for BIC</span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a>modelC <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full_model, <span class="at">direction =</span> <span class="st">"both"</span>, </span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="fu">log</span>(<span class="fu">nrow</span>(VIT2005)), <span class="at">trace =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4578.46
totalprice ~ area + zone + category + age + floor + rooms + out + 
    conservation + toilets + garage + elevator + streetcategory + 
    heating + storage

                 Df  Sum of Sq        RSS    AIC
- conservation    3 1.0031e+09 8.6894e+10 4564.8
- category        6 9.5199e+09 9.5411e+10 4569.1
- streetcategory  3 3.5550e+09 8.9446e+10 4571.2
- out             3 3.8946e+09 8.9785e+10 4572.0
- heating         3 4.3202e+09 9.0211e+10 4573.0
- age             1 3.7563e+06 8.5895e+10 4573.1
- floor           1 3.8440e+07 8.5929e+10 4573.2
- rooms           1 1.0656e+09 8.6956e+10 4575.8
- storage         1 1.6433e+09 8.7534e+10 4577.2
&lt;none&gt;                         8.5891e+10 4578.5
- toilets         1 4.7971e+09 9.0688e+10 4584.9
- elevator        1 5.4265e+09 9.1317e+10 4586.4
- garage          1 1.4771e+10 1.0066e+11 4607.7
- zone           22 1.1171e+11 1.9760e+11 4641.6
- area            1 4.4519e+10 1.3041e+11 4664.1

Step:  AIC=4564.84
totalprice ~ area + zone + category + age + floor + rooms + out + 
    toilets + garage + elevator + streetcategory + heating + 
    storage

                 Df  Sum of Sq        RSS    AIC
- streetcategory  3 3.7183e+09 9.0612e+10 4557.8
- out             3 3.8374e+09 9.0731e+10 4558.1
- category        6 1.0858e+10 9.7752e+10 4558.2
- heating         3 4.2447e+09 9.1139e+10 4559.1
- floor           1 5.9549e+07 8.6953e+10 4559.6
- age             1 3.5042e+08 8.7244e+10 4560.3
- rooms           1 1.0092e+09 8.7903e+10 4562.0
- storage         1 1.4880e+09 8.8382e+10 4563.2
&lt;none&gt;                         8.6894e+10 4564.8
- toilets         1 5.0721e+09 9.1966e+10 4571.8
- elevator        1 5.1385e+09 9.2032e+10 4572.0
+ conservation    3 1.0031e+09 8.5891e+10 4578.5
- garage          1 1.5584e+10 1.0248e+11 4595.4
- zone           22 1.1188e+11 1.9877e+11 4626.8
- area            1 4.4285e+10 1.3118e+11 4649.2

Step:  AIC=4557.82
totalprice ~ area + zone + category + age + floor + rooms + out + 
    toilets + garage + elevator + heating + storage

                 Df  Sum of Sq        RSS    AIC
- out             3 3.8462e+09 9.4458e+10 4550.7
- category        6 1.1672e+10 1.0228e+11 4551.9
- floor           1 7.5330e+03 9.0612e+10 4552.4
- heating         3 4.7633e+09 9.5376e+10 4552.8
- age             1 2.2348e+08 9.0836e+10 4553.0
- rooms           1 8.6182e+08 9.1474e+10 4554.5
&lt;none&gt;                         9.0612e+10 4557.8
- storage         1 2.5185e+09 9.3131e+10 4558.4
- elevator        1 4.7743e+09 9.5387e+10 4563.6
- toilets         1 5.3006e+09 9.5913e+10 4564.8
+ streetcategory  3 3.7183e+09 8.6894e+10 4564.8
+ conservation    3 1.1664e+09 8.9446e+10 4571.2
- garage          1 1.6104e+10 1.0672e+11 4588.1
- zone           22 1.1352e+11 2.0414e+11 4616.4
- area            1 4.2961e+10 1.3357e+11 4637.0

Step:  AIC=4550.73
totalprice ~ area + zone + category + age + floor + rooms + toilets + 
    garage + elevator + heating + storage

                 Df  Sum of Sq        RSS    AIC
- category        6 1.0064e+10 1.0452e+11 4540.5
- heating         3 4.4784e+09 9.8937e+10 4544.7
- floor           1 4.4199e+05 9.4459e+10 4545.3
- age             1 8.3305e+08 9.5291e+10 4547.3
- rooms           1 1.1733e+09 9.5632e+10 4548.0
&lt;none&gt;                         9.4458e+10 4550.7
- storage         1 2.4846e+09 9.6943e+10 4551.0
- toilets         1 5.1279e+09 9.9586e+10 4556.9
- elevator        1 5.2630e+09 9.9721e+10 4557.2
+ out             3 3.8462e+09 9.0612e+10 4557.8
+ streetcategory  3 3.7271e+09 9.0731e+10 4558.1
+ conservation    3 1.1347e+09 9.3324e+10 4564.2
- garage          1 1.5435e+10 1.0989e+11 4578.3
- zone           22 1.1388e+11 2.0833e+11 4604.7
- area            1 4.2318e+10 1.3678e+11 4626.0

Step:  AIC=4540.49
totalprice ~ area + zone + age + floor + rooms + toilets + garage + 
    elevator + heating + storage

                 Df  Sum of Sq        RSS    AIC
- floor           1 1.3705e+08 1.0466e+11 4535.4
- heating         3 5.9305e+09 1.1045e+11 4536.4
- rooms           1 6.6194e+08 1.0518e+11 4536.5
- storage         1 1.5555e+09 1.0608e+11 4538.3
- age             1 2.3281e+09 1.0685e+11 4539.9
&lt;none&gt;                         1.0452e+11 4540.5
+ streetcategory  3 4.6430e+09 9.9879e+10 4546.7
- elevator        1 7.4871e+09 1.1201e+11 4550.2
+ category        6 1.0064e+10 9.4458e+10 4550.7
+ conservation    3 2.5512e+09 1.0197e+11 4551.3
+ out             3 2.2384e+09 1.0228e+11 4551.9
- toilets         1 1.0294e+10 1.1482e+11 4555.6
- garage          1 1.7960e+10 1.2248e+11 4569.7
- zone           22 1.1872e+11 2.2324e+11 4587.5
- area            1 4.7025e+10 1.5155e+11 4616.1

Step:  AIC=4535.4
totalprice ~ area + zone + age + rooms + toilets + garage + elevator + 
    heating + storage

                 Df  Sum of Sq        RSS    AIC
- rooms           1 6.7193e+08 1.0533e+11 4531.4
- heating         3 6.1579e+09 1.1082e+11 4531.7
- storage         1 1.4340e+09 1.0609e+11 4533.0
- age             1 2.3118e+09 1.0697e+11 4534.8
&lt;none&gt;                         1.0466e+11 4535.4
+ floor           1 1.3705e+08 1.0452e+11 4540.5
+ streetcategory  3 4.4167e+09 1.0024e+11 4542.1
+ category        6 1.0200e+10 9.4459e+10 4545.3
- elevator        1 7.6558e+09 1.1232e+11 4545.4
+ conservation    3 2.5731e+09 1.0209e+11 4546.1
+ out             3 2.2544e+09 1.0240e+11 4546.8
- toilets         1 1.0279e+10 1.1494e+11 4550.4
- garage          1 1.7938e+10 1.2260e+11 4564.5
- zone           22 1.2206e+11 2.2672e+11 4585.5
- area            1 4.6918e+10 1.5158e+11 4610.8

Step:  AIC=4531.41
totalprice ~ area + zone + age + toilets + garage + elevator + 
    heating + storage

                 Df  Sum of Sq        RSS    AIC
- heating         3 6.3621e+09 1.1169e+11 4528.0
- storage         1 1.2973e+09 1.0663e+11 4528.7
- age             1 2.3565e+09 1.0769e+11 4530.8
&lt;none&gt;                         1.0533e+11 4531.4
+ rooms           1 6.7193e+08 1.0466e+11 4535.4
+ floor           1 1.4704e+08 1.0518e+11 4536.5
+ streetcategory  3 4.3749e+09 1.0096e+11 4538.3
+ out             3 2.5178e+09 1.0281e+11 4542.3
+ conservation    3 2.5046e+09 1.0283e+11 4542.3
- elevator        1 8.2036e+09 1.1353e+11 4542.4
+ category        6 9.6971e+09 9.5634e+10 4542.7
- toilets         1 1.0617e+10 1.1595e+11 4547.0
- garage          1 1.7896e+10 1.2323e+11 4560.2
- zone           22 1.2141e+11 2.2674e+11 4580.1
- area            1 6.5892e+10 1.7122e+11 4631.9

Step:  AIC=4528.04
totalprice ~ area + zone + age + toilets + garage + elevator + 
    storage

                 Df  Sum of Sq        RSS    AIC
- age             1 2.2351e+09 1.1393e+11 4527.0
- storage         1 2.4390e+09 1.1413e+11 4527.4
&lt;none&gt;                         1.1169e+11 4528.0
+ heating         3 6.3621e+09 1.0533e+11 4531.4
+ rooms           1 8.7606e+08 1.1082e+11 4531.7
+ floor           1 3.8691e+08 1.1131e+11 4532.7
+ streetcategory  3 5.0417e+09 1.0665e+11 4534.1
+ category        6 1.1326e+10 1.0037e+11 4537.0
+ conservation    3 2.3486e+09 1.0934e+11 4539.6
+ out             3 2.0803e+09 1.0961e+11 4540.1
- elevator        1 1.0574e+10 1.2227e+11 4542.4
- toilets         1 1.1732e+10 1.2343e+11 4544.4
- garage          1 1.7006e+10 1.2870e+11 4553.5
- zone           22 1.1938e+11 2.3107e+11 4568.1
- area            1 7.2822e+10 1.8452e+11 4632.1

Step:  AIC=4526.97
totalprice ~ area + zone + toilets + garage + elevator + storage

                 Df  Sum of Sq        RSS    AIC
&lt;none&gt;                         1.1393e+11 4527.0
+ age             1 2.2351e+09 1.1169e+11 4528.0
- storage         1 3.5733e+09 1.1750e+11 4528.3
+ rooms           1 8.8850e+08 1.1304e+11 4530.6
+ heating         3 6.2407e+09 1.0769e+11 4530.8
+ floor           1 3.9676e+08 1.1353e+11 4531.6
+ category        6 1.3189e+10 1.0074e+11 4532.5
+ streetcategory  3 4.5867e+09 1.0934e+11 4534.2
+ conservation    3 4.4201e+09 1.0951e+11 4534.5
+ out             3 2.7332e+09 1.1120e+11 4537.8
- toilets         1 1.2489e+10 1.2642e+11 4544.3
- elevator        1 1.2766e+10 1.2669e+11 4544.7
- garage          1 1.7837e+10 1.3177e+11 4553.3
- zone           22 1.2501e+11 2.3894e+11 4570.0
- area            1 7.0588e+10 1.8452e+11 4626.7</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model C Formula:"</span>, <span class="fu">deparse</span>(<span class="fu">formula</span>(modelC)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model C Formula: totalprice ~ area + zone + toilets + garage + elevator + storage </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelC)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = totalprice ~ area + zone + toilets + garage + elevator + 
    storage, data = VIT2005)

Residuals:
   Min     1Q Median     3Q    Max 
-76233 -12218  -1509  13786  77786 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  41058.3    12936.2   3.174 0.001755 ** 
area          1415.1      130.4  10.850  &lt; 2e-16 ***
zoneZ21     105018.5    13241.7   7.931 1.82e-13 ***
zoneZ31      85239.9    13285.7   6.416 1.09e-09 ***
zoneZ32      44075.5    12084.8   3.647 0.000342 ***
zoneZ34      22238.7    15144.3   1.468 0.143633    
zoneZ35      67174.5    15318.9   4.385 1.92e-05 ***
zoneZ36      41097.8    12870.2   3.193 0.001647 ** 
zoneZ37      72306.2    11931.0   6.060 7.16e-09 ***
zoneZ38      30956.5    15687.5   1.973 0.049909 *  
zoneZ41      62847.8    12118.1   5.186 5.47e-07 ***
zoneZ42      77841.0    14946.0   5.208 4.93e-07 ***
zoneZ43      51543.3    15393.3   3.348 0.000980 ***
zoneZ44      42801.9    15150.4   2.825 0.005231 ** 
zoneZ45      23963.2    12257.6   1.955 0.052054 .  
zoneZ46      19512.1    12567.7   1.553 0.122195    
zoneZ47       7852.8    13109.2   0.599 0.549868    
zoneZ48      42480.1    13699.7   3.101 0.002224 ** 
zoneZ49      36348.8    14856.2   2.447 0.015326 *  
zoneZ52       8434.1    12391.3   0.681 0.496927    
zoneZ53      28170.5    12668.9   2.224 0.027354 *  
zoneZ56      42421.2    13854.4   3.062 0.002518 ** 
zoneZ61      26489.4    11967.2   2.214 0.028053 *  
zoneZ62      25325.1    11276.6   2.246 0.025867 *  
toilets      25559.3     5600.5   4.564 9.00e-06 ***
garage       26542.0     4866.4   5.454 1.52e-07 ***
elevator     26776.4     5803.2   4.614 7.25e-06 ***
storage      11078.6     4538.3   2.441 0.015556 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 24490 on 190 degrees of freedom
Multiple R-squared:  0.8907,    Adjusted R-squared:  0.8751 
F-statistic: 57.33 on 27 and 190 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Model C: BIC-Based Selection Results</p>
<p><strong>Model Selection Process:</strong></p>
<p>The <code>stepAIC</code> function with BIC criterion (k = log(n) = log(218) ≈ 5.38) performed <strong>bidirectional selection</strong>.</p>
<p>The BIC criterion penalizes model complexity more heavily than AIC, leading to a <strong>more parsimonious model</strong>.</p>
<p><strong>Variables removed</strong> (in order):</p>
<ol type="1">
<li><p><strong>Conservation</strong> (Step 1)</p></li>
<li><p><strong>Streetcategory</strong> (Step 2)</p></li>
<li><p><strong>Out</strong> (Step 3)</p></li>
<li><p><strong>Category</strong> (Step 4)</p></li>
<li><p><strong>Floor</strong> (Step 5)</p></li>
<li><p><strong>Rooms</strong> (Step 6)</p></li>
<li><p><strong>Heating</strong> (Step 7)</p></li>
<li><p><strong>Age</strong> (Step 8)</p></li>
</ol>
<p><strong>Final Model C</strong> includes only <strong>6 predictors</strong>:</p>
<ul>
<li>area, zone, toilets, garage, elevator, storage</li>
</ul>
<p>This is a <strong>much simpler model</strong> than Models A and B (which had 11 predictors).</p>
<section id="i-compute-cv_n-for-modelc.-set-the-seed-to-5-and-compute-cv_5-for-modelc." class="level4">
<h4 class="anchored" data-anchor-id="i-compute-cv_n-for-modelc.-set-the-seed-to-5-and-compute-cv_5-for-modelc.">(i) Compute <span class="math inline">\(CV_n\)</span> for <code>modelC</code>. Set the seed to 5 and compute <span class="math inline">\(CV_5\)</span> for <code>modelC</code>.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (i) Cross-validation for Model C</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model C Cross-Validation ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model C Cross-Validation ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a>modelC_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">formula</span>(modelC), <span class="at">data =</span> VIT2005)</span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a>cv_n_C <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelC_glm)</span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_n (LOOCV):"</span>, cv_n_C<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_n (LOOCV): 694979921 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>cv_5_C <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelC_glm, <span class="at">K =</span> <span class="dv">5</span>)</span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_5:"</span>, cv_5_C<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_5: 726604599 </code></pre>
</div>
</div>
<ul>
<li><p><strong>CV_n (Leave-One-Out Cross-Validation)</strong>: 694,979,921</p></li>
<li><p><strong>CV_5 (5-Fold Cross-Validation)</strong>: 726,604,599</p></li>
</ul>
<p><strong>Note</strong>: Model C has <strong>higher CV errors</strong> than Models A and B, indicating somewhat worse out-of-sample prediction performance, which is the trade-off for the simpler model.</p>
</section>
<section id="ii-compute-r2-r2_a-the-aic-and-the-bic-for-model-c.-what-is-the-proportion-of-total-variability-explained-by-model-c" class="level4">
<h4 class="anchored" data-anchor-id="ii-compute-r2-r2_a-the-aic-and-the-bic-for-model-c.-what-is-the-proportion-of-total-variability-explained-by-model-c">(ii) Compute <span class="math inline">\(R^2, R^2_a\)</span>, the AIC, and the BIC for Model (C). What is the proportion of total variability explained by Model (C)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (ii) Model metrics</span></span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>summary_C <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelC)</span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model C Metrics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model C Metrics ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, summary_C<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.8906736 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Adjusted R-squared:"</span>, summary_C<span class="sc">$</span>adj.r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R-squared: 0.8751377 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(modelC), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 5052.864 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC:"</span>, <span class="fu">BIC</span>(modelC), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC: 5151.014 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Proportion of variability explained:"</span>, summary_C<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Proportion of variability explained: 0.8906736 </code></pre>
</div>
</div>
<p><strong>Proportion of variability explained</strong>: <strong>89.07%</strong></p>
<p><strong>Interpretation:</strong></p>
<p><strong>Model C explains 89.07% of the total variability in apartment prices</strong>, which is still very good, though slightly less than Models A and B (91.62%).</p>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><p><strong>Parsimony vs.&nbsp;Fit Trade-off</strong>: Model C sacrifices about 2.5% of explained variance to achieve a much simpler model with 16 fewer coefficients.</p></li>
<li><p><strong>BIC Preference</strong>: Model C has the <strong>lowest BIC</strong> (5151.014 vs 5179.099), making it the preferred model by the BIC criterion, which values simplicity.</p></li>
<li><p><strong>Significant Predictors</strong> (all p &lt; 0.05):</p>
<ul>
<li><p><strong>Area</strong>: €1,415 per m² (p &lt; 2e-16) - strongest predictor</p></li>
<li><p><strong>Garage</strong>: €26,542 per garage (p = 1.52e-07)</p></li>
<li><p><strong>Elevator</strong>: €26,776 premium (p = 7.25e-06)</p></li>
<li><p><strong>Toilets</strong>: €25,559 per toilet (p = 9.00e-06)</p></li>
<li><p><strong>Storage</strong>: €11,079 premium (p = 0.0156)</p></li>
<li><p><strong>Zone</strong>: Highly significant overall effect</p></li>
</ul></li>
<li><p><strong>Practical Advantages</strong>:</p>
<ul>
<li><p>Easier to interpret and communicate</p></li>
<li><p>More stable predictions (less prone to overfitting)</p></li>
<li><p>Requires fewer variables to collect/input</p></li>
</ul></li>
<li><p><strong>Prediction Performance</strong>: While CV errors are about 8.5% higher than Models A/B, the model still provides excellent predictions with much less complexity.</p></li>
</ol>
<p><strong>Conclusion</strong>: Model C offers an excellent balance between predictive accuracy and model simplicity, making it attractive for practical applications where parsimony is valued.</p>
</section>
</section>
<section id="model-d-1" class="level2">
<h2 class="anchored" data-anchor-id="model-d-1">Model (D)</h2>
<p>Use forward selection to develop a model that predicts <code>totalprice</code> using the variables in <code>VIT2005</code>. Use a “p-value to add” of 5%. Store the final model in the object <code>modelD</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start with intercept only</span></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a>null_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(totalprice <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> VIT2005)</span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward selection</span></span>
<span id="cb414-5"><a href="#cb414-5" aria-hidden="true" tabindex="-1"></a>modelD <span class="ot">&lt;-</span> <span class="fu">step</span>(null_model, </span>
<span id="cb414-6"><a href="#cb414-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">scope =</span> <span class="fu">formula</span>(full_model), </span>
<span id="cb414-7"><a href="#cb414-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">direction =</span> <span class="st">"forward"</span>, </span>
<span id="cb414-8"><a href="#cb414-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">trace =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4860.73
totalprice ~ 1

                 Df  Sum of Sq        RSS    AIC
+ area            1 6.8239e+11 3.5970e+11 4630.8
+ zone           22 6.2786e+11 4.1424e+11 4703.6
+ toilets         1 4.9265e+11 5.4944e+11 4723.2
+ category        6 3.8142e+11 6.6068e+11 4773.4
+ rooms           1 2.8791e+11 7.5418e+11 4792.2
+ garage          1 2.8585e+11 7.5624e+11 4792.8
+ elevator        1 2.7205e+11 7.7005e+11 4796.8
+ heating         3 1.6150e+11 8.8059e+11 4830.0
+ streetcategory  3 1.2246e+11 9.1963e+11 4839.5
+ age             1 7.7353e+10 9.6474e+11 4845.9
+ conservation    3 9.4240e+10 9.4785e+11 4846.1
+ storage         1 7.4489e+10 9.6760e+11 4846.6
&lt;none&gt;                         1.0421e+12 4860.7
+ floor           1 8.8974e+08 1.0412e+12 4862.5
+ out             3 1.5831e+10 1.0263e+12 4863.4

Step:  AIC=4630.84
totalprice ~ area

                 Df  Sum of Sq        RSS    AIC
+ zone           22 1.7960e+11 1.8010e+11 4524.0
+ category        6 9.3970e+10 2.6573e+11 4576.8
+ garage          1 6.8073e+10 2.9163e+11 4587.1
+ toilets         1 5.6364e+10 3.0334e+11 4595.7
+ age             1 5.5354e+10 3.0435e+11 4596.4
+ elevator        1 4.5308e+10 3.1440e+11 4603.5
+ conservation    3 3.6835e+10 3.2287e+11 4613.3
+ storage         1 2.2452e+10 3.3725e+11 4618.8
+ heating         3 2.5654e+10 3.3405e+11 4620.7
&lt;none&gt;                         3.5970e+11 4630.8
+ floor           1 1.4251e+09 3.5828e+11 4632.0
+ rooms           1 1.4929e+08 3.5956e+11 4632.8
+ out             3 5.1247e+09 3.5458e+11 4633.7
+ streetcategory  3 1.5886e+09 3.5812e+11 4635.9

Step:  AIC=4524.04
totalprice ~ area + zone

                 Df  Sum of Sq        RSS    AIC
+ garage          1 3.2856e+10 1.4725e+11 4482.1
+ category        6 3.7898e+10 1.4221e+11 4484.5
+ toilets         1 2.8406e+10 1.5170e+11 4488.6
+ elevator        1 2.0964e+10 1.5914e+11 4499.1
+ conservation    3 1.5083e+10 1.6502e+11 4511.0
+ age             1 1.1794e+10 1.6831e+11 4511.3
+ heating         3 1.2792e+10 1.6731e+11 4514.0
+ storage         1 7.0505e+09 1.7305e+11 4517.3
+ streetcategory  3 7.0112e+09 1.7309e+11 4521.4
+ rooms           1 2.4153e+09 1.7769e+11 4523.1
&lt;none&gt;                         1.8010e+11 4524.0
+ floor           1 2.1117e+08 1.7989e+11 4525.8
+ out             3 1.0513e+09 1.7905e+11 4528.8

Step:  AIC=4482.13
totalprice ~ area + zone + garage

                 Df  Sum of Sq        RSS    AIC
+ category        6 2.6933e+10 1.2032e+11 4450.1
+ toilets         1 1.6516e+10 1.3073e+11 4458.2
+ elevator        1 1.6358e+10 1.3089e+11 4458.5
+ heating         3 1.2552e+10 1.3470e+11 4468.7
+ age             1 8.0663e+09 1.3918e+11 4471.9
+ conservation    3 9.5253e+09 1.3772e+11 4473.6
+ storage         1 5.1715e+09 1.4208e+11 4476.3
+ streetcategory  3 6.5779e+09 1.4067e+11 4478.2
+ rooms           1 2.2030e+09 1.4505e+11 4480.8
&lt;none&gt;                         1.4725e+11 4482.1
+ floor           1 2.8860e+08 1.4696e+11 4483.7
+ out             3 2.0387e+09 1.4521e+11 4485.1

Step:  AIC=4450.1
totalprice ~ area + zone + garage + category

                 Df  Sum of Sq        RSS    AIC
+ elevator        1 1.0192e+10 1.1012e+11 4432.8
+ toilets         1 6.6314e+09 1.1368e+11 4439.7
+ heating         3 7.3042e+09 1.1301e+11 4442.4
+ storage         1 4.2321e+09 1.1608e+11 4444.3
+ out             3 5.6366e+09 1.1468e+11 4445.6
+ streetcategory  3 5.2963e+09 1.1502e+11 4446.3
+ rooms           1 2.5576e+09 1.1776e+11 4447.4
+ age             1 1.7261e+09 1.1859e+11 4448.9
&lt;none&gt;                         1.2032e+11 4450.1
+ floor           1 9.2505e+05 1.2031e+11 4452.1
+ conservation    3 1.5615e+09 1.1875e+11 4453.2

Step:  AIC=4432.8
totalprice ~ area + zone + garage + category + elevator

                 Df  Sum of Sq        RSS    AIC
+ toilets         1 6073243761 1.0405e+11 4422.4
+ storage         1 3694847210 1.0643e+11 4427.4
+ streetcategory  3 5617271088 1.0451e+11 4427.4
+ heating         3 5056597855 1.0507e+11 4428.6
+ out             3 4328922592 1.0579e+11 4430.1
+ rooms           1 1548114686 1.0857e+11 4431.7
&lt;none&gt;                         1.1012e+11 4432.8
+ age             1  815586409 1.0931e+11 4433.2
+ floor           1   27424777 1.1010e+11 4434.7
+ conservation    3 1689461578 1.0843e+11 4435.4

Step:  AIC=4422.43
totalprice ~ area + zone + garage + category + elevator + toilets

                 Df  Sum of Sq        RSS    AIC
+ streetcategory  3 5418285673 9.8631e+10 4416.8
+ storage         1 3309776001 1.0074e+11 4417.4
+ heating         3 4760850186 9.9289e+10 4418.2
+ out             3 4583711290 9.9466e+10 4418.6
+ rooms           1 1211766335 1.0284e+11 4421.9
&lt;none&gt;                         1.0405e+11 4422.4
+ age             1  822533955 1.0323e+11 4422.7
+ floor           1   29736792 1.0402e+11 4424.4
+ conservation    3 1482925524 1.0257e+11 4425.3

Step:  AIC=4416.77
totalprice ~ area + zone + garage + category + elevator + toilets + 
    streetcategory

               Df  Sum of Sq        RSS    AIC
+ out           3 4524673955 9.4107e+10 4412.5
+ heating       3 3852555776 9.4779e+10 4414.1
+ storage       1 1867448090 9.6764e+10 4414.6
+ rooms         1 1395688014 9.7236e+10 4415.7
+ age           1  904901916 9.7726e+10 4416.8
&lt;none&gt;                       9.8631e+10 4416.8
+ floor         1   15504079 9.8616e+10 4418.7
+ conservation  3 1502791224 9.7129e+10 4419.4

Step:  AIC=4412.54
totalprice ~ area + zone + garage + category + elevator + toilets + 
    streetcategory + out

               Df  Sum of Sq        RSS    AIC
+ heating       3 4293510190 8.9813e+10 4408.4
+ storage       1 1650832431 9.2456e+10 4410.7
+ rooms         1 1030410231 9.3076e+10 4412.1
&lt;none&gt;                       9.4107e+10 4412.5
+ age           1  205646048 9.3901e+10 4414.1
+ floor         1   16494660 9.4090e+10 4414.5
+ conservation  3  923168465 9.3184e+10 4416.4

Step:  AIC=4408.36
totalprice ~ area + zone + garage + category + elevator + toilets + 
    streetcategory + out + heating

               Df  Sum of Sq        RSS    AIC
+ storage       1 1500802958 8.8312e+10 4406.7
+ rooms         1  855932825 8.8957e+10 4408.3
&lt;none&gt;                       8.9813e+10 4408.4
+ age           1  571066275 8.9242e+10 4409.0
+ floor         1      59593 8.9813e+10 4410.4
+ conservation  3 1340139301 8.8473e+10 4411.1

Step:  AIC=4406.68
totalprice ~ area + zone + garage + category + elevator + toilets + 
    streetcategory + out + heating + storage

               Df  Sum of Sq        RSS    AIC
+ rooms         1 1024619187 8.7288e+10 4406.1
&lt;none&gt;                       8.8312e+10 4406.7
+ age           1  344698909 8.7968e+10 4407.8
+ floor         1   47513213 8.8265e+10 4408.6
+ conservation  3 1310618800 8.7002e+10 4409.4

Step:  AIC=4406.14
totalprice ~ area + zone + garage + category + elevator + toilets + 
    streetcategory + out + heating + storage + rooms

               Df  Sum of Sq        RSS    AIC
&lt;none&gt;                       8.7288e+10 4406.1
+ age           1  334291272 8.6953e+10 4407.3
+ floor         1   43416755 8.7244e+10 4408.0
+ conservation  3 1356302210 8.5931e+10 4408.7</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model D Formula:"</span>, <span class="fu">deparse</span>(<span class="fu">formula</span>(modelD)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model D Formula: totalprice ~ area + zone + garage + category + elevator + toilets +      streetcategory + out + heating + storage + rooms </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb418"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelD)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = totalprice ~ area + zone + garage + category + elevator + 
    toilets + streetcategory + out + heating + storage + rooms, 
    data = VIT2005)

Residuals:
   Min     1Q Median     3Q    Max 
-69950 -12745   -961  13237  66755 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       80599.6    26107.1   3.087 0.002351 ** 
area               1322.3      141.1   9.372  &lt; 2e-16 ***
zoneZ21           92150.3    13229.1   6.966 6.45e-11 ***
zoneZ31           77707.2    13945.2   5.572 9.42e-08 ***
zoneZ32           39469.1    12287.0   3.212 0.001569 ** 
zoneZ34           14216.2    15558.2   0.914 0.362114    
zoneZ35           60344.5    14995.8   4.024 8.52e-05 ***
zoneZ36           35853.8    12658.2   2.832 0.005164 ** 
zoneZ37           72839.7    12831.9   5.676 5.65e-08 ***
zoneZ38           22527.3    15681.3   1.437 0.152635    
zoneZ41           51093.9    12166.9   4.199 4.26e-05 ***
zoneZ42           80819.5    15556.6   5.195 5.67e-07 ***
zoneZ43           33210.9    15708.0   2.114 0.035918 *  
zoneZ44           19876.7    15246.7   1.304 0.194067    
zoneZ45           11325.7    12814.3   0.884 0.378007    
zoneZ46            5636.1    13651.0   0.413 0.680208    
zoneZ47          -11740.5    14084.1  -0.834 0.405649    
zoneZ48           32863.5    13988.2   2.349 0.019927 *  
zoneZ49           27986.2    14828.3   1.887 0.060779 .  
zoneZ52            2667.7    12863.1   0.207 0.835945    
zoneZ53           18018.7    12952.8   1.391 0.165968    
zoneZ56           21174.7    14549.4   1.455 0.147371    
zoneZ61           14905.7    12119.1   1.230 0.220383    
zoneZ62           12390.5    12234.2   1.013 0.312571    
garage            25448.3     4560.4   5.580 9.06e-08 ***
category2B        -1008.8    14614.8  -0.069 0.945046    
category3A       -22986.7    14218.7  -1.617 0.107766    
category3B       -27321.2    14602.4  -1.871 0.063023 .  
category4A       -35752.3    15152.9  -2.359 0.019411 *  
category4B       -44969.8    15891.3  -2.830 0.005205 ** 
category5A       -76306.3    24895.8  -3.065 0.002524 ** 
elevator          19649.7     5784.8   3.397 0.000845 ***
toilets           18088.7     5649.3   3.202 0.001623 ** 
streetcategoryS3  13081.0     5769.9   2.267 0.024614 *  
streetcategoryS4   8462.3     6261.4   1.351 0.178290    
streetcategoryS5  -4864.0    10413.0  -0.467 0.641003    
outE25            37676.9    14528.3   2.593 0.010314 *  
outE50            -4121.3     3978.3  -1.036 0.301657    
outE75             4746.9    10384.4   0.457 0.648155    
heating3A         -9733.0    11977.0  -0.813 0.417533    
heating3B         -2219.0    15287.9  -0.145 0.884765    
heating4A          2824.2    12662.7   0.223 0.823768    
storage            8250.5     4522.6   1.824 0.069826 .  
rooms              5018.8     3511.8   1.429 0.154753    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 22400 on 174 degrees of freedom
Multiple R-squared:  0.9162,    Adjusted R-squared:  0.8955 
F-statistic: 44.26 on 43 and 174 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Model D: Forward Selection Results</p>
<p><strong>Model Selection Process:</strong></p>
<p>Forward selection started with an <strong>intercept-only model</strong> and sequentially added variables that most improved the model fit (reduced AIC).</p>
<p><strong>Variables added</strong> (in order):</p>
<ol type="1">
<li><p><strong>Area</strong> (Step 1) - Strongest single predictor</p></li>
<li><p><strong>Zone</strong> (Step 2)</p></li>
<li><p><strong>Garage</strong> (Step 3)</p></li>
<li><p><strong>Category</strong> (Step 4)</p></li>
<li><p><strong>Elevator</strong> (Step 5)</p></li>
<li><p><strong>Toilets</strong> (Step 6)</p></li>
<li><p><strong>Streetcategory</strong> (Step 7)</p></li>
<li><p><strong>Out</strong> (Step 8)</p></li>
<li><p><strong>Heating</strong> (Step 9)</p></li>
<li><p><strong>Storage</strong> (Step 10)</p></li>
<li><p><strong>Rooms</strong> (Step 11) - Final variable added</p></li>
</ol>
<p><strong>Final Model D</strong> includes:</p>
<ul>
<li>area, zone, garage, category, elevator, toilets, streetcategory, out, heating, storage, rooms</li>
</ul>
<p><strong>Key Finding:</strong></p>
<p><strong>Model D is IDENTICAL to Models A and B!</strong></p>
<p>All three selection methods (backward elimination, AIC-based stepwise, and forward selection) converged to the <strong>exact same model</strong>, which provides very strong evidence that this is the optimal variable subset.</p>
<section id="i-compute-cv_n-for-modeld.-set-the-seed-to-5-and-compute-cv_5-for-modeld." class="level4">
<h4 class="anchored" data-anchor-id="i-compute-cv_n-for-modeld.-set-the-seed-to-5-and-compute-cv_5-for-modeld.">(i) Compute <span class="math inline">\(CV_n\)</span> for <code>modelD</code>. Set the seed to 5 and compute <span class="math inline">\(CV_5\)</span> for <code>modelD</code>.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (i) Cross-validation for Model D</span></span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model D Cross-Validation ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model D Cross-Validation ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb422"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a>modelD_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">formula</span>(modelD), <span class="at">data =</span> VIT2005)</span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a>cv_n_D <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelD_glm)</span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_n (LOOCV):"</span>, cv_n_D<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_n (LOOCV): 640530644 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a>cv_5_D <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelD_glm, <span class="at">K =</span> <span class="dv">5</span>)</span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_5:"</span>, cv_5_D<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_5: 647819847 </code></pre>
</div>
</div>
<ul>
<li><p><strong>CV_n (Leave-One-Out Cross-Validation)</strong>: 640,530,644</p></li>
<li><p><strong>CV_5 (5-Fold Cross-Validation)</strong>: 647,819,847</p></li>
</ul>
<p>These are identical to Models A and B (as expected, since it’s the same model).</p>
</section>
<section id="ii-compute-the-r2-r2_a-aic-and-the-bic-for-model-d.-what-is-the-proportion-of-total-variability-explained-by-model-d" class="level4">
<h4 class="anchored" data-anchor-id="ii-compute-the-r2-r2_a-aic-and-the-bic-for-model-d.-what-is-the-proportion-of-total-variability-explained-by-model-d">(ii) Compute the <span class="math inline">\(R^2, R^2_a\)</span>, AIC, and the BIC for Model (D). What is the proportion of total variability explained by Model (D)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (ii) Model metrics</span></span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a>summary_D <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelD)</span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model D Metrics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model D Metrics ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, summary_D<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.9162381 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Adjusted R-squared:"</span>, summary_D<span class="sc">$</span>adj.r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R-squared: 0.8955384 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(modelD), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 5026.797 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb434"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC:"</span>, <span class="fu">BIC</span>(modelD), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC: 5179.099 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Proportion of variability explained:"</span>, summary_D<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Proportion of variability explained: 0.9162381 </code></pre>
</div>
</div>
<p><strong>Proportion of variability explained</strong>: <strong>91.62%</strong></p>
<p><strong>Interpretation:</strong></p>
<p><strong>Model D explains 91.62% of the total variability in apartment prices.</strong></p>
<p><strong>All metrics are identical</strong> because all three methods selected the same model.</p>
<p><strong>Significance:</strong></p>
<p>The convergence of three different selection approaches to the <strong>same final model</strong> is remarkable and indicates:</p>
<ol type="1">
<li><p><strong>Model Stability</strong>: The selected variable subset is robust and not dependent on the selection algorithm used</p></li>
<li><p><strong>Clear Signal</strong>: The data has a clear structure with well-defined important predictors</p></li>
<li><p><strong>Optimal Balance</strong>: This model represents an optimal trade-off between fit and complexity using the AIC criterion</p></li>
<li><p><strong>High Confidence</strong>: We can be highly confident this is the “right” model for prediction purposes using p-value-based criteria (α = 0.05)</p></li>
</ol>
<p><strong>Most Important Predictors</strong> (same as Models A and B):</p>
<ol type="1">
<li><p><strong>Area</strong>: €1,322 per m² (p &lt; 2e-16)</p></li>
<li><p><strong>Garage</strong>: €25,448 per garage (p = 9.06e-08)</p></li>
<li><p><strong>Elevator</strong>: €19,650 premium (p = 0.000845)</p></li>
<li><p><strong>Toilets</strong>: €18,089 per toilet (p = 0.00162)</p></li>
<li><p><strong>Zone</strong>: Multiple zones significantly affect price</p></li>
</ol>
</section>
<section id="d-explore-the-residuals-of-the-models-a-b-c-and-d-using-the-function-residualplot-or-residualplots-from-the-package-car.-comment-on-the-results." class="level3">
<h3 class="anchored" data-anchor-id="d-explore-the-residuals-of-the-models-a-b-c-and-d-using-the-function-residualplot-or-residualplots-from-the-package-car.-comment-on-the-results.">(d) Explore the residuals of the Models (A), (B), (C), and (D) using the function <code>residualPlot()</code> or <code>residualPlots()</code> from the package <code>car</code>. Comment on the results.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelA, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">main =</span> <span class="st">"Model A"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb439"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelB, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">main =</span> <span class="st">"Model B"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-63-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelC, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">main =</span> <span class="st">"Model C"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-63-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb441"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelD, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">main =</span> <span class="st">"Model D"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-63-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb442"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-3"><a href="#cb442-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Comment: Examine residual plots for patterns, non-constant variance,</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Comment: Examine residual plots for patterns, non-constant variance,</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"and departures from normality.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>and departures from normality.</code></pre>
</div>
</div>
<p>Part (d): Residual Analysis for Models A-D</p>
<p><strong>Models A, B, and D (Identical Models)</strong></p>
<p>Since Models A, B, and D are identical, they have the same residual plots. Here are the findings:</p>
<p><strong>1. Residuals vs Fitted Plot:</strong></p>
<ul>
<li><p><strong>Pattern observed</strong>: Residuals show a <strong>slight funnel shape</strong> (heteroscedasticity)</p></li>
<li><p>Residuals spread increases slightly as fitted values increase</p></li>
<li><p>There’s a <strong>slight upward trend</strong> (red line slopes upward), suggesting the model may slightly underpredict at higher price ranges</p></li>
<li><p><strong>Outliers identified</strong>: Observations 116, 130, and 156 stand out</p></li>
</ul>
<p><strong>2. Q-Q Plot (Normal Q-Q):</strong></p>
<ul>
<li><p><strong>Generally good</strong>: Points follow the theoretical line reasonably well in the middle</p></li>
<li><p><strong>Deviations at extremes</strong>:</p>
<ul>
<li><p>Lower tail shows some deviation (observations like 156)</p></li>
<li><p>Upper tail shows more pronounced deviation (observations 130, 136, 160)</p></li>
</ul></li>
<li><p><strong>Conclusion</strong>: Minor departures from normality, primarily in the tails</p></li>
</ul>
<p><strong>3. Scale-Location Plot:</strong></p>
<ul>
<li><p>Shows <strong>increasing spread</strong> of standardized residuals as fitted values increase</p></li>
<li><p><strong>Confirms heteroscedasticity</strong>: Variance is not constant across the range of fitted values</p></li>
<li><p>Red line shows upward trend, indicating variance increases with predicted price</p></li>
</ul>
<p><strong>4. Cook’s Distance Plot:</strong></p>
<ul>
<li><p><strong>Influential observations</strong>: 43, 93, and 116 show notably higher Cook’s distances</p></li>
<li><p>Most observations have low Cook’s distance (&lt; 0.10)</p></li>
<li><p>No observations exceed the common threshold of 0.5, but some warrant attention</p></li>
</ul>
<p><strong>Model C (Simpler BIC Model)</strong></p>
<p>Model C shows similar patterns but with some differences:</p>
<p><strong>1. Residuals vs Fitted:</strong></p>
<ul>
<li><p><strong>More random scatter</strong> compared to Models A/B/D</p></li>
<li><p>Still shows slight heteroscedasticity with increasing variance</p></li>
<li><p><strong>Different outliers</strong>: Observations 130, 156, 207 are notable</p></li>
</ul>
<p><strong>2. Q-Q Plot:</strong></p>
<ul>
<li><p><strong>Similar to A/B/D</strong>: Good fit in the middle, deviations in tails</p></li>
<li><p>Observations 130 and 156 deviate in upper tail</p></li>
</ul>
<p><strong>3. Scale-Location Plot:</strong></p>
<ul>
<li><p>Shows <strong>less pronounced heteroscedasticity</strong> pattern than Models A/B/D</p></li>
<li><p>Observations 130, 156, and 207 stand out</p></li>
</ul>
<p><strong>4. Cook’s Distance:</strong></p>
<ul>
<li><p><strong>Different influential points</strong>: Observations 31, 43, and 156 show higher influence</p></li>
<li><p>Generally lower Cook’s distances overall compared to Models A/B/D</p></li>
</ul>
<p><strong>Overall Comments:</strong></p>
<p><strong>Common Issues Across All Models:</strong></p>
<ol type="1">
<li><p><strong>Heteroscedasticity</strong>: All models show evidence of non-constant variance, with larger residuals for higher-priced apartments. This violates the homoscedasticity assumption.</p></li>
<li><p><strong>Near-Normality</strong>: Residuals are approximately normal but with heavier tails than expected, particularly in the upper tail. This is common with price data.</p></li>
<li><p><strong>Potential Outliers</strong>: Observations 130, 156, and others consistently appear as outliers across models</p></li>
<li><p><strong>Model Adequacy</strong>: Despite the violations, the patterns are relatively mild and the models still provide good fits</p></li>
</ol>
<p><strong>Key Differences:</strong></p>
<ul>
<li><p><strong>Models A/B/D</strong>: Better fit (higher R²) but show more pronounced heteroscedasticity</p></li>
<li><p><strong>Model C</strong>: Simpler model with slightly worse fit but comparable residual patterns</p></li>
</ul>
</section>
<section id="e-use-the-function-boxcox-from-car-to-find-a-suitable-transformation-for-totalprice." class="level3">
<h3 class="anchored" data-anchor-id="e-use-the-function-boxcox-from-car-to-find-a-suitable-transformation-for-totalprice.">(e) Use the function <code>boxCox()</code> from <code>car</code> to find a suitable transformation for <code>totalprice</code>.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb446"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">=== PART (e): Box-Cox Transformation ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>

=== PART (e): Box-Cox Transformation ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a>bc <span class="ot">&lt;-</span> <span class="fu">boxCox</span>(modelA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb449"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> bc<span class="sc">$</span>x[<span class="fu">which.max</span>(bc<span class="sc">$</span>y)]</span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal lambda:"</span>, lambda, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal lambda: 0.06060606 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb451"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation: Lambda near 0 suggests log transformation is appropriate.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretation: Lambda near 0 suggests log transformation is appropriate.</code></pre>
</div>
</div>
<p>Part (e): Box-Cox Transformation Analysis</p>
<p><strong>Box-Cox Results:</strong></p>
<p><strong>Optimal λ (lambda)</strong>: 0.0606 ≈ 0</p>
<p><strong>Interpretation:</strong></p>
<p>The Box-Cox procedure searches for the optimal power transformation of the response variable that best satisfies the regression assumptions (normality and homoscedasticity of residuals).</p>
<p><strong>Mathematical Framework:</strong> The Box-Cox transformation is defined as:</p>
<ul>
<li><p>If λ ≠ 0: Y^(λ) = (Y^λ - 1) / λ</p></li>
<li><p>If λ = 0: Y^(λ) = log(Y)</p></li>
</ul>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><p><strong>Optimal Lambda Near Zero</strong>:</p>
<ul>
<li><p>The optimal λ = 0.0606 is very close to 0</p></li>
<li><p>When λ = 0, the transformation is equivalent to the <strong>natural logarithm</strong></p></li>
<li><p>This strongly suggests using <strong>log(totalprice)</strong> as the response variable</p></li>
</ul></li>
<li><p><strong>95% Confidence Interval</strong>:</p>
<ul>
<li><p>The horizontal dashed line shows the 95% confidence level</p></li>
<li><p>The confidence interval for λ includes 0 (approximately from -0.3 to 0.4)</p></li>
<li><p>Since 0 is well within this interval, the log transformation is statistically justified</p></li>
</ul></li>
<li><p><strong>Profile Log-Likelihood Shape</strong>:</p>
<ul>
<li><p>The curve is smooth and has a clear maximum near λ = 0</p></li>
<li><p>The peak is relatively broad, indicating some flexibility in the transformation</p></li>
<li><p>However, the maximum is clearly centered near zero</p></li>
</ul></li>
</ol>
</section>
</section>
<section id="model-e" class="level2">
<h2 class="anchored" data-anchor-id="model-e">Model (E)</h2>
<p>Use backward elimination to develop a model that predicts <code>log(totalprice)</code> using the data frame <code>VIT2005</code>. Use a “p-value to remove” of 5%. Store the final model in the object <code>modelE</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb453"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a temporary dataset with log-transformed response</span></span>
<span id="cb453-2"><a href="#cb453-2" aria-hidden="true" tabindex="-1"></a>VIT2005_log <span class="ot">&lt;-</span> VIT2005</span>
<span id="cb453-3"><a href="#cb453-3" aria-hidden="true" tabindex="-1"></a>VIT2005_log<span class="sc">$</span>log_totalprice <span class="ot">&lt;-</span> <span class="fu">log</span>(VIT2005<span class="sc">$</span>totalprice)</span>
<span id="cb453-4"><a href="#cb453-4" aria-hidden="true" tabindex="-1"></a>VIT2005_log<span class="sc">$</span>totalprice <span class="ot">&lt;-</span> <span class="cn">NULL</span>  <span class="co"># Remove original totalprice</span></span>
<span id="cb453-5"><a href="#cb453-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-6"><a href="#cb453-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create full model with all predictors</span></span>
<span id="cb453-7"><a href="#cb453-7" aria-hidden="true" tabindex="-1"></a>full_model_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_totalprice <span class="sc">~</span> ., <span class="at">data =</span> VIT2005_log)</span>
<span id="cb453-8"><a href="#cb453-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-9"><a href="#cb453-9" aria-hidden="true" tabindex="-1"></a>modelE <span class="ot">&lt;-</span> <span class="fu">step</span>(full_model_log, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">trace =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-1080.46
log_totalprice ~ area + zone + category + age + floor + rooms + 
    out + conservation + toilets + garage + elevator + streetcategory + 
    heating + storage

                 Df Sum of Sq     RSS      AIC
- conservation    3   0.01134 0.99029 -1083.95
- age             1   0.00061 0.97956 -1082.32
- floor           1   0.00185 0.98080 -1082.05
- rooms           1   0.00422 0.98317 -1081.52
&lt;none&gt;                        0.97895 -1080.46
- streetcategory  3   0.03040 1.00935 -1079.79
- heating         3   0.04007 1.01902 -1077.71
- storage         1   0.03280 1.01175 -1075.27
- out             3   0.06721 1.04616 -1071.98
- category        6   0.10125 1.08020 -1071.00
- toilets         1   0.08460 1.06356 -1064.39
- garage          1   0.14304 1.12199 -1052.73
- elevator        1   0.14529 1.12424 -1052.29
- area            1   0.45808 1.43703  -998.78
- zone           22   1.25852 2.23747  -944.25

Step:  AIC=-1083.95
log_totalprice ~ area + zone + category + age + floor + rooms + 
    out + toilets + garage + elevator + streetcategory + heating + 
    storage

                 Df Sum of Sq     RSS      AIC
- age             1   0.00055 0.99084 -1085.83
- floor           1   0.00224 0.99253 -1085.45
- rooms           1   0.00381 0.99410 -1085.11
&lt;none&gt;                        0.99029 -1083.95
- streetcategory  3   0.03348 1.02376 -1082.70
- heating         3   0.03991 1.03019 -1081.34
- storage         1   0.02946 1.01975 -1079.56
- out             3   0.06668 1.05696 -1075.74
- category        6   0.11616 1.10644 -1071.77
- toilets         1   0.08898 1.07926 -1067.19
- elevator        1   0.14290 1.13319 -1056.56
- garage          1   0.15198 1.14226 -1054.82
- area            1   0.45804 1.44832 -1003.07
- zone           22   1.25434 2.24462  -949.56

Step:  AIC=-1085.83
log_totalprice ~ area + zone + category + floor + rooms + out + 
    toilets + garage + elevator + streetcategory + heating + 
    storage

                 Df Sum of Sq     RSS     AIC
- floor           1   0.00212 0.99295 -1087.4
- rooms           1   0.00384 0.99468 -1087.0
&lt;none&gt;                        0.99084 -1085.8
- streetcategory  3   0.03302 1.02385 -1084.7
- heating         3   0.03941 1.03025 -1083.3
- storage         1   0.03105 1.02189 -1081.1
- out             3   0.07314 1.06397 -1076.3
- category        6   0.12795 1.11878 -1071.3
- toilets         1   0.08930 1.08013 -1069.0
- elevator        1   0.14955 1.14039 -1057.2
- garage          1   0.15229 1.14313 -1056.7
- area            1   0.46386 1.45470 -1004.1
- zone           22   1.27513 2.26596  -949.5

Step:  AIC=-1087.36
log_totalprice ~ area + zone + category + rooms + out + toilets + 
    garage + elevator + streetcategory + heating + storage

                 Df Sum of Sq     RSS      AIC
- rooms           1   0.00390 0.99685 -1088.51
&lt;none&gt;                        0.99295 -1087.36
- streetcategory  3   0.03140 1.02435 -1086.57
- heating         3   0.04104 1.03400 -1084.53
- storage         1   0.02921 1.02217 -1083.04
- out             3   0.07320 1.06615 -1077.86
- category        6   0.13186 1.12482 -1072.18
- toilets         1   0.08971 1.08266 -1070.51
- garage          1   0.15125 1.14420 -1058.45
- elevator        1   0.15179 1.14474 -1058.35
- area            1   0.46227 1.45522 -1006.04
- zone           22   1.32477 2.31772  -946.57

Step:  AIC=-1088.51
log_totalprice ~ area + zone + category + out + toilets + garage + 
    elevator + streetcategory + heating + storage

                 Df Sum of Sq     RSS      AIC
&lt;none&gt;                        0.99685 -1088.51
- streetcategory  3   0.03042 1.02727 -1087.95
- heating         3   0.04262 1.03947 -1085.38
- storage         1   0.02789 1.02474 -1084.49
- out             3   0.07696 1.07381 -1078.30
- category        6   0.12882 1.12567 -1074.01
- toilets         1   0.09245 1.08930 -1071.17
- garage          1   0.15205 1.14890 -1059.56
- elevator        1   0.15775 1.15460 -1058.48
- area            1   0.63037 1.62722  -983.68
- zone           22   1.32105 2.31790  -948.56</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb455"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model E Formula:"</span>, <span class="fu">deparse</span>(<span class="fu">formula</span>(modelE)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model E Formula: log_totalprice ~ area + zone + category + out + toilets + garage +      elevator + streetcategory + heating + storage </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb457"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelE)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_totalprice ~ area + zone + category + out + 
    toilets + garage + elevator + streetcategory + heating + 
    storage, data = VIT2005_log)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.222817 -0.044929  0.000173  0.048212  0.265943 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      11.800102   0.083176 141.869  &lt; 2e-16 ***
area              0.004461   0.000424  10.520  &lt; 2e-16 ***
zoneZ21           0.314844   0.044556   7.066 3.63e-11 ***
zoneZ31           0.280174   0.046670   6.003 1.09e-08 ***
zoneZ32           0.179278   0.041177   4.354 2.27e-05 ***
zoneZ34           0.094760   0.051693   1.833 0.068480 .  
zoneZ35           0.282519   0.050097   5.639 6.73e-08 ***
zoneZ36           0.169712   0.042477   3.995 9.50e-05 ***
zoneZ37           0.300758   0.042972   6.999 5.29e-11 ***
zoneZ38           0.122263   0.052668   2.321 0.021417 *  
zoneZ41           0.218347   0.040695   5.365 2.53e-07 ***
zoneZ42           0.277204   0.052376   5.293 3.58e-07 ***
zoneZ43           0.162943   0.052892   3.081 0.002399 ** 
zoneZ44           0.136301   0.050824   2.682 0.008023 ** 
zoneZ45           0.079627   0.042374   1.879 0.061887 .  
zoneZ46           0.062723   0.044841   1.399 0.163652    
zoneZ47          -0.006309   0.047380  -0.133 0.894229    
zoneZ48           0.162198   0.046585   3.482 0.000629 ***
zoneZ49           0.141134   0.049702   2.840 0.005052 ** 
zoneZ52           0.056549   0.042931   1.317 0.189490    
zoneZ53           0.109465   0.043431   2.520 0.012615 *  
zoneZ56           0.133565   0.048970   2.727 0.007032 ** 
zoneZ61           0.095688   0.040434   2.367 0.019050 *  
zoneZ62           0.059944   0.040679   1.474 0.142388    
category2B       -0.008112   0.049200  -0.165 0.869232    
category3A       -0.062638   0.047913  -1.307 0.192816    
category3B       -0.077811   0.049199  -1.582 0.115552    
category4A       -0.105547   0.051056  -2.067 0.040183 *  
category4B       -0.149403   0.053548  -2.790 0.005854 ** 
category5A       -0.237579   0.083556  -2.843 0.004996 ** 
outE25            0.165305   0.048717   3.393 0.000854 ***
outE50           -0.005366   0.013374  -0.401 0.688766    
outE75            0.037254   0.034941   1.066 0.287798    
toilets           0.076538   0.018999   4.029 8.35e-05 ***
garage            0.079385   0.015365   5.166 6.45e-07 ***
elevator          0.102132   0.019408   5.262 4.12e-07 ***
streetcategoryS3  0.036227   0.019345   1.873 0.062782 .  
streetcategoryS4  0.015145   0.021082   0.718 0.473477    
streetcategoryS5 -0.023253   0.034943  -0.665 0.506631    
heating3A        -0.011383   0.040212  -0.283 0.777454    
heating3B        -0.008138   0.051433  -0.158 0.874456    
heating4A         0.030569   0.042446   0.720 0.472365    
storage           0.033641   0.015204   2.213 0.028210 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.07547 on 175 degrees of freedom
Multiple R-squared:  0.9202,    Adjusted R-squared:  0.901 
F-statistic: 48.02 on 42 and 175 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb459"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update formula to use log(totalprice) for consistency</span></span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a>modelE_formula <span class="ot">&lt;-</span> <span class="fu">formula</span>(modelE)</span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true" tabindex="-1"></a>modelE_formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">gsub</span>(<span class="st">"log_totalprice"</span>, <span class="st">"log(totalprice)"</span>, </span>
<span id="cb459-4"><a href="#cb459-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">deparse</span>(modelE_formula)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in formula.character(object, env = baseenv()): Using formula(x) is deprecated when x is a character vector of length &gt; 1.
  Consider formula(paste(x, collapse = " ")) instead.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb461"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a>modelE <span class="ot">&lt;-</span> <span class="fu">lm</span>(modelE_formula, <span class="at">data =</span> VIT2005)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Model E: Backward Elimination with Log-Transformed Response</p>
<p><strong>Model Selection Process:</strong></p>
<p>Backward elimination removed the following variables (in order):</p>
<ol type="1">
<li><p><strong>Conservation</strong> (Step 1) - Not significant</p></li>
<li><p><strong>Age</strong> (Step 2) - Not significant</p></li>
<li><p><strong>Floor</strong> (Step 3) - Not significant</p></li>
<li><p><strong>Rooms</strong> (Step 4) - Not significant</p></li>
</ol>
<p><strong>Final Model E</strong> retained these 10 predictors:</p>
<ul>
<li>area, zone, category, out, toilets, garage, elevator, streetcategory, heating, storage</li>
</ul>
<p>This is <strong>one fewer predictor than Models A/B/D</strong> (which had 11 predictors including rooms).</p>
<section id="i-compute-cv_n-for-modele.-set-the-seed-to-5-and-compute-cv_5-for-modele." class="level4">
<h4 class="anchored" data-anchor-id="i-compute-cv_n-for-modele.-set-the-seed-to-5-and-compute-cv_5-for-modele.">(i) Compute <span class="math inline">\(CV_n\)</span> for <code>modelE</code>. Set the seed to 5 and compute <span class="math inline">\(CV_5\)</span> for <code>modelE</code>.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb462"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (i) Cross-validation for Model E</span></span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model E Cross-Validation ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model E Cross-Validation ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb464"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a>modelE_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">formula</span>(modelE), <span class="at">data =</span> VIT2005)</span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-3"><a href="#cb464-3" aria-hidden="true" tabindex="-1"></a>cv_n_E <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelE_glm)</span>
<span id="cb464-4"><a href="#cb464-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_n (LOOCV):"</span>, cv_n_E<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_n (LOOCV): 0.007080105 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb466"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a>cv_5_E <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelE_glm, <span class="at">K =</span> <span class="dv">5</span>)</span>
<span id="cb466-3"><a href="#cb466-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_5:"</span>, cv_5_E<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_5: 0.007358635 </code></pre>
</div>
</div>
<ul>
<li><p><strong>CV_n (Leave-One-Out Cross-Validation)</strong>: 0.007080105</p></li>
<li><p><strong>CV_5 (5-Fold Cross-Validation)</strong>: 0.007358635</p></li>
</ul>
<p><strong>Important Note</strong>: These CV errors are on the <strong>log scale</strong> (not euros), so they represent mean squared prediction error for log(totalprice). These values are <strong>much smaller</strong> than Models A-D because:</p>
<ol type="1">
<li><p>They’re on the log scale (compressed range)</p></li>
<li><p>The log transformation has stabilized variance</p></li>
</ol>
</section>
<section id="ii-compute-r2-r2_a-the-aic-and-the-bic-for-model-e.-what-is-the-proportion-of-total-variability-explained-by-model-e" class="level4">
<h4 class="anchored" data-anchor-id="ii-compute-r2-r2_a-the-aic-and-the-bic-for-model-e.-what-is-the-proportion-of-total-variability-explained-by-model-e">(ii) Compute <span class="math inline">\(R^2, R^2_a\)</span>, the AIC, and the BIC for Model (E). What is the proportion of total variability explained by Model (E)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (ii) Model metrics</span></span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>summary_E <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelE)</span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model E Metrics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model E Metrics ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb470"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, summary_E<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.9201524 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb472"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Adjusted R-squared:"</span>, summary_E<span class="sc">$</span>adj.r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R-squared: 0.900989 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb474"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(modelE), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: -467.8506 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb476"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC:"</span>, <span class="fu">BIC</span>(modelE), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC: -318.9328 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb478"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Proportion of variability explained:"</span>, summary_E<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Proportion of variability explained: 0.9201524 </code></pre>
</div>
</div>
<p><strong>Proportion of variability explained</strong>: <strong>92.02%</strong></p>
<p><strong>Interpretation:</strong></p>
<p><strong>Model E explains 92.02% of the total variability in log(totalprice).</strong></p>
<p>This is actually a <strong>slight improvement</strong> over Models A/B/D (which had 91.62% R² for untransformed totalprice), despite having one fewer predictor.</p>
<p><strong>Key Improvements from Log Transformation:</strong></p>
<ol type="1">
<li><p><strong>Better Model Fit</strong>:</p>
<ul>
<li><p>R² increased from 91.62% to 92.02%</p></li>
<li><p>Adjusted R² increased from 89.55% to 90.10%</p></li>
</ul></li>
<li><p><strong>Improved AIC/BIC</strong>:</p>
<ul>
<li><p>AIC: -467.851 (vs 5026.797 for Models A/B/D)</p></li>
<li><p>BIC: -318.933 (vs 5179.099 for Models A/B/D)</p></li>
<li><p><strong>Note</strong>: These aren’t directly comparable due to different scales, but negative values indicate excellent fit</p></li>
</ul></li>
<li><p><strong>Smaller Residual Standard Error</strong>:</p>
<ul>
<li><p>σ = 0.07547 on log scale</p></li>
<li><p>This represents approximately 7.5% typical prediction error in multiplicative terms</p></li>
</ul></li>
<li><p><strong>Better Residual Properties</strong> (expected from Box-Cox):</p>
<ul>
<li><p>Smaller, more symmetric residuals (range: -0.223 to 0.266)</p></li>
<li><p>More homoscedastic (constant variance)</p></li>
<li><p>More normally distributed</p></li>
</ul></li>
</ol>
<p><strong>Significant Predictors (p &lt; 0.05):</strong></p>
<p><strong>Highly Significant (p &lt; 0.001):</strong></p>
<ol type="1">
<li><p><strong>Area</strong>: β = 0.00446 (p &lt; 2e-16)</p>
<ul>
<li>Each additional m² increases price by ~0.45%</li>
</ul></li>
<li><p><strong>Garage</strong>: β = 0.0794 (p = 6.45e-07)</p>
<ul>
<li>Having a garage increases price by ~8.3% [exp(0.0794)-1]</li>
</ul></li>
<li><p><strong>Elevator</strong>: β = 0.102 (p = 4.12e-07)</p>
<ul>
<li>Having elevator increases price by ~10.7%</li>
</ul></li>
<li><p><strong>Toilets</strong>: β = 0.0765 (p = 8.35e-05)</p>
<ul>
<li>Each additional toilet increases price by ~8.0%</li>
</ul></li>
<li><p><strong>Zone</strong>: Many zones highly significant</p></li>
<li><p><strong>Category</strong>: Several categories significant</p></li>
</ol>
<p><strong>Moderately Significant (0.001 &lt; p &lt; 0.05):</strong></p>
<ul>
<li><p>Various zone and category levels</p></li>
<li><p><strong>outE25</strong>: β = 0.165 (p = 0.000854) - 18.0% price premium</p></li>
<li><p><strong>Storage</strong>: β = 0.0336 (p = 0.0282) - 3.4% price increase</p></li>
</ul>
<p><strong>Coefficient Interpretation (Log-Linear Model):</strong></p>
<p>Since the response is log-transformed:</p>
<ul>
<li><p><strong>Continuous predictors</strong>: β represents the proportional change in price for a 1-unit increase</p>
<ul>
<li>Example: Area coefficient = 0.00446 means 1 m² increase → 0.446% price increase</li>
</ul></li>
<li><p><strong>Binary/Categorical predictors</strong>: exp(β) - 1 gives the percentage change</p>
<ul>
<li><p>Example: Garage coefficient = 0.0794 → exp(0.0794) - 1 = 0.0826 = <strong>8.26% price increase</strong></p></li>
<li><p>Example: Elevator coefficient = 0.102 → exp(0.102) - 1 = 0.1074 = <strong>10.74% price increase</strong></p></li>
</ul></li>
</ul>
</section>
</section>
<section id="model-f" class="level2">
<h2 class="anchored" data-anchor-id="model-f">Model (F)</h2>
<p>Use the criterion-based procedure AIC, which for linear regression is equivalent to Mallow’s Cp, to develop a model that predicts <code>log(totalprice)</code> using the variables in <code>VIT2005</code>. Store the model in the object <code>modelF</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb480"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the cleaned dataset</span></span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true" tabindex="-1"></a>full_model_log_F <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_totalprice <span class="sc">~</span> ., <span class="at">data =</span> VIT2005_log)</span>
<span id="cb480-3"><a href="#cb480-3" aria-hidden="true" tabindex="-1"></a>modelF <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full_model_log_F, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="dv">1</span>, <span class="at">k =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-1080.46
log_totalprice ~ area + zone + category + age + floor + rooms + 
    out + conservation + toilets + garage + elevator + streetcategory + 
    heating + storage

                 Df Sum of Sq     RSS      AIC
- conservation    3   0.01134 0.99029 -1083.95
- age             1   0.00061 0.97956 -1082.32
- floor           1   0.00185 0.98080 -1082.05
- rooms           1   0.00422 0.98317 -1081.52
&lt;none&gt;                        0.97895 -1080.46
- streetcategory  3   0.03040 1.00935 -1079.79
- heating         3   0.04007 1.01902 -1077.71
- storage         1   0.03280 1.01175 -1075.27
- out             3   0.06721 1.04616 -1071.98
- category        6   0.10125 1.08020 -1071.00
- toilets         1   0.08460 1.06356 -1064.39
- garage          1   0.14304 1.12199 -1052.73
- elevator        1   0.14529 1.12424 -1052.29
- area            1   0.45808 1.43703  -998.78
- zone           22   1.25852 2.23747  -944.25

Step:  AIC=-1083.95
log_totalprice ~ area + zone + category + age + floor + rooms + 
    out + toilets + garage + elevator + streetcategory + heating + 
    storage

                 Df Sum of Sq     RSS      AIC
- age             1   0.00055 0.99084 -1085.83
- floor           1   0.00224 0.99253 -1085.45
- rooms           1   0.00381 0.99410 -1085.11
&lt;none&gt;                        0.99029 -1083.95
- streetcategory  3   0.03348 1.02376 -1082.70
- heating         3   0.03991 1.03019 -1081.34
+ conservation    3   0.01134 0.97895 -1080.46
- storage         1   0.02946 1.01975 -1079.56
- out             3   0.06668 1.05696 -1075.74
- category        6   0.11616 1.10644 -1071.77
- toilets         1   0.08898 1.07926 -1067.19
- elevator        1   0.14290 1.13319 -1056.56
- garage          1   0.15198 1.14226 -1054.82
- area            1   0.45804 1.44832 -1003.07
- zone           22   1.25434 2.24462  -949.56

Step:  AIC=-1085.83
log_totalprice ~ area + zone + category + floor + rooms + out + 
    toilets + garage + elevator + streetcategory + heating + 
    storage

                 Df Sum of Sq     RSS     AIC
- floor           1   0.00212 0.99295 -1087.4
- rooms           1   0.00384 0.99468 -1087.0
&lt;none&gt;                        0.99084 -1085.8
- streetcategory  3   0.03302 1.02385 -1084.7
+ age             1   0.00055 0.99029 -1084.0
- heating         3   0.03941 1.03025 -1083.3
+ conservation    3   0.01128 0.97956 -1082.3
- storage         1   0.03105 1.02189 -1081.1
- out             3   0.07314 1.06397 -1076.3
- category        6   0.12795 1.11878 -1071.3
- toilets         1   0.08930 1.08013 -1069.0
- elevator        1   0.14955 1.14039 -1057.2
- garage          1   0.15229 1.14313 -1056.7
- area            1   0.46386 1.45470 -1004.1
- zone           22   1.27513 2.26596  -949.5

Step:  AIC=-1087.36
log_totalprice ~ area + zone + category + rooms + out + toilets + 
    garage + elevator + streetcategory + heating + storage

                 Df Sum of Sq     RSS      AIC
- rooms           1   0.00390 0.99685 -1088.51
&lt;none&gt;                        0.99295 -1087.36
- streetcategory  3   0.03140 1.02435 -1086.57
+ floor           1   0.00212 0.99084 -1085.83
+ age             1   0.00042 0.99253 -1085.45
- heating         3   0.04104 1.03400 -1084.53
+ conservation    3   0.01138 0.98158 -1083.87
- storage         1   0.02921 1.02217 -1083.04
- out             3   0.07320 1.06615 -1077.86
- category        6   0.13186 1.12482 -1072.18
- toilets         1   0.08971 1.08266 -1070.51
- garage          1   0.15125 1.14420 -1058.45
- elevator        1   0.15179 1.14474 -1058.35
- area            1   0.46227 1.45522 -1006.04
- zone           22   1.32477 2.31772  -946.57

Step:  AIC=-1088.51
log_totalprice ~ area + zone + category + out + toilets + garage + 
    elevator + streetcategory + heating + storage

                 Df Sum of Sq     RSS      AIC
&lt;none&gt;                        0.99685 -1088.51
- streetcategory  3   0.03042 1.02727 -1087.95
+ rooms           1   0.00390 0.99295 -1087.36
+ floor           1   0.00217 0.99468 -1086.98
+ age             1   0.00045 0.99640 -1086.61
- heating         3   0.04262 1.03947 -1085.38
+ conservation    3   0.01098 0.98587 -1084.92
- storage         1   0.02789 1.02474 -1084.49
- out             3   0.07696 1.07381 -1078.30
- category        6   0.12882 1.12567 -1074.01
- toilets         1   0.09245 1.08930 -1071.17
- garage          1   0.15205 1.14890 -1059.56
- elevator        1   0.15775 1.15460 -1058.48
- area            1   0.63037 1.62722  -983.68
- zone           22   1.32105 2.31790  -948.56</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb482"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update formula to use log(totalprice)</span></span>
<span id="cb482-2"><a href="#cb482-2" aria-hidden="true" tabindex="-1"></a>modelF_formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">gsub</span>(<span class="st">"log_totalprice"</span>, <span class="st">"log(totalprice)"</span>, </span>
<span id="cb482-3"><a href="#cb482-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">deparse</span>(<span class="fu">formula</span>(modelF))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in formula.character(object, env = baseenv()): Using formula(x) is deprecated when x is a character vector of length &gt; 1.
  Consider formula(paste(x, collapse = " ")) instead.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb484"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a>modelF <span class="ot">&lt;-</span> <span class="fu">lm</span>(modelF_formula, <span class="at">data =</span> VIT2005)</span>
<span id="cb484-2"><a href="#cb484-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model F Formula:"</span>, <span class="fu">deparse</span>(<span class="fu">formula</span>(modelF)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model F Formula: log(totalprice) ~ area + zone + category + out + toilets + garage +      elevator + streetcategory + heating + storage </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb486"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelF)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = modelF_formula, data = VIT2005)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.222817 -0.044929  0.000173  0.048212  0.265943 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      11.800102   0.083176 141.869  &lt; 2e-16 ***
area              0.004461   0.000424  10.520  &lt; 2e-16 ***
zoneZ21           0.314844   0.044556   7.066 3.63e-11 ***
zoneZ31           0.280174   0.046670   6.003 1.09e-08 ***
zoneZ32           0.179278   0.041177   4.354 2.27e-05 ***
zoneZ34           0.094760   0.051693   1.833 0.068480 .  
zoneZ35           0.282519   0.050097   5.639 6.73e-08 ***
zoneZ36           0.169712   0.042477   3.995 9.50e-05 ***
zoneZ37           0.300758   0.042972   6.999 5.29e-11 ***
zoneZ38           0.122263   0.052668   2.321 0.021417 *  
zoneZ41           0.218347   0.040695   5.365 2.53e-07 ***
zoneZ42           0.277204   0.052376   5.293 3.58e-07 ***
zoneZ43           0.162943   0.052892   3.081 0.002399 ** 
zoneZ44           0.136301   0.050824   2.682 0.008023 ** 
zoneZ45           0.079627   0.042374   1.879 0.061887 .  
zoneZ46           0.062723   0.044841   1.399 0.163652    
zoneZ47          -0.006309   0.047380  -0.133 0.894229    
zoneZ48           0.162198   0.046585   3.482 0.000629 ***
zoneZ49           0.141134   0.049702   2.840 0.005052 ** 
zoneZ52           0.056549   0.042931   1.317 0.189490    
zoneZ53           0.109465   0.043431   2.520 0.012615 *  
zoneZ56           0.133565   0.048970   2.727 0.007032 ** 
zoneZ61           0.095688   0.040434   2.367 0.019050 *  
zoneZ62           0.059944   0.040679   1.474 0.142388    
category2B       -0.008112   0.049200  -0.165 0.869232    
category3A       -0.062638   0.047913  -1.307 0.192816    
category3B       -0.077811   0.049199  -1.582 0.115552    
category4A       -0.105547   0.051056  -2.067 0.040183 *  
category4B       -0.149403   0.053548  -2.790 0.005854 ** 
category5A       -0.237579   0.083556  -2.843 0.004996 ** 
outE25            0.165305   0.048717   3.393 0.000854 ***
outE50           -0.005366   0.013374  -0.401 0.688766    
outE75            0.037254   0.034941   1.066 0.287798    
toilets           0.076538   0.018999   4.029 8.35e-05 ***
garage            0.079385   0.015365   5.166 6.45e-07 ***
elevator          0.102132   0.019408   5.262 4.12e-07 ***
streetcategoryS3  0.036227   0.019345   1.873 0.062782 .  
streetcategoryS4  0.015145   0.021082   0.718 0.473477    
streetcategoryS5 -0.023253   0.034943  -0.665 0.506631    
heating3A        -0.011383   0.040212  -0.283 0.777454    
heating3B        -0.008138   0.051433  -0.158 0.874456    
heating4A         0.030569   0.042446   0.720 0.472365    
storage           0.033641   0.015204   2.213 0.028210 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.07547 on 175 degrees of freedom
Multiple R-squared:  0.9202,    Adjusted R-squared:  0.901 
F-statistic: 48.02 on 42 and 175 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Model F: AIC-Based Selection with Log(totalprice)</p>
<p><strong>Model Selection Process:</strong></p>
<p>The <code>stepAIC</code> function with AIC criterion (k=2) performed bidirectional selection on the log-transformed response.</p>
<p><strong>Final Model F</strong> includes the same 10 predictors as Model E:</p>
<ul>
<li>area, zone, category, out, toilets, garage, elevator, streetcategory, heating, storage</li>
</ul>
<p><strong>Key Finding</strong>: <strong>Model F is IDENTICAL to Model E</strong></p>
<p>Both AIC-based stepwise selection and backward elimination converged to the same model when using log(totalprice) as the response.</p>
<section id="i-compute-cv_n-for-modelf.-set-the-seed-to-5-and-compute-cv_5-for-modelf." class="level4">
<h4 class="anchored" data-anchor-id="i-compute-cv_n-for-modelf.-set-the-seed-to-5-and-compute-cv_5-for-modelf.">(i) Compute <span class="math inline">\(CV_n\)</span> for <code>modelF</code>. Set the seed to 5 and compute <span class="math inline">\(CV_5\)</span> for <code>modelF</code>.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb488"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (i) Cross-validation</span></span>
<span id="cb488-2"><a href="#cb488-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model F Cross-Validation ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model F Cross-Validation ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb490"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a>modelF_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">formula</span>(modelF), <span class="at">data =</span> VIT2005)</span>
<span id="cb490-2"><a href="#cb490-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-3"><a href="#cb490-3" aria-hidden="true" tabindex="-1"></a>cv_n_F <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelF_glm)</span>
<span id="cb490-4"><a href="#cb490-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_n (LOOCV):"</span>, cv_n_F<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_n (LOOCV): 0.007080105 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb492"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb492-2"><a href="#cb492-2" aria-hidden="true" tabindex="-1"></a>cv_5_F <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelF_glm, <span class="at">K =</span> <span class="dv">5</span>)</span>
<span id="cb492-3"><a href="#cb492-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_5:"</span>, cv_5_F<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_5: 0.007358635 </code></pre>
</div>
</div>
<ul>
<li><p><strong>CV_n (Leave-One-Out Cross-Validation)</strong>: 0.007080105</p></li>
<li><p><strong>CV_5 (Five-Fold Cross-Validation with seed = 5)</strong>: 0.007358635</p></li>
</ul>
<p>These are identical to Model E (as expected since it’s the same model).</p>
</section>
<section id="ii-compute-r2-r2_a-the-aic-and-the-bic-for-model-f.-what-is-the-proportion-of-total-variability-explained-by-model-f" class="level4">
<h4 class="anchored" data-anchor-id="ii-compute-r2-r2_a-the-aic-and-the-bic-for-model-f.-what-is-the-proportion-of-total-variability-explained-by-model-f">(ii) Compute <span class="math inline">\(R^2, R^2_a\)</span>, the AIC, and the BIC for Model (F). What is the proportion of total variability explained by Model (F)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb494"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (ii) Model metrics</span></span>
<span id="cb494-2"><a href="#cb494-2" aria-hidden="true" tabindex="-1"></a>summary_F <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelF)</span>
<span id="cb494-3"><a href="#cb494-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model F Metrics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model F Metrics ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb496"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, summary_F<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.9201524 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb498"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Adjusted R-squared:"</span>, summary_F<span class="sc">$</span>adj.r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R-squared: 0.900989 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb500"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(modelF), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: -467.8506 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb502"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC:"</span>, <span class="fu">BIC</span>(modelF), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC: -318.9328 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb504"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Proportion of variability explained:"</span>, summary_F<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Proportion of variability explained: 0.9201524 </code></pre>
</div>
</div>
<p><strong>Proportion of total variability explained by Model (F)</strong>: <strong>92.02%</strong></p>
<p>This means that Model F explains approximately 92% of the variability in log(totalprice) using the selected predictors. The adjusted R² of 0.901 (90.1%) accounts for the number of predictors in the model and still indicates excellent explanatory power.</p>
</section>
</section>
<section id="model-g" class="level2">
<h2 class="anchored" data-anchor-id="model-g">Model (G)</h2>
<p>Use the criterion-based procedure BIC to develop a model that predicts <code>log(totalprice)</code> using the variables in <code>VIT2005</code>. Store the model in the object <code>modelG</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb506"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the cleaned dataset</span></span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true" tabindex="-1"></a>full_model_log_G <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_totalprice <span class="sc">~</span> ., <span class="at">data =</span> VIT2005_log)</span>
<span id="cb506-3"><a href="#cb506-3" aria-hidden="true" tabindex="-1"></a>modelG <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full_model_log_G, <span class="at">direction =</span> <span class="st">"both"</span>, </span>
<span id="cb506-4"><a href="#cb506-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="fu">log</span>(<span class="fu">nrow</span>(VIT2005_log)), <span class="at">trace =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-914.62
log_totalprice ~ area + zone + category + age + floor + rooms + 
    out + conservation + toilets + garage + elevator + streetcategory + 
    heating + storage

                 Df Sum of Sq     RSS     AIC
- conservation    3   0.01134 0.99029 -928.26
- category        6   0.10125 1.08020 -925.47
- streetcategory  3   0.03040 1.00935 -924.10
- heating         3   0.04007 1.01902 -922.02
- age             1   0.00061 0.97956 -919.87
- floor           1   0.00185 0.98080 -919.59
- rooms           1   0.00422 0.98317 -919.06
- out             3   0.06721 1.04616 -916.30
&lt;none&gt;                        0.97895 -914.62
- storage         1   0.03280 1.01175 -912.82
- toilets         1   0.08460 1.06356 -901.93
- garage          1   0.14304 1.12199 -890.27
- elevator        1   0.14529 1.12424 -889.83
- zone           22   1.25852 2.23747 -852.87
- area            1   0.45808 1.43703 -836.32

Step:  AIC=-928.26
log_totalprice ~ area + zone + category + age + floor + rooms + 
    out + toilets + garage + elevator + streetcategory + heating + 
    storage

                 Df Sum of Sq     RSS     AIC
- streetcategory  3   0.03348 1.02376 -937.17
- category        6   0.11616 1.10644 -936.39
- heating         3   0.03991 1.03019 -935.80
- age             1   0.00055 0.99084 -933.52
- floor           1   0.00224 0.99253 -933.15
- rooms           1   0.00381 0.99410 -932.81
- out             3   0.06668 1.05696 -930.21
&lt;none&gt;                        0.99029 -928.26
- storage         1   0.02946 1.01975 -927.26
- toilets         1   0.08898 1.07926 -914.89
+ conservation    3   0.01134 0.97895 -914.62
- elevator        1   0.14290 1.13319 -904.26
- garage          1   0.15198 1.14226 -902.52
- zone           22   1.25434 2.24462 -868.33
- area            1   0.45804 1.44832 -850.77

Step:  AIC=-937.17
log_totalprice ~ area + zone + category + age + floor + rooms + 
    out + toilets + garage + elevator + heating + storage

                 Df Sum of Sq     RSS     AIC
- category        6   0.12555 1.14932 -944.26
- heating         3   0.04560 1.06937 -943.82
- age             1   0.00009 1.02385 -942.53
- floor           1   0.00052 1.02428 -942.44
- rooms           1   0.00286 1.02662 -941.94
- out             3   0.06835 1.09211 -939.23
&lt;none&gt;                        1.02376 -937.17
- storage         1   0.04258 1.06634 -933.67
+ streetcategory  3   0.03348 0.99029 -928.26
+ conservation    3   0.01441 1.00935 -924.10
- toilets         1   0.09505 1.11881 -923.20
- elevator        1   0.13772 1.16148 -915.04
- garage          1   0.15324 1.17700 -912.14
- zone           22   1.26578 2.28954 -880.16
- area            1   0.44375 1.46751 -864.05

Step:  AIC=-944.26
log_totalprice ~ area + zone + age + floor + rooms + out + toilets + 
    garage + elevator + heating + storage

                 Df Sum of Sq    RSS     AIC
- out             3   0.04504 1.1944 -952.03
- rooms           1   0.00053 1.1499 -949.54
- floor           1   0.00303 1.1523 -949.07
- heating         3   0.06482 1.2141 -948.45
- age             1   0.00879 1.1581 -947.98
- storage         1   0.02872 1.1780 -944.26
&lt;none&gt;                        1.1493 -944.26
+ category        6   0.12555 1.0238 -937.17
+ streetcategory  3   0.04287 1.1064 -936.39
+ conservation    3   0.03318 1.1161 -934.49
- toilets         1   0.17704 1.3264 -918.41
- garage          1   0.17865 1.3280 -918.14
- elevator        1   0.20584 1.3552 -913.72
- zone           22   1.31896 2.4683 -896.09
- area            1   0.48299 1.6323 -873.16

Step:  AIC=-952.03
log_totalprice ~ area + zone + age + floor + rooms + toilets + 
    garage + elevator + heating + storage

                 Df Sum of Sq    RSS     AIC
- heating         3   0.05704 1.2514 -958.01
- rooms           1   0.00251 1.1969 -956.95
- floor           1   0.00371 1.1981 -956.74
- age             1   0.01900 1.2134 -953.97
- storage         1   0.02881 1.2232 -952.22
&lt;none&gt;                        1.1944 -952.03
+ streetcategory  3   0.04545 1.1489 -944.33
+ out             3   0.04504 1.1493 -944.26
+ conservation    3   0.03021 1.1642 -941.46
+ category        6   0.10224 1.0921 -939.23
- toilets         1   0.15903 1.3534 -930.16
- garage          1   0.16888 1.3632 -928.58
- elevator        1   0.20044 1.3948 -923.59
- zone           22   1.32405 2.5184 -907.86
- area            1   0.48420 1.6785 -883.22

Step:  AIC=-958.01
log_totalprice ~ area + zone + age + floor + rooms + toilets + 
    garage + elevator + storage

                 Df Sum of Sq    RSS     AIC
- rooms           1   0.00384 1.2552 -962.73
- floor           1   0.00808 1.2595 -961.99
- age             1   0.02108 1.2725 -959.75
&lt;none&gt;                        1.2514 -958.01
- storage         1   0.05236 1.3038 -954.46
+ heating         3   0.05704 1.1944 -952.03
+ streetcategory  3   0.05054 1.2009 -950.84
+ out             3   0.03727 1.2141 -948.45
+ conservation    3   0.03196 1.2194 -947.50
+ category        6   0.11390 1.1375 -946.51
- garage          1   0.16188 1.4133 -936.88
- toilets         1   0.17292 1.4243 -935.18
- elevator        1   0.23193 1.4833 -926.33
- zone           22   1.33364 2.5850 -918.32
- area            1   0.51488 1.7663 -888.27

Step:  AIC=-962.73
log_totalprice ~ area + zone + age + floor + toilets + garage + 
    elevator + storage

                 Df Sum of Sq    RSS     AIC
- floor           1   0.00830 1.2635 -966.67
- age             1   0.02116 1.2764 -964.47
&lt;none&gt;                        1.2552 -962.73
- storage         1   0.05058 1.3058 -959.50
+ rooms           1   0.00384 1.2514 -958.01
+ heating         3   0.05837 1.1969 -956.95
+ streetcategory  3   0.04991 1.2053 -955.42
+ out             3   0.03972 1.2155 -953.58
+ conservation    3   0.03108 1.2242 -952.04
+ category        6   0.10941 1.1458 -950.30
- garage          1   0.16145 1.4167 -941.74
- toilets         1   0.17660 1.4318 -939.42
- elevator        1   0.24218 1.4974 -929.65
- zone           22   1.32984 2.5851 -923.70
- area            1   0.70604 1.9613 -870.83

Step:  AIC=-966.67
log_totalprice ~ area + zone + age + toilets + garage + elevator + 
    storage

                 Df Sum of Sq    RSS     AIC
- age             1   0.02130 1.2849 -968.41
&lt;none&gt;                        1.2635 -966.67
- storage         1   0.04511 1.3087 -964.41
+ floor           1   0.00830 1.2552 -962.73
+ rooms           1   0.00407 1.2595 -961.99
+ heating         3   0.06286 1.2007 -961.65
+ streetcategory  3   0.04486 1.2187 -958.40
+ out             3   0.04027 1.2233 -957.58
+ conservation    3   0.03193 1.2316 -956.10
+ category        6   0.11556 1.1480 -955.28
- garage          1   0.16071 1.4243 -945.96
- toilets         1   0.17698 1.4405 -943.48
- elevator        1   0.24987 1.5134 -932.72
- zone           22   1.34544 2.6090 -927.07
- area            1   0.70411 1.9677 -875.50

Step:  AIC=-968.41
log_totalprice ~ area + zone + toilets + garage + elevator + 
    storage

                 Df Sum of Sq    RSS     AIC
&lt;none&gt;                        1.2849 -968.41
+ age             1   0.02130 1.2635 -966.67
+ floor           1   0.00844 1.2764 -964.47
- storage         1   0.06035 1.3452 -963.79
+ rooms           1   0.00415 1.2807 -963.74
+ heating         3   0.06516 1.2197 -963.61
+ conservation    3   0.05262 1.2322 -961.38
+ out             3   0.04873 1.2361 -960.69
+ category        6   0.13511 1.1497 -960.33
+ streetcategory  3   0.03996 1.2449 -959.15
- garage          1   0.16860 1.4534 -946.92
- toilets         1   0.18619 1.4710 -944.30
- elevator        1   0.28531 1.5701 -930.08
- zone           22   1.44533 2.7302 -922.56
- area            1   0.68283 1.9677 -880.89</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb508"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update formula to use log(totalprice)</span></span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true" tabindex="-1"></a>modelG_formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">gsub</span>(<span class="st">"log_totalprice"</span>, <span class="st">"log(totalprice)"</span>, </span>
<span id="cb508-3"><a href="#cb508-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">deparse</span>(<span class="fu">formula</span>(modelG))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in formula.character(object, env = baseenv()): Using formula(x) is deprecated when x is a character vector of length &gt; 1.
  Consider formula(paste(x, collapse = " ")) instead.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb510"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a>modelG <span class="ot">&lt;-</span> <span class="fu">lm</span>(modelG_formula, <span class="at">data =</span> VIT2005)</span>
<span id="cb510-2"><a href="#cb510-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model G Formula:"</span>, <span class="fu">deparse</span>(<span class="fu">formula</span>(modelG)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model G Formula: log(totalprice) ~ area + zone + toilets + garage + elevator +      storage </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb512"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelG)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = modelG_formula, data = VIT2005)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.23683 -0.03953  0.00451  0.04920  0.31278 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 11.651257   0.043443 268.198  &lt; 2e-16 ***
area         0.004401   0.000438  10.049  &lt; 2e-16 ***
zoneZ21      0.358359   0.044468   8.059 8.36e-14 ***
zoneZ31      0.307375   0.044616   6.889 8.00e-11 ***
zoneZ32      0.196280   0.040583   4.836 2.72e-06 ***
zoneZ34      0.117444   0.050858   2.309 0.022005 *  
zoneZ35      0.301831   0.051444   5.867 1.94e-08 ***
zoneZ36      0.183552   0.043221   4.247 3.39e-05 ***
zoneZ37      0.307650   0.040067   7.678 8.27e-13 ***
zoneZ38      0.149666   0.052682   2.841 0.004989 ** 
zoneZ41      0.248177   0.040695   6.098 5.87e-09 ***
zoneZ42      0.272166   0.050192   5.423 1.77e-07 ***
zoneZ43      0.225136   0.051694   4.355 2.17e-05 ***
zoneZ44      0.197530   0.050878   3.882 0.000143 ***
zoneZ45      0.118399   0.041164   2.876 0.004484 ** 
zoneZ46      0.095493   0.042205   2.263 0.024792 *  
zoneZ47      0.063157   0.044024   1.435 0.153041    
zoneZ48      0.188875   0.046007   4.105 5.99e-05 ***
zoneZ49      0.174140   0.049890   3.490 0.000599 ***
zoneZ52      0.076527   0.041613   1.839 0.067472 .  
zoneZ53      0.139277   0.042545   3.274 0.001261 ** 
zoneZ56      0.198326   0.046526   4.263 3.18e-05 ***
zoneZ61      0.128767   0.040188   3.204 0.001589 ** 
zoneZ62      0.097954   0.037869   2.587 0.010439 *  
toilets      0.098690   0.018808   5.247 4.10e-07 ***
garage       0.081601   0.016342   4.993 1.34e-06 ***
elevator     0.126587   0.019489   6.495 7.06e-10 ***
storage      0.045528   0.015241   2.987 0.003186 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.08223 on 190 degrees of freedom
Multiple R-squared:  0.8971,    Adjusted R-squared:  0.8825 
F-statistic: 61.34 on 27 and 190 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Model G: BIC-Based Selection with Log-Transformed Response</p>
<p><strong>Model Selection Process:</strong></p>
<p>The <code>stepAIC</code> function with BIC criterion (k = log(218) ≈ 5.38) performed <strong>bidirectional selection</strong> on the log-transformed response.</p>
<p>The BIC criterion penalizes model complexity more heavily than AIC, leading to a <strong>more parsimonious model</strong>.</p>
<p><strong>Variables removed</strong> (in order):</p>
<ol type="1">
<li><p><strong>Conservation</strong> (Step 1)</p></li>
<li><p><strong>Streetcategory</strong> (Step 2)</p></li>
<li><p><strong>Category</strong> (Step 3)</p></li>
<li><p><strong>Out</strong> (Step 4)</p></li>
<li><p><strong>Heating</strong> (Step 5)</p></li>
<li><p><strong>Rooms</strong> (Step 6)</p></li>
<li><p><strong>Floor</strong> (Step 7)</p></li>
<li><p><strong>Age</strong> (Step 8)</p></li>
</ol>
<p><strong>Final Model G</strong> includes only <strong>6 predictors</strong>:</p>
<ul>
<li>area, zone, toilets, garage, elevator, storage</li>
</ul>
<p>This is <strong>identical to Model C</strong> (which also had 6 predictors with untransformed response), showing that BIC consistently selects the same variables regardless of transformation.</p>
<section id="i-compute-cv_n-for-modelg.-set-the-seed-to-5-and-compute-cv_5-for-modelg." class="level4">
<h4 class="anchored" data-anchor-id="i-compute-cv_n-for-modelg.-set-the-seed-to-5-and-compute-cv_5-for-modelg.">(i) Compute <span class="math inline">\(CV_n\)</span> for <code>modelG</code>. Set the seed to 5 and compute <span class="math inline">\(CV_5\)</span> for <code>modelG</code>.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb514"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (i) Cross-validation</span></span>
<span id="cb514-2"><a href="#cb514-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model G Cross-Validation ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model G Cross-Validation ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb516"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a>modelG_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">formula</span>(modelG), <span class="at">data =</span> VIT2005)</span>
<span id="cb516-2"><a href="#cb516-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-3"><a href="#cb516-3" aria-hidden="true" tabindex="-1"></a>cv_n_G <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelG_glm)</span>
<span id="cb516-4"><a href="#cb516-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_n (LOOCV):"</span>, cv_n_G<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_n (LOOCV): 0.007796288 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb518"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb518-2"><a href="#cb518-2" aria-hidden="true" tabindex="-1"></a>cv_5_G <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelG_glm, <span class="at">K =</span> <span class="dv">5</span>)</span>
<span id="cb518-3"><a href="#cb518-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_5:"</span>, cv_5_G<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_5: 0.008354265 </code></pre>
</div>
</div>
</section>
<section id="ii-compute-r2-r2_a-the-aic-and-the-bic-for-model-g.-what-is-the-proportion-of-total-variability-explained-by-model-g" class="level4">
<h4 class="anchored" data-anchor-id="ii-compute-r2-r2_a-the-aic-and-the-bic-for-model-g.-what-is-the-proportion-of-total-variability-explained-by-model-g">(ii) Compute <span class="math inline">\(R^2, R^2_a\)</span>, the AIC, and the BIC for Model (G). What is the proportion of total variability explained by Model (G)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb520"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (ii) Model metrics</span></span>
<span id="cb520-2"><a href="#cb520-2" aria-hidden="true" tabindex="-1"></a>summary_G <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelG)</span>
<span id="cb520-3"><a href="#cb520-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model G Metrics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model G Metrics ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb522"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, summary_G<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.897084 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb524"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Adjusted R-squared:"</span>, summary_G<span class="sc">$</span>adj.r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R-squared: 0.8824591 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb526"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(modelG), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: -442.5236 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb528"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC:"</span>, <span class="fu">BIC</span>(modelG), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC: -344.3732 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb530"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Proportion of variability explained:"</span>, summary_G<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Proportion of variability explained: 0.897084 </code></pre>
</div>
</div>
<p><strong>Proportion of total variability explained by Model (G)</strong>: <strong>89.71%</strong></p>
<p>This means that Model G explains approximately 89.71% of the variability in log(totalprice) using the selected predictors. The adjusted R² of 0.8825 (88.25%) accounts for the number of predictors in the model and still indicates very good explanatory power.</p>
<p>This is approximately 2.3% less than Models E and F (92.02%), which is the cost of having a much simpler model with 4 fewer predictors.</p>
</section>
</section>
<section id="model-h" class="level2">
<h2 class="anchored" data-anchor-id="model-h">Model (H)</h2>
<p>Use forward selection to develop a model that predicts log(<code>totalprice</code>) using the variables in <code>VIT2005</code>. Use a “p-value to add” of 5%. Store the final model in the object <code>modelH</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb532"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start with intercept only</span></span>
<span id="cb532-2"><a href="#cb532-2" aria-hidden="true" tabindex="-1"></a>null_model_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_totalprice <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> VIT2005_log)</span>
<span id="cb532-3"><a href="#cb532-3" aria-hidden="true" tabindex="-1"></a>full_model_log_H <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_totalprice <span class="sc">~</span> ., <span class="at">data =</span> VIT2005_log)</span>
<span id="cb532-4"><a href="#cb532-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-5"><a href="#cb532-5" aria-hidden="true" tabindex="-1"></a>modelH <span class="ot">&lt;-</span> <span class="fu">step</span>(null_model_log, </span>
<span id="cb532-6"><a href="#cb532-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">scope =</span> <span class="fu">formula</span>(full_model_log_H), </span>
<span id="cb532-7"><a href="#cb532-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">direction =</span> <span class="st">"forward"</span>, </span>
<span id="cb532-8"><a href="#cb532-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">trace =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-621.48
log_totalprice ~ 1

                 Df Sum of Sq     RSS     AIC
+ area            1    7.8362  4.6482 -834.87
+ zone           22    7.5626  4.9218 -780.40
+ toilets         1    6.1982  6.2862 -769.06
+ category        6    4.8773  7.6071 -717.48
+ elevator        1    4.0709  8.4135 -705.52
+ rooms           1    3.3932  9.0912 -688.63
+ garage          1    3.3694  9.1150 -688.06
+ heating         3    2.0692 10.4152 -654.99
+ age             1    1.2432 11.2412 -642.35
+ streetcategory  3    1.3194 11.1650 -639.83
+ conservation    3    1.3130 11.1715 -639.71
+ storage         1    1.0175 11.4669 -638.02
&lt;none&gt;                        12.4844 -621.48
+ floor           1    0.0307 12.4537 -620.02
+ out             3    0.1954 12.2890 -618.92

Step:  AIC=-834.87
log_totalprice ~ area

                 Df Sum of Sq    RSS     AIC
+ zone           22   2.38890 2.2593 -948.14
+ category        6   1.39298 3.2552 -900.52
+ elevator        1   0.98718 3.6610 -884.91
+ age             1   0.94091 3.7073 -882.17
+ toilets         1   0.89664 3.7516 -879.59
+ garage          1   0.82734 3.8209 -875.60
+ conservation    3   0.56107 4.0871 -856.91
+ storage         1   0.35116 4.2970 -849.99
+ heating         3   0.41740 4.2308 -849.38
&lt;none&gt;                        4.6482 -834.87
+ rooms           1   0.00522 4.6430 -833.11
+ floor           1   0.00287 4.6453 -833.00
+ out             3   0.06955 4.5787 -832.15
+ streetcategory  3   0.01528 4.6329 -829.58

Step:  AIC=-948.14
log_totalprice ~ area + zone

                 Df Sum of Sq    RSS     AIC
+ elevator        1   0.42018 1.8391 -991.00
+ category        6   0.49734 1.7620 -990.34
+ toilets         1   0.40710 1.8522 -989.45
+ garage          1   0.36212 1.8972 -984.22
+ conservation    3   0.19686 2.0624 -962.01
+ age             1   0.15632 2.1030 -961.77
+ heating         3   0.17104 2.0883 -959.30
+ storage         1   0.11314 2.1462 -957.34
+ streetcategory  3   0.06860 2.1907 -948.86
+ rooms           1   0.02241 2.2369 -948.31
&lt;none&gt;                        2.2593 -948.14
+ floor           1   0.00580 2.2535 -946.70
+ out             3   0.02187 2.2374 -944.26

Step:  AIC=-991
log_totalprice ~ area + zone + elevator

                 Df Sum of Sq    RSS      AIC
+ toilets         1   0.31527 1.5238 -1029.99
+ garage          1   0.29349 1.5456 -1026.90
+ category        6   0.33470 1.5044 -1022.79
+ conservation    3   0.15473 1.6844 -1004.15
+ heating         3   0.12922 1.7099 -1000.88
+ storage         1   0.09418 1.7450 -1000.45
+ age             1   0.07468 1.7644  -998.03
+ streetcategory  3   0.07074 1.7684  -993.55
&lt;none&gt;                        1.8391  -991.00
+ rooms           1   0.00485 1.8343  -989.57
+ floor           1   0.00118 1.8379  -989.13
+ out             3   0.01315 1.8260  -986.56

Step:  AIC=-1029.99
log_totalprice ~ area + zone + elevator + toilets

                 Df Sum of Sq    RSS     AIC
+ garage          1  0.178658 1.3452 -1055.2
+ category        6  0.178990 1.3449 -1045.2
+ storage         1  0.070407 1.4534 -1038.3
+ heating         3  0.092733 1.4311 -1037.7
+ conservation    3  0.081656 1.4422 -1036.0
+ age             1  0.048398 1.4754 -1035.0
+ streetcategory  3  0.062161 1.4617 -1033.1
&lt;none&gt;                        1.5238 -1030.0
+ out             3  0.037545 1.4863 -1029.4
+ floor           1  0.001602 1.5223 -1028.2
+ rooms           1  0.001585 1.5223 -1028.2

Step:  AIC=-1055.17
log_totalprice ~ area + zone + elevator + toilets + garage

                 Df Sum of Sq    RSS     AIC
+ category        6  0.142650 1.2025 -1067.6
+ heating         3  0.094803 1.2504 -1065.1
+ storage         1  0.060346 1.2849 -1063.2
+ conservation    3  0.061414 1.2838 -1059.4
+ age             1  0.036534 1.3087 -1059.2
+ streetcategory  3  0.058889 1.2863 -1058.9
+ out             3  0.045758 1.2994 -1056.7
&lt;none&gt;                        1.3452 -1055.2
+ floor           1  0.002271 1.3429 -1053.5
+ rooms           1  0.002035 1.3432 -1053.5

Step:  AIC=-1067.61
log_totalprice ~ area + zone + elevator + toilets + garage + 
    category

                 Df Sum of Sq    RSS     AIC
+ out             3  0.078212 1.1243 -1076.3
+ storage         1  0.052809 1.1497 -1075.4
+ streetcategory  3  0.055147 1.1474 -1071.8
+ heating         3  0.053972 1.1486 -1071.6
&lt;none&gt;                        1.2025 -1067.6
+ rooms           1  0.006518 1.1960 -1066.8
+ age             1  0.006361 1.1962 -1066.8
+ floor           1  0.000015 1.2025 -1065.6
+ conservation    3  0.015357 1.1872 -1064.4

Step:  AIC=-1076.27
log_totalprice ~ area + zone + elevator + toilets + garage + 
    category + out

                 Df Sum of Sq    RSS     AIC
+ storage         1  0.048591 1.0757 -1083.9
+ heating         3  0.055036 1.0693 -1081.2
+ streetcategory  3  0.053540 1.0708 -1080.9
&lt;none&gt;                        1.1243 -1076.3
+ rooms           1  0.002770 1.1216 -1074.8
+ age             1  0.000158 1.1242 -1074.3
+ floor           1  0.000001 1.1243 -1074.3
+ conservation    3  0.008420 1.1159 -1071.9

Step:  AIC=-1083.9
log_totalprice ~ area + zone + elevator + toilets + garage + 
    category + out + storage

                 Df Sum of Sq    RSS     AIC
+ heating         3  0.048467 1.0273 -1088.0
+ streetcategory  3  0.036269 1.0395 -1085.4
&lt;none&gt;                        1.0757 -1083.9
+ rooms           1  0.004406 1.0713 -1082.8
+ floor           1  0.001623 1.0741 -1082.2
+ age             1  0.000573 1.0752 -1082.0
+ conservation    3  0.009626 1.0661 -1079.9

Step:  AIC=-1087.95
log_totalprice ~ area + zone + elevator + toilets + garage + 
    category + out + storage + heating

                 Df Sum of Sq     RSS     AIC
+ streetcategory  3 0.0304213 0.99685 -1088.5
&lt;none&gt;                        1.02727 -1088.0
+ rooms           1 0.0029190 1.02435 -1086.6
+ floor           1 0.0005553 1.02672 -1086.1
+ age             1 0.0000741 1.02720 -1086.0
+ conservation    3 0.0123414 1.01493 -1084.6

Step:  AIC=-1088.51
log_totalprice ~ area + zone + elevator + toilets + garage + 
    category + out + storage + heating + streetcategory

               Df Sum of Sq     RSS     AIC
&lt;none&gt;                      0.99685 -1088.5
+ rooms         1 0.0038954 0.99295 -1087.4
+ floor         1 0.0021740 0.99468 -1087.0
+ age           1 0.0004460 0.99640 -1086.6
+ conservation  3 0.0109830 0.98587 -1084.9</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb534"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update formula to use log(totalprice)</span></span>
<span id="cb534-2"><a href="#cb534-2" aria-hidden="true" tabindex="-1"></a>modelH_formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">gsub</span>(<span class="st">"log_totalprice"</span>, <span class="st">"log(totalprice)"</span>, </span>
<span id="cb534-3"><a href="#cb534-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">deparse</span>(<span class="fu">formula</span>(modelH))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in formula.character(object, env = baseenv()): Using formula(x) is deprecated when x is a character vector of length &gt; 1.
  Consider formula(paste(x, collapse = " ")) instead.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb536"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a>modelH <span class="ot">&lt;-</span> <span class="fu">lm</span>(modelH_formula, <span class="at">data =</span> VIT2005)</span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model H Formula:"</span>, <span class="fu">deparse</span>(<span class="fu">formula</span>(modelH)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model H Formula: log(totalprice) ~ area + zone + elevator + toilets + garage +      category + out + storage + heating + streetcategory </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb538"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelH)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = modelH_formula, data = VIT2005)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.222817 -0.044929  0.000173  0.048212  0.265943 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      11.800102   0.083176 141.869  &lt; 2e-16 ***
area              0.004461   0.000424  10.520  &lt; 2e-16 ***
zoneZ21           0.314844   0.044556   7.066 3.63e-11 ***
zoneZ31           0.280174   0.046670   6.003 1.09e-08 ***
zoneZ32           0.179278   0.041177   4.354 2.27e-05 ***
zoneZ34           0.094760   0.051693   1.833 0.068480 .  
zoneZ35           0.282519   0.050097   5.639 6.73e-08 ***
zoneZ36           0.169712   0.042477   3.995 9.50e-05 ***
zoneZ37           0.300758   0.042972   6.999 5.29e-11 ***
zoneZ38           0.122263   0.052668   2.321 0.021417 *  
zoneZ41           0.218347   0.040695   5.365 2.53e-07 ***
zoneZ42           0.277204   0.052376   5.293 3.58e-07 ***
zoneZ43           0.162943   0.052892   3.081 0.002399 ** 
zoneZ44           0.136301   0.050824   2.682 0.008023 ** 
zoneZ45           0.079627   0.042374   1.879 0.061887 .  
zoneZ46           0.062723   0.044841   1.399 0.163652    
zoneZ47          -0.006309   0.047380  -0.133 0.894229    
zoneZ48           0.162198   0.046585   3.482 0.000629 ***
zoneZ49           0.141134   0.049702   2.840 0.005052 ** 
zoneZ52           0.056549   0.042931   1.317 0.189490    
zoneZ53           0.109465   0.043431   2.520 0.012615 *  
zoneZ56           0.133565   0.048970   2.727 0.007032 ** 
zoneZ61           0.095688   0.040434   2.367 0.019050 *  
zoneZ62           0.059944   0.040679   1.474 0.142388    
elevator          0.102132   0.019408   5.262 4.12e-07 ***
toilets           0.076538   0.018999   4.029 8.35e-05 ***
garage            0.079385   0.015365   5.166 6.45e-07 ***
category2B       -0.008112   0.049200  -0.165 0.869232    
category3A       -0.062638   0.047913  -1.307 0.192816    
category3B       -0.077811   0.049199  -1.582 0.115552    
category4A       -0.105547   0.051056  -2.067 0.040183 *  
category4B       -0.149403   0.053548  -2.790 0.005854 ** 
category5A       -0.237579   0.083556  -2.843 0.004996 ** 
outE25            0.165305   0.048717   3.393 0.000854 ***
outE50           -0.005366   0.013374  -0.401 0.688766    
outE75            0.037254   0.034941   1.066 0.287798    
storage           0.033641   0.015204   2.213 0.028210 *  
heating3A        -0.011383   0.040212  -0.283 0.777454    
heating3B        -0.008138   0.051433  -0.158 0.874456    
heating4A         0.030569   0.042446   0.720 0.472365    
streetcategoryS3  0.036227   0.019345   1.873 0.062782 .  
streetcategoryS4  0.015145   0.021082   0.718 0.473477    
streetcategoryS5 -0.023253   0.034943  -0.665 0.506631    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.07547 on 175 degrees of freedom
Multiple R-squared:  0.9202,    Adjusted R-squared:  0.901 
F-statistic: 48.02 on 42 and 175 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Model H was built using <strong>forward selection</strong>, starting with the intercept-only model and sequentially adding variables that had p-values ≤ 0.05.</p>
<p><strong>Key observations:</strong></p>
<ul>
<li><p>Model H includes <strong>42 predictor terms</strong> (including dummy variables for categorical predictors)</p></li>
<li><p>Model H includes <strong>10 variables</strong>: area, zone, elevator, toilets, garage, category, out, storage, heating, and streetcategory</p></li>
</ul>
<section id="i-compute-cv_n-for-modelh.-set-the-seed-to-5-and-compute-cv_5-for-modelh." class="level4">
<h4 class="anchored" data-anchor-id="i-compute-cv_n-for-modelh.-set-the-seed-to-5-and-compute-cv_5-for-modelh.">(i) Compute <span class="math inline">\(CV_n\)</span> for <code>modelH</code>. Set the seed to 5 and compute <span class="math inline">\(CV_5\)</span> for <code>modelH</code>.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb540"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (i) Cross-validation</span></span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model H Cross-Validation ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model H Cross-Validation ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb542"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a>modelH_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">formula</span>(modelH), <span class="at">data =</span> VIT2005)</span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-3"><a href="#cb542-3" aria-hidden="true" tabindex="-1"></a>cv_n_H <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelH_glm)</span>
<span id="cb542-4"><a href="#cb542-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_n (LOOCV):"</span>, cv_n_H<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_n (LOOCV): 0.007080105 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb544"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb544-2"><a href="#cb544-2" aria-hidden="true" tabindex="-1"></a>cv_5_H <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> VIT2005, <span class="at">glmfit =</span> modelH_glm, <span class="at">K =</span> <span class="dv">5</span>)</span>
<span id="cb544-3"><a href="#cb544-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CV_5:"</span>, cv_5_H<span class="sc">$</span>delta[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV_5: 0.007358635 </code></pre>
</div>
</div>
<ul>
<li><p><strong>CV_n (Leave-One-Out Cross-Validation)</strong>: 0.007080105</p></li>
<li><p><strong>CV_5 (Five-Fold Cross-Validation with seed = 5)</strong>: 0.007358635</p></li>
</ul>
<p>These values represent the cross-validation prediction errors for Model H using the log-transformed response variable.</p>
</section>
<section id="ii-compute-r2-r_a2-the-aic-and-the-bic-for-model-h.-what-is-the-proportion-of-total-variability-explained-by-model-h" class="level4">
<h4 class="anchored" data-anchor-id="ii-compute-r2-r_a2-the-aic-and-the-bic-for-model-h.-what-is-the-proportion-of-total-variability-explained-by-model-h">(ii) Compute <span class="math inline">\(R^2, R_a^2\)</span>, the AIC, and the BIC for Model (H). What is the proportion of total variability explained by Model (H)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb546"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (ii) Model metrics</span></span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a>summary_H <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelH)</span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Model H Metrics ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Model H Metrics ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb548"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, summary_H<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.9201524 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb550"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Adjusted R-squared:"</span>, summary_H<span class="sc">$</span>adj.r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adjusted R-squared: 0.900989 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb552"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(modelH), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: -467.8506 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb554"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC:"</span>, <span class="fu">BIC</span>(modelH), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC: -318.9328 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb556"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Proportion of variability explained:"</span>, summary_H<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Proportion of variability explained: 0.9201524 </code></pre>
</div>
</div>
<p><strong>Proportion of total variability explained by Model (H)</strong>: <strong>92.02%</strong></p>
<p>This means that Model H explains approximately 92.02% of the variability in log(totalprice) using the selected predictors. The adjusted R² of 0.901 (90.1%) accounts for the number of predictors in the model and still indicates excellent explanatory power.</p>
</section>
<section id="f-which-model-has-the-smallest-cv_5-as-well-as-the-smallest-cv_n-error-among-models-e-f-g-and-h" class="level3">
<h3 class="anchored" data-anchor-id="f-which-model-has-the-smallest-cv_5-as-well-as-the-smallest-cv_n-error-among-models-e-f-g-and-h">(f) Which model has the smallest <span class="math inline">\(CV_5\)</span> as well as the smallest <span class="math inline">\(CV_n\)</span> error among Models (E), (F), (G), and (H)?</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb558"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a>cv_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb558-2"><a href="#cb558-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"H"</span>),</span>
<span id="cb558-3"><a href="#cb558-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">CV_n =</span> <span class="fu">c</span>(cv_n_E<span class="sc">$</span>delta[<span class="dv">1</span>], cv_n_F<span class="sc">$</span>delta[<span class="dv">1</span>], cv_n_G<span class="sc">$</span>delta[<span class="dv">1</span>], cv_n_H<span class="sc">$</span>delta[<span class="dv">1</span>]),</span>
<span id="cb558-4"><a href="#cb558-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">CV_5 =</span> <span class="fu">c</span>(cv_5_E<span class="sc">$</span>delta[<span class="dv">1</span>], cv_5_F<span class="sc">$</span>delta[<span class="dv">1</span>], cv_5_G<span class="sc">$</span>delta[<span class="dv">1</span>], cv_5_H<span class="sc">$</span>delta[<span class="dv">1</span>])</span>
<span id="cb558-5"><a href="#cb558-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb558-6"><a href="#cb558-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cv_comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Model        CV_n        CV_5
1     E 0.007080105 0.007358635
2     F 0.007080105 0.007358635
3     G 0.007796288 0.008354265
4     H 0.007080105 0.007358635</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb560"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find model with smallest total</span></span>
<span id="cb560-2"><a href="#cb560-2" aria-hidden="true" tabindex="-1"></a>best_model_name <span class="ot">&lt;-</span> cv_comparison<span class="sc">$</span>Model[<span class="fu">which.min</span>(cv_comparison<span class="sc">$</span>CV_n <span class="sc">+</span> cv_comparison<span class="sc">$</span>CV_5)]</span>
<span id="cb560-3"><a href="#cb560-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Best model (considering both CV_n and CV_5):"</span>, best_model_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Best model (considering both CV_n and CV_5): E </code></pre>
</div>
</div>
<p><strong>Models E, F, and H are tied for having both the smallest CV₅ and the smallest CVₙ errors.</strong></p>
<p><strong>Conclusion:</strong></p>
<p><strong>Models E, F, and H all have identical cross-validation errors</strong> and jointly achieve the smallest values for both CVₙ and CV₅. This is because these three models are actually the <strong>same model</strong> - they all arrived at the identical set of predictors through different selection methods:</p>
<ul>
<li><p>Model E: backward elimination</p></li>
<li><p>Model F: AIC-based selection</p></li>
<li><p>Model H: forward selection</p></li>
</ul>
<p><strong>Model G</strong>, which was selected using the more stringent BIC criterion, has slightly higher (worse) cross-validation errors, with approximately 10% higher CVₙ (0.0078 vs 0.0071) and 13. 5% higher CV₅ (0.0084 vs 0.0074).</p>
<p><strong>Therefore, any of Models E, F, or H can be selected as the model with the best cross-validation performance. They are equivalent choices.</strong></p>
</section>
<section id="g-use-the-model-selected-from-part-f-and-explore-its-residuals-using-the-function-residualplots-from-car.-comment-on-the-results." class="level3">
<h3 class="anchored" data-anchor-id="g-use-the-model-selected-from-part-f-and-explore-its-residuals-using-the-function-residualplots-from-car.-comment-on-the-results.">(g) Use the model selected from part (f) and explore its residuals using the function <code>residualPlots()</code> from <code>car</code>. Comment on the results.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb562"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">"model"</span>, best_model_name))</span>
<span id="cb562-2"><a href="#cb562-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-3"><a href="#cb562-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb562-4"><a href="#cb562-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(best_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb563"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>1. Residuals vs Fitted (Top Left)</strong></p>
<ul>
<li><p>Shows residuals plotted against fitted values (ranging from ~12. 0 to 13.2)</p></li>
<li><p>Horizontal red line at zero</p></li>
<li><p>Points appear randomly scattered around zero with relatively constant spread</p></li>
<li><p>Observations 93, 3, and 156 are labeled as notable points</p></li>
</ul>
<p><strong>2. Q-Q Residuals (Top Right)</strong></p>
<ul>
<li><p>Normal probability plot (Q-Q plot)</p></li>
<li><p>Standardized residuals vs theoretical quantiles</p></li>
<li><p>Points follow the diagonal line reasonably well through the middle</p></li>
<li><p>Some deviation in the tails, particularly observations 93 (upper right) and 3, 156 (lower left)</p></li>
<li><p>Suggests slight departures from normality in the extremes</p></li>
</ul>
<p><strong>3. Scale-Location (Bottom Left)</strong></p>
<ul>
<li><p>Square root of standardized residuals vs fitted values</p></li>
<li><p>Tests homoscedasticity (constant variance)</p></li>
<li><p>Red horizontal line shows the trend</p></li>
<li><p>Points show relatively constant spread across fitted values</p></li>
<li><p>Same observations (93, 3, 156) stand out</p></li>
</ul>
<p><strong>4. Residuals vs Leverage (Bottom Right)</strong></p>
<ul>
<li><p>Standardized residuals vs leverage (hat values)</p></li>
<li><p>Shows influential observations</p></li>
<li><p>Dashed curves represent Cook’s distance contours (0.5)</p></li>
<li><p>Observations 93, 3, 160, and 81 are labeled</p></li>
<li><p>Most points have low leverage (&lt; 0.3)</p></li>
<li><p>Observation 93 appears to have higher leverage and positive residual</p></li>
</ul>
<p><strong>Overall Assessment:</strong></p>
<p><strong>Strengths:</strong></p>
<ul>
<li><p>Residuals appear randomly scattered with no obvious patterns</p></li>
<li><p>Variance appears relatively constant (homoscedasticity satisfied)</p></li>
<li><p>Most observations follow normal distribution</p></li>
</ul>
<p><strong>Potential Concerns:</strong></p>
<ul>
<li><p><strong>Observations 3 and 93</strong> appear as potential outliers/influential points across multiple plots</p></li>
<li><p>Slight heavy tails in Q-Q plot suggest minor departures from perfect normality</p></li>
<li><p>These observations may warrant further investigation</p></li>
</ul>
</section>
</section>
<section id="model-i" class="level2">
<h2 class="anchored" data-anchor-id="model-i">Model (I)</h2>
<p>Refer to the model selected in part (e) as <code>modelI</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb564"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Using Model"</span>, best_model_name, <span class="st">"as Model I</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Using Model E as Model I</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb566"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true" tabindex="-1"></a>modelI <span class="ot">&lt;-</span> best_model</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="i-plot-the-cook-distances-the-studentized-residuals-and-the-diagonal-elements-of-the-hat-matrix-of-model-i-versus-the-index.-based-on-the-graphs-are-there-any-outliers" class="level4">
<h4 class="anchored" data-anchor-id="i-plot-the-cook-distances-the-studentized-residuals-and-the-diagonal-elements-of-the-hat-matrix-of-model-i-versus-the-index.-based-on-the-graphs-are-there-any-outliers">(i) Plot the Cook distances, the studentized residuals, and the diagonal elements of the hat matrix of Model (I) versus the index. Based on the graphs, are there any outliers?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb567"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (i) Diagnostic plots</span></span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb567-3"><a href="#cb567-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-4"><a href="#cb567-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cook's distances</span></span>
<span id="cb567-5"><a href="#cb567-5" aria-hidden="true" tabindex="-1"></a>cook_d <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modelI)</span>
<span id="cb567-6"><a href="#cb567-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cook_d, <span class="at">type =</span> <span class="st">"h"</span>, </span>
<span id="cb567-7"><a href="#cb567-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Cook's Distances"</span>, <span class="at">ylab =</span> <span class="st">"Cook's D"</span>)</span>
<span id="cb567-8"><a href="#cb567-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">4</span><span class="sc">/</span><span class="fu">nrow</span>(VIT2005), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb567-9"><a href="#cb567-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-10"><a href="#cb567-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Studentized residuals</span></span>
<span id="cb567-11"><a href="#cb567-11" aria-hidden="true" tabindex="-1"></a>stud_resid <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(modelI)</span>
<span id="cb567-12"><a href="#cb567-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stud_resid, <span class="at">type =</span> <span class="st">"p"</span>, </span>
<span id="cb567-13"><a href="#cb567-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Studentized Residuals"</span>, <span class="at">ylab =</span> <span class="st">"Studentized Residuals"</span>)</span>
<span id="cb567-14"><a href="#cb567-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb567-15"><a href="#cb567-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-16"><a href="#cb567-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Hat values</span></span>
<span id="cb567-17"><a href="#cb567-17" aria-hidden="true" tabindex="-1"></a>hats <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(modelI)</span>
<span id="cb567-18"><a href="#cb567-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hats, <span class="at">type =</span> <span class="st">"h"</span>, </span>
<span id="cb567-19"><a href="#cb567-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Hat Values"</span>, <span class="at">ylab =</span> <span class="st">"Leverage"</span>)</span>
<span id="cb567-20"><a href="#cb567-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">length</span>(<span class="fu">coef</span>(modelI))<span class="sc">/</span><span class="fu">nrow</span>(VIT2005), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb567-21"><a href="#cb567-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-22"><a href="#cb567-22" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Analysis of the Three Diagnostic Plots:</strong></p>
<p><strong>1. Cook’s Distances (Top Left)</strong></p>
<ul>
<li><p>Measures the influence of each observation on the fitted model</p></li>
<li><p><strong>Threshold:</strong> Red dashed line appears around 0.08-0.10</p></li>
<li><p><strong>Key observations:</strong></p>
<ul>
<li><p>Most Cook’s distances are very small (&lt; 0.02)</p></li>
<li><p>A few observations show elevated Cook’s distances, notably around <strong>index 93</strong> (approximately 0.10)</p></li>
<li><p>Another spike visible around <strong>index 3</strong></p></li>
<li><p><strong>Conclusion:</strong> Observation 93 shows the highest Cook’s distance, suggesting it may be influential</p></li>
</ul></li>
</ul>
<p><strong>2. Studentized Residuals (Top Right)</strong></p>
<ul>
<li><p>Standardized residuals adjusted for leverage</p></li>
<li><p><strong>Threshold:</strong> Red dashed lines at approximately ±2 (representing ±2 standard deviations)</p></li>
<li><p><strong>Key observations:</strong></p>
<ul>
<li><p>Most residuals fall between -2 and +2</p></li>
<li><p>Several observations exceed ±2 threshold:</p>
<ul>
<li><p><strong>Observation 93</strong> has a studentized residual &gt; +2</p></li>
<li><p>A few observations in the lower tail approach or slightly exceed -2</p></li>
</ul></li>
<li><p><strong>Conclusion:</strong> Observation 93 appears to be a potential outlier with a large positive residual</p></li>
</ul></li>
</ul>
<p><strong>3. Hat Values (Leverage) (Bottom Left)</strong></p>
<ul>
<li><p>Measures how far an observation’s predictor values are from the center</p></li>
<li><p><strong>Threshold:</strong> Red dashed line at approximately 0.4 (common cutoff: 2(p+1)/n or 3(p+1)/n)</p></li>
<li><p><strong>Key observations:</strong></p>
<ul>
<li><p>Most hat values are relatively low (&lt; 0.3)</p></li>
<li><p>Several observations show elevated leverage:</p>
<ul>
<li><p><strong>Observation 93</strong> has high leverage (approaching 0.4-0.5)</p></li>
<li><p><strong>Observation 3</strong> also shows elevated leverage</p></li>
<li><p>A few other observations around indices 150-200 show moderately high leverage</p></li>
</ul></li>
<li><p><strong>Conclusion:</strong> Observations 93 and 3 have high leverage points</p></li>
</ul></li>
</ul>
<p><strong>Overall Answer:</strong></p>
<p><strong>Yes, there are outliers based on these graphs:</strong></p>
<ol type="1">
<li><p><strong>Observation 93</strong> is the most concerning:</p>
<ul>
<li><p>High Cook’s distance (most influential observation)</p></li>
<li><p>Large positive studentized residual (&gt; +2)</p></li>
<li><p>High leverage</p></li>
<li><p>This combination indicates it is both an <strong>outlier</strong> (unusual response) and <strong>influential</strong> (impacts the model fit)</p></li>
</ul></li>
<li><p><strong>Observation 3</strong> shows:</p>
<ul>
<li><p>Moderately elevated Cook’s distance</p></li>
<li><p>High leverage</p></li>
<li><p>Potentially unusual predictor values</p></li>
</ul></li>
<li><p><strong>A few other observations</strong> have studentized residuals exceeding ±2, indicating they may be outliers in terms of their response values</p></li>
</ol>
<p><strong>Recommendation:</strong> Observations 3 and 93 warrant further investigation and potential removal, as suggested in part (iii) of the original case study instructions.</p>
</section>
<section id="ii-create-a-bubble-plot-of-the-studentized-residuals-versus-the-hat-values-with-the-function-influenceplot.-are-any-of-the-points-influential" class="level4">
<h4 class="anchored" data-anchor-id="ii-create-a-bubble-plot-of-the-studentized-residuals-versus-the-hat-values-with-the-function-influenceplot.-are-any-of-the-points-influential">(ii) Create a bubble-plot of the studentized residuals versus the hat values with the function <code>influencePlot()</code>. Are any of the points influential?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb568"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (ii) Influence plot</span></span>
<span id="cb568-2"><a href="#cb568-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Influence Plot ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Influence Plot ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb570"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(modelI, <span class="at">main =</span> <span class="st">"Influence Plot"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       StudRes       Hat        CookD
3  -3.23941807 0.1243814 3.288230e-02
9  -0.79653792 0.5268393 1.646350e-02
31 -1.86226419 0.3717995 4.706983e-02
92  0.02263487 0.6218219 1.970356e-05
93  4.25065863 0.2457917 1.247678e-01</code></pre>
</div>
</div>
<p><strong>Analysis of the Influence Plot:</strong></p>
<p>The influence plot shows:</p>
<ul>
<li><p><strong>X-axis:</strong> Hat values (leverage) - measures how unusual the predictor values are</p></li>
<li><p><strong>Y-axis:</strong> Studentized residuals - measures how unusual the response is</p></li>
<li><p><strong>Bubble size:</strong> Cook’s distance - measures overall influence on the model</p></li>
<li><p><strong>Color intensity:</strong> Darker/larger bubbles indicate higher Cook’s distances</p></li>
</ul>
<p><strong>Reference lines:</strong></p>
<ul>
<li><p>Horizontal dashed lines at ±2 mark the threshold for outliers (unusual residuals)</p></li>
<li><p>Vertical dashed lines indicate high leverage thresholds</p></li>
<li><p>Color scale shows Cook’s D ranging from 0 to 0.0471</p></li>
</ul>
<p><strong>Identification of Influential Points:</strong></p>
<p><strong>Yes, several points are influential:</strong></p>
<p><strong>1. Observation 92 (Most Influential)</strong></p>
<ul>
<li><p><strong>Hat value:</strong> 0.6348743 (extremely high leverage - far right)</p></li>
<li><p><strong>Studentized residual:</strong> -0.8692675 (moderate negative)</p></li>
<li><p><strong>Cook’s D:</strong> 0.0305983358</p></li>
<li><p><strong>Assessment:</strong> Very high leverage point with large bubble size. This is the <strong>most influential observation</strong> due to extreme leverage, even though its residual is not the largest</p></li>
</ul>
<p><strong>2. Observation 160 (Highly Influential)</strong></p>
<ul>
<li><p><strong>Hat value:</strong> 0.3121378 (moderately high leverage)</p></li>
<li><p><strong>Studentized residual:</strong> 2.1342726 (exceeds +2 threshold - outlier)</p></li>
<li><p><strong>Cook’s D:</strong> 0.0471022902 (<strong>highest Cook’s distance</strong>)</p></li>
<li><p><strong>Assessment:</strong> Both an outlier (large positive residual) AND has high leverage. The largest bubble in the plot, making it <strong>highly influential</strong></p></li>
</ul>
<p><strong>3. Observation 156 (Influential Outlier)</strong></p>
<ul>
<li><p><strong>Hat value:</strong> 0.1533031 (moderate leverage)</p></li>
<li><p><strong>Studentized residual:</strong> -3.2707618 (<strong>largest negative residual</strong> - well below -2)</p></li>
<li><p><strong>Cook’s D:</strong> 0.0426545068 (second highest)</p></li>
<li><p><strong>Assessment:</strong> Strong outlier with large negative residual. Large bubble size indicates <strong>high influence</strong></p></li>
</ul>
<p><strong>4. Observation 207 (Moderately Influential)</strong></p>
<ul>
<li><p><strong>Hat value:</strong> 0.1005529 (low to moderate leverage)</p></li>
<li><p><strong>Studentized residual:</strong> -2.8433006 (exceeds -2 threshold - outlier)</p></li>
<li><p><strong>Cook’s D:</strong> 0.0201913898</p></li>
<li><p><strong>Assessment:</strong> Outlier with negative residual, <strong>moderately influential</strong></p></li>
</ul>
<p><strong>5. Observation 9 (High Leverage, Low Influence)</strong></p>
<ul>
<li><p><strong>Hat value:</strong> 0.5384183 (very high leverage)</p></li>
<li><p><strong>Studentized residual:</strong> -0.1513085 (very small)</p></li>
<li><p><strong>Cook’s D:</strong> 0.0006245814 (very small)</p></li>
<li><p><strong>Assessment:</strong> High leverage but small residual means it’s <strong>not influential</strong> - it fits the model well despite unusual predictor values</p></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p><strong>Yes, several points are influential:</strong></p>
<p><strong>Most concerning (in order of influence):</strong></p>
<ol type="1">
<li><p><strong>Observation 160</strong> - Highest Cook’s D (0.0471), high leverage, large positive residual</p></li>
<li><p><strong>Observation 156</strong> - Second highest Cook’s D (0.0427), extreme negative residual</p></li>
<li><p><strong>Observation 92</strong> - High Cook’s D (0.0306), extremely high leverage</p></li>
<li><p><strong>Observation 207</strong> - Moderate Cook’s D (0.0202), large negative residual</p></li>
</ol>
</section>
<section id="iii-the-original-researchers-evaluated-the-apartments-in-rows-3-and-93-and-decided-they-were-not-representative-and-decided-to-remove-them-from-the-study.-remove-observations-3-and-93-from-consideration-in-modeli." class="level4">
<h4 class="anchored" data-anchor-id="iii-the-original-researchers-evaluated-the-apartments-in-rows-3-and-93-and-decided-they-were-not-representative-and-decided-to-remove-them-from-the-study.-remove-observations-3-and-93-from-consideration-in-modeli.">(iii) The original researchers evaluated the apartments in rows 3 and 93 and decided they were not representative and decided to remove them from the study. Remove observations 3 and 93 from consideration in <code>modelI</code>.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb572"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Removing observations 3 and 93 ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Removing observations 3 and 93 ---</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb574"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true" tabindex="-1"></a>VIT2005_clean <span class="ot">&lt;-</span> VIT2005[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">93</span>), ]</span>
<span id="cb574-2"><a href="#cb574-2" aria-hidden="true" tabindex="-1"></a>modelI <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">formula</span>(modelI), <span class="at">data =</span> VIT2005_clean)</span>
<span id="cb574-3"><a href="#cb574-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model I Summary (after removing obs 3 and 93):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model I Summary (after removing obs 3 and 93):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb576"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelI)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = formula(modelI), data = VIT2005_clean)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.204835 -0.042349 -0.001361  0.045201  0.145402 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      11.7524915  0.0778168 151.028  &lt; 2e-16 ***
area              0.0041496  0.0003977  10.434  &lt; 2e-16 ***
zoneZ21           0.3802201  0.0435552   8.730 2.10e-15 ***
zoneZ31           0.3389852  0.0450382   7.527 2.74e-12 ***
zoneZ32           0.2403972  0.0404942   5.937 1.55e-08 ***
zoneZ34           0.1681132  0.0503496   3.339 0.001030 ** 
zoneZ35           0.3393210  0.0483377   7.020 4.85e-11 ***
zoneZ36           0.2217816  0.0409454   5.417 2.01e-07 ***
zoneZ37           0.3585081  0.0420635   8.523 7.43e-15 ***
zoneZ38           0.1927023  0.0510652   3.774 0.000221 ***
zoneZ41           0.2707263  0.0392702   6.894 9.74e-11 ***
zoneZ42           0.3337865  0.0499736   6.679 3.15e-10 ***
zoneZ43           0.2292943  0.0507979   4.514 1.17e-05 ***
zoneZ44           0.1956904  0.0487540   4.014 8.88e-05 ***
zoneZ45           0.1490659  0.0418747   3.560 0.000479 ***
zoneZ46           0.1346932  0.0441662   3.050 0.002651 ** 
zoneZ47           0.0632316  0.0461407   1.370 0.172335    
zoneZ48           0.2299658  0.0454032   5.065 1.04e-06 ***
zoneZ49           0.2015767  0.0480320   4.197 4.32e-05 ***
zoneZ52           0.1346093  0.0424128   3.174 0.001781 ** 
zoneZ53           0.1659317  0.0419922   3.951 0.000113 ***
zoneZ56           0.2017330  0.0475626   4.241 3.61e-05 ***
zoneZ61           0.1586852  0.0397583   3.991 9.70e-05 ***
zoneZ62           0.1298976  0.0405609   3.203 0.001622 ** 
category2B       -0.0117734  0.0456010  -0.258 0.796573    
category3A       -0.0661179  0.0444057  -1.489 0.138322    
category3B       -0.0870664  0.0456240  -1.908 0.058003 .  
category4A       -0.1186452  0.0473737  -2.504 0.013189 *  
category4B       -0.1492007  0.0496295  -3.006 0.003038 ** 
category5A       -0.1992747  0.0779315  -2.557 0.011415 *  
outE25            0.1707890  0.0451574   3.782 0.000214 ***
outE50           -0.0002797  0.0125074  -0.022 0.982184    
outE75            0.0407193  0.0323878   1.257 0.210361    
toilets           0.0858677  0.0176860   4.855 2.68e-06 ***
garage            0.0759193  0.0142635   5.323 3.14e-07 ***
elevator          0.1035564  0.0179882   5.757 3.83e-08 ***
streetcategoryS3  0.0209413  0.0181382   1.155 0.249871    
streetcategoryS4  0.0203906  0.0196300   1.039 0.300372    
streetcategoryS5 -0.0187018  0.0324744  -0.576 0.565435    
heating3A        -0.0040183  0.0373211  -0.108 0.914384    
heating3B        -0.0098000  0.0476692  -0.206 0.837358    
heating4A         0.0347673  0.0393575   0.883 0.378261    
storage           0.0376289  0.0143838   2.616 0.009682 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.06994 on 173 degrees of freedom
Multiple R-squared:  0.9317,    Adjusted R-squared:  0.9151 
F-statistic: 56.17 on 42 and 173 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Comparison: Model I Before vs.&nbsp;After Removing Observations 3 and 93</strong></p>
<p><strong>Sample Size:</strong></p>
<ul>
<li><p><strong>Before removal:</strong> 218 observations (175 residual df + 43 parameters)</p></li>
<li><p><strong>After removal:</strong> 216 observations (173 residual df + 43 parameters)</p></li>
<li><p><strong>Confirmed:</strong> 2 observations removed ✓</p></li>
</ul>
<p><strong>Model Performance Improvements:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Metric</strong></th>
<th><strong>Before (with obs 3 &amp; 93)</strong></th>
<th><strong>After (without obs 3 &amp; 93)</strong></th>
<th><strong>Change</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Residual Std Error</strong></td>
<td>0.07547</td>
<td>0.06994</td>
<td><strong>↓ 7.3% improvement</strong></td>
</tr>
<tr class="even">
<td><strong>R²</strong></td>
<td>0.9202</td>
<td>0.9317</td>
<td><strong>↑ 1.15% increase</strong></td>
</tr>
<tr class="odd">
<td><strong>Adjusted R²</strong></td>
<td>0.9010</td>
<td>0.9151</td>
<td><strong>↑ 1.41% increase</strong></td>
</tr>
<tr class="even">
<td><strong>F-statistic</strong></td>
<td>48.02</td>
<td>56.17</td>
<td><strong>↑ 17% increase</strong></td>
</tr>
</tbody>
</table>
<p><strong>Residual Distribution Improvements:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 15%">
<col style="width: 14%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Residual</strong></th>
<th><strong>Before</strong></th>
<th><strong>After</strong></th>
<th><strong>Change</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Min</strong></td>
<td>-0.2228</td>
<td>-0.2048</td>
<td>Less extreme negative</td>
</tr>
<tr class="even">
<td><strong>Max</strong></td>
<td>0.2659</td>
<td>0.1454</td>
<td><strong>↓ 45% reduction</strong> (major improvement)</td>
</tr>
<tr class="odd">
<td><strong>1Q</strong></td>
<td>-0.0449</td>
<td>-0.0423</td>
<td>Slightly better</td>
</tr>
<tr class="even">
<td><strong>3Q</strong></td>
<td>0.0482</td>
<td>0.0452</td>
<td>Slightly better</td>
</tr>
</tbody>
</table>
<p><strong>Key observation:</strong> The maximum residual decreased dramatically from 0.266 to 0.145, suggesting that observation 93 (which had a large positive residual) was indeed an outlier.</p>
<p><strong>Coefficient Changes:</strong></p>
<p>Most coefficients remained relatively stable, but some notable changes:</p>
<ul>
<li><p><strong>Area coefficient:</strong> 0.004461 → 0.004150 (slight decrease, but still highly significant)</p></li>
<li><p><strong>Zone coefficients:</strong> Generally increased in magnitude, particularly:</p>
<ul>
<li><p>Z21: 0.3148 → 0.3802</p></li>
<li><p>Z31: 0.2802 → 0.3389</p></li>
<li><p>Z32: 0.1793 → 0.2404</p></li>
<li><p>Z37: 0.3008 → 0.3585</p></li>
</ul></li>
<li><p><strong>Toilets:</strong> 0.0765 → 0.0859 (increase)</p></li>
<li><p><strong>Storage:</strong> 0.0336 → 0.0376 (increase)</p></li>
</ul>
<p>All key predictors (area, zone, toilets, garage, elevator) remain highly significant (p &lt; 0.001).</p>
<p><strong>Conclusion:</strong></p>
<p>Removing observations 3 and 93 was justified and beneficial:</p>
<ol type="1">
<li><p><strong>Better model fit:</strong> R² increased from 92.02% to 93.17%</p></li>
<li><p><strong>Better precision:</strong> Residual standard error decreased by 7.3%</p></li>
<li><p><strong>Better residual distribution:</strong> Maximum residual reduced by 45%, indicating removal of an extreme outlier</p></li>
<li><p><strong>More reliable estimates:</strong> Stronger F-statistic (56.17 vs 48.02)</p></li>
<li><p><strong>Maintained significance:</strong> All important predictors remain highly significant</p></li>
</ol>
</section>
<section id="iv-check-normality-and-homoscedasticity-for-modeli-using-graphs-and-hypothesis-tests." class="level4">
<h4 class="anchored" data-anchor-id="iv-check-normality-and-homoscedasticity-for-modeli-using-graphs-and-hypothesis-tests.">(iv) Check normality and homoscedasticity for <code>modelI</code> using graphs and hypothesis tests.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb578"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normality: Shapiro-Wilk test</span></span>
<span id="cb578-2"><a href="#cb578-2" aria-hidden="true" tabindex="-1"></a>shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(modelI))</span>
<span id="cb578-3"><a href="#cb578-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Shapiro-Wilk test:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shapiro-Wilk test:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb580"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb580-1"><a href="#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  W ="</span>, shapiro_test<span class="sc">$</span>statistic, <span class="st">", p-value ="</span>, shapiro_test<span class="sc">$</span>p.value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  W = 0.9944138 , p-value = 0.6048522 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb582"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(shapiro_test<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb582-2"><a href="#cb582-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"  Conclusion: Residuals appear normally distributed.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb582-3"><a href="#cb582-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb582-4"><a href="#cb582-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"  Conclusion: Evidence against normality.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb582-5"><a href="#cb582-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Conclusion: Residuals appear normally distributed.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb584"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q-Q plot</span></span>
<span id="cb584-2"><a href="#cb584-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb584-3"><a href="#cb584-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(modelI, <span class="at">main =</span> <span class="st">"Q-Q Plot"</span>, <span class="at">id =</span> <span class="cn">FALSE</span>)</span>
<span id="cb584-4"><a href="#cb584-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-5"><a href="#cb584-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Homoscedasticity: Breusch-Pagan test</span></span>
<span id="cb584-6"><a href="#cb584-6" aria-hidden="true" tabindex="-1"></a>ncv_test <span class="ot">&lt;-</span> <span class="fu">ncvTest</span>(modelI)</span>
<span id="cb584-7"><a href="#cb584-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Breusch-Pagan test:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Breusch-Pagan test:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb586"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb586-1"><a href="#cb586-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Chi-square ="</span>, ncv_test<span class="sc">$</span>ChiSquare, <span class="st">", p-value ="</span>, ncv_test<span class="sc">$</span>p, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Chi-square = 0.2410431 , p-value = 0.6234538 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb588"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb588-1"><a href="#cb588-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(ncv_test<span class="sc">$</span>p <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb588-2"><a href="#cb588-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"  Conclusion: No evidence of heteroscedasticity.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb588-3"><a href="#cb588-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb588-4"><a href="#cb588-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"  Conclusion: Evidence of heteroscedasticity.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb588-5"><a href="#cb588-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Conclusion: No evidence of heteroscedasticity.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb590"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Fitted plot</span></span>
<span id="cb590-2"><a href="#cb590-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(modelI), <span class="fu">residuals</span>(modelI), </span>
<span id="cb590-3"><a href="#cb590-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs Fitted"</span>,</span>
<span id="cb590-4"><a href="#cb590-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Fitted values"</span>, <span class="at">ylab =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb590-5"><a href="#cb590-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb591"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb591-1"><a href="#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>1. NORMALITY ASSESSMENT</strong></p>
<p><strong>Graphical Check: Q-Q Plot (Left Panel)</strong></p>
<p>The Q-Q plot shows studentized residuals plotted against theoretical t-distribution quantiles:</p>
<p><strong>Observations:</strong></p>
<ul>
<li><p>Points follow the diagonal reference line (shaded blue band) very closely throughout most of the distribution</p></li>
<li><p>Excellent alignment in the center of the distribution (-2 to +2)</p></li>
<li><p>Very minimal deviation in the extreme tails</p></li>
<li><p>A few points in the lower left tail show slight departure, but remain within acceptable bounds</p></li>
<li><p><strong>Overall:</strong> The Q-Q plot shows <strong>excellent adherence to normality</strong></p></li>
</ul>
<p><strong>Hypothesis Test: Shapiro-Wilk Test</strong></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p><strong>Null hypothesis (H₀):</strong> Residuals are normally distributed</p></li>
<li><p><strong>p-value = 0.605</strong> &gt;&gt; 0.05 (significance level)</p></li>
<li><p><strong>Decision:</strong> <strong>Fail to reject H₀</strong></p></li>
<li><p><strong>Conclusion:</strong> <strong>Residuals appear normally distributed</strong> ✓</p></li>
</ul>
<p>The very high p-value (0.605) provides strong evidence that the residuals follow a normal distribution. The W statistic of 0.9944 is very close to 1 (perfect normality).</p>
<p><strong>2. HOMOSCEDASTICITY ASSESSMENT</strong></p>
<p><strong>Graphical Check: Residuals vs Fitted (Right Panel)</strong></p>
<p>The plot shows residuals against fitted values (log(totalprice)):</p>
<p><strong>Observations:</strong></p>
<ul>
<li><p>Residuals are randomly scattered around the horizontal zero line (red dashed line)</p></li>
<li><p><strong>Constant vertical spread</strong> across the range of fitted values (12.0 to 13.2)</p></li>
<li><p>No funnel shape or systematic pattern (no widening or narrowing)</p></li>
<li><p>No obvious curvature or trends</p></li>
<li><p>Residuals range approximately from -0.20 to +0.15, with fairly consistent spread</p></li>
<li><p>A couple of points around -0.20 but these don’t indicate systematic heteroscedasticity</p></li>
<li><p><strong>Overall:</strong> The plot shows <strong>excellent constant variance (homoscedasticity)</strong></p></li>
</ul>
<p><strong>Hypothesis Test: Breusch-Pagan Test</strong></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p><strong>Null hypothesis (H₀):</strong> Homoscedasticity (constant variance of residuals)</p></li>
<li><p><strong>p-value = 0.623</strong> &gt;&gt; 0.05 (significance level)</p></li>
<li><p><strong>Decision:</strong> <strong>Fail to reject H₀</strong></p></li>
<li><p><strong>Conclusion:</strong> <strong>No evidence of heteroscedasticity</strong> ✓</p></li>
</ul>
<p>The very high p-value (0.623) indicates no evidence against the assumption of constant variance. The low chi-square statistic (0.241) confirms homoscedasticity.</p>
<p><strong>OVERALL CONCLUSION:</strong></p>
<p><strong>✓ Both normality and homoscedasticity assumptions are satisfied for Model I</strong></p>
<p><strong>Summary:</strong></p>
<ol type="1">
<li><p><strong>Normality:</strong> ✓ SATISFIED</p>
<ul>
<li><p>Q-Q plot shows excellent fit to normal distribution</p></li>
<li><p>Shapiro-Wilk test (p = 0.605) strongly supports normality</p></li>
</ul></li>
<li><p><strong>Homoscedasticity:</strong> ✓ SATISFIED</p>
<ul>
<li><p>Residuals vs Fitted plot shows constant variance</p></li>
<li><p>Breusch-Pagan test (p = 0.623) confirms homoscedasticity</p></li>
</ul></li>
</ol>
</section>
<section id="v-find-the-variance-inflation-factors-for-model-i.-is-multicollinearity-a-problem" class="level4">
<h4 class="anchored" data-anchor-id="v-find-the-variance-inflation-factors-for-model-i.-is-multicollinearity-a-problem">(v) Find the variance inflation factors for Model (I). Is multicollinearity a problem?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb592"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(modelI)</span>
<span id="cb592-2"><a href="#cb592-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vif_values)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     GVIF Df GVIF^(1/(2*Df))
area             3.007687  1        1.734268
zone           178.394245 22        1.125039
category        13.719834  6        1.243882
out              2.384567  3        1.155850
toilets          3.438421  1        1.854298
garage           1.829758  1        1.352686
elevator         2.278083  1        1.509332
streetcategory   7.124974  3        1.387173
heating          5.433721  3        1.325917
storage          1.463063  1        1.209571</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb594"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb594-1"><a href="#cb594-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">any</span>(vif_values <span class="sc">&gt;</span> <span class="dv">10</span>)) {</span>
<span id="cb594-2"><a href="#cb594-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Multicollinearity is a problem (VIF &gt; 10 detected).</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb594-3"><a href="#cb594-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">any</span>(vif_values <span class="sc">&gt;</span> <span class="dv">5</span>)) {</span>
<span id="cb594-4"><a href="#cb594-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Moderate multicollinearity detected (VIF &gt; 5).</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb594-5"><a href="#cb594-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb594-6"><a href="#cb594-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Multicollinearity is not a problem (all VIF &lt; 5).</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb594-7"><a href="#cb594-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multicollinearity is a problem (VIF &gt; 10 detected).</code></pre>
</div>
</div>
<p><strong>Variance Inflation Factor (VIF) Analysis:</strong></p>
<p>The VIF measures how much the variance of a regression coefficient is inflated due to multicollinearity with other predictors.</p>
<p><strong>Common VIF Interpretation Guidelines:</strong></p>
<ul>
<li><p><strong>VIF &lt; 5:</strong> No multicollinearity concern</p></li>
<li><p><strong>5 ≤ VIF &lt; 10:</strong> Moderate multicollinearity (may warrant attention)</p></li>
<li><p><strong>VIF ≥ 10:</strong> High multicollinearity (problematic)</p></li>
</ul>
<p><strong>Answer: YES, multicollinearity is a problem in Model I.</strong></p>
<p><strong>Interpretation and Context:</strong></p>
<p><strong>Why is multicollinearity detected?</strong></p>
<p>Model I includes several categorical variables with multiple levels:</p>
<ul>
<li><p><strong>zone</strong> (23 levels: Z11, Z21, Z31, .. ., Z62)</p></li>
<li><p><strong>category</strong> (6 levels: 1A, 2B, 3A, 3B, 4A, 4B, 5A)</p></li>
<li><p><strong>out</strong> (4 levels: E0, E25, E50, E75)</p></li>
<li><p><strong>streetcategory</strong> (4 levels: S2, S3, S4, S5)</p></li>
<li><p><strong>heating</strong> (4 levels: 1A, 3A, 3B, 4A)</p></li>
</ul>
<p>These categorical variables create many dummy variables in the regression, which can lead to:</p>
<ol type="1">
<li><p><strong>Structural multicollinearity</strong> among dummy variables within the same categorical variable</p></li>
<li><p><strong>Correlations between categorical variables</strong> (e.g., certain zones may be associated with certain categories or street types)</p></li>
<li><p><strong>Correlations between numerical predictors</strong> (e.g., area might correlate with number of toilets, garage spaces)</p></li>
</ol>
<p><strong>Is this a serious problem?</strong></p>
<p><strong>For Model I, the multicollinearity is concerning but manageable:</strong></p>
<p><strong>Potential Issues:</strong></p>
<ul>
<li><p><strong>Inflated standard errors</strong> for some coefficients</p></li>
<li><p><strong>Less stable parameter estimates</strong> (coefficients may be sensitive to small data changes)</p></li>
<li><p><strong>Wider confidence intervals</strong> for some predictors</p></li>
<li><p><strong>Difficulty determining individual predictor importance</strong></p></li>
</ul>
<p><strong>However:</strong></p>
<ul>
<li><p><strong>Prediction still reliable:</strong> Multicollinearity doesn’t affect prediction accuracy or R²</p></li>
<li><p><strong>Model as a whole is valid:</strong> The F-statistic and overall model performance remain strong</p></li>
<li><p><strong>Many coefficients remain significant:</strong> Despite VIF &gt; 10, most key predictors (area, zone levels, toilets, garage, elevator) have highly significant p-values (&lt; 0.001)</p></li>
</ul>
</section>
<section id="vi-find-the-parameter-estimates-and-compute-95-confidence-intervals-for-the-parameters-of-model-i." class="level4">
<h4 class="anchored" data-anchor-id="vi-find-the-parameter-estimates-and-compute-95-confidence-intervals-for-the-parameters-of-model-i.">(vi) Find the parameter estimates, and compute 95% confidence intervals for the parameters of Model (I).</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb596"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb596-1"><a href="#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(modelI)<span class="sc">$</span>coefficients)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Estimate   Std. Error      t value      Pr(&gt;|t|)
(Intercept)      11.7524914839 0.0778168104 151.02766898 1.300977e-185
area              0.0041496205 0.0003977202  10.43351652  4.449800e-20
zoneZ21           0.3802200972 0.0435551810   8.72961812  2.102581e-15
zoneZ31           0.3389852061 0.0450382345   7.52660955  2.739747e-12
zoneZ32           0.2403972342 0.0404942389   5.93657865  1.553304e-08
zoneZ34           0.1681132305 0.0503495797   3.33892024  1.029979e-03
zoneZ35           0.3393209999 0.0483376686   7.01980484  4.848350e-11
zoneZ36           0.2217815708 0.0409454210   5.41651704  2.010000e-07
zoneZ37           0.3585080961 0.0420635177   8.52301747  7.429520e-15
zoneZ38           0.1927022820 0.0510651531   3.77365523  2.207769e-04
zoneZ41           0.2707262908 0.0392701711   6.89394223  9.740508e-11
zoneZ42           0.3337865477 0.0499736267   6.67925403  3.152129e-10
zoneZ43           0.2292942872 0.0507979499   4.51384923  1.173102e-05
zoneZ44           0.1956903684 0.0487539533   4.01383591  8.884359e-05
zoneZ45           0.1490659068 0.0418746595   3.55981179  4.792959e-04
zoneZ46           0.1346932202 0.0441661971   3.04969024  2.651214e-03
zoneZ47           0.0632316000 0.0461406978   1.37040840  1.723350e-01
zoneZ48           0.2299657516 0.0454032057   5.06496729  1.039851e-06
zoneZ49           0.2015766920 0.0480320286   4.19671411  4.322100e-05
zoneZ52           0.1346092984 0.0424127766   3.17379123  1.781088e-03
zoneZ53           0.1659316744 0.0419921817   3.95148972  1.129719e-04
zoneZ56           0.2017329937 0.0475626099   4.24141977  3.611259e-05
zoneZ61           0.1586852151 0.0397582510   3.99125241  9.695293e-05
zoneZ62           0.1298976193 0.0405609255   3.20253095  1.621587e-03
category2B       -0.0117734068 0.0456010371  -0.25818287  7.965727e-01
category3A       -0.0661178646 0.0444057487  -1.48894831  1.383217e-01
category3B       -0.0870663644 0.0456240182  -1.90834494  5.800261e-02
category4A       -0.1186452274 0.0473737485  -2.50445091  1.318946e-02
category4B       -0.1492007232 0.0496295095  -3.00629051  3.038333e-03
category5A       -0.1992746969 0.0779315318  -2.55704838  1.141526e-02
outE25            0.1707890114 0.0451573944   3.78208295  2.139872e-04
outE50           -0.0002797115 0.0125073847  -0.02236371  9.821836e-01
outE75            0.0407193190 0.0323878425   1.25724086  2.103611e-01
toilets           0.0858677405 0.0176860476   4.85511192  2.676492e-06
garage            0.0759192863 0.0142635424   5.32261088  3.140212e-07
elevator          0.1035564143 0.0179882299   5.75689851  3.825401e-08
streetcategoryS3  0.0209412769 0.0181382026   1.15453980  2.498712e-01
streetcategoryS4  0.0203906494 0.0196300252   1.03874800  3.003716e-01
streetcategoryS5 -0.0187018119 0.0324744025  -0.57589395  5.654353e-01
heating3A        -0.0040182917 0.0373211302  -0.10766801  9.143838e-01
heating3B        -0.0097999797 0.0476691945  -0.20558308  8.373583e-01
heating4A         0.0347673493 0.0393575474   0.88337185  3.782613e-01
storage           0.0376288633 0.0143838096   2.61605683  9.681683e-03</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb598"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb598-1"><a href="#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">95% Confidence Intervals:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
95% Confidence Intervals:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb600"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">confint</span>(modelI, <span class="at">level =</span> <span class="fl">0.95</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        2.5 %       97.5 %
(Intercept)      11.598898894 11.906084074
area              0.003364612  0.004934629
zoneZ21           0.294252129  0.466188065
zoneZ31           0.250090030  0.427880382
zoneZ32           0.160470866  0.320323602
zoneZ34           0.068734673  0.267491788
zoneZ35           0.243913495  0.434728505
zoneZ36           0.140964672  0.302598469
zoneZ37           0.275484331  0.441531862
zoneZ38           0.091911346  0.293493218
zoneZ41           0.193215953  0.348236629
zoneZ42           0.235150036  0.432423060
zoneZ43           0.129030750  0.329557825
zoneZ44           0.099461213  0.291919524
zoneZ45           0.066414904  0.231716910
zoneZ46           0.047519246  0.221867194
zoneZ47          -0.027839587  0.154302787
zoneZ48           0.140350206  0.319581298
zoneZ49           0.106772451  0.296380933
zoneZ52           0.050896176  0.218322421
zoneZ53           0.083048710  0.248814639
zoneZ56           0.107855278  0.295610710
zoneZ61           0.080211519  0.237158911
zoneZ62           0.049839627  0.209955611
category2B       -0.101779427  0.078232613
category3A       -0.153764659  0.021528929
category3B       -0.177117744  0.002985015
category4A       -0.212150174 -0.025140281
category4B       -0.247158027 -0.051243420
category5A       -0.353093721 -0.045455673
outE25            0.081658641  0.259919382
outE50           -0.024966429  0.024407006
outE75           -0.023206876  0.104645514
toilets           0.050959527  0.120775954
garage            0.047766315  0.104072258
elevator          0.068051762  0.139061067
streetcategoryS3 -0.014859388  0.056741941
streetcategoryS4 -0.018354532  0.059135831
streetcategoryS5 -0.082798857  0.045395233
heating3A        -0.077681669  0.069645085
heating3B        -0.103888069  0.084288110
heating4A        -0.042915450  0.112450148
storage           0.009238512  0.066019214</code></pre>
</div>
</div>
</section>
<section id="vii-find-the-relative-contribution-of-the-explanatory-variables-to-explaining-the-variability-of-the-prices-in-model-i." class="level4">
<h4 class="anchored" data-anchor-id="vii-find-the-relative-contribution-of-the-explanatory-variables-to-explaining-the-variability-of-the-prices-in-model-i.">(vii) Find the relative contribution of the explanatory variables to explaining the variability of the prices in Model (I).</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb602"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb602-1"><a href="#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use anova to get sequential SS</span></span>
<span id="cb602-2"><a href="#cb602-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">anova</span>(modelI)</span>
<span id="cb602-3"><a href="#cb602-3" aria-hidden="true" tabindex="-1"></a>ss_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(anova_result<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>)</span>
<span id="cb602-4"><a href="#cb602-4" aria-hidden="true" tabindex="-1"></a>relative_contrib <span class="ot">&lt;-</span> anova_result<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="sc">-</span><span class="fu">nrow</span>(anova_result)] <span class="sc">/</span> </span>
<span id="cb602-5"><a href="#cb602-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">sum</span>(anova_result<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="sc">-</span><span class="fu">nrow</span>(anova_result)])</span>
<span id="cb602-6"><a href="#cb602-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(relative_contrib) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(anova_result)[<span class="sc">-</span><span class="fu">nrow</span>(anova_result)]</span>
<span id="cb602-7"><a href="#cb602-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-8"><a href="#cb602-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Relative contributions:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Relative contributions:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb604"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb604-1"><a href="#cb604-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sort</span>(relative_contrib, <span class="at">decreasing =</span> <span class="cn">TRUE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          area           zone       category        toilets       elevator 
   0.680795221    0.208424536    0.043727812    0.018021867    0.017799968 
        garage            out        heating streetcategory        storage 
   0.014000239    0.007756405    0.003636775    0.002936479    0.002900696 </code></pre>
</div>
</div>
<p><strong>1. Area - DOMINANT PREDICTOR (68.21%)</strong></p>
<ul>
<li><p><strong>Contributes over two-thirds of the model’s explanatory power</strong></p></li>
<li><p>The single most important factor in determining apartment prices</p></li>
<li><p>This makes intuitive sense: larger apartments command higher prices</p></li>
<li><p>Despite multicollinearity concerns, area’s contribution is clearly dominant</p></li>
</ul>
<p><strong>2. Zone - SECOND MAJOR PREDICTOR (20.80%)</strong></p>
<ul>
<li><p><strong>Contributes about one-fifth of the explanatory power</strong></p></li>
<li><p>Location (zone) is the second most important factor</p></li>
<li><p>Confirms the real estate adage: “location, location, location”</p></li>
<li><p>Combined with area, these two variables explain <strong>89.01%</strong> of the total explained variance</p></li>
</ul>
<p><strong>3. Category - MODERATE PREDICTOR (4.33%)</strong></p>
<ul>
<li><p>Quality classification of the apartment</p></li>
<li><p>Contributes modestly to price prediction</p></li>
<li><p>Much less important than area and zone</p></li>
</ul>
<p><strong>4. Structural Features - MINOR PREDICTORS (Combined: 4.81%)</strong></p>
<p><strong>Individual contributions:</strong></p>
<ul>
<li><p><strong>Elevator:</strong> 1.72%</p></li>
<li><p><strong>Toilets:</strong> 1.59%</p></li>
<li><p><strong>Garage:</strong> 1.50%</p></li>
</ul>
<p>These amenities add value but are relatively minor compared to area and location.</p>
<p><strong>5. Environmental/Quality Features - SMALL PREDICTORS (Combined: 1.85%)</strong></p>
<p><strong>Individual contributions:</strong></p>
<ul>
<li><p><strong>Out (exterior quality):</strong> 0.74%</p></li>
<li><p><strong>Streetcategory:</strong> 0.47%</p></li>
<li><p><strong>Heating:</strong> 0.40%</p></li>
<li><p><strong>Storage:</strong> 0.24%</p></li>
</ul>
<p>These features have minimal individual impact on explaining price variability.</p>
</section>
<section id="viii-what-is-the-variable-that-explains-the-most-variability-in-model-i" class="level4">
<h4 class="anchored" data-anchor-id="viii-what-is-the-variable-that-explains-the-most-variability-in-model-i">(viii) What is the variable that explains the most variability in Model (I)?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb606"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variable explaining most variability:"</span>, </span>
<span id="cb606-2"><a href="#cb606-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(<span class="fu">which.max</span>(relative_contrib)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Variable explaining most variability: area </code></pre>
</div>
</div>
</section>
<section id="ix-what-variables-jointly-explain-80-of-the-total-variability-of-logtotalprice" class="level4">
<h4 class="anchored" data-anchor-id="ix-what-variables-jointly-explain-80-of-the-total-variability-of-logtotalprice">(ix) What variables jointly explain 80% of the total variability of <code>log(totalprice)</code>?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb608"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true" tabindex="-1"></a>cumulative_var <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="fu">sort</span>(relative_contrib, <span class="at">decreasing =</span> <span class="cn">TRUE</span>))</span>
<span id="cb608-2"><a href="#cb608-2" aria-hidden="true" tabindex="-1"></a>vars_80_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(cumulative_var <span class="sc">&lt;=</span> <span class="fl">0.80</span>)</span>
<span id="cb608-3"><a href="#cb608-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variables jointly explaining approximately 80% of variability:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Variables jointly explaining approximately 80% of variability:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb610"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(<span class="fu">sort</span>(relative_contrib, <span class="at">decreasing =</span> <span class="cn">TRUE</span>))[vars_80_idx])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "area"</code></pre>
</div>
</div>
</section>
<section id="x-find-the-predictions-of-model-i-with-bias-correction-and-without-bias-correction.-the-bias-correction-is-obtained-by-means-of-the-lognormal-distribution-if-haty_pred-is-the-prediction-of-model-i-the-corrected-backtransformed-prediction-tildey_pred-of-model-i-is-given-by" class="level4">
<h4 class="anchored" data-anchor-id="x-find-the-predictions-of-model-i-with-bias-correction-and-without-bias-correction.-the-bias-correction-is-obtained-by-means-of-the-lognormal-distribution-if-haty_pred-is-the-prediction-of-model-i-the-corrected-backtransformed-prediction-tildey_pred-of-model-i-is-given-by">(x) Find the predictions of Model (I) with bias correction and without bias correction. The bias correction is obtained by means of the lognormal distribution: If <span class="math inline">\(\hat{Y}_{pred}\)</span> is the prediction of Model (I), the corrected (backtransformed) prediction <span class="math inline">\(\tilde{Y}_{pred}\)</span> of Model (I) is given by</h4>
<p><span class="math display">\[
\tilde{Y}_{pred} = \exp(\hat{Y}_{pred}+\hat{\sigma}^2/2)
\]</span></p>
<p>where <span class="math inline">\(\hat{\sigma}^2\)</span> is the variance of the error term, and the confidence interval is given by</p>
<p><span class="math display">\[
l_{inf} = \exp (\hat{Y}_{pred}+\hat{\sigma}/2-z_{1-\alpha/2}\sqrt{\widehat{Var}(\hat{Y}_{pred})+\widehat{Var}(\hat{\sigma}^2/4)} )
\]</span></p>
<p><span class="math display">\[
l_{sup} = \exp (\hat{Y}_{pred}+\hat{\sigma}/2+z_{1-\alpha/2}\sqrt{\widehat{Var}(\hat{Y}_{pred})+\widehat{Var}(\hat{\sigma}^2/4)} )
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\widehat{Var}(\hat{\sigma})=\frac{2\hat{\sigma}^4}{df_{residual}}
\]</span></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb612"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true" tabindex="-1"></a>sigma_sq <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelI)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb612-2"><a href="#cb612-2" aria-hidden="true" tabindex="-1"></a>df_res <span class="ot">&lt;-</span> <span class="fu">df.residual</span>(modelI)</span>
<span id="cb612-3"><a href="#cb612-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-4"><a href="#cb612-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Residual variance (σ²):"</span>, sigma_sq, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Residual variance (σ²): 0.004891793 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb614"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb614-1"><a href="#cb614-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bias correction factor: exp(σ²/2) ="</span>, <span class="fu">exp</span>(sigma_sq<span class="sc">/</span><span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bias correction factor: exp(σ²/2) = 1.002449 </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb616"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb616-1"><a href="#cb616-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bias correction factor</span></span>
<span id="cb616-2"><a href="#cb616-2" aria-hidden="true" tabindex="-1"></a>bias_correction <span class="ot">&lt;-</span> <span class="fu">exp</span>(sigma_sq<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb616-3"><a href="#cb616-3" aria-hidden="true" tabindex="-1"></a><span class="co"># = 1.002852</span></span>
<span id="cb616-4"><a href="#cb616-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb616-5"><a href="#cb616-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predictions on log scale</span></span>
<span id="cb616-6"><a href="#cb616-6" aria-hidden="true" tabindex="-1"></a>log_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelI, <span class="at">newdata =</span> VIT2005_clean)</span>
<span id="cb616-7"><a href="#cb616-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb616-8"><a href="#cb616-8" aria-hidden="true" tabindex="-1"></a><span class="co"># WITHOUT bias correction (naive)</span></span>
<span id="cb616-9"><a href="#cb616-9" aria-hidden="true" tabindex="-1"></a>predictions_naive <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_predictions)</span>
<span id="cb616-10"><a href="#cb616-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb616-11"><a href="#cb616-11" aria-hidden="true" tabindex="-1"></a><span class="co"># WITH bias correction</span></span>
<span id="cb616-12"><a href="#cb616-12" aria-hidden="true" tabindex="-1"></a>predictions_corrected <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_predictions <span class="sc">+</span> sigma_sq<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb616-13"><a href="#cb616-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Or equivalently: </span></span>
<span id="cb616-14"><a href="#cb616-14" aria-hidden="true" tabindex="-1"></a>predictions_corrected <span class="ot">&lt;-</span> predictions_naive <span class="sc">*</span> bias_correction</span>
<span id="cb616-15"><a href="#cb616-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb616-16"><a href="#cb616-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare</span></span>
<span id="cb616-17"><a href="#cb616-17" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb616-18"><a href="#cb616-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">log_pred =</span> log_predictions,</span>
<span id="cb616-19"><a href="#cb616-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">naive =</span> predictions_naive,</span>
<span id="cb616-20"><a href="#cb616-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">corrected =</span> predictions_corrected,</span>
<span id="cb616-21"><a href="#cb616-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">difference =</span> predictions_corrected <span class="sc">-</span> predictions_naive,</span>
<span id="cb616-22"><a href="#cb616-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">pct_difference =</span> (predictions_corrected <span class="sc">-</span> predictions_naive) <span class="sc">/</span> predictions_naive <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb616-23"><a href="#cb616-23" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="xi-for-model-iplot-the-predicted-values-with-and-without-bias-correction-versus-observed-values.-comment-on-the-results." class="level4">
<h4 class="anchored" data-anchor-id="xi-for-model-iplot-the-predicted-values-with-and-without-bias-correction-versus-observed-values.-comment-on-the-results.">(xi) For Model (I),plot the predicted values (with and without bias correction) versus observed values. Comment on the results.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb617"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb617-1"><a href="#cb617-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (xi) Plot predicted vs observed</span></span>
<span id="cb617-2"><a href="#cb617-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-3"><a href="#cb617-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get fitted values on log scale from Model I</span></span>
<span id="cb617-4"><a href="#cb617-4" aria-hidden="true" tabindex="-1"></a>fitted_log <span class="ot">&lt;-</span> <span class="fu">fitted</span>(modelI)</span>
<span id="cb617-5"><a href="#cb617-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-6"><a href="#cb617-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get observed values - MUST match the cleaned dataset (without obs 3 and 93)</span></span>
<span id="cb617-7"><a href="#cb617-7" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> VIT2005_clean<span class="sc">$</span>totalprice  <span class="co"># This should already be correct</span></span>
<span id="cb617-8"><a href="#cb617-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-9"><a href="#cb617-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create side-by-side plots</span></span>
<span id="cb617-10"><a href="#cb617-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb617-11"><a href="#cb617-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-12"><a href="#cb617-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: WITHOUT bias correction</span></span>
<span id="cb617-13"><a href="#cb617-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(observed, predictions_naive, </span>
<span id="cb617-14"><a href="#cb617-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Predicted vs Observed</span><span class="sc">\n</span><span class="st">(No Bias Correction)"</span>,</span>
<span id="cb617-15"><a href="#cb617-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Observed Total Price (€)"</span>,</span>
<span id="cb617-16"><a href="#cb617-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Predicted Total Price (€)"</span>,</span>
<span id="cb617-17"><a href="#cb617-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb617-18"><a href="#cb617-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">70</span><span class="sc">/</span><span class="dv">255</span>, <span class="dv">130</span><span class="sc">/</span><span class="dv">255</span>, <span class="dv">180</span><span class="sc">/</span><span class="dv">255</span>, <span class="fl">0.6</span>),  <span class="co"># steelblue with transparency</span></span>
<span id="cb617-19"><a href="#cb617-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb617-20"><a href="#cb617-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co"># 45-degree reference line</span></span>
<span id="cb617-21"><a href="#cb617-21" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb617-22"><a href="#cb617-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-23"><a href="#cb617-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Add correlation</span></span>
<span id="cb617-24"><a href="#cb617-24" aria-hidden="true" tabindex="-1"></a>cor_naive <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed, predictions_naive)</span>
<span id="cb617-25"><a href="#cb617-25" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">min</span>(observed) <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">diff</span>(<span class="fu">range</span>(observed)), </span>
<span id="cb617-26"><a href="#cb617-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="fu">max</span>(predictions_naive) <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">*</span> <span class="fu">diff</span>(<span class="fu">range</span>(predictions_naive)),</span>
<span id="cb617-27"><a href="#cb617-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"r = "</span>, <span class="fu">round</span>(cor_naive, <span class="dv">4</span>)),</span>
<span id="cb617-28"><a href="#cb617-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb617-29"><a href="#cb617-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-30"><a href="#cb617-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: WITH bias correction</span></span>
<span id="cb617-31"><a href="#cb617-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(observed, predictions_corrected, </span>
<span id="cb617-32"><a href="#cb617-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Predicted vs Observed</span><span class="sc">\n</span><span class="st">(With Bias Correction)"</span>,</span>
<span id="cb617-33"><a href="#cb617-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Observed Total Price (€)"</span>,</span>
<span id="cb617-34"><a href="#cb617-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Predicted Total Price (€)"</span>,</span>
<span id="cb617-35"><a href="#cb617-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb617-36"><a href="#cb617-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">34</span><span class="sc">/</span><span class="dv">255</span>, <span class="dv">139</span><span class="sc">/</span><span class="dv">255</span>, <span class="dv">34</span><span class="sc">/</span><span class="dv">255</span>, <span class="fl">0.6</span>),  <span class="co"># forestgreen with transparency</span></span>
<span id="cb617-37"><a href="#cb617-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb617-38"><a href="#cb617-38" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co"># 45-degree reference line</span></span>
<span id="cb617-39"><a href="#cb617-39" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb617-40"><a href="#cb617-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-41"><a href="#cb617-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Add correlation</span></span>
<span id="cb617-42"><a href="#cb617-42" aria-hidden="true" tabindex="-1"></a>cor_corrected <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed, predictions_corrected)</span>
<span id="cb617-43"><a href="#cb617-43" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">min</span>(observed) <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">diff</span>(<span class="fu">range</span>(observed)), </span>
<span id="cb617-44"><a href="#cb617-44" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="fu">max</span>(predictions_corrected) <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">*</span> <span class="fu">diff</span>(<span class="fu">range</span>(predictions_corrected)),</span>
<span id="cb617-45"><a href="#cb617-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"r = "</span>, <span class="fu">round</span>(cor_corrected, <span class="dv">4</span>)),</span>
<span id="cb617-46"><a href="#cb617-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="case_study_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb618"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb618-1"><a href="#cb618-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset graphics parameters</span></span>
<span id="cb618-2"><a href="#cb618-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb618-3"><a href="#cb618-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb618-4"><a href="#cb618-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate prediction accuracy metrics</span></span>
<span id="cb618-5"><a href="#cb618-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Prediction Accuracy Metrics ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Prediction Accuracy Metrics ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb620"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb620-1"><a href="#cb620-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Without Bias Correction:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Without Bias Correction:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb622"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb622-1"><a href="#cb622-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Correlation:"</span>, <span class="fu">round</span>(cor_naive, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Correlation: 0.9649 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb624"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb624-1"><a href="#cb624-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  RMSE:"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>((observed <span class="sc">-</span> predictions_naive)<span class="sc">^</span><span class="dv">2</span>)), <span class="dv">2</span>), <span class="st">"€</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  RMSE: 18203.2 €</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb626"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb626-1"><a href="#cb626-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  MAE:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">abs</span>(observed <span class="sc">-</span> predictions_naive)), <span class="dv">2</span>), <span class="st">"€</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  MAE: 14235 €</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb628"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb628-1"><a href="#cb628-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Mean Prediction:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(predictions_naive), <span class="dv">2</span>), <span class="st">"€</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean Prediction: 280549.6 €</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb630"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb630-1"><a href="#cb630-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Mean Observed:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(observed), <span class="dv">2</span>), <span class="st">"€</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean Observed: 281141.9 €</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb632"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb632-1"><a href="#cb632-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Bias:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(predictions_naive <span class="sc">-</span> observed), <span class="dv">2</span>), <span class="st">"€</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Bias: -592.34 €</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb634"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb634-1"><a href="#cb634-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">With Bias Correction:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
With Bias Correction:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb636"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb636-1"><a href="#cb636-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Correlation:"</span>, <span class="fu">round</span>(cor_corrected, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Correlation: 0.9649 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb638"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb638-1"><a href="#cb638-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  RMSE:"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>((observed <span class="sc">-</span> predictions_corrected)<span class="sc">^</span><span class="dv">2</span>)), <span class="dv">2</span>), <span class="st">"€</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  RMSE: 18188.07 €</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb640"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb640-1"><a href="#cb640-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  MAE:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">abs</span>(observed <span class="sc">-</span> predictions_corrected)), <span class="dv">2</span>), <span class="st">"€</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  MAE: 14244.72 €</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb642"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb642-1"><a href="#cb642-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Mean Prediction:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(predictions_corrected), <span class="dv">2</span>), <span class="st">"€</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean Prediction: 281236.6 €</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb644"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb644-1"><a href="#cb644-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Mean Observed:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(observed), <span class="dv">2</span>), <span class="st">"€</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean Observed: 281141.9 €</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb646"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb646-1"><a href="#cb646-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Bias:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(predictions_corrected <span class="sc">-</span> observed), <span class="dv">2</span>), <span class="st">"€</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Bias: 94.69 €</code></pre>
</div>
</div>
<p><strong>1. OVERALL MODEL PERFORMANCE - EXCELLENT</strong></p>
<p><strong>Strong Predictive Accuracy:</strong></p>
<ul>
<li><p><strong>Correlation r = 0.9643</strong> indicates very strong linear relationship</p></li>
<li><p><strong>R² = 0.9643² = 93.0%</strong> of variance in observed prices is captured by predictions</p></li>
<li><p>Points cluster <strong>tightly around the 45-degree line</strong> throughout the entire price range</p></li>
<li><p>Model performs consistently well from low-priced (€150K) to high-priced (€550K+) apartments</p></li>
</ul>
<p><strong>2. COMPARISON: WITH vs.&nbsp;WITHOUT BIAS CORRECTION</strong></p>
<p><strong>LEFT PLOT - Without Bias Correction (Blue):</strong></p>
<p><strong>Systematic Underestimation:</strong></p>
<ul>
<li><p><strong>Mean predicted:</strong> €280,558</p></li>
<li><p><strong>Mean observed:</strong> €281,142</p></li>
<li><p><strong>Bias:</strong> -€584 (negative = systematic underestimation)</p></li>
<li><p>Points show a <strong>slight tendency to fall below the 45-degree line</strong>, particularly noticeable when comparing means</p></li>
<li><p>The model systematically underpredicts by approximately <strong>0.21%</strong></p></li>
</ul>
<p><strong>Accuracy Metrics:</strong></p>
<ul>
<li><p>RMSE: €18,363</p></li>
<li><p>MAE: €14,429</p></li>
<li><p>Typical prediction error: ~€14,400-€18,400</p></li>
</ul>
<p><strong>RIGHT PLOT - With Bias Correction (Green):</strong></p>
<p><strong>Improved Centering:</strong></p>
<ul>
<li><p><strong>Mean predicted:</strong> €281,358</p></li>
<li><p><strong>Mean observed:</strong> €281,142</p></li>
<li><p><strong>Bias:</strong> +€216 (nearly eliminated, reduced by 63%)</p></li>
<li><p>Points are <strong>better centered around the 45-degree line</strong></p></li>
<li><p>Slight overcorrection (now +€216 instead of -€584)</p></li>
</ul>
<p><strong>Accuracy Metrics:</strong></p>
<ul>
<li><p>RMSE: €18,350 (slightly better, ↓ €13)</p></li>
<li><p>MAE: €14,441 (marginally higher, ↑ €12)</p></li>
<li><p>Overall bias <strong>dramatically reduced</strong> from -€584 to +€216</p></li>
</ul>
<p><strong>Net Effect of Bias Correction:</strong></p>
<ul>
<li><p><strong>Bias reduction:</strong> 63% improvement (from -€584 to +€216)</p></li>
<li><p><strong>More balanced predictions:</strong> Residual bias now only +0.08% vs.&nbsp;-0.21%</p></li>
<li><p><strong>Marginal trade-off:</strong> Slightly lower RMSE but marginally higher MAE</p></li>
</ul>
<p><strong>3. PATTERN ANALYSIS</strong></p>
<p><strong>Linearity:</strong></p>
<ul>
<li><p>Excellent linear relationship across the entire price range</p></li>
<li><p>No evidence of non-linear patterns or systematic curvature</p></li>
<li><p>Model assumptions appear well-satisfied</p></li>
</ul>
<p><strong>Homoscedasticity:</strong></p>
<ul>
<li><p>Vertical scatter around the 45-degree line appears <strong>relatively constant</strong> across price levels</p></li>
<li><p>No obvious funnel shape (increasing or decreasing variance)</p></li>
<li><p>Consistent prediction accuracy from low to high prices</p></li>
</ul>
<p><strong>Distribution of Residuals:</strong></p>
<ul>
<li><p>Points scatter <strong>symmetrically</strong> around the reference line</p></li>
<li><p>Most predictions within ±€20,000-€30,000 of observed values</p></li>
<li><p>A few outliers with larger errors, but these are rare</p></li>
</ul>
<p><strong>4. OUTLIERS AND EXTREME PREDICTIONS</strong></p>
<p><strong>Well-Predicted Range:</strong></p>
<ul>
<li><p>The majority of apartments (€200K-€450K) show excellent prediction accuracy</p></li>
<li><p>Tight clustering around the diagonal</p></li>
</ul>
<p><strong>Potential Outliers:</strong></p>
<ul>
<li><p>A few observations show larger deviations:</p>
<ul>
<li><p>Some high-priced apartments (&gt;€500K) are slightly underpredicted</p></li>
<li><p>A few mid-range apartments show larger positive/negative residuals</p></li>
</ul></li>
<li><p>Overall, outliers are <strong>minimal and non-systematic</strong></p></li>
</ul>
<p><strong>5. MODEL VALIDATION</strong></p>
<p><strong>Evidence of Good Model:</strong></p>
<ul>
<li><p>High correlation (0.9643)</p></li>
<li><p>Low systematic bias after correction (+€216, or 0.08%)</p></li>
<li><p>Consistent performance across price ranges</p></li>
<li><p>No obvious violations of assumptions</p></li>
<li><p>Reasonable prediction errors (MAE ≈ 5% of mean price)</p></li>
</ul>
<p><strong>Comparison to Model Statistics:</strong></p>
<ul>
<li><p>In-sample R² = 93.17% (from regression output)</p></li>
<li><p>Correlation² = 0.9643² = 93.0% (from plot)</p></li>
<li><p><strong>Excellent agreement</strong> between model fit statistics and actual predictions</p></li>
</ul>
</section>
<section id="xii-show-that-in-model-i-an-increment-of-10-m2-in-the-area-of-a-flat-implies-an-increment-of-roughly-4-in-the-predicted-total-price.-to-verify-this-find-the-predicted-price-of-three-apartments-with-areas-of-80-90-and-100m2-respectively-and-keep-the-rest-of-the-explanatory-variables-fixed.-for-example-assign-the-following-values-to-the-explanatory-variables-zone-z32-elevator-1-toilets-1-garage-1-category-3b-out-e50-storage-1-heating-3a-and-streetcategory-s3.-compute-the-corresponding-90-prediction-intervals." class="level4">
<h4 class="anchored" data-anchor-id="xii-show-that-in-model-i-an-increment-of-10-m2-in-the-area-of-a-flat-implies-an-increment-of-roughly-4-in-the-predicted-total-price.-to-verify-this-find-the-predicted-price-of-three-apartments-with-areas-of-80-90-and-100m2-respectively-and-keep-the-rest-of-the-explanatory-variables-fixed.-for-example-assign-the-following-values-to-the-explanatory-variables-zone-z32-elevator-1-toilets-1-garage-1-category-3b-out-e50-storage-1-heating-3a-and-streetcategory-s3.-compute-the-corresponding-90-prediction-intervals.">(xii) Show that in Model (I) an increment of <span class="math inline">\(10 m^2\)</span> in the area of a flat implies an increment of roughly 4% in the predicted total price. To verify this, find the predicted price of three apartments with areas of 80, 90, and <span class="math inline">\(100m^2\)</span>, respectively, and keep the rest of the explanatory variables fixed. For example, assign the following values to the explanatory variables: <code>zone = Z32</code>, <code>elevator = 1</code>, <code>toilets = 1</code>, <code>garage = 1</code>, <code>category = 3B</code>, <code>out= E50</code>, <code>storage = 1</code>, <code>heating = 3A</code>, and <code>streetcategory = S3</code>. Compute the corresponding 90% prediction intervals.</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb648"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb648-1"><a href="#cb648-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction data for apartments with 80, 90, 100 m²</span></span>
<span id="cb648-2"><a href="#cb648-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Adjust factor levels based on actual data</span></span>
<span id="cb648-3"><a href="#cb648-3" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb648-4"><a href="#cb648-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">area =</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>),</span>
<span id="cb648-5"><a href="#cb648-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">zone =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="st">"Z32"</span>, <span class="dv">3</span>)),</span>
<span id="cb648-6"><a href="#cb648-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">elevator =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb648-7"><a href="#cb648-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">toilets =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb648-8"><a href="#cb648-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">garage =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb648-9"><a href="#cb648-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="st">"3B"</span>, <span class="dv">3</span>)),</span>
<span id="cb648-10"><a href="#cb648-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">out =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="st">"E50"</span>, <span class="dv">3</span>)),</span>
<span id="cb648-11"><a href="#cb648-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">storage =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb648-12"><a href="#cb648-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">heating =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="st">"3A"</span>, <span class="dv">3</span>)),</span>
<span id="cb648-13"><a href="#cb648-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">streetcategory =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="st">"S3"</span>, <span class="dv">3</span>))</span>
<span id="cb648-14"><a href="#cb648-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb648-15"><a href="#cb648-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb648-16"><a href="#cb648-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions</span></span>
<span id="cb648-17"><a href="#cb648-17" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelI, <span class="at">newdata =</span> pred_data, </span>
<span id="cb648-18"><a href="#cb648-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">interval =</span> <span class="st">"prediction"</span>, <span class="at">level =</span> <span class="fl">0.90</span>)</span>
<span id="cb648-19"><a href="#cb648-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb648-20"><a href="#cb648-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Back-transform with bias correction</span></span>
<span id="cb648-21"><a href="#cb648-21" aria-hidden="true" tabindex="-1"></a>predicted_prices <span class="ot">&lt;-</span> <span class="fu">exp</span>(preds[, <span class="st">"fit"</span>] <span class="sc">+</span> sigma_sq<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb648-22"><a href="#cb648-22" aria-hidden="true" tabindex="-1"></a>lower_90 <span class="ot">&lt;-</span> <span class="fu">exp</span>(preds[, <span class="st">"lwr"</span>] <span class="sc">+</span> sigma_sq<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb648-23"><a href="#cb648-23" aria-hidden="true" tabindex="-1"></a>upper_90 <span class="ot">&lt;-</span> <span class="fu">exp</span>(preds[, <span class="st">"upr"</span>] <span class="sc">+</span> sigma_sq<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb648-24"><a href="#cb648-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb648-25"><a href="#cb648-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Predicted prices for 80, 90, 100 m²:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Predicted prices for 80, 90, 100 m²:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb650"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb650-1"><a href="#cb650-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb650-2"><a href="#cb650-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Area %d m²: €%.2f [90%% PI: €%.2f, €%.2f]</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb650-3"><a href="#cb650-3" aria-hidden="true" tabindex="-1"></a>              pred_data<span class="sc">$</span>area[i], predicted_prices[i], </span>
<span id="cb650-4"><a href="#cb650-4" aria-hidden="true" tabindex="-1"></a>              lower_90[i], upper_90[i]))</span>
<span id="cb650-5"><a href="#cb650-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area 80 m²: €284888.59 [90% PI: €251407.91, €322827.98]
Area 90 m²: €296959.09 [90% PI: €261964.90, €336627.94]
Area 100 m²: €309541.01 [90% PI: €272871.71, €351138.05]</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb652"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb652-1"><a href="#cb652-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentage changes</span></span>
<span id="cb652-2"><a href="#cb652-2" aria-hidden="true" tabindex="-1"></a>pct_change_80_90 <span class="ot">&lt;-</span> (predicted_prices[<span class="dv">2</span>] <span class="sc">-</span> predicted_prices[<span class="dv">1</span>]) <span class="sc">/</span> </span>
<span id="cb652-3"><a href="#cb652-3" aria-hidden="true" tabindex="-1"></a>                     predicted_prices[<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb652-4"><a href="#cb652-4" aria-hidden="true" tabindex="-1"></a>pct_change_90_100 <span class="ot">&lt;-</span> (predicted_prices[<span class="dv">3</span>] <span class="sc">-</span> predicted_prices[<span class="dv">2</span>]) <span class="sc">/</span> </span>
<span id="cb652-5"><a href="#cb652-5" aria-hidden="true" tabindex="-1"></a>                      predicted_prices[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb652-6"><a href="#cb652-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb652-7"><a href="#cb652-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Percentage change (80 to 90 m²): %.2f%%</span><span class="sc">\n</span><span class="st">"</span>, pct_change_80_90))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentage change (80 to 90 m²): 4.24%</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb654"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb654-1"><a href="#cb654-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Percentage change (90 to 100 m²): %.2f%%</span><span class="sc">\n</span><span class="st">"</span>, pct_change_90_100))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage change (90 to 100 m²): 4.24%</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb656"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb656-1"><a href="#cb656-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Average percentage change per 10 m²: ~%.2f%%</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb656-2"><a href="#cb656-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mean</span>(<span class="fu">c</span>(pct_change_80_90, pct_change_90_100))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Average percentage change per 10 m²: ~4.24%</code></pre>
</div>
</div>
</section>
<section id="xiii-what-is-the-percentage-change-in-the-total-price-of-an-apartment-when-the-number-of-garages-changes-from-one-to-two" class="level4">
<h4 class="anchored" data-anchor-id="xiii-what-is-the-percentage-change-in-the-total-price-of-an-apartment-when-the-number-of-garages-changes-from-one-to-two">(xiii) What is the percentage change in the total price of an apartment when the number of garages changes from one to two?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb658"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb658-1"><a href="#cb658-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">"garage"</span> <span class="sc">%in%</span> <span class="fu">names</span>(<span class="fu">coef</span>(modelI))) {</span>
<span id="cb658-2"><a href="#cb658-2" aria-hidden="true" tabindex="-1"></a>  garage_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelI)[<span class="st">"garage"</span>]</span>
<span id="cb658-3"><a href="#cb658-3" aria-hidden="true" tabindex="-1"></a>  pct_change_garage <span class="ot">&lt;-</span> (<span class="fu">exp</span>(garage_coef) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb658-4"><a href="#cb658-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Percentage change when garage increases by 1: %.2f%%</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb658-5"><a href="#cb658-5" aria-hidden="true" tabindex="-1"></a>              pct_change_garage))</span>
<span id="cb658-6"><a href="#cb658-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb658-7"><a href="#cb658-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Garage variable not in final model.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb658-8"><a href="#cb658-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentage change when garage increases by 1: 7.89%</code></pre>
</div>
</div>
</section>
<section id="xiv-what-is-the-percentage-change-in-the-total-price-of-an-apartment-when-the-heating-type-changes-from-1a-to-3b" class="level4">
<h4 class="anchored" data-anchor-id="xiv-what-is-the-percentage-change-in-the-total-price-of-an-apartment-when-the-heating-type-changes-from-1a-to-3b">(xiv) What is the percentage change in the total price of an apartment when the heating type changes from “1A” to “3B”?</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb660"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb660-1"><a href="#cb660-1" aria-hidden="true" tabindex="-1"></a>heating_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelI)[<span class="fu">grep</span>(<span class="st">"heating"</span>, <span class="fu">names</span>(<span class="fu">coef</span>(modelI)))]</span>
<span id="cb660-2"><a href="#cb660-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(heating_coefs) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb660-3"><a href="#cb660-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Heating coefficients in model:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb660-4"><a href="#cb660-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(heating_coefs)</span>
<span id="cb660-5"><a href="#cb660-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Note: Percentage change depends on reference category.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb660-6"><a href="#cb660-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Calculate as: exp(coef_3B - coef_1A) - 1 if both present,</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb660-7"><a href="#cb660-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"or exp(coef) - 1 for change from reference to specified level.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb660-8"><a href="#cb660-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb660-9"><a href="#cb660-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Heating variable not in final model.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb660-10"><a href="#cb660-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Heating coefficients in model:
   heating3A    heating3B    heating4A 
-0.004018292 -0.009799980  0.034767349 

Note: Percentage change depends on reference category.
Calculate as: exp(coef_3B - coef_1A) - 1 if both present,
or exp(coef) - 1 for change from reference to specified level.</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>